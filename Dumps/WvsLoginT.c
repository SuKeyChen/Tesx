/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2015 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __cdecl operator new(unsigned int uSize);
void __cdecl operator delete(void *p); // idb
int _E14();
void _E11();
int _E13();
void __cdecl _E12(); // idb
void __thiscall CAdminAcceptor::CAdminAcceptor(CAdminAcceptor *this); // idb
CAdminAcceptor *__thiscall CAdminAcceptor::`scalar deleting destructor'(CAdminAcceptor *this, unsigned int __flags);
void __thiscall CAdminAcceptor::~CAdminAcceptor(CAdminAcceptor *this); // idb
int __thiscall CAdminAcceptor::Begin(CAdminAcceptor *this, ZInetAddr *sockaddr); // idb
void __thiscall CAdminAcceptor::Terminate(CAdminAcceptor *this); // idb
void __thiscall CAdminAcceptor::RemoveSocket(CAdminAcceptor *this, CAdminSocket *pSocket); // idb
void __thiscall CAdminAcceptor::OnAccept(CAdminAcceptor *this, unsigned int dwErr, CAdminSocket *pSocket, sockaddr_in *pAddr); // idb
void *_L112199();
void __thiscall ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>(ZCriticalSectionEx<4000> *this); // idb
void __thiscall ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>(ZSynchronizedHelper<ZCriticalSectionEx<4000> > *this); // idb
void __thiscall ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>(ZRef<ZSocketBuffer> *this); // idb
void __thiscall ZSocketAcceptor<CAdminSocket>::~ZSocketAcceptor<CAdminSocket>(ZSocketAcceptor<CAdminSocket> *this); // idb
void __stdcall ZSocketAcceptor<CAdminSocket>::OnAccept(unsigned int dwErr, CAdminSocket *pSocket, sockaddr_in *pAddr);
int ZSocketAcceptor<CAdminSocket>::GetType();
void TSingleton<CAdminAcceptor>::~TSingleton<CAdminAcceptor>();
void __thiscall ZList<ZRef<CAdminSocket>>::~ZList<ZRef<CAdminSocket>>(ZList<ZRef<CAdminSocket> > *this); // idb
ZRef<CAdminSocket> *__thiscall ZList<ZRef<CAdminSocket>>::AddTail(ZList<ZRef<CAdminSocket> > *this, ZRef<CAdminSocket> *d);
void __thiscall ZRef<CAdminSocket>::~ZRef<CAdminSocket>(ZRef<CAdminSocket> *this); // idb
ZSocketAcceptor<CAdminSocket> *__thiscall ZSocketAcceptor<CAdminSocket>::`vector deleting destructor'(ZSocketAcceptor<CAdminSocket> *this, unsigned int __flags);
ZList<ZRef<CAdminSocket> > *__thiscall ZList<ZRef<CAdminSocket>>::`scalar deleting destructor'(ZList<ZRef<CAdminSocket> > *this, unsigned int __flags);
void __thiscall ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::~ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>(ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped> *this); // idb
ZRef<CAdminSocket> *__thiscall ZRef<CAdminSocket>::operator=(ZRef<CAdminSocket> *this, ZRef<CAdminSocket> *r); // idb
void __thiscall ZRef<CAdminSocket>::_AddRef(ZRef<CAdminSocket> *this); // idb
void __thiscall ZRef<CAdminSocket>::_Release(ZRef<CAdminSocket> *this); // idb
void __thiscall ZRef<ZSocketBuffer>::_ReleaseRaw(ZRef<ZSocketBuffer> *this, ZRefCounted *__formal); // idb
void __cdecl ZRefCountedAccessorBase::_Delete(ZRefCounted *p); // idb
void __thiscall ZRef<CAdminSocket>::_ReleaseRaw(ZRef<CAdminSocket> *this, ZRefCounted *__formal); // idb
int __thiscall ZAllocEx<ZAllocAnonSelector>::Alloc(ZAllocEx<ZAllocAnonSelector> *this, unsigned int uSize);
char *__cdecl ZAllocBase::_AllocRawBlocks(unsigned int uBlockSize, unsigned int u);
void __thiscall ZAllocEx<ZAllocAnonSelector>::Free(ZAllocEx<ZAllocAnonSelector> *this, void *p); // idb
ZXString<char> *ZXString<char>::Format(ZXString<char> *this, const char *sFormat, ...); // idb
void __thiscall ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::RemoveAll(ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped> *this); // idb
int __thiscall ZSocketAcceptor<CAdminSocket>::BeginAcceptor(ZSocketAcceptor<CAdminSocket> *this, sockaddr_in *pAddr, ZPort *pPort, int nAccepts, int backlog); // idb
void __thiscall ZSocketAcceptor<CAdminSocket>::CloseAcceptor(ZSocketAcceptor<CAdminSocket> *this); // idb
void __cdecl ZSocketAcceptor<CAdminSocket>::OnComplete(void *pUser, unsigned int key, unsigned int dwErr);
void *_L113873();
ZRef<CAdminSocket> *__thiscall ZList<ZRef<CAdminSocket>>::AddTail(ZList<ZRef<CAdminSocket> > *this); // idb
void __thiscall ZList<ZRef<CAdminSocket>>::RemoveAt(ZList<ZRef<CAdminSocket> > *this, __POSITION *pos); // idb
void __thiscall ZList<ZRef<CAdminSocket>>::RemoveAll(ZList<ZRef<CAdminSocket> > *this); // idb
void _E20();
void _E18();
void _E19();
void __thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this); // idb
ZRecyclableStatic::CallBack *__thiscall ZRecyclableStatic::CallBack::`vector deleting destructor'(ZRecyclableStatic::CallBack *this, unsigned int __flags);
void __thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this); // idb
ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *__thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vector deleting destructor'(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this, unsigned int __flags);
void __thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::~ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::~ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this); // idb
void __thiscall ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped::~ZAcceptOverlapped(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *this); // idb
void __thiscall ZXString<char>::_FormatV(ZXString<char> *this, const char *lpszFormat, char *argList); // idb
void __thiscall ZXString<char>::~ZXString<char>(ZXString<char> *this); // idb
ZXString<char> *__thiscall ZXString<char>::operator=(ZXString<char> *this, ZXString<char> *s); // idb
void __thiscall ZXString<char>::Assign(ZXString<char> *this, const char *s, int n); // idb
void __thiscall ZXString<char>::Empty(ZXString<char> *this); // idb
char *__thiscall ZXString<char>::GetBuffer(ZXString<char> *this, int nMinLength, int bRetain); // idb
void __thiscall ZXString<char>::ReleaseBuffer(ZXString<char> *this, int nLength); // idb
ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *__thiscall ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::_Alloc(ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
void __thiscall ZSocketAcceptor<CAdminSocket>::_BeginAccept(ZSocketAcceptor<CAdminSocket> *this, ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *pOverlapped); // idb
ZRef<CAdminSocket> *__thiscall ZList<ZRef<CAdminSocket>>::_New(ZList<ZRef<CAdminSocket> > *this, void *pPrev, void *pNext); // idb
void _E39();
void _E31();
void _E32();
void _E33();
void _E34();
void _E35();
void _E36();
void _E37();
void _E38();
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this); // idb
ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this, unsigned int __flags);
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::~ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::~ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this); // idb
int __thiscall ZAllocEx<ZAllocStrSelector<char>>::Alloc(ZAllocEx<ZAllocStrSelector<char> > *this, unsigned int uSize);
void __thiscall ZAllocEx<ZAllocStrSelector<char>>::Free(ZAllocEx<ZAllocStrSelector<char> > *this, void *p); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this, void *p); // idb
ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *__cdecl construct(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *p); // idb
void __thiscall ZRefCountedDummy<ZRef<CAdminSocket>>::ZRefCountedDummy<ZRef<CAdminSocket>>(ZRefCountedDummy<ZRef<CAdminSocket> > *this); // idb
ZRefCounted *__thiscall ZRefCounted::`vector deleting destructor'(ZRefCounted *this, unsigned int __flags);
ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *__thiscall ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this, unsigned int __flags);
ZRefCountedDummy<ZRef<CAdminSocket> > *__thiscall ZRefCountedDummy<ZRef<CAdminSocket>>::`vector deleting destructor'(ZRefCountedDummy<ZRef<CAdminSocket> > *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<ZRef<CAdminSocket>>::~ZRefCountedDummy<ZRef<CAdminSocket>>(ZRefCountedDummy<ZRef<CAdminSocket> > *this); // idb
void __thiscall ZRefCounted::~ZRefCounted(ZRefCounted *this); // idb
void __thiscall ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::~ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this);
char *__thiscall ZInetAddr::GetAddr(ZInetAddr *this);
void __thiscall ZSocketBase::~ZSocketBase(ZSocketBase *this); // idb
void __thiscall ZSocketBase::Listen(ZSocketBase *this, int backlog); // idb
void __thiscall ZSocketBase::SetNonBlocking(ZSocketBase *this, int bNonBlocking); // idb
void __thiscall ZSocketBase::UpdateAcceptContext(ZSocketBase *this, unsigned int hListenSocket); // idb
void __thiscall ZPort::~ZPort(ZPort *this); // idb
ZList<ZPort::ZPortThread *> *__thiscall ZList<ZPort::ZPortThread *>::`vector deleting destructor'(ZList<ZPort::ZPortThread *> *this, unsigned int __flags);
void __thiscall ZList<ZPort::ZPortThread *>::RemoveAll(ZList<ZPort::ZPortThread *> *this); // idb
ZPort *__thiscall ZPort::`vector deleting destructor'(ZPort *this, unsigned int __flags);
void __thiscall ZSocketEx::_SockRelease(ZSocketEx *this); // idb
void __cdecl ZSocketBuffer::Alloc(unsigned int u);
void __thiscall ZSocketBuffer::ZSocketBuffer(ZSocketBuffer *this, unsigned int len, char *buf, ZSocketBuffer *pParent); // idb
ZRef<ZSocketBuffer> *__thiscall ZRef<ZSocketBuffer>::operator=(ZRef<ZSocketBuffer> *this, ZSocketBuffer *pT); // idb
ZSocketBuffer *__thiscall ZSocketBuffer::`vector deleting destructor'(ZSocketBuffer *this, unsigned int __flags);
void __thiscall ZSocketBuffer::~ZSocketBuffer(ZSocketBuffer *this); // idb
void __thiscall ZPort::ZPort(ZPort *this); // idb
void __thiscall ZPort::Attach(ZPort *this, void *hFile); // idb
int __thiscall ZPort::BeginPort(ZPort *this, unsigned int uThreads); // idb
int __thiscall ZPort::_AddThread(ZPort *this); // idb
int __thiscall ZThread::BeginThread(ZThread *this, void *pParam, int nPriority, int bSuspended, unsigned int dwStackSize, _SECURITY_ATTRIBUTES *lpThreadAttributes); // idb
int __stdcall ZThread::_ZTE(void *pVoid);
ZPort::ZPortThread **__thiscall ZList<ZPort::ZPortThread *>::AddTail(ZList<ZPort::ZPortThread *> *this); // idb
ZPort::ZPortThread **__thiscall ZList<ZPort::ZPortThread *>::_New(ZList<ZPort::ZPortThread *> *this, void *pPrev, void *pNext); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this, void *p); // idb
void __thiscall ZRefCountedDummy<ZPort::ZPortThread *>::ZRefCountedDummy<ZPort::ZPortThread *>(ZRefCountedDummy<ZPort::ZPortThread *> *this); // idb
ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *__thiscall ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this, unsigned int __flags);
ZRefCountedDummy<ZPort::ZPortThread *> *__thiscall ZRefCountedDummy<ZPort::ZPortThread *>::`vector deleting destructor'(ZRefCountedDummy<ZPort::ZPortThread *> *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<ZPort::ZPortThread *>::~ZRefCountedDummy<ZPort::ZPortThread *>(ZRefCountedDummy<ZPort::ZPortThread *> *this); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this);
int __thiscall ZPort::ZPortThread::Run(ZPort::ZPortThread *this, void *__formal, ZThread::ZThreadResult *pResult); // idb
void __thiscall ZThread::ZThreadResult::Succeeded(ZThread::ZThreadResult *this); // idb
ZPort::ZPortThread *__thiscall ZPort::ZPortThread::`vector deleting destructor'(ZPort::ZPortThread *this, unsigned int __flags);
void __thiscall ZPort::ZPortThread::~ZPortThread(ZPort::ZPortThread *this); // idb
int __stdcall ZThread::Run(void *pParam, ZThread::ZThreadResult *pResult);
ZThread *__thiscall ZThread::`vector deleting destructor'(ZThread *this, unsigned int __flags);
void __thiscall ZThread::CloseThread(ZThread *this); // idb
void __thiscall ZPort::_ThreadExit(ZPort *this, ZPort::ZPortThread *pThread); // idb
void __thiscall ZList<ZPort::ZPortThread *>::RemoveAt(ZList<ZPort::ZPortThread *> *this, __POSITION *pos); // idb
ZPort::ZPortThread **__thiscall ZList<ZPort::ZPortThread *>::Find(ZList<ZPort::ZPortThread *> *this, ZPort::ZPortThread *const *d, __POSITION *posAfter);
void __thiscall ZPort::ClosePort(ZPort *this, int bWait); // idb
int __thiscall ZPort::_RemoveThread(ZPort *this); // idb
void __thiscall ZSocketEx::AttachPort(ZSocketEx *this, ZPort *pPort); // idb
void __thiscall ZSocketBase::SetReceiveBufferSize(ZSocketBase *this, unsigned int uSize); // idb
void __thiscall ZSocketBase::SetSendBufferSize(ZSocketBase *this, unsigned int uSize); // idb
void __thiscall ZSocketEx::NotifySend(ZSocketEx *this); // idb
unsigned int __thiscall ZSocketEx::_BeginRecv(ZSocketEx *this);
void __thiscall CAdminSocket::CAdminSocket(CAdminSocket *this); // idb
void __thiscall CInPacket::CInPacket(CInPacket *this, int bLoopback); // idb
void __thiscall CInPacket::~CInPacket(CInPacket *this); // idb
CAdminSocket *__thiscall CAdminSocket::`vector deleting destructor'(CAdminSocket *this, unsigned int __flags);
void __thiscall CAdminSocket::~CAdminSocket(CAdminSocket *this); // idb
int __thiscall CAdminSocket::PostClose(CAdminSocket *this); // idb
void __thiscall COutPacket::~COutPacket(COutPacket *this); // idb
void __thiscall CAdminSocket::SendPacket(CAdminSocket *this, COutPacket *oPacket, int bForce); // idb
// void *__usercall _L114803@<eax>(int a1@<ebp>);
void __cdecl CAdminSocket::OnReceive(unsigned int dwErr, ZSocketBuffer *pBuff);
void __thiscall CAdminSocket::ProcessPacket(CAdminSocket *this, CInPacket *iPacket); // idb
void __thiscall CInPacket::AUTO_CLEAR::~AUTO_CLEAR(CInPacket::AUTO_CLEAR *this); // idb
char __thiscall CInPacket::Decode1(CInPacket *this); // idb
void __thiscall CAdminSocket::OnClose(CAdminSocket *this, CInPacket *iPacket); // idb
void __thiscall CAdminSocket::OnUserRequest(CAdminSocket *this, CInPacket *iPacket); // idb
void __thiscall COutPacket::Encode4(COutPacket *this, unsigned int n); // idb
void __thiscall COutPacket::EnlargeBuffer(COutPacket *this, unsigned int uSize); // idb
void __thiscall CAdminSocket::OnBanUser(CAdminSocket *this, CInPacket *iPacket); // idb
unsigned int __thiscall CInPacket::Decode4(CInPacket *this); // idb
void __thiscall COutPacket::Encode1(COutPacket *this, char n); // idb
ZRef<CClientSocket> *__cdecl CClientSocket::FindClinetSocketByAccountID(ZRef<CClientSocket> *result, const unsigned int __$ReturnUdt); // idb
void __thiscall CAdminSocket::OnReloadIPListRequest(CAdminSocket *this, CInPacket *iPacket); // idb
void __thiscall CIPFilter::ReloadIPList(CIPFilter *this); // idb
void __thiscall CIPFilter::SetReloadingStatus(CIPFilter *this, int bIsReloading); // idb
void __thiscall CAdminSocket::OnIgnoreSPW(CAdminSocket *this, CInPacket *iPacket); // idb
void __thiscall CAdminSocket::OnIgnoreSSNOnCreateNewCharacter(CAdminSocket *this, CInPacket *iPacket); // idb
void __thiscall ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>(ZList<ZRef<ZSocketBuffer> > *this); // idb
void __thiscall ZRef<CClientSocket>::~ZRef<CClientSocket>(ZRef<CClientSocket> *this); // idb
ZRef<CClientSocket> *__thiscall ZRef<CClientSocket>::operator=(ZRef<CClientSocket> *this, ZRef<CClientSocket> *r); // idb
ZList<ZRef<ZSocketBuffer> > *__thiscall ZList<ZRef<ZSocketBuffer>>::`vector deleting destructor'(ZList<ZRef<ZSocketBuffer> > *this, unsigned int __flags);
void __thiscall ZRef<CClientSocket>::_ReleaseRaw(ZRef<CClientSocket> *this, ZRefCounted *__formal); // idb
void __thiscall ZArray<unsigned char>::RemoveAll(ZArray<unsigned char> *this); // idb
char *__thiscall ZArray<unsigned char>::_Alloc(ZArray<unsigned char> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
char *__thiscall ZArray<unsigned char>::_Realloc(ZArray<unsigned char> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
void __thiscall ZList<ZRef<ZSocketBuffer>>::RemoveAll(ZList<ZRef<ZSocketBuffer> > *this); // idb
ZRef<CClientSocket> *__thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::GetAt(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, const unsigned int *key, ZRef<CClientSocket> *value); // idb
void _E37_0();
void _E30();
void _E31_0();
void _E32_0();
void _E33_0();
void _E34_0();
void _E35_0();
void _E36_0();
char *__thiscall ZArray<unsigned char>::GetCapacity(ZArray<unsigned char> *this);
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this); // idb
ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this, unsigned int __flags);
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::~ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::~ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this); // idb
void _E58();
void _E49();
void _E50();
void _E51();
void _E52();
void _E53();
void _E54();
void _E55();
void _E56();
void _E57();
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this); // idb
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this, unsigned int __flags);
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this); // idb
unsigned int __thiscall ZSocketEx::GetType(ZSocketEx *this);
void __thiscall ZSocketEx::ZSocketEx(ZSocketEx *this); // idb
ZSocketEx *__thiscall ZSocketEx::`vector deleting destructor'(ZSocketEx *this, unsigned int __flags);
void __thiscall ZSocketEx::Delete(ZSocketEx *this); // idb
void __thiscall ZSocketEx::~ZSocketEx(ZSocketEx *this); // idb
void __thiscall ZSocketEx::Close(ZSocketEx *this); // idb
void __thiscall ZSocketEx::SendPacket(ZSocketEx *this, ZList<ZRef<ZSocketBuffer> > *lpBuff); // idb
ZRef<ZSocketBuffer> *__thiscall ZRef<ZSocketBuffer>::operator=(ZRef<ZSocketBuffer> *this, ZRef<ZSocketBuffer> *r); // idb
ZRef<ZSocketBuffer> *__thiscall ZList<ZRef<ZSocketBuffer>>::AddTail(ZList<ZRef<ZSocketBuffer> > *this); // idb
ZRef<ZSocketBuffer> *__thiscall ZList<ZRef<ZSocketBuffer>>::_New(ZList<ZRef<ZSocketBuffer> > *this, void *pPrev, void *pNext); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this, void *p); // idb
void __thiscall ZRefCountedDummy<ZRef<ZSocketBuffer>>::ZRefCountedDummy<ZRef<ZSocketBuffer>>(ZRefCountedDummy<ZRef<ZSocketBuffer> > *this); // idb
ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *__thiscall ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this, unsigned int __flags);
ZRefCountedDummy<ZRef<ZSocketBuffer> > *__thiscall ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vector deleting destructor'(ZRefCountedDummy<ZRef<ZSocketBuffer> > *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<ZRef<ZSocketBuffer>>::~ZRefCountedDummy<ZRef<ZSocketBuffer>>(ZRefCountedDummy<ZRef<ZSocketBuffer> > *this); // idb
void __thiscall ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::~ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this);
void __thiscall ZSocketEx::LoopBackPacket(ZSocketEx *this, ZSocketBuffer *pBuff); // idb
int __thiscall ZSocketEx::OnSend(ZSocketEx *this, ZList<ZRef<ZSocketBuffer> > *l); // idb
void __thiscall ZList<ZRef<ZSocketBuffer>>::MoveBefore(ZList<ZRef<ZSocketBuffer> > *this, ZList<ZRef<ZSocketBuffer> > *l, __POSITION *posFrom, __POSITION *posTo, __POSITION *pos); // idb
void __thiscall ZList<ZRef<ZSocketBuffer>>::MoveAfter(ZList<ZRef<ZSocketBuffer> > *this, ZList<ZRef<ZSocketBuffer> > *l, __POSITION *posFrom, __POSITION *posTo, __POSITION *pos); // idb
void __thiscall ZSocketEx::OnComplete(ZSocketEx *this, void *pUser, unsigned int key, unsigned int dwErr, unsigned int dwTransfered); // idb
unsigned int __thiscall ZMeanBuff<unsigned int,4,1460>::Next(ZMeanBuff<unsigned int,4,1460> *this, unsigned int t); // idb
void __thiscall ZList<ZRef<ZSocketBuffer>>::RemoveAt(ZList<ZRef<ZSocketBuffer> > *this, __POSITION *pos); // idb
unsigned int __thiscall ZSocketEx::_BeginSend(ZSocketEx *this);
unsigned int __thiscall ZSocketEx::_SafeOnReceive(ZSocketEx *this, unsigned int dwErr, ZSocketBuffer *pBuff); // idb
char *CVerboseObj::GetLogTail();
void __cdecl CAESCipher::Encrypt(char *pDest, char *pSrc, int nLen, unsigned int *pdwKey); // idb
void __cdecl CAESCipher::Decrypt(char *pDest, char *pSrc, int nLen, unsigned int *pdwKey); // idb
void __cdecl CAESCipher::gen_tabs(); // idb
void __cdecl CAESCipher::AES_EncInit(CAESCipher::AES_ALG_INFO *AlgInfo, unsigned int *pdwKey);
void __cdecl CAESCipher::AES_DecInit(CAESCipher::AES_ALG_INFO *AlgInfo, unsigned int *pdwKey);
void __cdecl CAESCipher::AES_EncKeySchedule(unsigned int *UserKey, CAESCipher::AES_ALG_INFO *AlgInfo); // idb
void __cdecl CAESCipher::AES_DecKeySchedule(unsigned int *UserKey, CAESCipher::AES_ALG_INFO *AlgInfo); // idb
void __cdecl CAESCipher::RIJNDAEL_KeySchedule(unsigned int *UserKey, unsigned int *e_key); // idb
void __cdecl CAESCipher::AES_Encrypt(void *CipherKey, char *Data); // idb
void __cdecl CAESCipher::AES_Decrypt(void *CipherKey, char *Data); // idb
char __cdecl CAESCipher::OFB_EncUpdate(CAESCipher::AES_ALG_INFO *AlgInfo, char *PlainTxt, unsigned int PlainTxtLen, char *CipherTxt, unsigned int *CipherTxtLen); // idb
char __cdecl CAESCipher::OFB_EncFinal(CAESCipher::AES_ALG_INFO *AlgInfo, char *CipherTxt, unsigned int *CipherTxtLen); // idb
char __cdecl CAESCipher::OFB_DecUpdate(CAESCipher::AES_ALG_INFO *AlgInfo, char *CipherTxt, unsigned int CipherTxtLen, char *PlainTxt, unsigned int *PlainTxtLen); // idb
char __cdecl CAESCipher::OFB_DecFinal(CAESCipher::AES_ALG_INFO *AlgInfo, char *PlainTxt, unsigned int *PlainTxtLen); // idb
void _E19_0();
void _E17();
void _E18_0();
void _E36_1();
void _E29();
void _E30_0();
void _E31_1();
void _E32_1();
void _E33_1();
void _E34_1();
void _E35_1();
char __cdecl is_correct_bodypart(int nItemID, int nBodyPart, int nGender);
int __cdecl get_bodypart_from_item(int nItemID, int nGender, int *pnBodyPart, int bAll); // idb
int __cdecl get_weapon_type(int nItemID); // idb
void _E13_0();
void _E11_0();
void _E12_0();
void _E30_1();
void _E23();
void _E24();
void _E25();
void _E26();
void _E27();
void _E28();
void _E29_0();
void __thiscall CCenter::CCenter(CCenter *this); // idb
void __thiscall CCenter::~CCenter(CCenter *this); // idb
int __thiscall CCenter::Init(CCenter *this, const unsigned __int16 *sName, int nIndex, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry); // idb
void __thiscall CCenter::SendPacket(CCenter *this, COutPacket *oPacket); // idb
void __thiscall CCenter::OnPacket(CCenter *this, CInPacket *iPacket); // idb
unsigned __int16 __thiscall CInPacket::Decode2(CInPacket *this); // idb
void __thiscall CCenter::TryConnect(CCenter *this); // idb
void __thiscall CCenter::Disconnect(CCenter *this); // idb
void __thiscall CCenter::OnUserNoResult(CCenter *this, CInPacket *iPacket); // idb
void __stdcall CCenter::SendLoopbackMessage(int nMsg, CInPacket *iPacket);
void __thiscall CInPacket::CopyTo(CInPacket *this, COutPacket *oPacket); // idb
void __thiscall COutPacket::EncodeBuffer(COutPacket *this, const void *p, unsigned int uSize); // idb
void __thiscall CCenter::OnAliveReq(CCenter *this, CInPacket *iPacket); // idb
void __thiscall CCenter::OnAdminResult(CCenter *this, CInPacket *iPacket); // idb
void __thiscall CCenter::OnSetWorldInfo(CCenter *this, CInPacket *iPacket); // idb
ZXString<char> *__thiscall CInPacket::DecodeStr(CInPacket *this, ZXString<char> *result); // idb
unsigned int __cdecl CIOBufferManipulator::DecodeStr(ZXString<char> *s, const char *pSrc, unsigned int uRemain); // idb
void __thiscall CCenter::OnServerStatusChanged(CCenter *this, CInPacket *iPacket); // idb
void __thiscall CCenter::OnWorldSpecificBonusRateSet(CCenter *this, CInPacket *iPacket); // idb
int __thiscall CCenter::IsServerConnected(CCenter *this, int nIdx); // idb
void __thiscall _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>(_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *this); // idb
void __thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this); // idb
IWzProperty *__thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this); // idb
void __thiscall ZArray<long>::~ZArray<long>(ZArray<long> *this); // idb
void __thiscall ZArray<int>::~ZArray<int>(ZArray<int> *this); // idb
void __thiscall _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *this); // idb
ZMap<long,int,long> *__thiscall ZMap<long,int,long>::`vector deleting destructor'(ZMap<long,int,long> *this, unsigned int __flags);
void __thiscall ZArray<long>::RemoveAll(ZArray<long> *this); // idb
int *__thiscall ZArray<long>::_Alloc(ZArray<long> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
void __thiscall ZArray<int>::RemoveAll(ZArray<int> *this); // idb
int *__thiscall ZArray<int>::_Alloc(ZArray<int> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
int *__thiscall ZMap<long,int,long>::GetAt(ZMap<long,int,long> *this, const int *key, int *value); // idb
__POSITION *__thiscall ZMap<long,int,long>::Insert(ZMap<long,int,long> *this, const int *key, const int *value); // idb
ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *__thiscall ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`scalar deleting destructor'(ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this, unsigned int __flags);
void __thiscall ZMap<long,int,long>::RemoveAll(ZMap<long,int,long> *this); // idb
int *__thiscall ZArray<int>::operator[](ZArray<int> *this, int i); // idb
void __thiscall _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *this, _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *p); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this, void *p); // idb
void _E37_1();
void _E29_1();
void _E30_2();
void _E31_2();
void _E32_2();
void _E33_2();
void _E34_2();
void _E35_2();
void _E36_2();
void __thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this); // idb
ZMap<long,int,long>::_PAIR *__thiscall ZMap<long,int,long>::_PAIR::`scalar deleting destructor'(ZMap<long,int,long>::_PAIR *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this, unsigned int __flags);
void __thiscall ZMap<long,int,long>::_PAIR::~_PAIR(ZMap<long,int,long>::_PAIR *this); // idb
int __cdecl ZComAPI::ZComVariantClear(tagVARIANT *pvarg); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this); // idb
void __thiscall _bstr_t::_bstr_t(_bstr_t *this, const unsigned __int16 *s); // idb
unsigned __int16 *__thiscall _bstr_t::operator unsigned short const *(_bstr_t *this);
void __thiscall _bstr_t::Data_t::Data_t(_bstr_t::Data_t *this, const unsigned __int16 *s); // idb
unsigned __int16 *__cdecl ZComAPI::ZComSysAllocString(const unsigned __int16 *s); // idb
unsigned int __thiscall _bstr_t::Data_t::Release(_bstr_t::Data_t *this); // idb
void __thiscall ZMap<long,int,long>::ResizeHashTable(ZMap<long,int,long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<long,int,long>::_CalcAutoGrow(ZMap<long,int,long> *this, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZXString<char>::Assign(ZXString<char> *this, int a2, int a3);
int __thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this, int); // idb
void __thiscall _bstr_t::Data_t::_Free(_bstr_t::Data_t *this); // idb
int __thiscall _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_QueryInterface(_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *this, int); // idb
void **__thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this);
void _E56_0();
void _E48();
void _E49_0();
void _E50_0();
void _E51_0();
void _E52_0();
void _E53_0();
void _E54_0();
void _E55_0();
// _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *__thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator=(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this, IWzProperty *pInterface); idb
// _com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *__thiscall _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::operator=(_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *this, IEnumVARIANT *pInterface); idb
IUnknown *__thiscall Ztl_variant_t::GetUnknown(Ztl_variant_t *this, char fAddRef, char fTryChangeType); // idb
void __thiscall _variant_t::ChangeType(_variant_t *this, unsigned __int16 vartype, _variant_t *pSrc); // idb
int __cdecl ZComAPI::ZComVariantChangeType(tagVARIANT *pvargDest, tagVARIANT *pvarSrc, unsigned __int16 wFlags, unsigned __int16 vt); // idb
int __cdecl ZComAPI::ZComVarBstrFromVariant(tagVARIANT *pvargDest, tagVARIANT *pvarSrc); // idb
unsigned __int16 *__cdecl ZComAPI::ZComSysAllocStringLen(const unsigned __int16 *s, unsigned int u); // idb
void __thiscall _variant_t::~_variant_t(_variant_t *this); // idb
void __thiscall Ztl_bstr_t::Ztl_bstr_t(Ztl_bstr_t *this, const unsigned __int16 *s); // idb
void __thiscall Ztl_bstr_t::~Ztl_bstr_t(Ztl_bstr_t *this); // idb
void __thiscall ZInetAddr::~ZInetAddr(ZInetAddr *this); // idb
void __thiscall ZInetAddr::ZInetAddr(ZInetAddr *this, const char *sAddr, unsigned int uPort); // idb
void __thiscall ZInetAddr::_Init(ZInetAddr *this, unsigned int uPort, unsigned int uAddr); // idb
void __thiscall ZInetAddr::_InitN(ZInetAddr *this, unsigned __int16 uPort, unsigned int uAddr); // idb
void __thiscall Ztl_variant_t::~Ztl_variant_t(Ztl_variant_t *this); // idb
Ztl_variant_t *__thiscall IWzProperty::Getitem(IWzProperty *this, Ztl_variant_t *result, Ztl_bstr_t __$ReturnUdt); // idb
void __thiscall _variant_t::_variant_t(_variant_t *this, tagVARIANT *varSrc, char fCopy); // idb
int __cdecl ZComAPI::ZComVariantCopy(tagVARIANT *pvargDest, tagVARIANT *pvargSrc); // idb
_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *__thiscall IWzProperty::Get_NewEnum(IWzProperty *this, _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *result); // idb
void __thiscall Ztl_bstr_t::Ztl_bstr_t(Ztl_bstr_t *this, Ztl_bstr_t *__that); // idb
unsigned int __cdecl get_int32(Ztl_variant_t *v, int nDefault);
void __thiscall CCenterSocket::CCenterSocket(CCenterSocket *this, CCenter *pCenter); // idb
unsigned int __stdcall ZIStream::ReadFromSpecificPos(unsigned int uPos, char *pData, unsigned int uSize);
const char *__thiscall CCenterSocket::GetLogTail(CCenterSocket *this); // idb
CCenterSocket *__thiscall CCenterSocket::`vector deleting destructor'(CCenterSocket *this, unsigned int __flags);
void __thiscall CCenterSocket::~CCenterSocket(CCenterSocket *this); // idb
void __cdecl CCenterSocket::OnSocketReceive(ZSocket *pSocket, int nErr);
void __thiscall CCenterSocket::OnSocketSend(CCenterSocket *this, ZSocket *pSocket, int nErr); // idb
// void *__usercall _L116531@<eax>(int a1@<ebp>);
// void *__usercall _L116532@<eax>(int a1@<ebp>);
void __thiscall CCenterSocket::OnSocketClose(CCenterSocket *this, ZSocket *pSocket, int nErr); // idb
int __thiscall CCenterSocket::Connect(CCenterSocket *this); // idb
int __cdecl CIOBufferManipulator::EncodeStr(ZXString<char> s, char *pDes);
void __thiscall CCenterSocket::PostCloseMessage(CCenterSocket *this); // idb
void __thiscall CCenterSocket::SendPacket(CCenterSocket *this, COutPacket *oPacket); // idb
// void *__usercall _L117224@<eax>(int a1@<ebp>);
void __thiscall CCenterSocket::Flush(CCenterSocket *this); // idb
void __thiscall CCenterSocket::ProcessPacket(CCenterSocket *this, CInPacket *iPacket); // idb
int __thiscall ZIStream::CopyTo(ZIStream *this, ZIStream *pStream, unsigned int uSize);
ZRef<ZSocketBuffer> *__thiscall ZList<ZRef<ZSocketBuffer>>::AddTail(ZList<ZRef<ZSocketBuffer> > *this, ZRef<ZSocketBuffer> *d);
unsigned int __thiscall ZIStream::CopyFrom(ZIStream *this, ZIStream *pStream, unsigned int uSize); // idb
void __thiscall ZFixedArray<unsigned char,65536,0>::~ZFixedArray<unsigned char,65536,0>(ZFixedArray<unsigned char,65536,0> *this); // idb
unsigned int __thiscall ZIStream::CopyFromHelper(ZIStream *this, ZIStream *pStream, unsigned int uSize, void *pBuff, unsigned int uBuff); // idb
char *__thiscall ZFixedArray<unsigned char,65536,0>::_Alloc(ZFixedArray<unsigned char,65536,0> *this); // idb
ZFixedArray<unsigned char,65536,0>::_ArrayData *__thiscall ZFixedArray<unsigned char,65536,0>::_ArrayData::`vector deleting destructor'(ZFixedArray<unsigned char,65536,0>::_ArrayData *this, unsigned int __flags);
void __thiscall ZFixedArray<unsigned char,65536,0>::_ArrayData::~_ArrayData(ZFixedArray<unsigned char,65536,0>::_ArrayData *this); // idb
ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *__thiscall ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`scalar deleting destructor'(ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this, unsigned int __flags);
_DWORD **__thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::raw_new(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this);
void __thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::raw_delete(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this, void *p); // idb
void _E42();
void _E34_3();
void _E35_3();
void _E36_3();
void _E37_2();
void _E38_0();
void _E39_0();
void _E40();
void _E41();
void _E61();
void _E53_1();
void _E54_1();
void _E55_1();
void _E56_1();
void _E57_0();
void _E58_0();
void _E59();
void _E60();
void __thiscall ZSocket::~ZSocket(ZSocket *this); // idb
void __thiscall ZIStream::~ZIStream(ZIStream *this); // idb
unsigned int __stdcall ZIStream::Read(void *pData, unsigned int uSize);
unsigned int __stdcall ZIStream::Write(const void *pData, unsigned int uSize);
ZIStream *__thiscall ZIStream::`scalar deleting destructor'(ZIStream *this, unsigned int __flags);
void __thiscall ZRef<ZSocketThread>::~ZRef<ZSocketThread>(ZRef<ZSocketThread> *this); // idb
unsigned int __thiscall ZIStream::ReadEOF(ZIStream *this, void *pData, unsigned int uSize); // idb
unsigned int __thiscall ZIStream::WriteEOF(ZIStream *this, const void *pData, unsigned int uSize); // idb
void __thiscall ZRef<ZSocketThread>::_ReleaseRaw(ZRef<ZSocketThread> *this, ZRefCounted *__formal); // idb
void __thiscall ZSocket::Close(ZSocket *this); // idb
ZSocket *__thiscall ZSocket::`vector deleting destructor'(ZSocket *this, unsigned int __flags);
void __thiscall ZSocket::AttachThread(ZSocket *this, int lEvents, ZSocketThread *pThread); // idb
ZRef<ZSocketThread> *__thiscall ZRef<ZSocketThread>::operator=(ZRef<ZSocketThread> *this, ZSocketThread *pT); // idb
void __thiscall ZRef<ZSocketThread>::_Alloc(ZRef<ZSocketThread> *this); // idb
ZSocketThread::REQ *__thiscall ZList<ZSocketThread::REQ>::AddTail(ZList<ZSocketThread::REQ> *this); // idb
ZSocketThread::REQ *__thiscall ZList<ZSocketThread::REQ>::_New(ZList<ZSocketThread::REQ> *this, void *pPrev, void *pNext); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this, void *p); // idb
void __thiscall ZRefCountedDummy<ZSocketThread::REQ>::ZRefCountedDummy<ZSocketThread::REQ>(ZRefCountedDummy<ZSocketThread::REQ> *this); // idb
ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *__thiscall ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vector deleting destructor'(ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this, unsigned int __flags);
ZRefCountedDummy<ZSocketThread::REQ> *__thiscall ZRefCountedDummy<ZSocketThread::REQ>::`scalar deleting destructor'(ZRefCountedDummy<ZSocketThread::REQ> *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<ZSocketThread::REQ>::~ZRefCountedDummy<ZSocketThread::REQ>(ZRefCountedDummy<ZSocketThread::REQ> *this); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this);
void __cdecl ZRefCounted_Alloc();
void __thiscall ZSocketThread::ZSocketThread(ZSocketThread *this); // idb
ZMap<void *,ZSocket *,void *> *__thiscall ZMap<void *,ZSocket *,void *>::`vector deleting destructor'(ZMap<void *,ZSocket *,void *> *this, unsigned int __flags);
ZList<ZSocketThread::REQ> *__thiscall ZList<ZSocketThread::REQ>::`scalar deleting destructor'(ZList<ZSocketThread::REQ> *this, unsigned int __flags);
void __thiscall ZMap<void *,ZSocket *,void *>::RemoveAll(ZMap<void *,ZSocket *,void *> *this); // idb
void __thiscall ZList<ZSocketThread::REQ>::RemoveAll(ZList<ZSocketThread::REQ> *this); // idb
ZSocketThread *__thiscall ZSocketThread::`vector deleting destructor'(ZSocketThread *this, unsigned int a2);
ZSocketThread *__thiscall ZSocketThread::`scalar deleting destructor'(ZSocketThread *this, unsigned int __flags);
void __thiscall ZSocketThread::BeginThread(ZSocketThread *this); // idb
void **__thiscall ZArray<void *>::InsertBefore(ZArray<void *> *this, int nIndex); // idb
void **__thiscall ZArray<void *>::_Realloc(ZArray<void *> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
void **__thiscall ZArray<void *>::GetCapacity(ZArray<void *> *this);
void __thiscall ZSocketThread::~ZSocketThread(ZSocketThread *this); // idb
void __thiscall ZThread::~ZThread(ZThread *this); // idb
void __thiscall ZArray<void *>::~ZArray<void *>(ZArray<void *> *this); // idb
int __thiscall ZThread::JoinThread(ZThread *this, unsigned int dwTimeOutMillisec); // idb
void __thiscall ZArray<void *>::RemoveAll(ZArray<void *> *this); // idb
int __thiscall ZSocketThread::Run(ZSocketThread *this, void *__formal, ZThread::ZThreadResult *pResult); // idb
int __thiscall ZSocketThread::DoEvent(ZSocketThread *this, void *hEvent); // idb
ZSocket **__thiscall ZMap<void *,ZSocket *,void *>::GetAt(ZMap<void *,ZSocket *,void *> *this, void *const *key, ZSocket **value); // idb
void __thiscall ZSocketThread::DoRequests(ZSocketThread *this); // idb
void __thiscall ZList<ZSocketThread::REQ>::RemoveAt(ZList<ZSocketThread::REQ> *this, __POSITION *pos); // idb
void __thiscall ZSocketThread::ForceClose(ZSocketThread *this, ZSocket *pSocket, int nErr); // idb
void *_L123941();
void *__thiscall ZSocketThread::RawRegisterSocket(ZSocketThread *this, ZSocket *pSocket); // idb
__POSITION *__thiscall ZMap<void *,ZSocket *,void *>::Insert(ZMap<void *,ZSocket *,void *> *this, void *const *key, ZSocket *const *value); // idb
ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *__thiscall ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`scalar deleting destructor'(ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this, unsigned int __flags);
void __thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this, void *p); // idb
ZMap<void *,ZSocket *,void *>::_PAIR *__thiscall ZMap<void *,ZSocket *,void *>::_PAIR::`scalar deleting destructor'(ZMap<void *,ZSocket *,void *>::_PAIR *this, unsigned int __flags);
void __thiscall ZMap<void *,ZSocket *,void *>::_PAIR::~_PAIR(ZMap<void *,ZSocket *,void *>::_PAIR *this); // idb
void __thiscall ZMap<void *,ZSocket *,void *>::ResizeHashTable(ZMap<void *,ZSocket *,void *> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<void *,ZSocket *,void *>::_CalcAutoGrow(ZMap<void *,ZSocket *,void *> *this, unsigned int uAutoGrowEvery128); // idb
void **__thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this);
void **__thiscall ZSocketThread::RawUnregisterSocket(ZSocketThread *this, ZSocket *pSocket);
int __thiscall ZMap<void *,ZSocket *,void *>::RemoveKey(ZMap<void *,ZSocket *,void *> *this, void *const *key); // idb
__POSITION *__thiscall ZMap<void *,ZSocket *,void *>::FindInverse(ZMap<void *,ZSocket *,void *> *this, ZSocket *const *value);
ZMap<void *,ZSocket *,void *>::_PAIR *__thiscall ZMap<void *,ZSocket *,void *>::GetHeadPosition(ZMap<void *,ZSocket *,void *> *this);
void __thiscall ZArray<void *>::RemoveAt(ZArray<void *> *this, __POSITION *pos); // idb
__POSITION *__thiscall ZMap<void *,ZSocket *,void *>::GetNext(ZMap<void *,ZSocket *,void *> *this, __POSITION **pos, ZSocket **value);
void __thiscall ZSocket::DetachThread(ZSocket *this); // idb
int __thiscall ZSocket::Connect(ZSocket *this, sockaddr_in *pAddr); // idb
int __thiscall ZSocket::Send(ZSocket *this, const void *pData, unsigned int uSize, int bOOB);
int __thiscall ZSocket::Receive(ZSocket *this, void *pData, unsigned int uSize, int bOOB);
int __thiscall ZSocket::Read(ZSocket *this, void *pData, unsigned int uSize);
int __thiscall ZSocket::Write(ZSocket *this, const void *pData, unsigned int uSize);
int __thiscall ZSocket::ReadEOF(ZSocket *this, void *pData, unsigned int uSize);
int __thiscall ZSocket::WriteEOF(ZSocket *this, const void *pData, unsigned int uSize);
void __thiscall ZSocketBuffer::Sub(ZSocketBuffer *this, unsigned int uFrom, unsigned int uLength, ZAllocHelper *_ALLOC);
int __thiscall CRand32::Random(CRand32 *this);
_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *__cdecl get_conf(); // idb
const unsigned __int16 *__cdecl get_string(Ztl_variant_t *v, const unsigned __int16 *sDefault); // idb
int _E32_3();
void _E28_0();
int _E31_3();
void __cdecl _E29_2(); // idb
int _E37_3();
void _E34_4();
int _E36_4();
void __cdecl _E35_4(); // idb
int _E42_0();
void _E39_1();
int _E41_0();
void __cdecl _E40_0(); // idb
int _E47();
void _E44();
int _E46();
void __cdecl _E45(); // idb
int _E52_1();
void _E49_1();
int _E51_1();
void __cdecl _E50_1(); // idb
void __thiscall CClientSocket::CClientSocket(CClientSocket *this); // idb
void __thiscall CSecuritySession::CSecuritySession(CSecuritySession *this, CClientSocket *pSocket); // idb
_RTL_CRITICAL_SECTION_DEBUG *__thiscall CClientSocket::GetLogTail(CClientSocket *this);
CClientSocket *__thiscall CClientSocket::`vector deleting destructor'(CClientSocket *this, unsigned int __flags);
void __thiscall CClientSocket::~CClientSocket(CClientSocket *this); // idb
void __thiscall CSecuritySession::~CSecuritySession(CSecuritySession *this); // idb
int __thiscall CClientSocket::IsAdmin(CClientSocket *this); // idb
unsigned int __thiscall CClientSocket::IsLimitedIP(CClientSocket *this);
unsigned int __thiscall CClientSocket::IsSkipCrcIP(CClientSocket *this);
int __thiscall CClientSocket::PostClose(CClientSocket *this); // idb
int __thiscall CClientSocket::PostUpdate(CClientSocket *this, int tCur, COutPacket *oPacket); // idb
void __thiscall CClientSocket::SendPacket(CClientSocket *this, COutPacket *oPacket, int bForce); // idb
// void *__usercall _L125551@<eax>(int a1@<ebp>);
void __thiscall CClientSocket::ResetLoginState(CClientSocket *this, int nLoginState); // idb
void __thiscall CClientSocket::SendDisconnectPacket(CClientSocket *this); // idb
void __thiscall CClientSocket::SendRemoveUserMigrateTimeout(CClientSocket *this); // idb
void __thiscall CClientSocket::SendWorldInformation(CClientSocket *this); // idb
void __thiscall COutPacket::Encode2(COutPacket *this, unsigned __int16 n); // idb
void __thiscall COutPacket::EncodeStr(COutPacket *this, ZXString<char> s); // idb
char *__thiscall CCenter::GetName(CCenter *this);
int __thiscall CCenter::GetWorldState(CCenter *this); // idb
ZXString<char> *__thiscall CCenter::GetWorldEventDesc(CCenter *this, ZXString<char> *result); // idb
void __cdecl CClientSocket::OnReceive(unsigned int dwErr, ZSocketBuffer *pBuff);
void __thiscall CClientSocket::ProcessPacket(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCheckPassword(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CInPacket::DecodeBuffer(CInPacket *this, void *p, unsigned int uSize); // idb
void __thiscall CClientSocket::OnWorldInfoRequest(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnSelectWorld(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnSelectCharacter(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnSelectCharacterByVAC(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnVACFlagSet(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCheckDuplicatedID(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCreateNewCharacter(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnDeleteCharacter(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnEnableSPW(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCheckSPW(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCheckSSN2OnCreateNewCharacter(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCheckSPWOnCreateNewCharacter(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCheckGameGuardUpdated(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCheckUserLimit(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnAliveAck(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCenterLoginResult(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall AvatarLook::AvatarLook(AvatarLook *this); // idb
void __thiscall CClientSocket::OnCenterSelectCharacterResult(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCenterSelectCharacterByVACResult(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCenterViewAllCharResult(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCenterCheckDuplicatedIDResult(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCenterCreateNewCharacterResult(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCenterDeleteCharacterResult(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::SetCenterSelectCharacterResultPacket(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCenterCheckUserLimitResult(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnCheckPinCode(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnUpdatePinCode(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnSetGender(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnConfirmEULA(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnLogoutWorld(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnViewAllChar(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnUpdate(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnClose(CClientSocket *this, CInPacket *iPacket); // idb
void __thiscall CClientSocket::OnExceptionLog(CClientSocket *this, CInPacket *iPacket); // idb
void __cdecl CClientSocket::RefreshProcessList(); // idb
void __thiscall CClientSocket::OnWorldRequest(CClientSocket *this, CInPacket *iPacket); // idb
int __cdecl CSecuritySessionHelper::IsSkipCrcIP(CClientSocket *pSocket); // idb
void __cdecl CSecuritySessionHelper::SendPacket(CClientSocket *pSocket, COutPacket *oPacket); // idb
int __cdecl CSecuritySessionHelper::IsAdminClient(CClientSocket *pSocket); // idb
void __cdecl CSecuritySessionHelper::CloseSocket(CClientSocket *pSocket); // idb
ZXString<char> *__cdecl CSecuritySessionHelper::GetLogInfo(ZXString<char> *result, CClientSocket *__$ReturnUdt); // idb
IWzResMan *__thiscall _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *this); // idb
void __thiscall ZXString<char>::ZXString<char>(ZXString<char> *this, ZXString<char> *s); // idb
void __thiscall ZXString<char>::MakeUpper(ZXString<char> *this); // idb
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::~ZMap<unsigned long,ZXString<char>,unsigned long>(ZMap<unsigned long,ZXString<char>,unsigned long> *this); // idb
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::~ZMap<ZXString<char>,unsigned long,ZXString<char>>(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this); // idb
void __thiscall ZRef<CMxHelperServerManager>::~ZRef<CMxHelperServerManager>(ZRef<CMxHelperServerManager> *this); // idb
void __thiscall _variant_t::_variant_t(_variant_t *this, _variant_t *varSrc); // idb
ZMap<unsigned long,ZXString<char>,unsigned long> *__thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::`scalar deleting destructor'(ZMap<unsigned long,ZXString<char>,unsigned long> *this, unsigned int __flags);
ZMap<ZXString<char>,unsigned long,ZXString<char> > *__thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::`scalar deleting destructor'(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, unsigned int __flags);
ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *__thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vector deleting destructor'(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, unsigned int __flags);
ZMap<char const *,int,ZXString<char> > *__thiscall ZMap<char const *,int,ZXString<char>>::`vector deleting destructor'(ZMap<char const *,int,ZXString<char> > *this, unsigned int __flags);
void __thiscall ZRef<CMxHelperServerManager>::_Alloc(ZRef<CMxHelperServerManager> *this); // idb
void __thiscall ZRef<CMxHelperServerManager>::_ReleaseRaw(ZRef<CMxHelperServerManager> *this, ZRefCounted *__formal); // idb
ZXString<char> *__thiscall ZXString<char>::TrimRight(ZXString<char> *this, const char *sWhiteSpaceSet); // idb
ZXString<char> *__thiscall ZXString<char>::TrimLeft(ZXString<char> *this, const char *sWhiteSpaceSet); // idb
void __cdecl ZXString<char>::_Release(ZXString<char>::_ZXStringData *pData); // idb
ZXString<char> *__thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::GetAt(ZMap<unsigned long,ZXString<char>,unsigned long> *this, const unsigned int *key, ZXString<char> *value); // idb
__POSITION *__thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::Insert(ZMap<unsigned long,ZXString<char>,unsigned long> *this, const unsigned int *key, ZXString<char> *value); // idb
ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this, unsigned int __flags);
int __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveKey(ZMap<unsigned long,ZXString<char>,unsigned long> *this, const unsigned int *key); // idb
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveAll(ZMap<unsigned long,ZXString<char>,unsigned long> *this); // idb
unsigned int *__thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::GetAt(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, ZXString<char> *key, unsigned int *value); // idb
unsigned int __cdecl HashKey(const char *s); // idb
ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *__thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::Insert(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, ZXString<char> *key, const unsigned int *value);
void __thiscall ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::~ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this); // idb
ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *__thiscall ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this, unsigned int __flags);
void __cdecl ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::operator delete(void *p); // idb
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::RemoveAll(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this); // idb
int __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveKey(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, const unsigned int *key); // idb
void __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveAll(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this); // idb
void __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_CalcAutoGrow(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, unsigned int uAutoGrowEvery128); // idb
ZMap<char const *,int,ZXString<char> >::_PAIR *__thiscall ZMap<char const *,int,ZXString<char>>::Insert(ZMap<char const *,int,ZXString<char> > *this, const char *const *key, const int *value);
void __thiscall ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::~ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this); // idb
ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *__thiscall ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this, unsigned int __flags);
void __cdecl ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::operator delete(void *p); // idb
void __thiscall ZMap<char const *,int,ZXString<char>>::RemoveAll(ZMap<char const *,int,ZXString<char> > *this); // idb
void __thiscall ZMap<char const *,int,ZXString<char>>::_CalcAutoGrow(ZMap<char const *,int,ZXString<char> > *this, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this, void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this, void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this, void *p); // idb
void __cdecl ZRefCounted_Alloc();
void _E80();
void _E67();
void _E68();
void _E69();
void _E70();
void _E71();
void _E72();
void _E73();
void _E74();
void _E75();
void _E76();
void _E77();
void _E78();
void _E79();
void __thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this); // idb
ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::`scalar deleting destructor'(ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *this, unsigned int __flags);
ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *__thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::`scalar deleting destructor'(ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *this, unsigned int __flags);
ZMap<char const *,int,ZXString<char> >::_PAIR *__thiscall ZMap<char const *,int,ZXString<char>>::_PAIR::`scalar deleting destructor'(ZMap<char const *,int,ZXString<char> >::_PAIR *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this, unsigned int __flags);
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::~_PAIR(ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *this); // idb
void __thiscall ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::~ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this); // idb
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::~_PAIR(ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *this); // idb
void __thiscall ZMap<char const *,int,ZXString<char>>::_PAIR::~_PAIR(ZMap<char const *,int,ZXString<char> >::_PAIR *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this); // idb
Ztl_variant_t *__thiscall IWzResMan::GetObjectA(IWzResMan *this, Ztl_variant_t *result, Ztl_bstr_t __$ReturnUdt, Ztl_variant_t *sUOL, Ztl_variant_t *vParam); // idb
_FILETIME *__thiscall IWvsUnifiedDB::CheckPassword(IWvsUnifiedDB *this, char *sId, char *sPasswd, int nRegionID, int nTemporaryDue, int nWaitingDue, unsigned int *pdwAccountID, char *pnGender, int *pnBirthDate, char *pnCountryId, char *pnGradeCode, unsigned __int16 **pbsNexonClubID, char *pnRegStatID, int *pnUseDay, char *pnPurchaseExp, int *pnBlockReason, _FILETIME *pdtUnblockDate, int *pnChatBlockReason, _FILETIME *pdtChatUnblockDate, char *pnPrivateStatusID, _FILETIME *pdtRegisterDate);
unsigned int __thiscall IWvsUnifiedDB::CheckUserConnected(IWvsUnifiedDB *this, unsigned int dwAccountID);
int __thiscall ZXString<char>::operator==(ZXString<char> *this, ZXString<char> *s); // idb
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::ResizeHashTable(ZMap<unsigned long,ZXString<char>,unsigned long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::_CalcAutoGrow(ZMap<unsigned long,ZXString<char>,unsigned long> *this, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::ResizeHashTable(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::_CalcAutoGrow(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<char const *,int,ZXString<char>>::ResizeHashTable(ZMap<char const *,int,ZXString<char> > *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void **__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this);
void **__thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this);
void **__thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this);
void _E109();
int _E96();
void _E97();
void _E98();
void _E99();
void _E100();
void _E101();
void _E102();
void _E103();
void _E104();
void _E105();
void _E106();
void _E107();
// void __cdecl ZXString<char>::_s_sEmpty`template static data member destructor helper'(); idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this); // idb
ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this, unsigned int __flags);
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this); // idb
_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *__cdecl get_rm(); // idb
unsigned int __cdecl CCrc32::GetCrc32(const char *pData, unsigned int dwSize, unsigned int dwInit, int bUseAddr); // idb
void _E14_0();
void _E12_1();
void _E13_1();
void _E31_4();
void _E24_0();
void _E25_0();
void _E26_0();
void _E27_0();
void _E28_1();
void _E29_3();
void _E30_3();
void __thiscall GW_CharacterStat::Encode(GW_CharacterStat *this, COutPacket *oPacket); // idb
void __thiscall GW_CharacterStat::EncodeMoney(GW_CharacterStat *this, COutPacket *oPacket); // idb
void __thiscall GW_CharacterStat::Decode(GW_CharacterStat *this, CInPacket *iPacket, int bBackwardUpdate); // idb
void __thiscall GW_CharacterStat::DecodeMoney(GW_CharacterStat *this, CInPacket *iPacket); // idb
void __thiscall GW_CharacterStat::EncodeChangeStat(GW_CharacterStat *this, unsigned int flag, COutPacket *oPacket); // idb
unsigned int __thiscall GW_CharacterStat::DecodeChangeStat(GW_CharacterStat *this, CInPacket *iPacket); // idb
void __thiscall GW_ItemSlotBase::Encode(GW_ItemSlotBase *this, COutPacket *oPacket); // idb
ZRef<GW_ItemSlotBase> *__cdecl GW_ItemSlotBase::Decode(ZRef<GW_ItemSlotBase> *result, CInPacket *__$ReturnUdt); // idb
int __thiscall GW_ItemSlotBase::IsSameItem(GW_ItemSlotBase *this, GW_ItemSlotBase *pSrc); // idb
int __thiscall GW_ItemSlotEquip::IsSameEquipItem(GW_ItemSlotEquip *this, GW_ItemSlotEquip *pSrc); // idb
ZRef<GW_ItemSlotBase> *__cdecl GW_ItemSlotBase::CreateItem(ZRef<GW_ItemSlotBase> *result, int __$ReturnUdt); // idb
void __thiscall GW_ItemSlotBase::GW_ItemSlotBase(GW_ItemSlotBase *this); // idb
GW_ItemSlotBase *__thiscall GW_ItemSlotBase::`vector deleting destructor'(GW_ItemSlotBase *this, unsigned int __flags);
void __thiscall GW_ItemSlotBase::~GW_ItemSlotBase(GW_ItemSlotBase *this); // idb
int __thiscall GW_ItemSlotEquip::IsProtectedItem(GW_ItemSlotEquip *this); // idb
int GW_ItemSlotEquip::GetType();
int GW_ItemSlotEquip::GetDataSize();
int GW_ItemSlotEquip::GetItemNumber();
ZXString<char> *__thiscall GW_ItemSlotEquip::GetItemTitle(GW_ItemSlotEquip *this, ZXString<char> *result); // idb
void __thiscall GW_ItemSlotEquip::SetItemTitle(GW_ItemSlotEquip *this, ZXString<char> sName); // idb
void __thiscall GW_ItemSlotEquip::SetProtected(GW_ItemSlotEquip *this); // idb
void __thiscall GW_ItemSlotEquip::SetItemAttribute(GW_ItemSlotEquip *this, __int16 nNewAttribute); // idb
int __thiscall GW_ItemSlotBundle::IsProtectedItem(GW_ItemSlotBundle *this); // idb
int GW_ItemSlotBundle::GetType();
int GW_ItemSlotBundle::GetDataSize();
int __thiscall GW_ItemSlotBundle::GetItemNumber(GW_ItemSlotBundle *this); // idb
void __thiscall GW_ItemSlotBundle::SetItemNumber(GW_ItemSlotBundle *this, __int16 nNumber); // idb
ZXString<char> *__thiscall GW_ItemSlotBundle::GetItemTitle(GW_ItemSlotBundle *this, ZXString<char> *result); // idb
void __thiscall GW_ItemSlotBundle::SetItemTitle(GW_ItemSlotBundle *this, ZXString<char> sName); // idb
void __thiscall GW_ItemSlotBundle::SetProtected(GW_ItemSlotBundle *this); // idb
void __thiscall GW_ItemSlotBundle::SetItemAttribute(GW_ItemSlotBundle *this, __int16 nNewAttribute); // idb
int GW_ItemSlotPet::IsProtectedItem();
int GW_ItemSlotPet::GetType();
int GW_ItemSlotPet::GetDataSize();
int GW_ItemSlotPet::GetItemNumber();
ZXString<char> *__stdcall GW_ItemSlotPet::GetItemTitle(ZXString<char> *result);
void __stdcall GW_ItemSlotPet::SetItemTitle(ZXString<char> sName);
_LARGE_INTEGER *__stdcall GW_ItemSlotPet::GetSN(_LARGE_INTEGER *__$ReturnUdt);
GW_ItemSlotEquip *__thiscall GW_ItemSlotEquip::`scalar deleting destructor'(GW_ItemSlotEquip *this, unsigned int __flags);
GW_ItemSlotBundle *__thiscall GW_ItemSlotBundle::`vector deleting destructor'(GW_ItemSlotBundle *this, unsigned int __flags);
GW_ItemSlotPet *__thiscall GW_ItemSlotPet::`vector deleting destructor'(GW_ItemSlotPet *this, unsigned int __flags);
void __thiscall GW_ItemSlotEquip::~GW_ItemSlotEquip(GW_ItemSlotEquip *this); // idb
void __thiscall GW_ItemSlotBundle::~GW_ItemSlotBundle(GW_ItemSlotBundle *this); // idb
void __thiscall GW_ItemSlotPet::~GW_ItemSlotPet(GW_ItemSlotPet *this); // idb
ZRef<GW_ItemSlotBase> *__thiscall GW_ItemSlotBase::MakeClone(GW_ItemSlotBase *this, ZRef<GW_ItemSlotBase> *result); // idb
ZXString<char> *__thiscall GW_ItemSlotBase::DumpString(GW_ItemSlotBase *this, ZXString<char> *result); // idb
void __thiscall GW_ItemSlotBase::RawEncode(GW_ItemSlotBase *this, COutPacket *oPacket); // idb
void __thiscall GW_ItemSlotBase::RawDecode(GW_ItemSlotBase *this, CInPacket *iPacket); // idb
void __thiscall GW_ItemSlotEquip::BackwardUpdateCashItem(GW_ItemSlotEquip *this, GW_ItemSlotBase *pSrc); // idb
ZXString<char> *__thiscall GW_ItemSlotEquip::DumpString(GW_ItemSlotEquip *this, ZXString<char> *result); // idb
void __thiscall GW_ItemSlotEquip::RawEncode(GW_ItemSlotEquip *this, COutPacket *oPacket); // idb
void __thiscall GW_ItemSlotEquip::RawDecode(GW_ItemSlotEquip *this, CInPacket *iPacket); // idb
ZXString<char> *__thiscall GW_ItemSlotBundle::DumpString(GW_ItemSlotBundle *this, ZXString<char> *result); // idb
void __thiscall GW_ItemSlotBundle::RawEncode(GW_ItemSlotBundle *this, COutPacket *oPacket); // idb
void __thiscall GW_ItemSlotBundle::RawDecode(GW_ItemSlotBundle *this, CInPacket *iPacket); // idb
void __thiscall GW_ItemSlotPet::BackwardUpdateCashItem(GW_ItemSlotPet *this, GW_ItemSlotBase *pSrc); // idb
ZXString<char> *__thiscall GW_ItemSlotPet::DumpString(GW_ItemSlotPet *this, ZXString<char> *result); // idb
void __thiscall GW_ItemSlotPet::RawEncode(GW_ItemSlotPet *this, COutPacket *oPacket); // idb
void __thiscall GW_ItemSlotPet::RawDecode(GW_ItemSlotPet *this, CInPacket *iPacket); // idb
void __thiscall GW_MiniGameRecord::InitializeData(GW_MiniGameRecord *this, int nGameType); // idb
void __thiscall GW_MiniGameRecord::Encode(GW_MiniGameRecord *this, COutPacket *oPacket); // idb
void __thiscall GW_MiniGameRecord::Decode(GW_MiniGameRecord *this, CInPacket *iPacket); // idb
void __thiscall PARCEL::Encode(PARCEL *this, COutPacket *oPacket); // idb
void __thiscall PARCEL::Decode(PARCEL *this, CInPacket *iPacket); // idb
void __thiscall PARTYMEMBER::Encode(PARTYMEMBER *this, COutPacket *oPacket); // idb
void __thiscall PARTYMEMBER::Decode(PARTYMEMBER *this, CInPacket *iPacket); // idb
void __thiscall PARTYDATA::Encode(PARTYDATA *this, COutPacket *oPacket); // idb
void __thiscall PARTYDATA::Decode(PARTYDATA *this, CInPacket *iPacket); // idb
void __thiscall FUNCKEY_MAPPED::Encode(FUNCKEY_MAPPED *this, COutPacket *oPacket); // idb
void __thiscall FUNCKEY_MAPPED::Decode(FUNCKEY_MAPPED *this, CInPacket *iPacket); // idb
void __thiscall GW_Friend::Encode(GW_Friend *this, COutPacket *oPacket); // idb
void __thiscall GW_Friend::Decode(GW_Friend *this, CInPacket *iPacket); // idb
void __thiscall GUILDMEMBER::Encode(GUILDMEMBER *this, COutPacket *oPacket); // idb
void __thiscall GUILDMEMBER::Decode(GUILDMEMBER *this, CInPacket *iPacket); // idb
void __thiscall GUILDDATA::Encode(GUILDDATA *this, COutPacket *oPacket); // idb
void __thiscall GUILDDATA::Decode(GUILDDATA *this, CInPacket *iPacket); // idb
void __thiscall GW_CoupleRecord::Encode(GW_CoupleRecord *this, COutPacket *oPacket); // idb
void __thiscall GW_CoupleRecord::Decode(GW_CoupleRecord *this, CInPacket *iPacket); // idb
void __thiscall GW_FriendRecord::Encode(GW_FriendRecord *this, COutPacket *oPacket); // idb
void __thiscall GW_FriendRecord::Decode(GW_FriendRecord *this, CInPacket *iPacket); // idb
void __thiscall GW_MarriageRecord::Encode(GW_MarriageRecord *this, COutPacket *oPacket); // idb
void __thiscall GW_MarriageRecord::Decode(GW_MarriageRecord *this, CInPacket *iPacket); // idb
void __thiscall GW_WeddingReservation::Encode(GW_WeddingReservation *this, COutPacket *oPacket); // idb
void __thiscall GW_WeddingReservation::Decode(GW_WeddingReservation *this, CInPacket *iPacket); // idb
void __thiscall GW_WeddingWishList::Encode(GW_WeddingWishList *this, COutPacket *oPacket); // idb
void __thiscall GW_WeddingWishList::Decode(GW_WeddingWishList *this, CInPacket *iPacket); // idb
void __thiscall GW_Memo::Encode(GW_Memo *this, COutPacket *oPacket); // idb
void __thiscall GW_Memo::Decode(GW_Memo *this, CInPacket *iPacket); // idb
void __thiscall CharacterData::Encode(CharacterData *this, COutPacket *oPacket, unsigned __int16 usFlag); // idb
int __thiscall CharacterData::Decode(CharacterData *this, CInPacket *iPacket, int bBackwardUpdate);
int __thiscall CharacterData::FindEmptySlotPosition(CharacterData *this, int nTI); // idb
void __thiscall CashItemEntry::Set(CashItemEntry *this, ZRef<GW_ItemSlotBase> pItem, int nPOS); // idb
__POSITION *__thiscall CharacterData::SetQuest(CharacterData *this, unsigned __int16 usQRKey, ZXString<char> *sQRValue);
int __thiscall CharacterData::RemoveQuest(CharacterData *this, unsigned __int16 usQRKey); // idb
void __thiscall CharacterData::RemoveAllQuest(CharacterData *this); // idb
ZXString<char> *__thiscall CharacterData::SELECTEDMOB::Encode(CharacterData::SELECTEDMOB *this, ZXString<char> *result); // idb
char __thiscall CharacterData::SELECTEDMOB::Decode(CharacterData::SELECTEDMOB *this, ZXString<char> *sQRValue); // idb
CharacterData::SELECTEDMOB *__thiscall CharacterData::_GetQuestValue(CharacterData *this, CharacterData::SELECTEDMOB *result, unsigned __int16 __$ReturnUdt); // idb
int __thiscall CharacterData::GetItemCount(CharacterData *this, int nTI, int nItemID); // idb
ZRef<GW_ItemSlotBase> *__thiscall CharacterData::GetItem(CharacterData *this, ZRef<GW_ItemSlotBase> *result, int __$ReturnUdt, int nTI); // idb
void __thiscall AvatarLook::Load(AvatarLook *this, GW_CharacterStat *cs, const int *anEquipped, const int *anEquipped2); // idb
void __thiscall AvatarLook::Load(AvatarLook *this, GW_CharacterStat *cs, ZRef<GW_ItemSlotBase> *apEquipped, ZRef<GW_ItemSlotBase> *apEquipped2); // idb
void __thiscall AvatarLook::Encode(AvatarLook *this, COutPacket *oPacket); // idb
void __thiscall AvatarLook::Decode(AvatarLook *this, CInPacket *iPacket); // idb
void __thiscall SCRIPTINFO::Encode(SCRIPTINFO *this, COutPacket *oPacket); // idb
void __thiscall SCRIPTINFO::Decode(SCRIPTINFO *this, CInPacket *iPacket); // idb
void __thiscall MODSCRIPT::Encode(MODSCRIPT *this, COutPacket *oPacket); // idb
void __thiscall MODSCRIPT::Decode(MODSCRIPT *this, CInPacket *iPacket); // idb
void __thiscall ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(ZRef<GW_ItemSlotBase> *this); // idb
void __thiscall ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>(ZRef<GW_ItemSlotBase> *this, ZRef<GW_ItemSlotBase> *r); // idb
ZRef<GW_ItemSlotBase> *__thiscall ZRef<GW_ItemSlotBase>::operator=(ZRef<GW_ItemSlotBase> *this, ZRef<GW_ItemSlotBase> *r); // idb
void __thiscall ZRef<GW_MiniGameRecord>::~ZRef<GW_MiniGameRecord>(ZRef<GW_MiniGameRecord> *this); // idb
void __thiscall ZArray<CashItemEntry>::ZArray<CashItemEntry>(ZArray<CashItemEntry> *this); // idb
void __thiscall ZArray<CashItemEntry>::~ZArray<CashItemEntry>(ZArray<CashItemEntry> *this); // idb
void __thiscall ZRef<GW_MiniGameRecord>::_Alloc(ZRef<GW_MiniGameRecord> *this); // idb
void __thiscall ZRef<GW_ItemSlotBase>::_ReleaseRaw(ZRef<GW_ItemSlotBase> *this, ZRefCounted *__formal); // idb
void __thiscall ZRef<GW_MiniGameRecord>::_ReleaseRaw(ZRef<GW_MiniGameRecord> *this, void *__formal); // idb
ZXString<char> *__thiscall ZXString<char>::Substring(ZXString<char> *this, ZXString<char> *result, int __$ReturnUdt, int nFrom); // idb
ZXString<char> *__thiscall ZXString<char>::_Cat(ZXString<char> *this, const char *s, int len); // idb
ZXString<char> *__thiscall ZXString<char>::ZXString<char>(ZXString<char> *this, char *s, int n);
ZXString<char> *__thiscall ZArray<ZXString<char>>::InsertBefore(ZArray<ZXString<char> > *this, int nIndex); // idb
unsigned int *__thiscall ZArray<unsigned long>::_Alloc(ZArray<unsigned long> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
void __thiscall ZArray<unsigned long>::RemoveAll(ZArray<unsigned long> *this); // idb
GUILDMEMBER *__thiscall ZArray<GUILDMEMBER>::_Alloc(ZArray<GUILDMEMBER> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
void __thiscall ZArray<GUILDMEMBER>::RemoveAll(ZArray<GUILDMEMBER> *this); // idb
ZRef<GW_ItemSlotBase> *__thiscall ZArray<ZRef<GW_ItemSlotBase>>::InsertBefore(ZArray<ZRef<GW_ItemSlotBase> > *this, int nIndex); // idb
ZRef<GW_ItemSlotBase> *__thiscall ZArray<ZRef<GW_ItemSlotBase>>::_Realloc(ZArray<ZRef<GW_ItemSlotBase> > *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
void __thiscall ZRef<GW_ItemSlotBase>::_Release(ZRef<GW_ItemSlotBase> *this); // idb
int *__thiscall ZMap<long,long,long>::GetAt(ZMap<long,long,long> *this, const int *key, int *value); // idb
__POSITION *__thiscall ZMap<long,long,long>::Insert(ZMap<long,long,long> *this, const int *key, const int *value); // idb
ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *__thiscall ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this, unsigned int __flags);
__POSITION *__thiscall ZMap<long,long,long>::GetNext(ZMap<long,long,long> *this, __POSITION **pos, int *value);
__POSITION *__thiscall ZMap<long,unsigned short,long>::Insert(ZMap<long,unsigned short,long> *this, const int *key, const unsigned __int16 *value); // idb
ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *__thiscall ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this, unsigned int __flags);
void __thiscall ZMap<long,unsigned short,long>::RemoveAll(ZMap<long,unsigned short,long> *this); // idb
__POSITION *__thiscall ZMap<long,unsigned short,long>::GetNext(ZMap<long,unsigned short,long> *this, __POSITION **pos, unsigned __int16 *value);
__POSITION *__thiscall ZMap<unsigned short,_FILETIME,unsigned short>::Insert(ZMap<unsigned short,_FILETIME,unsigned short> *this, const unsigned __int16 *key, _FILETIME *value); // idb
ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`scalar deleting destructor'(ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this, unsigned int __flags);
void __thiscall ZMap<unsigned short,_FILETIME,unsigned short>::RemoveAll(ZMap<unsigned short,_FILETIME,unsigned short> *this); // idb
__POSITION *__thiscall ZMap<unsigned short,_FILETIME,unsigned short>::GetNext(ZMap<unsigned short,_FILETIME,unsigned short> *this, __POSITION **pos, _FILETIME *value);
ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *__thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::Insert(ZMap<long,ZRef<GW_MiniGameRecord>,long> *this, const int *key, ZRef<GW_MiniGameRecord> *value);
ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *__thiscall ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this, unsigned int __flags);
__POSITION *__thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::GetNext(ZMap<long,ZRef<GW_MiniGameRecord>,long> *this, __POSITION **pos, ZRef<GW_MiniGameRecord> *value);
GW_CoupleRecord *__thiscall ZList<GW_CoupleRecord>::AddTail(ZList<GW_CoupleRecord> *this); // idb
GW_FriendRecord *__thiscall ZList<GW_FriendRecord>::AddTail(ZList<GW_FriendRecord> *this); // idb
GW_MarriageRecord *__thiscall ZList<GW_MarriageRecord>::AddTail(ZList<GW_MarriageRecord> *this); // idb
ZXString<char> *__thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::GetAt(ZMap<unsigned short,ZXString<char>,unsigned short> *this, const unsigned __int16 *key, ZXString<char> *value); // idb
__POSITION *__thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::Insert(ZMap<unsigned short,ZXString<char>,unsigned short> *this, const unsigned __int16 *key, ZXString<char> *value); // idb
ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this, unsigned int __flags);
int __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::RemoveKey(ZMap<unsigned short,ZXString<char>,unsigned short> *this, const unsigned __int16 *key); // idb
void __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::RemoveAll(ZMap<unsigned short,ZXString<char>,unsigned short> *this); // idb
__POSITION *__thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::GetNext(ZMap<unsigned short,ZXString<char>,unsigned short> *this, __POSITION **pos, ZXString<char> *value);
ZRef<GW_ItemSlotBase> *__thiscall ZArray<ZRef<GW_ItemSlotBase>>::operator[](ZArray<ZRef<GW_ItemSlotBase> > *this, int i); // idb
ZXString<char> *__thiscall ZArray<ZXString<char>>::operator[](ZArray<ZXString<char> > *this, int i); // idb
void __thiscall ZArray<CashItemEntry>::RemoveAll(ZArray<CashItemEntry> *this); // idb
CashItemEntry *__thiscall ZArray<CashItemEntry>::InsertBefore(ZArray<CashItemEntry> *this, int nIndex); // idb
void __thiscall ZArray<CashItemEntry>::RemoveAt(ZArray<CashItemEntry> *this, __POSITION *pos); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this, void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this, void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this, void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this, void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this, void *p); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this, void *p); // idb
void _E26_1();
void _E18_1();
void _E19_1();
void _E20_0();
void _E21();
void _E22();
void _E23_0();
void _E24_1();
void _E25_1();
void __thiscall ZRefCountedDummy<GW_MiniGameRecord>::ZRefCountedDummy<GW_MiniGameRecord>(ZRefCountedDummy<GW_MiniGameRecord> *this); // idb
ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *__thiscall ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this, unsigned int __flags);
ZRefCountedDummy<GW_MiniGameRecord> *__thiscall ZRefCountedDummy<GW_MiniGameRecord>::`scalar deleting destructor'(ZRefCountedDummy<GW_MiniGameRecord> *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<GW_MiniGameRecord>::~ZRefCountedDummy<GW_MiniGameRecord>(ZRefCountedDummy<GW_MiniGameRecord> *this); // idb
ZRef<GW_ItemSlotBase> *__thiscall ZArray<ZRef<GW_ItemSlotBase>>::GetCapacity(ZArray<ZRef<GW_ItemSlotBase> > *this);
ZRef<GW_MiniGameRecord> *__thiscall ZRef<GW_MiniGameRecord>::operator=(ZRef<GW_MiniGameRecord> *this, ZRef<GW_MiniGameRecord> *r); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this); // idb
ZMap<long,long,long>::_PAIR *__thiscall ZMap<long,long,long>::_PAIR::`scalar deleting destructor'(ZMap<long,long,long>::_PAIR *this, unsigned int __flags);
ZMap<long,unsigned short,long>::_PAIR *__thiscall ZMap<long,unsigned short,long>::_PAIR::`scalar deleting destructor'(ZMap<long,unsigned short,long>::_PAIR *this, unsigned int __flags);
ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *__thiscall ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::`scalar deleting destructor'(ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *this, unsigned int __flags);
ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *__thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::`scalar deleting destructor'(ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *this, unsigned int __flags);
ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *__thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::`scalar deleting destructor'(ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *this, unsigned int __flags);
ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this, unsigned int __flags);
void __thiscall ZMap<long,long,long>::_PAIR::~_PAIR(ZMap<long,long,long>::_PAIR *this); // idb
void __thiscall ZMap<long,unsigned short,long>::_PAIR::~_PAIR(ZMap<long,unsigned short,long>::_PAIR *this); // idb
void __thiscall ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::~_PAIR(ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *this); // idb
void __thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::~_PAIR(ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *this); // idb
void __thiscall ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::~ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this); // idb
void __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::~_PAIR(ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *this); // idb
void __thiscall ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::~ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this); // idb
void __thiscall CashItemEntry::~CashItemEntry(CashItemEntry *this); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this); // idb
void __thiscall ZRef<GW_MiniGameRecord>::_AddRef(ZRef<GW_MiniGameRecord> *this); // idb
ZXString<char> *__thiscall ZArray<ZXString<char>>::_Realloc(ZArray<ZXString<char> > *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
void __cdecl ZArray<ZXString<char>>::_Destroy(ZXString<char> *b, ZXString<char> *e); // idb
void __thiscall ZMap<long,long,long>::ResizeHashTable(ZMap<long,long,long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<long,unsigned short,long>::ResizeHashTable(ZMap<long,unsigned short,long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<unsigned short,_FILETIME,unsigned short>::ResizeHashTable(ZMap<unsigned short,_FILETIME,unsigned short> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::ResizeHashTable(ZMap<long,ZRef<GW_MiniGameRecord>,long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
GW_CoupleRecord *__thiscall ZList<GW_CoupleRecord>::_New(ZList<GW_CoupleRecord> *this, void *pPrev, void *pNext); // idb
GW_FriendRecord *__thiscall ZList<GW_FriendRecord>::_New(ZList<GW_FriendRecord> *this, void *pPrev, void *pNext); // idb
GW_MarriageRecord *__thiscall ZList<GW_MarriageRecord>::_New(ZList<GW_MarriageRecord> *this, void *pPrev, void *pNext); // idb
void __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::ResizeHashTable(ZMap<unsigned short,ZXString<char>,unsigned short> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
CashItemEntry *__thiscall ZArray<CashItemEntry>::_Realloc(ZArray<CashItemEntry> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
void **__thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this);
void **__thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this);
_DWORD **__thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this);
_DWORD **__thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this);
void **__thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this);
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this);
ZXString<char> *__cdecl construct(ZXString<char> *p); // idb
ZRef<GW_ItemSlotBase> *__cdecl construct(ZRef<GW_ItemSlotBase> *p); // idb
CashItemEntry *__cdecl construct(CashItemEntry *p); // idb
void _E49_2();
void _E39_2();
void _E40_1();
void _E41_1();
void _E42_1();
void _E43();
void _E44_0();
void _E45_0();
void _E46_0();
void _E47_0();
void _E48_0();
ZXString<char> *__thiscall ZArray<ZXString<char>>::GetCapacity(ZArray<ZXString<char> > *this);
CashItemEntry *__thiscall ZArray<CashItemEntry>::GetCapacity(ZArray<CashItemEntry> *this);
void __thiscall ZMap<long,long,long>::_CalcAutoGrow(ZMap<long,long,long> *this, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<long,unsigned short,long>::_CalcAutoGrow(ZMap<long,unsigned short,long> *this, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<unsigned short,_FILETIME,unsigned short>::_CalcAutoGrow(ZMap<unsigned short,_FILETIME,unsigned short> *this, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::_CalcAutoGrow(ZMap<long,ZRef<GW_MiniGameRecord>,long> *this, unsigned int uAutoGrowEvery128); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this, void *p); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this, void *p); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this, void *p); // idb
void __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::_CalcAutoGrow(ZMap<unsigned short,ZXString<char>,unsigned short> *this, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZRefCountedDummy<GW_CoupleRecord>::ZRefCountedDummy<GW_CoupleRecord>(ZRefCountedDummy<GW_CoupleRecord> *this); // idb
ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *__thiscall ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<GW_FriendRecord>::ZRefCountedDummy<GW_FriendRecord>(ZRefCountedDummy<GW_FriendRecord> *this); // idb
ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *__thiscall ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<GW_MarriageRecord>::ZRefCountedDummy<GW_MarriageRecord>(ZRefCountedDummy<GW_MarriageRecord> *this); // idb
ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *__thiscall ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vector deleting destructor'(ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this, unsigned int __flags);
ZRefCountedDummy<GW_CoupleRecord> *__thiscall ZRefCountedDummy<GW_CoupleRecord>::`scalar deleting destructor'(ZRefCountedDummy<GW_CoupleRecord> *this, unsigned int __flags);
ZRefCountedDummy<GW_FriendRecord> *__thiscall ZRefCountedDummy<GW_FriendRecord>::`scalar deleting destructor'(ZRefCountedDummy<GW_FriendRecord> *this, unsigned int __flags);
ZRefCountedDummy<GW_MarriageRecord> *__thiscall ZRefCountedDummy<GW_MarriageRecord>::`vector deleting destructor'(ZRefCountedDummy<GW_MarriageRecord> *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<GW_CoupleRecord>::~ZRefCountedDummy<GW_CoupleRecord>(ZRefCountedDummy<GW_CoupleRecord> *this); // idb
void __thiscall ZRefCountedDummy<GW_FriendRecord>::~ZRefCountedDummy<GW_FriendRecord>(ZRefCountedDummy<GW_FriendRecord> *this); // idb
void __thiscall ZRefCountedDummy<GW_MarriageRecord>::~ZRefCountedDummy<GW_MarriageRecord>(ZRefCountedDummy<GW_MarriageRecord> *this); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this);
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this);
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this);
void __thiscall CIPChecker::LoadIPList(CIPChecker *this); // idb
void __thiscall CIPChecker::AddIP(CIPChecker *this, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry); // idb
unsigned int __thiscall CIPChecker::GetFlag(CIPChecker *this, unsigned int dwIP); // idb
void __thiscall _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::_Release(_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *this); // idb
CIPChecker::IPELEM *__thiscall ZArray<CIPChecker::IPELEM>::InsertBefore(ZArray<CIPChecker::IPELEM> *this, int nIndex); // idb
void _E14_1();
void _E12_2();
void _E13_2();
CIPChecker::IPELEM *__thiscall ZArray<CIPChecker::IPELEM>::_Realloc(ZArray<CIPChecker::IPELEM> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
void _E31_5();
void _E24_2();
void _E25_2();
void _E26_2();
void _E27_1();
void _E28_2();
void _E29_4();
void _E30_4();
unsigned int *__thiscall ZArray<CIPChecker::IPELEM>::GetCapacity(ZArray<CIPChecker::IPELEM> *this);
char *__thiscall _bstr_t::Data_t::GetString(_bstr_t::Data_t *this);
char *__stdcall _com_util::ZtlConvertBSTRToString(unsigned __int16 *pSrc); // idb
int _E26_3();
void _E23_1();
int _E25_3();
void __cdecl _E24_3(); // idb
void __thiscall CIPCheckerServer::CIPCheckerServer(CIPCheckerServer *this); // idb
char *CIPCheckerServer::GetLogTail();
CIPCheckerServer *__thiscall CIPCheckerServer::`scalar deleting destructor'(CIPCheckerServer *this, unsigned int __flags);
void __thiscall CIPCheckerServer::~CIPCheckerServer(CIPCheckerServer *this); // idb
void __thiscall CIPCheckerServer::Disconnect(CIPCheckerServer *this); // idb
void __cdecl CIPCheckerServer::OnSocketReceive(ZSocket *pSocket, int nErr);
void __thiscall CIPCheckerServer::OnSocketSend(CIPCheckerServer *this, ZSocket *pSocket, int nErr); // idb
// void *__usercall _L115884@<eax>(int a1@<ebp>);
// void *__usercall _L115885@<eax>(int a1@<ebp>);
void __thiscall CIPCheckerServer::OnSocketClose(CIPCheckerServer *this, ZSocket *pSocket, int nErr); // idb
int __thiscall CIPCheckerServer::Connect(CIPCheckerServer *this); // idb
void __thiscall CIPCheckerServer::SendPacket(CIPCheckerServer *this, COutPacket *oPacket); // idb
// void *__usercall _L116645@<eax>(int a1@<ebp>);
void __thiscall CIPCheckerServer::Flush(CIPCheckerServer *this); // idb
void __stdcall CIPCheckerServer::ProcessPacket(CInPacket *iPacket);
void __stdcall CIPCheckerServer::LoopbackPacket(int nType, CInPacket *iPacket);
void TSingleton<CIPCheckerServer>::~TSingleton<CIPCheckerServer>();
void __thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_Release(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this); // idb
void __thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_AddRef(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this); // idb
void _E42_2();
void _E35_5();
void _E36_5();
void _E37_4();
void _E38_1();
void _E39_3();
void _E40_2();
void _E41_2();
void _E61_0();
void _E53_2();
void _E54_2();
void _E55_2();
void _E56_2();
void _E57_1();
void _E58_1();
void _E59_0();
void _E60_0();
void __thiscall ZSocketBase::CloseSocket(ZSocketBase *this); // idb
int __thiscall ZSocket::Connect(ZSocket *this, sockaddr *pAddr, int nAddr); // idb
void __thiscall CIPFilter::CIPFilter(CIPFilter *this); // idb
void __thiscall CIPFilter::AddIP(CIPFilter *this, unsigned int dwBlockType, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry); // idb
void __thiscall CIPFilter::AddGeoIP(CIPFilter *this, unsigned int dwBlockType, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry); // idb
void __cdecl `anonymous namespace'::Merge(ZArray<CIPRange> *aIPList); // idb
void __thiscall CIPFilter::LoadIPList(CIPFilter *this); // idb
void __thiscall CIPFilter::LoadGeoIPList(CIPFilter *this); // idb
signed int __thiscall CIPFilter::IsBlocked(CIPFilter *this, unsigned int dwIP);
BOOL __cdecl operator<(CIPRange *lhs, unsigned int rhs);
BOOL __cdecl operator<(unsigned int lhs, CIPRange *rhs);
void __thiscall CIPRange::SetRange(CIPRange *this, unsigned int dwBegin, unsigned int dwEnd); // idb
void TSingleton<CIPFilter>::~TSingleton<CIPFilter>();
void __thiscall ZArray<CIPRange>::ZArray<CIPRange>(ZArray<CIPRange> *this); // idb
void __thiscall ZArray<CIPRange>::~ZArray<CIPRange>(ZArray<CIPRange> *this); // idb
void __thiscall ZXString<unsigned short>::~ZXString<unsigned short>(ZXString<unsigned short> *this); // idb
unsigned __int16 *__thiscall ZXString<unsigned short>::operator unsigned short const *(ZXString<unsigned short> *this);
void __thiscall ZArray<CIPRange>::RemoveAll(ZArray<CIPRange> *this); // idb
CIPRange *__thiscall ZArray<CIPRange>::InsertBefore(ZArray<CIPRange> *this, int nIndex); // idb
void __thiscall ZArray<CIPRange>::RemoveAt(ZArray<CIPRange> *this, __POSITION *pos); // idb
ZXString<unsigned short> *ZXString<unsigned short>::Format(ZXString<unsigned short> *this, const unsigned __int16 *sFormat, ...); // idb
BOOL __cdecl std::binary_search(CIPRange *_F, CIPRange *_L, const unsigned int *_V);
void _E15();
void _E13_3();
void _E14_2();
CIPRange *__thiscall ZArray<CIPRange>::_Realloc(ZArray<CIPRange> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
void __thiscall ZXString<unsigned short>::_FormatV(ZXString<unsigned short> *this, const unsigned __int16 *lpszFormat, char *argList); // idb
void __cdecl std::_Sort_0(CIPRange *_F, CIPRange *_L);
CIPRange *__cdecl construct(CIPRange *p); // idb
void _E33_3();
void _E26_4();
void _E27_2();
void _E28_3();
void _E29_5();
void _E30_5();
void _E31_6();
void _E32_4();
unsigned int *__thiscall ZArray<CIPRange>::GetCapacity(ZArray<CIPRange> *this);
ZXString<unsigned short> *__thiscall ZXString<unsigned short>::operator=(ZXString<unsigned short> *this, ZXString<unsigned short> *s); // idb
unsigned __int16 *__thiscall ZXString<unsigned short>::GetBuffer(ZXString<unsigned short> *this, int nMinLength, int bRetain); // idb
void __thiscall ZXString<unsigned short>::ReleaseBuffer(ZXString<unsigned short> *this, int nLength); // idb
void __thiscall ZAllocEx<ZAllocStrSelector<unsigned short>>::Free(ZAllocEx<ZAllocStrSelector<unsigned short> > *this, void *p); // idb
void __cdecl std::_Sort(CIPRange *_F, CIPRange *_L);
CIPRange *__cdecl std::_Lower_bound(CIPRange *_F, CIPRange *_L, const unsigned int *_V);
ZXString<unsigned short>::_ZXStringData *__cdecl ZXString<unsigned short>::_Alloc(int nCap); // idb
void __cdecl std::_Insertion_sort_1(CIPRange *_F, CIPRange *_L);
CIPRange *__cdecl std::_Median(CIPRange *result, CIPRange __$ReturnUdt, CIPRange _X, CIPRange _Y); // idb
CIPRange *__cdecl std::_Unguarded_partition(CIPRange *_F, CIPRange *_L, CIPRange _Piv); // idb
void __thiscall ZXString<unsigned short>::Assign(ZXString<unsigned short> *this, const unsigned __int16 *s, int n); // idb
void __thiscall ZXString<unsigned short>::Empty(ZXString<unsigned short> *this); // idb
int __thiscall ZAllocEx<ZAllocStrSelector<unsigned short>>::Alloc(ZAllocEx<ZAllocStrSelector<unsigned short> > *this, unsigned int uSize);
int _E15_0();
void __cdecl _E14_3(); // idb
void __thiscall CLog::~CLog(CLog *this); // idb
void __thiscall CLog::Init(CLog *this, CLog::INITPARAM *a, unsigned int nCount); // idb
void __stdcall CLog::CreateNewFile(CLog::FILEINFO *fi, _SYSTEMTIME *st);
// void *__usercall _L110153@<eax>(int a1@<ebp>);
int __thiscall CLog::Run(CLog *this, void *pParam, ZThread::ZThreadResult *pResult); // idb
void __thiscall CLog::OutputLogV(CLog *this, unsigned int uIdx, unsigned int dwPrefixFlag, const char *sTail, const char *sFormat, char *argList); // idb
void CLog::OutputLog(CLog *this, unsigned int uIdx, unsigned int dwPrefixFlag, const char *sTail, const char *sFormat, ...); // idb
void LogReport(const char *sFormat, ...); // idb
void LogError(const char *sFormat, ...); // idb
void __cdecl LogException(ZException *e); // idb
void __cdecl LogException(_com_error *e); // idb
void TSingleton<CLog>::~TSingleton<CLog>();
void __thiscall ZArray<CLog::FILEINFO>::~ZArray<CLog::FILEINFO>(ZArray<CLog::FILEINFO> *this); // idb
void __thiscall ZList<CLog::FILELOG>::~ZList<CLog::FILELOG>(ZList<CLog::FILELOG> *this); // idb
int ZStrUtil::Snprintf(char *buffer, unsigned int count, const char *format, ...); // idb
ZList<CLog::FILELOG> *__thiscall ZList<CLog::FILELOG>::`vector deleting destructor'(ZList<CLog::FILELOG> *this, unsigned int __flags);
void __thiscall ZRef<ZFileStream>::_Alloc(ZRef<ZFileStream> *this); // idb
void __thiscall ZRef<ZFileStream>::_ReleaseRaw(ZRef<ZFileStream> *this, void *__formal); // idb
void __thiscall ZArray<CLog::FILEINFO>::RemoveAll(ZArray<CLog::FILEINFO> *this); // idb
CLog::FILEINFO *__thiscall ZArray<CLog::FILEINFO>::_Alloc(ZArray<CLog::FILEINFO> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
void __thiscall ZList<CLog::FILELOG>::RemoveAll(ZList<CLog::FILELOG> *this); // idb
void __thiscall ZList<CLog::FILELOG>::MoveAfter(ZList<CLog::FILELOG> *this, ZList<CLog::FILELOG> *l, __POSITION *posFrom, __POSITION *posTo, __POSITION *pos); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this, void *p); // idb
void _E24_4();
void _E21_0();
void _E22_0();
void _E23_2();
void __thiscall ZRefCountedDummy<ZFileStream>::ZRefCountedDummy<ZFileStream>(ZRefCountedDummy<ZFileStream> *this); // idb
ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *__thiscall ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this, unsigned int __flags);
ZRefCountedDummy<ZFileStream> *__thiscall ZRefCountedDummy<ZFileStream>::`scalar deleting destructor'(ZRefCountedDummy<ZFileStream> *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<ZFileStream>::~ZRefCountedDummy<ZFileStream>(ZRefCountedDummy<ZFileStream> *this); // idb
void __thiscall ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::~ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this); // idb
void __thiscall CLog::FILEINFO::~FILEINFO(CLog::FILEINFO *this); // idb
void __thiscall ZISeekableStream::~ZISeekableStream(ZISeekableStream *this); // idb
ZFileStream *__thiscall ZFileStream::`scalar deleting destructor'(ZFileStream *this, unsigned int __flags);
void __thiscall ZFileStream::~ZFileStream(ZFileStream *this); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this);
CLog::FILEINFO *__cdecl construct(CLog::FILEINFO *p); // idb
void _E39_4();
void _E33_4();
void _E34_5();
void _E35_6();
void _E36_6();
void _E37_5();
void _E38_2();
int __thiscall ZFileStream::Close(ZFileStream *this); // idb
void __thiscall ZFileStream::OpenForWriting(ZFileStream *this, const char *sFileName, unsigned int dwCreationDisposition, unsigned int dwFlagsAndAttributes, unsigned int dwShareMode, unsigned int dwDesiredAccess, _SECURITY_ATTRIBUTES *lpSecurityAttributes, void *hTemplateFile); // idb
__int64 __thiscall ZFileStream::GetPosition(ZFileStream *this);
unsigned __int64 __thiscall ZFileStream::GetPosition64(ZFileStream *this); // idb
void __thiscall ZFileStream::SetPosition(ZFileStream *this, int nPos, unsigned int uMethod); // idb
void __thiscall ZFileStream::SetPosition64(ZFileStream *this, __int64 nPos, unsigned int uMethod); // idb
__int64 __cdecl ZFileStream::_SetRealPosition(void *hFile, unsigned __int64 uPos, unsigned int uMethod);
int __thiscall ZFileStream::GetLength(ZFileStream *this);
unsigned __int64 __thiscall ZFileStream::GetLength64(ZFileStream *this); // idb
void __thiscall ZFileStream::SetLength(ZFileStream *this, unsigned int uLen); // idb
void __cdecl ZFileStream::SetLength64(unsigned __int64 uLen);
// unsigned int __userpurge ZFileStream::Read@<eax>(__int64 this@<ebx:ecx>, void *pData, unsigned int uSize);
ZRefCountedDummy<ZFileStream> *__thiscall ZRefCountedDummy<ZFileStream>::`vector deleting destructor'(ZRefCountedDummy<ZFileStream> *this, unsigned int a2);
unsigned int __thiscall ZFileStream::ReadFromSpecificPos(ZFileStream *this, unsigned int uPos, char *pData, unsigned int uSize); // idb
unsigned int __thiscall ZFileStream::Write(ZFileStream *this, const void *pData, unsigned int uSize); // idb
void __thiscall ZFileStream::Flush(ZFileStream *this, int bAll); // idb
unsigned int __thiscall ZFileStream::ReadEOF(ZFileStream *this, void *pData, unsigned int uSize); // idb
unsigned int __thiscall ZFileStream::WriteEOF(ZFileStream *this, const void *pData, unsigned int uSize); // idb
int __thiscall ZFileStream::CopyTo(ZFileStream *this, ZIStream *pStream, unsigned int uSize);
int __thiscall ZFileStream::CopyFrom(ZFileStream *this, ZIStream *pStream, unsigned int uSize);
int __thiscall ZFileStream::Unmap(ZFileStream *this, int bDestroyMappingObject); // idb
void __thiscall _com_error::_com_error(_com_error *this, int hr, IErrorInfo *perrinfo, char fAddRef); // idb
_com_error *__thiscall _com_error::`scalar deleting destructor'(_com_error *this, unsigned int __flags);
void __thiscall _com_error::~_com_error(_com_error *this); // idb
void __thiscall CLog::CLog(CLog *this); // idb
void __thiscall CLog::AddFileLog(CLog *this, int uIdx, ZXString<char> sLog); // idb
CLog::FILELOG *__thiscall ZList<CLog::FILELOG>::AddTail(ZList<CLog::FILELOG> *this); // idb
CLog::FILELOG *__thiscall ZList<CLog::FILELOG>::_New(ZList<CLog::FILELOG> *this, void *pPrev, void *pNext); // idb
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this, void *p); // idb
void __thiscall ZRefCountedDummy<CLog::FILELOG>::ZRefCountedDummy<CLog::FILELOG>(ZRefCountedDummy<CLog::FILELOG> *this); // idb
ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *__thiscall ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this, unsigned int __flags);
ZRefCountedDummy<CLog::FILELOG> *__thiscall ZRefCountedDummy<CLog::FILELOG>::`vector deleting destructor'(ZRefCountedDummy<CLog::FILELOG> *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<CLog::FILELOG>::~ZRefCountedDummy<CLog::FILELOG>(ZRefCountedDummy<CLog::FILELOG> *this); // idb
void __thiscall ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::~ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this);
CLog *__thiscall CLog::`scalar deleting destructor'(CLog *this, unsigned int __flags);
int _E25_4();
void _E22_1();
int _E24_5();
void __cdecl _E23_3(); // idb
void __thiscall CLoginAcceptor::CLoginAcceptor(CLoginAcceptor *this); // idb
CLoginAcceptor *__thiscall CLoginAcceptor::`vector deleting destructor'(CLoginAcceptor *this, unsigned int __flags);
void __thiscall CLoginAcceptor::~CLoginAcceptor(CLoginAcceptor *this); // idb
int __thiscall CLoginAcceptor::Begin(CLoginAcceptor *this, ZInetAddr *sockaddr); // idb
void __thiscall CLoginAcceptor::Terminate(CLoginAcceptor *this); // idb
void __thiscall CLoginAcceptor::OnAccept(CLoginAcceptor *this, unsigned int dwErr, CClientSocket *pSocket, sockaddr_in *pAddr); // idb
// void *__usercall _L115640@<eax>(int a1@<ebp>);
// void __userpurge _L115638(int a1@<ebp>, int a2, int a3, int a4);
ZRef<CClientSocket> *__thiscall CLoginAcceptor::GetSocket(CLoginAcceptor *this, ZRef<CClientSocket> *result, unsigned int __$ReturnUdt); // idb
void __thiscall CLoginAcceptor::RemoveSocket(CLoginAcceptor *this, CClientSocket *pSocket); // idb
void __thiscall ZSocketAcceptor<CClientSocket>::~ZSocketAcceptor<CClientSocket>(ZSocketAcceptor<CClientSocket> *this); // idb
void __stdcall ZSocketAcceptor<CClientSocket>::OnAccept(unsigned int dwErr, CClientSocket *pSocket, sockaddr_in *pAddr);
int ZSocketAcceptor<CClientSocket>::GetType();
void TSingleton<CLoginAcceptor>::~TSingleton<CLoginAcceptor>();
void __thiscall ZList<ZRef<CClientSocket>>::~ZList<ZRef<CClientSocket>>(ZList<ZRef<CClientSocket> > *this); // idb
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::~ZMap<unsigned long,unsigned long,unsigned long>(ZMap<unsigned long,unsigned long,unsigned long> *this); // idb
ZSocketAcceptor<CClientSocket> *__thiscall ZSocketAcceptor<CClientSocket>::`vector deleting destructor'(ZSocketAcceptor<CClientSocket> *this, unsigned int __flags);
ZList<ZRef<CClientSocket> > *__thiscall ZList<ZRef<CClientSocket>>::`scalar deleting destructor'(ZList<ZRef<CClientSocket> > *this, unsigned int __flags);
ZMap<unsigned long,unsigned long,unsigned long> *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::`vector deleting destructor'(ZMap<unsigned long,unsigned long,unsigned long> *this, unsigned int __flags);
void __thiscall ZRef<ZSocketBuffer>::_AddRef(ZRef<ZSocketBuffer> *this); // idb
void __thiscall ZRef<CClientSocket>::_AddRef(ZRef<CClientSocket> *this); // idb
void __thiscall ZRef<CClientSocket>::_Release(ZRef<CClientSocket> *this); // idb
void __thiscall ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::~ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>(ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped> *this); // idb
ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::Insert(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, const unsigned int *key, ZRef<CClientSocket> *value);
ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this, unsigned int __flags);
void __thiscall ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::RemoveAll(ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped> *this); // idb
int __thiscall ZSocketAcceptor<CClientSocket>::BeginAcceptor(ZSocketAcceptor<CClientSocket> *this, sockaddr_in *pAddr, ZPort *pPort, int nAccepts, int backlog); // idb
void __thiscall ZSocketAcceptor<CClientSocket>::CloseAcceptor(ZSocketAcceptor<CClientSocket> *this); // idb
void __cdecl ZSocketAcceptor<CClientSocket>::OnComplete(void *pUser, unsigned int key, unsigned int dwErr);
void *_L118578();
ZRef<CClientSocket> *__thiscall ZList<ZRef<CClientSocket>>::AddTail(ZList<ZRef<CClientSocket> > *this); // idb
void __thiscall ZList<ZRef<CClientSocket>>::RemoveAt(ZList<ZRef<CClientSocket> > *this, __POSITION *pos); // idb
void __thiscall ZList<ZRef<CClientSocket>>::RemoveAll(ZList<ZRef<CClientSocket> > *this); // idb
__POSITION *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::Insert(ZMap<unsigned long,unsigned long,unsigned long> *this, const unsigned int *key, const unsigned int *value); // idb
ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this, unsigned int __flags);
int __thiscall ZMap<unsigned long,unsigned long,unsigned long>::RemoveKey(ZMap<unsigned long,unsigned long,unsigned long> *this, const unsigned int *key); // idb
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::RemoveAll(ZMap<unsigned long,unsigned long,unsigned long> *this); // idb
__POSITION *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::GetNext(ZMap<unsigned long,unsigned long,unsigned long> *this, __POSITION **pos, unsigned int *value);
ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::GetPos(ZMap<unsigned long,unsigned long,unsigned long> *this, const unsigned int *key);
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this, void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this, void *p); // idb
void _E41_3();
void _E34_6();
void _E35_7();
void _E36_7();
void _E37_6();
void _E38_3();
void _E39_5();
void _E40_3();
ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::`vector deleting destructor'(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *this, unsigned int __flags);
ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::`scalar deleting destructor'(ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *this, unsigned int __flags);
void __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::~_PAIR(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *this); // idb
void __thiscall ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::~ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this); // idb
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::~_PAIR(ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *this); // idb
void __thiscall ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped::~ZAcceptOverlapped(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *this); // idb
void __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::ResizeHashTable(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *__thiscall ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::_Alloc(ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
void __thiscall ZSocketAcceptor<CClientSocket>::_BeginAccept(ZSocketAcceptor<CClientSocket> *this, ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *pOverlapped); // idb
ZRef<CClientSocket> *__thiscall ZList<ZRef<CClientSocket>>::_New(ZList<ZRef<CClientSocket> > *this, void *pPrev, void *pNext); // idb
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::ResizeHashTable(ZMap<unsigned long,unsigned long,unsigned long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128); // idb
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::_CalcAutoGrow(ZMap<unsigned long,unsigned long,unsigned long> *this, unsigned int uAutoGrowEvery128); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this);
void **__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this);
void _E60_1();
void _E52_2();
void _E53_3();
void _E54_3();
void _E55_3();
void _E56_3();
void _E57_2();
void _E58_2();
void _E59_1();
void __cdecl ZRefCounted_Alloc();
void __cdecl ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::operator delete(void *p); // idb
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this, void *p); // idb
ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *__cdecl construct(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *p); // idb
void __thiscall ZRefCountedDummy<ZRef<CClientSocket>>::ZRefCountedDummy<ZRef<CClientSocket>>(ZRefCountedDummy<ZRef<CClientSocket> > *this); // idb
ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *__thiscall ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vector deleting destructor'(ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this, unsigned int __flags);
ZRefCountedDummy<ZRef<CClientSocket> > *__thiscall ZRefCountedDummy<ZRef<CClientSocket>>::`vector deleting destructor'(ZRefCountedDummy<ZRef<CClientSocket> > *this, unsigned int __flags);
void __thiscall ZRefCountedDummy<ZRef<CClientSocket>>::~ZRefCountedDummy<ZRef<CClientSocket>>(ZRefCountedDummy<ZRef<CClientSocket> > *this); // idb
void __thiscall ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::~ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this); // idb
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this);
void __thiscall ZSocketEx::SendPacket(ZSocketEx *this, ZSocketBuffer *pBuff); // idb
void __thiscall CLoginApp::CLoginApp(CLoginApp *this); // idb
CLoginApp *__thiscall CLoginApp::`scalar deleting destructor'(CLoginApp *this, unsigned int __flags);
void __thiscall CLoginApp::~CLoginApp(CLoginApp *this); // idb
int __thiscall CLoginApp::SetUp(CLoginApp *this); // idb
// void *__usercall _L122490@<eax>(int a1@<ebp>);
// void *__usercall _L122491@<eax>(int a1@<ebp>);
void __thiscall CLoginApp::CleanUp(CLoginApp *this); // idb
void __thiscall CLoginApp::TryConnectCenter(CLoginApp *this); // idb
void __thiscall CLoginApp::CloseCenter(CLoginApp *this, int nIdx); // idb
void CLoginApp::InitializeDB();
void CLoginApp::CreateMainDialog();
void __thiscall CLoginApp::InitializeCenter(CLoginApp *this); // idb
// void __usercall __noreturn _L123034(int a1@<ebp>);
void CLoginApp::LoadConfiguration();
void __thiscall CLoginApp::CreateAcceptor(CLoginApp *this); // idb
void __thiscall CLoginApp::CreateAdminAcceptor(CLoginApp *this); // idb
void CLoginApp::CreateTimerThread();
void __thiscall CLoginApp::LoadNewCharInfo(CLoginApp *this); // idb
int __thiscall CLoginApp::CheckCharName(CLoginApp *this, ZXString<char> *sCharName, int bWordCheck); // idb
int __thiscall CLoginApp::CheckCharEquip(CLoginApp *this, int nGender, int nType, int nItemId); // idb
IWvsUnifiedDB *__thiscall _com_ptr_t<_com_IIID<IWvsUnifiedDB,&__s_GUID _GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38>>::operator->(_com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *this); // idb
ZXString<char> *__thiscall ZXString<char>::Mid(ZXString<char> *this, ZXString<char> *result, int __$ReturnUdt, int nFrom); // idb
void __thiscall ZXString<char>::MakeLower(ZXString<char> *this); // idb
CIPChecker *__cdecl TSingleton<CIPChecker>::CreateInstance(); // idb
void TSingleton<CIPChecker>::~TSingleton<CIPChecker>();
void __thiscall ZArray<CIPChecker::IPELEM>::~ZArray<CIPChecker::IPELEM>(ZArray<CIPChecker::IPELEM> *this); // idb
void __cdecl TSingleton<CSecurityServer>::CreateInstance();
void __thiscall CSecurityServer::CSecurityServer(CSecurityServer *this); // idb
CSecurityServer *__thiscall CSecurityServer::`scalar deleting destructor'(CSecurityServer *this, unsigned int __flags);
void __thiscall CSecurityServer::~CSecurityServer(CSecurityServer *this); // idb
void __thiscall ZArray<unsigned long>::~ZArray<unsigned long>(ZArray<unsigned long> *this); // idb
void TSingleton<CSecurityServer>::~TSingleton<CSecurityServer>();
int TSingleton<CSecurityServer>::DestroyInstance();
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::GetCount(ZArray<CLoginApp::NEWEQUIP> *this);
void __cdecl TSingleton<CIPFilter>::CreateInstance();
void __cdecl TSelfTestThread<CLoginAcceptor>::Create(ZXString<char> sParam); // idb
void TSelfTestThread<CLoginAcceptor>::Destroy();
// _com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *__thiscall _com_ptr_t<_com_IIID<IWvsUnifiedDB,&__s_GUID _GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38>>::operator=(_com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *this, IWvsUnifiedDB *pInterface); idb
void __thiscall TSelfTestThread<CLoginAcceptor>::TSelfTestThread<CLoginAcceptor>(TSelfTestThread<CLoginAcceptor> *this); // idb
// int __userpurge TSelfTestThread<CLoginAcceptor>::Run@<eax>(TSelfTestThread<CLoginAcceptor> *this@<ecx>, int a2@<ebx>, void *pParam, ZThread::ZThreadResult *pResult);
unsigned int __thiscall ZThread::ZThreadResult::Failed(ZThread::ZThreadResult *this, unsigned int dwErr); // idb
// void __usercall WRITEMINIDUMPNOW(int a1@<ebx>);
int __thiscall ZExceptionHandler::InitDbgHelpFunctions(ZExceptionHandler *this); // idb
// int __userpurge ZExceptionHandler::GenerateMiniDump@<eax>(ZExceptionHandler *this@<ecx>, int a2@<ebx>, int a3@<esi>, _EXCEPTION_POINTERS *pExceptionPointers);
TSelfTestThread<CLoginAcceptor> *__thiscall TSelfTestThread<CLoginAcceptor>::`vector deleting destructor'(TSelfTestThread<CLoginAcceptor> *this, unsigned int __flags);
void __thiscall TSelfTestThread<CLoginAcceptor>::~TSelfTestThread<CLoginAcceptor>(TSelfTestThread<CLoginAcceptor> *this); // idb
void __thiscall TSelfTestThread<CLoginAcceptor>::Terminate(TSelfTestThread<CLoginAcceptor> *this); // idb
void TSingleton<TSelfTestThread<CLoginAcceptor>>::~TSingleton<TSelfTestThread<CLoginAcceptor>>();
int __thiscall ZXString<char>::Find(ZXString<char> *this, const char *s, int nStart, int bTreatAsMBChar); // idb
char *__cdecl ZStrUtil::Str(const char *string, const char *pat, int bTreatAsMBChar); // idb
void __thiscall ZArray<ZXString<char>>::RemoveAll(ZArray<ZXString<char> > *this); // idb
ZXString<char> *__thiscall ZArray<ZXString<char>>::_Alloc(ZArray<ZXString<char> > *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
void __thiscall ZArray<CIPChecker::IPELEM>::RemoveAll(ZArray<CIPChecker::IPELEM> *this); // idb
void __thiscall ZArray<CCenter>::RemoveAll(ZArray<CCenter> *this); // idb
CCenter *__thiscall ZArray<CCenter>::_Alloc(ZArray<CCenter> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
void __thiscall ZArray<CLoginApp::NEWEQUIP>::RemoveAll(ZArray<CLoginApp::NEWEQUIP> *this); // idb
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::_Alloc(ZArray<CLoginApp::NEWEQUIP> *this, unsigned int u, ZAllocHelper *_ALLOC); // idb
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::_Realloc(ZArray<CLoginApp::NEWEQUIP> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
CCenter *__thiscall ZArray<CCenter>::operator[](ZArray<CCenter> *this, int i); // idb
void __cdecl PcCreateObject(const unsigned __int16 *sUOL, _com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *pObj, IUnknown *pUnkOuter); // idb
void __thiscall _com_error::_com_error(_com_error *this, _com_error *that); // idb
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::operator[](ZArray<CLoginApp::NEWEQUIP> *this, unsigned int i); // idb
void _E62();
void _E48_1();
void _E49_3();
void _E50_2();
void _E51_2();
void _E52_3();
void _E53_4();
void _E54_4();
void _E55_4();
void _E56_4();
void _E57_3();
void _E58_3();
void _E59_2();
void _E60_2();
void _E61_1();
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::GetCapacity(ZArray<CLoginApp::NEWEQUIP> *this);
DraggingProcessInfo *__thiscall ZPort::GetDraggingProcessInfo(ZPort *this, DraggingProcessInfo *result); // idb
int __thiscall ZPort::ZPortThread::GetCurProcessingProtocol(ZPort::ZPortThread *this); // idb
void __cdecl construct(CCenter *p);
void __cdecl operator delete(void *__formal, void *__formal); // idb
void _E87();
void _E76_0();
void _E77_0();
void _E78_0();
void _E79_0();
void _E80_0();
void _E81();
void _E82();
void _E83();
void _E84();
void _E85();
void _E86();
unsigned int __thiscall IWzProperty::Getcount(IWzProperty *this); // idb
int __thiscall IWvsUnifiedDB::InitGlobalAccount(IWvsUnifiedDB *this, Ztl_bstr_t sCatalogGlobalAccount, Ztl_bstr_t sDBSourc); // idb
_com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *__cdecl get_db(); // idb
wchar_t *__cdecl _Int2StrW(int n, unsigned __int16 *s);
void __thiscall CLoginDialog::CLoginDialog(CLoginDialog *this); // idb
CLoginDialog *__thiscall CLoginDialog::`scalar deleting destructor'(CLoginDialog *this, unsigned int __flags);
void __thiscall CLoginDialog::~CLoginDialog(CLoginDialog *this); // idb
void __thiscall CLoginDialog::UpdateConnection(CLoginDialog *this); // idb
void __thiscall CLoginDialog::OnTimer(CLoginDialog *this); // idb
int __stdcall CLoginDialog::OnWndMsg(HWND__ *hWnd, unsigned int message, unsigned int wParam, int lParam);
void _E43_0();
void _E35_8();
void _E36_8();
void _E37_7();
void _E38_4();
void _E39_6();
void _E40_4();
void _E41_4();
void _E42_3();
void _E62_0();
void _E54_5();
void _E55_5();
void _E56_5();
void _E57_4();
void _E58_4();
void _E59_3();
void _E60_3();
void _E61_2();
void __thiscall CMachineIDHelper::CMachineIDHelper(CMachineIDHelper *this); // idb
CMachineIDHelper *__thiscall CMachineIDHelper::`vector deleting destructor'(CMachineIDHelper *this, unsigned int __flags);
void __thiscall CMachineIDHelper::~CMachineIDHelper(CMachineIDHelper *this); // idb
void __thiscall CMachineIDHelper::WriteLog(CMachineIDHelper *this, CMass *mass); // idb
void __thiscall CMachineIDHelper::FlushBuffer(CMachineIDHelper *this); // idb
void _E13_5();
void _E11_1();
void _E12_3();
void _E30_6();
void _E23_4();
void _E24_6();
void _E25_5();
void _E26_5();
void _E27_3();
void _E28_4();
void _E29_6();
void __cdecl MD5Init(MD5_CTX *context); // idb
void __cdecl MD5Update(MD5_CTX *context, char *input, unsigned int inputLen); // idb
// void __usercall MD5Final(int a1@<ebx>, char *digest, MD5_CTX *context);
void __cdecl MD5Transform(unsigned int *state, char *block); // idb
void __cdecl Encode(char *output, unsigned int *input, unsigned int len); // idb
void __cdecl Decode(unsigned int *output, char *input, unsigned int len); // idb
void __cdecl MD5_memcpy(char *output, char *input, unsigned int len); // idb
// void __usercall MD5_memset(int a1@<ebx>, char *output, int value, unsigned int len);
ZXString<char> *__cdecl MD5_digest_string(ZXString<char> *result, ZXString<char> __$ReturnUdt); // idb
void _E11_2();
void _E12_4();
void _E30_7();
void _E23_5();
void _E24_7();
void _E25_6();
void _E26_6();
void _E27_4();
void _E28_5();
void _E29_7();
void __thiscall CMxHelperServerManager::CMxHelperServerManager(CMxHelperServerManager *this); // idb
CMxHelperServerManager *__thiscall CMxHelperServerManager::`scalar deleting destructor'(CMxHelperServerManager *this, unsigned int __flags);
void __thiscall CMxHelperServerManager::~CMxHelperServerManager(CMxHelperServerManager *this); // idb
int __thiscall CMxHelperServerManager::Load(CMxHelperServerManager *this, const char *isToken); // idb
void __thiscall CMxHelperServerManager::Unload(CMxHelperServerManager *this); // idb
int __thiscall CMxHelperServerManager::IsLoggedIn(CMxHelperServerManager *this, int *pVal); // idb
int __thiscall CMxHelperServerManager::GetAccountId(CMxHelperServerManager *this, unsigned int *pVal); // idb
int __thiscall CMxHelperServerManager::GetWebKey(CMxHelperServerManager *this, int *pVal); // idb
int __thiscall CMxHelperServerManager::GetLoggedInIP(CMxHelperServerManager *this, unsigned int *pVal); // idb
int __thiscall CMxHelperServerManager::GetLoggedInIP(CMxHelperServerManager *this, ZXString<char> *sIP); // idb
int __thiscall CMxHelperServerManager::GetEmail(CMxHelperServerManager *this, ZXString<char> *sEmail); // idb
void _E24_8();
void _E17_0();
void _E18_2();
void _E19_2();
void _E20_1();
void _E21_1();
void _E22_2();
void _E23_6();
void _E47_1();
void _E37_8();
void _E38_5();
void _E39_7();
void _E40_5();
void _E41_5();
void _E42_4();
void _E43_1();
void _E44_1();
void _E45_1();
void _E46_1();
unsigned __int16 *__cdecl NXParam::AnsiToUnicode(const char *isAnsi); // idb
char *__cdecl NXParam::UnicodeToAnsi(const unsigned __int16 *isUnicode); // idb
void __cdecl NXParam::DoneWithUnicode(const unsigned __int16 *isUnicode); // idb
void __cdecl NXParam::DoneWithAnsi(const char *isAnsi); // idb
void __thiscall NXParam::NXParam(NXParam *this); // idb
void __thiscall NXParam::~NXParam(NXParam *this); // idb
void __thiscall NXParam::Clear(NXParam *this); // idb
char __thiscall NXParam::SetTokenA(NXParam *this, const char *isToken); // idb
char __thiscall NXParam::SetTokenW(NXParam *this, const unsigned __int16 *isToken); // idb
signed int __thiscall NXParam::GetParamValueA(NXParam *this, const char *isName, void *osValue, unsigned int inLength);
signed int __thiscall NXParam::GetParamValueW(NXParam *this, const unsigned __int16 *isName, void *osValue, unsigned int inLength);
char __thiscall NXParam::Decrypt(NXParam *this, const char *isToken); // idb
int __thiscall NXParam::GetParamPtr(NXParam *this, const char *isName); // idb
int __cdecl NXParam::GetHashValue(void *ipBuffer, int inSize);
void _E13_7();
void _E11_3();
void _E12_5();
void _E30_8();
void _E23_7();
void _E24_9();
void _E25_7();
void _E26_7();
void _E27_5();
void _E28_6();
void _E29_8();
void __thiscall CInPacket::CInPacket(CInPacket *this, CInPacket *iPacket); // idb
int __thiscall CInPacket::AppendBuffer(CInPacket *this, ZRef<ZSocketBuffer> *pBuff, int *pnLastState, int bEnc); // idb
void __thiscall CInPacket::RawAppendBuffer(CInPacket *this, const void *p, unsigned int uSize); // idb
// int __userpurge CInPacket::DecryptData@<eax>(CInPacket *this@<ecx>, int a2@<ebp>, unsigned int dwKey);
ZXString<char> *__thiscall CInPacket::DumpString(CInPacket *this, ZXString<char> *result); // idb
void __thiscall COutPacket::COutPacket(COutPacket *this, int nType, int bLoopback); // idb
void __thiscall COutPacket::Init(COutPacket *this, int nType, int bLoopback); // idb
void __thiscall COutPacket::InitByte(COutPacket *this, int nType, int bLoopback); // idb
// void __userpurge COutPacket::MakeBufferList(COutPacket *this@<ecx>, int a2@<ebp>, ZList<ZRef<ZSocketBuffer> > *l, unsigned __int16 uSeqBase, unsigned int *puSeqKey, int bEnc, unsigned int dwKey);
ZXString<char> *__thiscall COutPacket::DumpString(COutPacket *this, ZXString<char> *result); // idb
void __thiscall ZArray<unsigned char>::~ZArray<unsigned char>(ZArray<unsigned char> *this); // idb
void _E17_1();
void _E18_3();
void _E36_9();
void _E29_9();
void _E30_9();
void _E31_7();
void _E32_5();
void _E33_5();
void _E34_7();
void _E35_9();
void _E11_4();
void _E12_6();
void _E30_10();
void _E23_8();
void _E24_10();
void _E25_8();
void _E26_8();
void _E27_6();
void _E28_7();
void _E29_10();
int _E11_5();
void __cdecl _E10(); // idb
void __thiscall CRand32::~CRand32(CRand32 *this); // idb
void _E18_4();
void _E16_0();
void _E17_2();
void _E35_10();
void _E28_8();
void _E29_11();
void _E30_11();
void _E31_8();
void _E32_6();
void _E33_6();
void _E34_8();
void __thiscall CRand32::CRand32(CRand32 *this); // idb
void __thiscall CRand32::Seed(CRand32 *this, unsigned int s1, unsigned int s2, unsigned int s3); // idb
void _E13_9();
void _E11_6();
void _E12_8();
void _E30_12();
void _E23_9();
void _E24_11();
void _E25_9();
void _E26_9();
void _E27_7();
void _E28_9();
void _E29_12();
void __thiscall CServerApp::CServerApp(CServerApp *this); // idb
CServerApp *__thiscall CServerApp::`vector deleting destructor'(CServerApp *this, unsigned int __flags);
void __thiscall CServerApp::~CServerApp(CServerApp *this); // idb
int __thiscall CServerApp::SetUp(CServerApp *this); // idb
void CServerApp::Run();
void __thiscall CServerApp::CleanUp(CServerApp *this); // idb
void __thiscall CServerApp::InitializePCOM(CServerApp *this); // idb
void CServerApp::InitializeResMan();
IWzNameSpace *__thiscall _com_ptr_t<_com_IIID<IWzNameSpace,&__s_GUID _GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d>>::operator->(_com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *this); // idb
_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *__thiscall _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator=(_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *this, int null); // idb
char *__thiscall ZXString<char>::operator char const *(ZXString<char> *this);
void __thiscall _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::~_com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>(_com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *this); // idb
IWzFileSystem *__thiscall _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::operator IWzFileSystem *(_com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *this); // idb
IWzFileSystem *__thiscall _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::operator->(_com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *this); // idb
// _com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *__thiscall _com_ptr_t<_com_IIID<IWzNameSpace,&__s_GUID _GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d>>::operator=(_com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *this, IWzNameSpace *pInterface); idb
// _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *__thiscall _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator=(_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *this, IWzResMan *pInterface); idb
void __cdecl PcCreateObject(const unsigned __int16 *sUOL, _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *pObj, IUnknown *pUnkOuter); // idb
void __cdecl PcCreateObject(const unsigned __int16 *sUOL, _com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *pObj, IUnknown *pUnkOuter); // idb
void __cdecl PcCreateObject(const unsigned __int16 *sUOL, _com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *pObj, IUnknown *pUnkOuter); // idb
void _E14_4();
void _E12_9();
void _E13_10();
// _com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *__thiscall _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::operator=(_com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *this, IWzFileSystem *pInterface); idb
void _E31_9();
void _E24_12();
void _E25_10();
void _E26_10();
void _E27_8();
void _E28_10();
void _E29_13();
void _E30_13();
int __cdecl ZtlSetErrorDescription(const unsigned __int16 *sDesc, _GUID *pIID); // idb
void __thiscall Ztl_bstr_t::Ztl_bstr_t(Ztl_bstr_t *this, const char *s); // idb
void __thiscall _bstr_t::_bstr_t(_bstr_t *this, const char *s); // idb
void __thiscall _bstr_t::Data_t::Data_t(_bstr_t::Data_t *this, const char *s); // idb
unsigned __int16 *__stdcall _com_util::ZtlConvertStringToBSTR(const char *pSrc); // idb
int __thiscall IWzNameSpace::Mount(IWzNameSpace *this, Ztl_bstr_t sPath, IWzNameSpace *pDown, int nPriority); // idb
int __thiscall IWzFileSystem::Init(IWzFileSystem *this, Ztl_bstr_t sPath); // idb
_com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *__cdecl get_root(); // idb
int _E17_3();
void _E13_11();
int _E16_1();
void __cdecl _E14_5(); // idb
void __thiscall CServerDialog::CServerDialog(CServerDialog *this); // idb
int __stdcall CServerDialog::OnWndMsg(HWND__ *hWnd, unsigned int message, unsigned int wParam, int lParam);
int _E23_10();
void _E19_4();
int _E22_3();
// void __cdecl _E20_2(); idb
CServerDialog *__thiscall CServerDialog::`scalar deleting destructor'(CServerDialog *this, unsigned int __flags);
void __thiscall CServerDialog::~CServerDialog(CServerDialog *this); // idb
void __thiscall CServerDialog::Create(CServerDialog *this, int nIdDlg, int nIdLog, int nIdConnection); // idb
void __thiscall CServerDialog::OnInitDialog(CServerDialog *this, HWND__ *hWnd); // idb
void __thiscall CServerDialog::Destroy(CServerDialog *this); // idb
void __thiscall CServerDialog::OnTimer(CServerDialog *this); // idb
void __cdecl CServerDialog::Log(const char *sLog); // idb
int __stdcall CServerDialog::DlgProc(HWND__ *hWnd, unsigned int message, unsigned int wParam, int lParam); // idb
int __stdcall CServerDialog::LogEditProc(HWND__ *hWnd, unsigned int message, unsigned int wParam, int lParam); // idb
void TSingleton<CServerDialog>::~TSingleton<CServerDialog>();
void _E29_14();
void _E27_9();
void _E28_11();
void _E46_2();
void _E39_8();
void _E40_6();
void _E41_6();
void _E42_5();
void _E43_2();
void _E44_2();
void _E45_2();
int __cdecl PcInitialize(const unsigned __int16 *sPCOMModule); // idb
int __cdecl LoadProc(HINSTANCE__ *hLib); // idb
void __cdecl PcUninitialize(); // idb
int _E12_10();
void _E9_0();
void __thiscall `anonymous namespace'::ZAPILoader::ZAPILoader(ZAPILoader *this); // idb
void __thiscall `anonymous namespace'::ZAPILoader::LoadLibraries(ZAPILoader *this); // idb
void __thiscall `anonymous namespace'::ZAPILoader::LoadAPI(ZAPILoader *this); // idb
int _E11_7();
void __cdecl _E10_0(); // idb
void __stdcall `anonymous namespace'::ZAPILoader::MakeRawKey(unsigned __int64 key, ZAPILoader::RAWKEY *rawkey);
unsigned int __thiscall `anonymous namespace'::ZAPILoader::DecodePackage(ZAPILoader *this, const void *raw_pSrc, unsigned int *pibot, void *raw_pDst); // idb
void __thiscall `anonymous namespace'::ZAPILoader::_Decode(ZAPILoader *this, char *pDst, const char *pSrc, unsigned int uLen); // idb
int __stdcall `anonymous namespace'::ZAPILoader::Decode(unsigned __int64 b, ZAPILoader::RAWKEY *rawkey);
int __cdecl _ZAPIInfo::GetModuleHandleCount(); // idb
HINSTANCE__ **__cdecl _ZAPIInfo::GetModuleHandles(); // idb
int __cdecl _ZAPIInfo::GetAPIFunctionCount(); // idb
int (__stdcall **__cdecl _ZAPIInfo::GetAPIFunctions())(); // idb
int _E18_5();
void _E14_6();
int _E17_4();
// void __cdecl _E15_1(); idb
int _E24_13();
void _E21_2();
int _E23_11();
// void __cdecl _E22_4(); idb
int _E31_10();
void _E28_12();
int _E30_14();
// void __cdecl _E29_15(); idb
int _E36_10();
void _E33_7();
int _E35_11();
// void __cdecl _E34_9(); idb
int _E41_7();
void _E38_6();
int _E40_7();
void __cdecl _E39_9(); // idb
int _E46_3();
void _E43_3();
int _E45_3();
void __cdecl _E44_3(); // idb
int _E51_3();
void _E48_2();
int _E50_3();
void __cdecl _E49_4(); // idb
void __thiscall ZAllocEx<ZAllocAnonSelector>::ZAllocEx<ZAllocAnonSelector>(ZAllocEx<ZAllocAnonSelector> *this); // idb
void __thiscall ZRecyclableStatic::~ZRecyclableStatic(ZRecyclableStatic *this); // idb
void __thiscall ZAllocEx<ZAllocStrSelector<char>>::ZAllocEx<ZAllocStrSelector<char>>(ZAllocEx<ZAllocStrSelector<char> > *this); // idb
void __thiscall ZAllocEx<ZAllocStrSelector<unsigned short>>::ZAllocEx<ZAllocStrSelector<unsigned short>>(ZAllocEx<ZAllocStrSelector<unsigned short> > *this); // idb
// int __usercall ZFatalSection::_TryI@<eax>(void *p@<eax>, int a2@<ecx>);
// void *__usercall ZFatalSection::_TryS@<eax>(void *__formal@<eax>, int _ECX@<ecx>);
// void *__usercall ZFatalSection::_TryM@<eax>(void *__formal@<eax>, int a2@<ecx>);
void __thiscall ZAllocEx<ZAllocAnonSelector>::~ZAllocEx<ZAllocAnonSelector>(ZAllocEx<ZAllocAnonSelector> *this); // idb
void __cdecl ZAllocBase::_FreeRawBlocks(void *p);
void __thiscall ZExceptionHandler::ZExceptionHandler(ZExceptionHandler *this); // idb
ZFatalSection *__cdecl construct(ZFatalSection *p); // idb
void __thiscall ZExceptionHandler::~ZExceptionHandler(ZExceptionHandler *this); // idb
int __stdcall ZExceptionHandler::RawUnhandledExceptionFilter(_EXCEPTION_POINTERS *pExceptionInfo); // idb
int __thiscall ZExceptionHandler::UnhandledExceptionFilter(ZExceptionHandler *this, _EXCEPTION_POINTERS *pExceptionInfo); // idb
void __thiscall ZFatalSection::Lock(ZFatalSection *this); // idb
void __thiscall ZExceptionHandler::GenerateExceptionReport(ZExceptionHandler *this, _EXCEPTION_POINTERS *pExceptionInfo); // idb
char *__cdecl ZExceptionHandler::GetExceptionString(unsigned int dwCode); // idb
int __cdecl ZExceptionHandler::GetLogicalAddress(void *pAddr, char *sModule, unsigned int len, unsigned int *dwSection, unsigned int *dwOffset); // idb
void __thiscall ZExceptionHandler::IntelStackWalk(ZExceptionHandler *this, _CONTEXT *pContext); // idb
void __thiscall ZExceptionHandler::DbgHelpStackWalk(ZExceptionHandler *this, _CONTEXT *pContext); // idb
void __thiscall ZAllocEx<ZAllocStrSelector<char>>::~ZAllocEx<ZAllocStrSelector<char>>(ZAllocEx<ZAllocStrSelector<char> > *this); // idb
void __thiscall ZAllocEx<ZAllocStrSelector<unsigned short>>::~ZAllocEx<ZAllocStrSelector<unsigned short>>(ZAllocEx<ZAllocStrSelector<unsigned short> > *this); // idb
int ZExceptionHandler::Report(ZExceptionHandler *this, const char *sFormat, ...); // idb
void _E57_5();
void _E55_6();
void _E56_6();
void _E73_0();
void _E66();
void _E67_0();
void _E68_0();
void _E69_0();
void _E70_0();
void _E71_0();
void _E72_0();
void __thiscall Ztl_variant_t::Ztl_variant_t(Ztl_variant_t *this); // idb
void __thiscall ZSocketBase::_ZSocketInit::_ZSocketInit(ZSocketBase::_ZSocketInit *this); // idb
void __thiscall ZSocketBase::_ZSocketInit::~_ZSocketInit(ZSocketBase::_ZSocketInit *this); // idb
void __thiscall CTimerThread::CTimerThread(CTimerThread *this); // idb
CTimerThread *__thiscall CTimerThread::`vector deleting destructor'(CTimerThread *this, unsigned int __flags);
void __thiscall CTimerThread::~CTimerThread(CTimerThread *this); // idb
int __thiscall CTimerThread::Run(CTimerThread *this, void *pParam, ZThread::ZThreadResult *pResult); // idb
void __thiscall CTimerThread::Terminate(CTimerThread *this); // idb
void _E38_7();
void _E31_11();
void _E32_7();
void _E33_8();
void _E34_10();
void _E35_12();
void _E36_11();
void _E37_9();
void _E57_6();
void _E49_5();
void _E50_4();
void _E51_4();
void _E52_4();
void _E53_5();
void _E54_6();
void _E55_7();
void _E56_7();
void __thiscall SingleInstance::SingleInstance(SingleInstance *this); // idb
int _E11_8();
void __cdecl _E10_1(); // idb
void _E14_7();
void __cdecl FinalExceptionHandlerRegister::FinalExceptionHandler(int bReportGenerated);
int _E20_3();
void _E17_5();
int _E19_5();
void __cdecl _E18_6(); // idb
int _E25_11();
void _E22_5();
int _E24_14();
void __cdecl _E23_12(); // idb
int _E30_15();
void _E27_10();
int _E29_16();
void __cdecl _E28_13(); // idb
int _E35_13();
void _E32_8();
int _E34_11();
void __cdecl _E33_9(); // idb
ZXString<char> *__cdecl get_cmdline_arg(ZXString<char> *result, int __$ReturnUdt); // idb
void __stdcall TimerProcMsgBox(HWND__ *hwnd, unsigned int uMsg, unsigned int idEvent, unsigned int dwTime); // idb
void __cdecl msgbox_timer(const char *sText, unsigned int uType, int tExpire); // idb
ZXString<char> *__cdecl format_com_error(ZXString<char> *result, _com_error *__$ReturnUdt); // idb
void __cdecl msgbox_com_error(_com_error *e); // idb
void __cdecl msgbox_ZException(ZException *e); // idb
Ztl_bstr_t *__cdecl DetachBSTR(Ztl_bstr_t *result, tagVARIANT *__$ReturnUdt); // idb
bool __cdecl CheckAdult(int nSSN1, int nSSN2, int nCriticalYear);
ZXString<char> *__cdecl get_labeled_string(ZXString<char> *result, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > __$ReturnUdt, int pProp, const unsigned __int16 *nID); // idb
ZXString<char> *__cdecl get_labeled_string(ZXString<char> *result, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > __$ReturnUdt, ZXString<char> pProp, const unsigned __int16 *sID); // idb
void __thiscall _com_ptr_t<_com_IIID<IErrorInfo,&__s_GUID _GUID_1cf2b120_547d_101b_8e65_08002b2bd119>>::~_com_ptr_t<_com_IIID<IErrorInfo,&__s_GUID _GUID_1cf2b120_547d_101b_8e65_08002b2bd119>>(_com_ptr_t<_com_IIID<IErrorInfo,&_GUID_1cf2b120_547d_101b_8e65_08002b2bd119> > *this); // idb
unsigned __int16 *__cdecl ZStrUtil::_Conv(const char *m, unsigned __int16 *w, int nChars); // idb
void _E41_8();
void _E39_10();
void _E40_8();
void _E58_5();
void _E51_5();
void _E52_5();
void _E53_6();
void _E54_7();
void _E55_8();
void _E56_8();
void _E57_7();
void __thiscall _bstr_t::_bstr_t(_bstr_t *this, unsigned __int16 *bstr, char fCopy); // idb
void __thiscall _bstr_t::~_bstr_t(_bstr_t *this); // idb
void __thiscall _bstr_t::Data_t::Data_t(_bstr_t::Data_t *this, unsigned __int16 *bstr, char fCopy); // idb
unsigned __int16 *__cdecl ZComAPI::ZComSysAllocStringByteLen(const char *s, unsigned int bn); // idb
IErrorInfo *__thiscall _com_error::ErrorInfo(_com_error *this); // idb
_bstr_t *__thiscall _com_error::Description(_com_error *this, _bstr_t *result); // idb
const char *__thiscall _com_error::ErrorMessage(_com_error *this); // idb
void CVerboseObj::LogReport(CVerboseObj *this, const char *sFormat, ...); // idb
void CVerboseObj::LogError(CVerboseObj *this, const char *sFormat, ...); // idb
void __thiscall CVerboseObj::LogException(CVerboseObj *this, ZException *e); // idb
void __thiscall CVerboseObj::LogException(CVerboseObj *this, _com_error *e); // idb
void _E11_9();
void _E12_12();
void _E30_16();
void _E23_13();
void _E24_15();
void _E25_12();
void _E26_11();
void _E27_11();
void _E28_14();
void _E29_17();
int __stdcall WinMain(HINSTANCE__ *hInstance, HINSTANCE__ *hPrevInstance, char *lpCmdLine, int nCmdShow); // idb
void _E16_2();
void _E13_13();
void _E14_8();
void _E15_3();
void _E33_10();
void _E26_12();
void _E27_12();
void _E28_15();
void _E29_18();
void _E30_17();
void _E31_12();
void _E32_9();
unsigned int __cdecl CIGCipher::innoHash(char *pSrc, int nLen, unsigned int *pdwKey); // idb
void __cdecl CIGCipher::MorphKey(unsigned int *pdwKey, char bData); // idb
void __cdecl CIGCipher::innoEncrypt(char *pDest, char *pSrc, int nLen, unsigned int *pdwKey); // idb
void __cdecl CIGCipher::innoDecrypt(char *pDest, char *pSrc, int nLen, unsigned int *pdwKey); // idb
void __cdecl CIGCipher::innoEncryptStr(char *pDest, const char *pSrc);
char *__cdecl CIGCipher::innoDecryptStr(char *pDest, char *pSrc);
void _E14_9();
void _E12_13();
void _E13_14();
void _E31_13();
void _E24_16();
void _E25_13();
void _E26_13();
void _E27_13();
void _E28_16();
void _E29_19();
void _E30_18();
int __thiscall CSecurityServer::Init(CSecurityServer *this); // idb
void __thiscall CSecurityServer::InitMemoryCheck(CSecurityServer *this); // idb
void __thiscall CSecurityServer::Destroy(CSecurityServer *this); // idb
int __thiscall CSecurityServer::IsCorrectMemoryHash(CSecurityServer *this, unsigned __int16 usSeq, unsigned int dwHash); // idb
void __thiscall CSecurityServer::CheckUpdateGameGuardAuth(CSecurityServer *this); // idb
unsigned int *__thiscall ZArray<unsigned long>::InsertBefore(ZArray<unsigned long> *this, int nIndex); // idb
void _E15_4();
void _E13_15();
void _E14_10();
unsigned int *__thiscall ZArray<unsigned long>::_Realloc(ZArray<unsigned long> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC); // idb
void _E33_11();
void _E26_14();
void _E27_14();
void _E28_17();
void _E29_20();
void _E30_19();
void _E31_14();
void _E32_10();
unsigned int *__thiscall ZArray<unsigned long>::GetCapacity(ZArray<unsigned long> *this);
int __thiscall CSecuritySession::PreProcessPacket(CSecuritySession *this, int nType, CInPacket *iPacket, unsigned __int16 usSeq); // idb
void __thiscall CSecuritySession::SendMemoryRegion(CSecuritySession *this); // idb
void __thiscall CSecuritySession::Init(CSecuritySession *this); // idb
void __thiscall CSecuritySession::Update(CSecuritySession *this, int tCur); // idb
void __thiscall CSecuritySession::OnMemoryHash(CSecuritySession *this, unsigned __int16 usSeq, CInPacket *iPacket); // idb
void __thiscall CSecuritySession::OnGameGuardAuth(CSecuritySession *this, CInPacket *iPacket); // idb
void __thiscall CSecuritySession::SendGGAuthReqPacket(CSecuritySession *this, int bForCheckGameGuardUpdate); // idb
void __cdecl NpLog(int mode, char *msg); // idb
void __cdecl GGAuthUpdateCallback(_GG_UPREPORT *report); // idb
void _E14_11();
void _E12_14();
void _E13_16();
void _E31_15();
void _E24_17();
void _E25_14();
void _E26_15();
void _E27_15();
void _E28_18();
void _E29_21();
void _E30_20();
signed int __cdecl InitGameguardAuth(const char *a1, int a2, int a3, int a4);
void CleanupGameguardAuth();
int GGAuthUpdateTimer();
int __cdecl AddAuthProtocol(char *); // idb
signed int __cdecl SetGGVerLimit(unsigned int a1);
signed int __cdecl SetUpdateCondition(int a1, signed int a2);
signed int __cdecl LoadAuthProtocol(char *a1, int a2);
signed int __cdecl UnloadAuthProtocol(struct _GG_AUTH_PROTOCOL *Memory);
signed int __cdecl UpdateGGVersion(time_t Time2);
signed int __cdecl UpdateProtocol(struct _GG_AUTH_PROTOCOL *a1);
CCSAuth2 *__thiscall CCSAuth2::CCSAuth2(CCSAuth2 *this);
_DWORD __thiscall CCSAuth2::~CCSAuth2(CCSAuth2 *__hidden this); // idb
void __thiscall CCSAuth2::Init(CCSAuth2 *__hidden this); // idb
void __thiscall CCSAuth2::Close(CCSAuth2 *__hidden this); // idb
signed int __thiscall CCSAuth2::GetAuthQuery(CCSAuth2 *this);
signed int __thiscall CCSAuth2::CheckAuthAnswer(CCSAuth2 *this);
unsigned __int32 __thiscall CCSAuth2::GetCSAuthState(CCSAuth2 *this, struct _GG_CSAUTH_STATE *); // idb
unsigned __int32 __thiscall CCSAuth2::SetCSAuthState(CCSAuth2 *this, struct _GG_CSAUTH_STATE *); // idb
int __thiscall CCSAuth2::Info(CCSAuth2 *this, char *Dest, int); // idb
int __thiscall CCSAuth2::CheckUpdated(CCSAuth2 *__hidden this); // idb
signed int __cdecl ModuleInfo(void *a1, signed int a2);
CCSAuth2 *GGAuthCreateUser();
int __cdecl GGAuthDeleteUser(void *p); // idb
int __cdecl GGAuthInitUser(CCSAuth2 *); // idb
int __cdecl GGAuthCloseUser(CCSAuth2 *); // idb
int __cdecl GGAuthGetQuery(CCSAuth2 *, int); // idb
signed int __cdecl GGAuthCheckAnswer(CCSAuth2 *a1, int a2);
signed int __cdecl GGAuthCheckUpdated(CCSAuth2 *a1);
int __cdecl GGAuthUserInfo(CCSAuth2 *, char *Dest, int); // idb
signed int __cdecl GGAuthGetUserValue(int a1, int a2);
unsigned __int32 __cdecl GGAuthGetState(CCSAuth2 *a1, struct _GG_CSAUTH_STATE *a2);
unsigned __int32 __cdecl GGAuthSetState(CCSAuth2 *a1, struct _GG_CSAUTH_STATE *a2);
void __cdecl GGEncryptPacket(struct _GG_AUTH_DATA *); // idb
void __cdecl GGDecryptPacket(struct _GG_AUTH_DATA *); // idb
void __cdecl Blowfish_Encrypt(struct BLOWFISH_CTX *, unsigned __int32 *, unsigned __int32 *); // idb
int __cdecl sub_42D490(int a1, unsigned int a2);
void __cdecl Blowfish_Decrypt(struct BLOWFISH_CTX *, unsigned __int32 *, unsigned __int32 *); // idb
void __cdecl Blowfish_Init(struct BLOWFISH_CTX *, unsigned __int8 *, unsigned __int32); // idb
void __stdcall __noreturn _com_issue_error(int hr);
void __stdcall __noreturn _com_issue_errorex(int hr, IUnknown *punk, _GUID *riid);
int _com_dispatch_raw_method(IDispatch *pDispatch, int dwDispID, int wFlags, unsigned __int16 vtRet, void *pvRet, const unsigned __int16 *pwParamInfo, ...);
int __cdecl com_invoke_helper(IDispatch *pDispatch, int dwDispID, int wFlags, unsigned __int16 vtRet, void *pvRet, const unsigned __int16 *pwParamInfo, char *argList, IErrorInfo **pperrinfo);
int _com_dispatch_method(IDispatch *pDispatch, int dwDispID, int wFlags, unsigned __int16 vtRet, void *pvRet, const unsigned __int16 *pwParamInfo, ...);
int __stdcall _com_dispatch_raw_propget(IDispatch *pDispatch, int dwDispID, unsigned __int16 vtProp, void *pvProp); // idb
int __stdcall _com_dispatch_propget(IDispatch *pDispatch, int dwDispID, unsigned __int16 vtProp, void *pvProp); // idb
int _com_dispatch_raw_propput(IDispatch *pDispatch, int dwDispID, unsigned __int16 vtProp, ...); // idb
int _com_dispatch_propput(IDispatch *pDispatch, int dwDispID, unsigned __int16 vtProp, ...); // idb
int _E4();
void _E1();
int _E3();
void __cdecl _E2(); // idb
unsigned __int16 *__stdcall _com_util::ConvertStringToBSTR(const char *pSrc); // idb
char *__stdcall _com_util::ConvertBSTRToString(unsigned __int16 *pSrc); // idb
void __thiscall _variant_t::_variant_t(_variant_t *this, int lSrc, unsigned __int16 vtSrc); // idb
void __stdcall __noreturn _com_raise_error(int hr, IErrorInfo *perrinfo);
// void __stdcall GetAcceptExSockaddrs(PVOID lpOutputBuffer, DWORD dwReceiveDataLength, DWORD dwLocalAddressLength, DWORD dwRemoteAddressLength, struct sockaddr **LocalSockaddr, LPINT LocalSockaddrLength, struct sockaddr **RemoteSockaddr, LPINT RemoteSockaddrLength);
// BOOL __stdcall AcceptEx(SOCKET sListenSocket, SOCKET sAcceptSocket, PVOID lpOutputBuffer, DWORD dwReceiveDataLength, DWORD dwLocalAddressLength, DWORD dwRemoteAddressLength, LPDWORD lpdwBytesReceived, LPOVERLAPPED lpOverlapped);
// int __cdecl atexit(void (__cdecl *)());
char *__thiscall type_info::raw_name(type_info *this);
void *__thiscall type_info::operator=(void *this, int a2);
// _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD); weak
// int __cdecl _vsnprintf(char *Dest, size_t Count, const char *Format, va_list Args);
// void *__cdecl memcpy(void *Dst, const void *Src, size_t Size);
// size_t __cdecl strlen(const char *Str);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// int __cdecl _beginthreadex(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, int, int, DWORD dwCreationFlags, LPDWORD lpThreadId); idb
void __stdcall __noreturn StartAddress(void *Memory);
// int __cdecl _endthreadex(DWORD dwExitCode); idb
// unsigned __int32 __cdecl _lrotr(unsigned __int32 Val, int Shift);
// unsigned __int32 __cdecl _lrotl(unsigned __int32 Val, int Shift);
void __cdecl free(void *Memory);
// void *__cdecl malloc(size_t Size);
LPVOID __cdecl _heap_alloc(unsigned int a1);
// int __cdecl _wtoi(const wchar_t *Str);
// size_t __cdecl wcslen(const wchar_t *Str);
// int sprintf(char *Dest, const char *Format, ...);
// void *__cdecl memmove(void *Dst, const void *Src, size_t Size);
// char *__cdecl _strupr(char *String);
// char *__cdecl strchr(const char *Str, int Val);
// int __cdecl strcmp(const char *Str1, const char *Str2);
// int __cdecl memcmp(const void *Buf1, const void *Buf2, size_t Size);
// int __stdcall `eh vector destructor iterator'(void *, unsigned int, int, void (__thiscall *)(void *)); idb
// int __stdcall `eh vector constructor iterator'(void *, unsigned int, int, int, void (__thiscall *)(void *)); idb
// int __cdecl atoi(const char *Str);
// int __cdecl _vsnwprintf(wchar_t *Dest, size_t Count, const wchar_t *Format, va_list Args);
// void __cdecl srand(unsigned int Seed);
// int __cdecl rand();
// wchar_t *__cdecl wcsstr(const wchar_t *Str, const wchar_t *SubStr);
// char *__cdecl _strlwr(char *String);
// char *__cdecl strstr(const char *Str, const char *SubStr);
// wchar_t *__cdecl _itow(int Value, wchar_t *Dest, int Radix);
// char *__cdecl _itoa(int Value, char *Dest, int Radix);
// char *__cdecl strncpy(char *Dest, const char *Source, size_t Count);
// wchar_t *__cdecl wcsncpy(wchar_t *Dest, const wchar_t *Source, size_t Count);
// int __cdecl _amsg_exit(unsigned int NumberOfBytesWritten); idb
// int __cdecl fclose(FILE *File);
// int fscanf(FILE *File, const char *Format, ...);
// int __cdecl fseek(FILE *File, __int32 Offset, int Origin);
// FILE *__cdecl fopen(const char *Filename, const char *Mode);
// struct tm *__cdecl static localtime(const time_t *Time);
// time_t __cdecl static time(time_t *Time);
// int fprintf(FILE *File, const char *Format, ...);
// double __cdecl static difftime(time_t Time1, time_t Time2);
void *__cdecl realloc(void *Memory, size_t NewSize);
size_t __cdecl _msize(void *Memory);
// _DWORD __cdecl _lock(_DWORD); weak
// _DWORD __cdecl _unlock(_DWORD); weak
// int _getptd(void); weak
// int __cdecl _freeptd(void *Memory); idb
// int __stdcall __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *); idb
void __cdecl __CxxSetUnhandledExceptionFilter(); // idb
void __cdecl __CxxRestoreUnhandledExceptionFilter(); // idb
int __cdecl _output(FILE *File, int, int); // idb
// int __cdecl write_char(int, FILE *File, int); idb
// int __cdecl write_multi_char(int, int, FILE *File, int); idb
// int __cdecl write_string(int, int, FILE *File, int); idb
// _DWORD __cdecl get_int_arg(_DWORD); weak
// _DWORD __cdecl get_int64_arg(_DWORD); weak
// _DWORD __cdecl get_short_arg(_DWORD); weak
int *__cdecl _dosmaperr(unsigned __int32 a1);
// int *__cdecl _errno();
// unsigned __int32 *__cdecl __doserrno();
void *__cdecl calloc(size_t NumOfElements, size_t SizeOfElements);
char __cdecl _GetLinkerVersion(int a1);
__int32 __heap_select();
signed int __cdecl _heap_init(int a1);
BOOL _heap_term();
size_t __cdecl _get_sbh_threshold();
int __cdecl _set_sbh_threshold(size_t NewValue);
// _DWORD __cdecl __sbh_heap_init(_DWORD); weak
// _DWORD __cdecl __sbh_find_block(_DWORD); weak
char *__cdecl __sbh_free_block(unsigned int a1, int a2);
// _DWORD __cdecl __sbh_alloc_block(_DWORD); weak
// _DWORD __cdecl __sbh_resize_block(_DWORD, _DWORD, _DWORD); weak
int _get_old_sbh_threshold();
signed int __cdecl _set_old_sbh_threshold(int a1);
void **__old_sbh_new_region();
int __cdecl __old_sbh_release_region(LPVOID lpMem); // idb
void __cdecl __old_sbh_decommit_pages(int a1);
unsigned int __cdecl __old_sbh_find_block(unsigned int a1, void ***a2, unsigned int *a3);
void __cdecl __old_sbh_free_block(int a1, int a2, _BYTE *a3);
int __cdecl __old_sbh_alloc_block(unsigned int a1);
int __cdecl __old_sbh_alloc_block_from_page(int a1, unsigned int a2, unsigned int a3);
signed int __cdecl __old_sbh_resize_block(int a1, int a2, _BYTE *a3, unsigned int a4);
signed int __old_sbh_heap_check();
int (__cdecl *__cdecl _query_new_handler())(unsigned int); // idb
// _DWORD __cdecl _callnewh(_DWORD); weak
// char *__cdecl strcpy(char *Dest, const char *Source);
// char *__cdecl strcat(char *Dest, const char *Source);
int __init_dummy();
int __cdecl _woutput(char MbCh, int, int); // idb
// int __cdecl write_char_0(wchar_t WCh, char MbCh, int); idb
// int __cdecl write_multi_char_0(wchar_t WCh, int, char MbCh, int); idb
// int __cdecl write_string_0(int, int, char MbCh, int); idb
// _DWORD __cdecl get_int_arg_0(_DWORD); weak
// _DWORD __cdecl get_int64_arg_0(_DWORD); weak
int *__cdecl _NMSG_WRITE(unsigned int NumberOfBytesWritten);
int __cdecl _GET_RTERRMSG(int a1);
int __cdecl _ValidateRead(const void *lp, UINT_PTR ucb); // idb
int __cdecl _ValidateWrite(void *lp, UINT_PTR ucb); // idb
// int __cdecl wctomb(char *MbCh, wchar_t WCh);
// __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix);
// int __cdecl strncmp(const char *Str1, const char *Str2, size_t MaxCount);
// _DWORD __cdecl _ld12cvt(_DWORD, _DWORD, _DWORD); weak
int __cdecl _ld12tod(int a1, int a2);
int __cdecl _ld12tof(int a1, int a2);
signed int __init_ctype();
int __init_collate();
signed int __cdecl sub_439DFA(__int16 a1);
// int __cdecl __crtGetStringTypeA(DWORD dwInfoType, LPCSTR lpSrcStr, int cchSrc, LPWORD lpCharType, UINT CodePage, LCID Locale, int); idb
// int __cdecl mbtowc(wchar_t *DstCh, const char *SrcCh, size_t SrcSizeInBytes);
int __cdecl _ismbbkalnum(unsigned int);
signed int __cdecl sub_43A470(unsigned __int8 a1, int a2, unsigned __int8 a3);
// _DWORD __cdecl __crtMessageBoxA(_DWORD, _DWORD, _DWORD); weak
int __fpecode();
size_t __cdecl _Strftime(char *, size_t, const char *, const struct tm *, void *);
// _DWORD __cdecl _expandtime(char, _DWORD, _DWORD, _DWORD, _DWORD); weak
void __cdecl sub_43CC97(char *Str1, int a2, int a3, int a4, int a5);
// int __cdecl __getlocaleinfo(int, LCID Locale, LCTYPE LCType, int); idb
// int __cdecl __crtGetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int cchSrc, LPWORD lpCharType, UINT CodePage, LCID Locale); idb
// int __cdecl _strcmpi(const char *Str1, const char *Str2);
// void __usercall _L111766(int a1@<ebp>);
// void __usercall _L111840(int a1@<ebp>);
// void __usercall _L111841(int a1@<ebp>);
// void __usercall _L111842(int a1@<ebp>);
// void __usercall _L111843(int a1@<ebp>);
// void __usercall _L111844(int a1@<ebp>);
// void __usercall _L112055(int a1@<ebp>);
// void __usercall _L112161(int a1@<ebp>);
// void __usercall _L112202(int a1@<ebp>);
// void __usercall _L112203(int a1@<ebp>);
// void __usercall _L112204(int a1@<ebp>);
// void __usercall _L112205(int a1@<ebp>);
// void __usercall _L112675(int a1@<ebp>);
// void __usercall _L112676(int a1@<ebp>);
// void __usercall _L113428(int a1@<ebp>);
// void __usercall _L114569(int a1@<ebp>);
// void __usercall _L115765(int a1@<ebp>);
// void __usercall _L116109(int a1@<ebp>);
// void __usercall _L116110(int a1@<ebp>);
// void __usercall _L116189(int a1@<ebp>);
// void __usercall _L116313(int a1@<ebp>);
// void __usercall _L116314(int a1@<ebp>);
// void __usercall _L116675(int a1@<ebp>);
// void __usercall _L116676(int a1@<ebp>);
// void __usercall _L116941(int a1@<ebp>);
// void __usercall _L116942(int a1@<ebp>);
// void __usercall _L117082(int a1@<ebp>);
// void __usercall _L117394(int a1@<ebp>);
// void __usercall _L117539(int a1@<ebp>);
// void __usercall _L118013(int a1@<ebp>);
// void __usercall _L118078(int a1@<ebp>);
// void __usercall _L118191(int a1@<ebp>);
// void __usercall _L114348(int a1@<ebp>);
// void __usercall _L114349(int a1@<ebp>);
// void __usercall _L114350(int a1@<ebp>);
// void __usercall _L114619(int a1@<ebp>);
// void __usercall _L114620(int a1@<ebp>);
// void __usercall _L114621(int a1@<ebp>);
// void __usercall _L114622(int a1@<ebp>);
// void __usercall _L114728(int a1@<ebp>);
// void __usercall _L114805(int a1@<ebp>);
// void __usercall _L114958(int a1@<ebp>);
// void __usercall _L115137(int a1@<ebp>);
// void __usercall _L115223(int a1@<ebp>);
void _L115346();
void _L115547();
// void __usercall _L115548(int a1@<ebp>);
// void __usercall _L115549(int a1@<ebp>);
// void __usercall _L115916(int a1@<ebp>);
// void __usercall _L115917(int a1@<ebp>);
// void __usercall _L115918(int a1@<ebp>);
// void __usercall _L119043(int a1@<ebp>);
// void __usercall _L119044(int a1@<ebp>);
// void __usercall _L119045(int a1@<ebp>);
// void __usercall _L119046(int a1@<ebp>);
// void __usercall _L119047(int a1@<ebp>);
// void __usercall _L119048(int a1@<ebp>);
// void __usercall _L119049(int a1@<ebp>);
// void __usercall _L119050(int a1@<ebp>);
// void __usercall _L119343(int a1@<ebp>);
// void __usercall _L119825(int a1@<ebp>);
// void __usercall _L119826(int a1@<ebp>);
// void __usercall _L119912(int a1@<ebp>);
// void __usercall _L120050(int a1@<ebp>);
// void __usercall _L120051(int a1@<ebp>);
// void __usercall _L121184(int a1@<ebp>);
// void __usercall _L121185(int a1@<ebp>);
// void __usercall _L121186(int a1@<ebp>);
// void __usercall _L121187(int a1@<ebp>);
// void __usercall _L121188(int a1@<ebp>);
// void __usercall _L121189(int a1@<ebp>);
// void __usercall _L121377(int a1@<ebp>);
// void __usercall _L121190(int a1@<ebp>);
// void __usercall _L121191(int a1@<ebp>);
// void __usercall _L115759(int a1@<ebp>);
// void __usercall _L115760(int a1@<ebp>);
// void __usercall _L115761(int a1@<ebp>);
// void __usercall _L115830(int a1@<ebp>);
// void __usercall _L115831(int a1@<ebp>);
// void __usercall _L115832(int a1@<ebp>);
// void __usercall _L115833(int a1@<ebp>);
// void __usercall _L115834(int a1@<ebp>);
// void __usercall _L115835(int a1@<ebp>);
// void __usercall _L115836(int a1@<ebp>);
// void __usercall _L116012(int a1@<ebp>);
// void __usercall _L116013(int a1@<ebp>);
// void __usercall _L116014(int a1@<ebp>);
// void __usercall _L116015(int a1@<ebp>);
// void __usercall _L116016(int a1@<ebp>);
// void __usercall _L116017(int a1@<ebp>);
// void __usercall _L116018(int a1@<ebp>);
// void __usercall _L116019(int a1@<ebp>);
// void __usercall _L116020(int a1@<ebp>);
// void __usercall _L116021(int a1@<ebp>);
// void __usercall _L116022(int a1@<ebp>);
// void __usercall _L116023(int a1@<ebp>);
// void __usercall _L116024(int a1@<ebp>);
// void __usercall _L116025(int a1@<ebp>);
// void __usercall _L116026(int a1@<ebp>);
// void __usercall _L116027(int a1@<ebp>);
// void __usercall _L116028(int a1@<ebp>);
// void __usercall _L116029(int a1@<ebp>);
// void __usercall _L116030(int a1@<ebp>);
// void __usercall _L116031(int a1@<ebp>);
// void __usercall _L116032(int a1@<ebp>);
// void __usercall _L116033(int a1@<ebp>);
// void __usercall _L116034(int a1@<ebp>);
// void __usercall _L116035(int a1@<ebp>);
// void __usercall _L116036(int a1@<ebp>);
// void __usercall _L116037(int a1@<ebp>);
// void __usercall _L116038(int a1@<ebp>);
// void __usercall _L116758(int a1@<ebp>);
// void __usercall _L116880(int a1@<ebp>);
// void __usercall _L117029(int a1@<ebp>);
void _L117030();
void _L117386();
// void __usercall _L117564(int a1@<ebp>);
// void __usercall _L117626(int a1@<ebp>);
// void __usercall _L120123(int a1@<ebp>);
// void __usercall _L121129(int a1@<ebp>);
// void __usercall _L121388(int a1@<ebp>);
// void __usercall _L121563(int a1@<ebp>);
// void __usercall _L115761_0(int a1@<ebp>);
// void __usercall _L115762(int a1@<ebp>);
// void __usercall _L115763(int a1@<ebp>);
// void __usercall _L115764(int a1@<ebp>);
// void __usercall _L115765_0(int a1@<ebp>);
// void __usercall _L115766(int a1@<ebp>);
// void __usercall _L115767(int a1@<ebp>);
// void __usercall _L116003(int a1@<ebp>);
// void __usercall _L116004(int a1@<ebp>);
// void __usercall _L116005(int a1@<ebp>);
// void __usercall _L116006(int a1@<ebp>);
// void __usercall _L116007(int a1@<ebp>);
// void __usercall _L116008(int a1@<ebp>);
// void __usercall _L116323(int a1@<ebp>);
// void __usercall _L116245(int a1@<ebp>);
// void __usercall _L116246(int a1@<ebp>);
// void __usercall _L116562(int a1@<ebp>);
// void __usercall _L116563(int a1@<ebp>);
// void __usercall _L116564(int a1@<ebp>);
// void __usercall _L116565(int a1@<ebp>);
// void __usercall _L116568(int a1@<ebp>);
// void __usercall _L117225(int a1@<ebp>);
// void __usercall _L117277(int a1@<ebp>);
// void __usercall _L117867(int a1@<ebp>);
// void __usercall _L118918(int a1@<ebp>);
// void __usercall _L121523(int a1@<ebp>);
// void __usercall _L121524(int a1@<ebp>);
// void __usercall _L121525(int a1@<ebp>);
// void __usercall _L121841(int a1@<ebp>);
// void __usercall _L122319(int a1@<ebp>);
// void __usercall _L122827(int a1@<ebp>);
// void __usercall _L122828(int a1@<ebp>);
// void __usercall _L122829(int a1@<ebp>);
// void __usercall _L122830(int a1@<ebp>);
// void __usercall _L122831(int a1@<ebp>);
// void __usercall _L122832(int a1@<ebp>);
// void __usercall _L123081(int a1@<ebp>);
// void __usercall _L123082(int a1@<ebp>);
// void __usercall _L123492(int a1@<ebp>);
// void __usercall _L124132(int a1@<ebp>);
// void __usercall _L124302(int a1@<ebp>);
// void __usercall _L124775(int a1@<ebp>);
// void __usercall _L124776(int a1@<ebp>);
// void __usercall _L124777(int a1@<ebp>);
// void __usercall _L124778(int a1@<ebp>);
// void __usercall _L124779(int a1@<ebp>);
// void __usercall _L124780(int a1@<ebp>);
// void __usercall _L124781(int a1@<ebp>);
// void __usercall _L124782(int a1@<ebp>);
// void __usercall _L124783(int a1@<ebp>);
// void __usercall _L124784(int a1@<ebp>);
// void __usercall _L124785(int a1@<ebp>);
// void __usercall _L124786(int a1@<ebp>);
// void __usercall _L124787(int a1@<ebp>);
// void __usercall _L125128(int a1@<ebp>);
// void __usercall _L125165(int a1@<ebp>);
// void __usercall _L125166(int a1@<ebp>);
// void __usercall _L125167(int a1@<ebp>);
// void __usercall _L125168(int a1@<ebp>);
// void __usercall _L125169(int a1@<ebp>);
// void __usercall _L125170(int a1@<ebp>);
// void __usercall _L125171(int a1@<ebp>);
// void __usercall _L125172(int a1@<ebp>);
// void __usercall _L125173(int a1@<ebp>);
// void __usercall _L125174(int a1@<ebp>);
// void __usercall _L125175(int a1@<ebp>);
// void __usercall _L125176(int a1@<ebp>);
// void __usercall _L125177(int a1@<ebp>);
// void __usercall _L125420(int a1@<ebp>);
void _L125499();
// void __usercall _L125553(int a1@<ebp>);
// void __usercall _L125695(int a1@<ebp>);
void _L125755();
void _L126113();
void _L126371();
// void __usercall _L126374(int a1@<ebp>);
void _L126376();
// void __usercall _L127045(int a1@<ebp>);
// void __usercall _L127246(int a1@<ebp>);
// void __usercall _L127247(int a1@<ebp>);
// void __usercall _L127248(int a1@<ebp>);
// void __usercall _L127613(int a1@<ebp>);
// void __usercall _L127614(int a1@<ebp>);
// void __usercall _L127616(int a1@<ebp>);
void _L127617();
void _L127619();
// void __usercall _L127620(int a1@<ebp>);
// void __usercall _L127621(int a1@<ebp>);
// void __usercall _L127622(int a1@<ebp>);
// void __usercall _L127623(int a1@<ebp>);
// void __usercall _L127624(int a1@<ebp>);
// void __usercall _L127625(int a1@<ebp>);
// void __usercall _L127626(int a1@<ebp>);
void _L127627();
void _L128778();
// void __usercall _L129197(int a1@<ebp>);
void _L129198();
// void __usercall _L129669(int a1@<ebp>);
// void __usercall _L129670(int a1@<ebp>);
void _L129671();
// void __usercall _L130261(int a1@<ebp>);
void _L130262();
// void __usercall _L130500(int a1@<ebp>);
void _L130501();
void _L130503();
void _L131107();
void _L131108();
void _L131508();
void _L131777();
void _L131778();
// void __usercall _L131779(int a1@<ebp>);
void _L132129();
void _L132130();
void _L132505();
void _L132506();
void _L132821();
void _L132822();
// void __usercall _L132823(int a1@<ebp>);
// void __usercall _L132824(int a1@<ebp>);
// void __usercall _L133129(int a1@<ebp>);
void _L133130();
void _L133281();
// void __usercall _L133282(int a1@<ebp>);
void _L133490();
void _L133887();
// void __usercall _L134088(int a1@<ebp>);
void _L134089();
// void __usercall _L134315(int a1@<ebp>);
void _L134316();
void _L134481();
// void __usercall _L134754(int a1@<ebp>);
// void __usercall _L134755(int a1@<ebp>);
// void __usercall _L134756(int a1@<ebp>);
// void __usercall _L134757(int a1@<ebp>);
// void __usercall _L134758(int a1@<ebp>);
// void __usercall _L134759(int a1@<ebp>);
// void __usercall _L134760(int a1@<ebp>);
void _L134761();
void _L135000();
void _L135001();
void _L135002();
// void __usercall _L135003(int a1@<ebp>);
void _L135004();
void _L135006();
void _L135005();
void _L135641();
// void __usercall _L135684(int a1@<ebp>);
// void __usercall _L135685(int a1@<ebp>);
// void __usercall _L135834(int a1@<ebp>);
// void __usercall _L135946(int a1@<ebp>);
// void __usercall _L135947(int a1@<ebp>);
// void __usercall _L138332(int a1@<ebp>);
// void __usercall _L138394(int a1@<ebp>);
// void __usercall _L138517(int a1@<ebp>);
// void __usercall _L138519(int a1@<ebp>);
// void __usercall _L138604(int a1@<ebp>);
// void __usercall _L143532(int a1@<ebp>);
// void __usercall _L143574(int a1@<ebp>);
// void __usercall _L143613(int a1@<ebp>);
// void __usercall _L143797(int a1@<ebp>);
// void __usercall _L144198(int a1@<ebp>);
// void __usercall _L144262(int a1@<ebp>);
// void __usercall _L144326(int a1@<ebp>);
// void __usercall _L121430(int a1@<ebp>);
// void __usercall _L121431(int a1@<ebp>);
// void __usercall _L121622(int a1@<ebp>);
// void __usercall _L121621(int a1@<ebp>);
// void __usercall _L121617(int a1@<ebp>);
// void __usercall _L122261(int a1@<ebp>);
// void __usercall _L122262(int a1@<ebp>);
// void __usercall _L122396(int a1@<ebp>);
// void __usercall _L122751(int a1@<ebp>);
// void __usercall _L122752(int a1@<ebp>);
// void __usercall _L122753(int a1@<ebp>);
// void __usercall _L122754(int a1@<ebp>);
// void __usercall _L123747(int a1@<ebp>);
// void __usercall _L123748(int a1@<ebp>);
// void __usercall _L123749(int a1@<ebp>);
// void __usercall _L123750(int a1@<ebp>);
// void __usercall _L124177(int a1@<ebp>);
// void __usercall _L124178(int a1@<ebp>);
// void __usercall _L125000(int a1@<ebp>);
// void __usercall _L126052(int a1@<ebp>);
// void __usercall _L126053(int a1@<ebp>);
// void __usercall _L126054(int a1@<ebp>);
// void __usercall _L126920(int a1@<ebp>);
// int __usercall _L128225@<eax>(int a1@<ebp>);
// int __usercall _L128226@<eax>(int a1@<ebp>);
// void __usercall _L128227(int a1@<ebp>);
// void __usercall _L128228(int a1@<ebp>);
// void __usercall _L128229(int a1@<ebp>);
// void __usercall _L128230(int a1@<ebp>);
// void __usercall _L128231(int a1@<ebp>);
// void __usercall _L128232(int a1@<ebp>);
// void __usercall _L128233(int a1@<ebp>);
// void __usercall _L128234(int a1@<ebp>);
// void __usercall _L128235(int a1@<ebp>);
// void __usercall _L128236(int a1@<ebp>);
// void __usercall _L128237(int a1@<ebp>);
// void __usercall _L128238(int a1@<ebp>);
// void __usercall _L128239(int a1@<ebp>);
// void __usercall _L128240(int a1@<ebp>);
// void __usercall _L130563(int a1@<ebp>);
// void __usercall _L130759(int a1@<ebp>);
// void __usercall _L130856(int a1@<ebp>);
// void __usercall _L132152(int a1@<ebp>);
// void __usercall _L133437(int a1@<ebp>);
// void __usercall _L133440(int a1@<ebp>);
// void __usercall _L136178(int a1@<ebp>);
// void __usercall _L136262(int a1@<ebp>);
// void __usercall _L137029(int a1@<ebp>);
// void __usercall _L137093(int a1@<ebp>);
// void __usercall _L137157(int a1@<ebp>);
// void __usercall _L137221(int a1@<ebp>);
// void __usercall _L137285(int a1@<ebp>);
// void __usercall _L137349(int a1@<ebp>);
// void __usercall _L138979(int a1@<ebp>);
// void __usercall _L139043(int a1@<ebp>);
// void __usercall _L139107(int a1@<ebp>);
// void __usercall _L110150(int a1@<ebp>);
// void __usercall _L110151(int a1@<ebp>);
// void __usercall _L110152(int a1@<ebp>);
// void __usercall _L110153_0(int a1@<ebp>);
// void __usercall _L110154(int a1@<ebp>);
// void __usercall _L110155_0(int a1@<ebp>);
// void __usercall _L110156(int a1@<ebp>);
// void __usercall _L110157(int a1@<ebp>);
// void __usercall _L110158(int a1@<ebp>);
// void __usercall _L110159(int a1@<ebp>);
// void __usercall _L110160(int a1@<ebp>);
// void __usercall _L110161(int a1@<ebp>);
// void __usercall _L110427(int a1@<ebp>);
// void __usercall _L110428(int a1@<ebp>);
// void __usercall _L110429(int a1@<ebp>);
// void __usercall _L110430(int a1@<ebp>);
// void __usercall _L110431(int a1@<ebp>);
// void __usercall _L110432(int a1@<ebp>);
// void __usercall _L110433(int a1@<ebp>);
// void __usercall _L110434(int a1@<ebp>);
// void __usercall _L110435(int a1@<ebp>);
// void __usercall _L110436(int a1@<ebp>);
// void __usercall _L110437(int a1@<ebp>);
// void __usercall _L110438(int a1@<ebp>);
// void __usercall _L110439(int a1@<ebp>);
// void __usercall _L114973(int a1@<ebp>);
// void __usercall _L114974(int a1@<ebp>);
// void __usercall _L114975(int a1@<ebp>);
// void __usercall _L114976(int a1@<ebp>);
// void __usercall _L114977(int a1@<ebp>);
// void __usercall _L114978(int a1@<ebp>);
// void __usercall _L114979(int a1@<ebp>);
// void __usercall _L115253(int a1@<ebp>);
// void __usercall _L115254(int a1@<ebp>);
// void __usercall _L115255(int a1@<ebp>);
// void __usercall _L115256(int a1@<ebp>);
// void __usercall _L115257(int a1@<ebp>);
// void __usercall _L115258(int a1@<ebp>);
// void __usercall _L115259(int a1@<ebp>);
// void __usercall _L115676(int a1@<ebp>);
// void __usercall _L115598(int a1@<ebp>);
// void __usercall _L115599(int a1@<ebp>);
// void __usercall _L115932(int a1@<ebp>);
// void __usercall _L115933(int a1@<ebp>);
// void __usercall _L115934(int a1@<ebp>);
// void __usercall _L115935(int a1@<ebp>);
// void __usercall _L115936(int a1@<ebp>);
// void __usercall _L115937(int a1@<ebp>);
// void __usercall _L115938(int a1@<ebp>);
// void __usercall _L115939(int a1@<ebp>);
// void __usercall _L115940(int a1@<ebp>);
// void __usercall _L115941(int a1@<ebp>);
// void __usercall _L115942(int a1@<ebp>);
// void __usercall _L115943(int a1@<ebp>);
// void __usercall _L116302(int a1@<ebp>);
// void __usercall _L115945(int a1@<ebp>);
// void __usercall _L116646(int a1@<ebp>);
// void __usercall _L116701(int a1@<ebp>);
// void __usercall _L116855(int a1@<ebp>);
void _L116856();
// void __usercall _L114268(int a1@<ebp>);
// int __usercall _L114269@<eax>(int a1@<ebp>);
// int __usercall _L114270@<eax>(int a1@<ebp>);
// void __usercall _L114271(int a1@<ebp>);
// void __usercall _L114303(int a1@<ebp>);
// void __usercall _L114304(int a1@<ebp>);
// void __usercall _L114305(int a1@<ebp>);
// void __usercall _L114306_0(int a1@<ebp>);
// void __usercall _L114307(int a1@<ebp>);
// void __usercall _L114308(int a1@<ebp>);
// void __usercall _L114309(int a1@<ebp>);
// void __usercall _L114524(int a1@<ebp>);
// void __usercall _L114525(int a1@<ebp>);
// void __usercall _L114526(int a1@<ebp>);
// void __usercall _L114527(int a1@<ebp>);
// void __usercall _L114528(int a1@<ebp>);
// void __usercall _L114529(int a1@<ebp>);
// void __usercall _L114530(int a1@<ebp>);
// void __usercall _L114838(int a1@<ebp>);
// void __usercall _L114839(int a1@<ebp>);
// void __usercall _L114840(int a1@<ebp>);
// void __usercall _L114841(int a1@<ebp>);
// void __usercall _L114842(int a1@<ebp>);
// void __usercall _L114843(int a1@<ebp>);
// void __usercall _L114844(int a1@<ebp>);
// void __usercall _L114845(int a1@<ebp>);
// void __usercall _L114846(int a1@<ebp>);
// void __usercall _L114847(int a1@<ebp>);
// void __usercall _L114848(int a1@<ebp>);
// void __usercall _L114849(int a1@<ebp>);
// void __usercall _L114850(int a1@<ebp>);
// void __usercall _L114851(int a1@<ebp>);
// void __usercall _L114852(int a1@<ebp>);
// void __usercall _L114853(int a1@<ebp>);
// void __usercall _L114854(int a1@<ebp>);
// void __usercall _L114855(int a1@<ebp>);
// void __usercall _L114856(int a1@<ebp>);
// void __usercall _L114857(int a1@<ebp>);
// void __usercall _L114858(int a1@<ebp>);
// void __usercall _L114859(int a1@<ebp>);
// void __usercall _L114860(int a1@<ebp>);
// void __usercall _L114861(int a1@<ebp>);
// void __usercall _L114862(int a1@<ebp>);
// void __usercall _L114863(int a1@<ebp>);
// void __usercall _L114864(int a1@<ebp>);
// void __usercall _L114865(int a1@<ebp>);
// void __usercall _L114866(int a1@<ebp>);
// void __usercall _L114867(int a1@<ebp>);
// void __usercall _L114868(int a1@<ebp>);
// void __usercall _L115578(int a1@<ebp>);
// void __usercall _L115579(int a1@<ebp>);
// void __usercall _L115580(int a1@<ebp>);
// void __usercall _L115581(int a1@<ebp>);
// void __usercall _L115582(int a1@<ebp>);
// void __usercall _L115583(int a1@<ebp>);
// void __usercall _L115584(int a1@<ebp>);
// void __usercall _L115585(int a1@<ebp>);
// void __usercall _L115586(int a1@<ebp>);
// void __usercall _L115587(int a1@<ebp>);
// void __usercall _L115588(int a1@<ebp>);
// void __usercall _L115589(int a1@<ebp>);
// void __usercall _L115590(int a1@<ebp>);
// void __usercall _L115591(int a1@<ebp>);
// void __usercall _L115592(int a1@<ebp>);
// void __usercall _L115593(int a1@<ebp>);
// void __usercall _L115594(int a1@<ebp>);
// void __usercall _L115595(int a1@<ebp>);
// void __usercall _L115596_0(int a1@<ebp>);
// void __usercall _L115597_0(int a1@<ebp>);
// void __usercall _L115598_0(int a1@<ebp>);
// void __usercall _L115599_0(int a1@<ebp>);
// void __usercall _L115600(int a1@<ebp>);
// void __usercall _L115601(int a1@<ebp>);
// void __usercall _L115602(int a1@<ebp>);
// void __usercall _L115603(int a1@<ebp>);
// void __usercall _L115604(int a1@<ebp>);
// void __usercall _L115605(int a1@<ebp>);
// void __usercall _L115606(int a1@<ebp>);
// void __usercall _L117337(int a1@<ebp>);
// void __usercall _L118946(int a1@<ebp>);
// void __usercall _L109971(int a1@<ebp>);
// void __usercall _L109972(int a1@<ebp>);
// void __usercall _L109973(int a1@<ebp>);
// void __usercall _L109974(int a1@<ebp>);
// void __usercall _L109975(int a1@<ebp>);
// void __usercall _L110154_0(int a1@<ebp>);
// void __usercall _L110363(int a1@<ebp>);
// void __usercall _L110364(int a1@<ebp>);
// void __usercall _L110617(int a1@<ebp>);
// void __usercall _L110618(int a1@<ebp>);
// void __usercall _L110792(int a1@<ebp>);
// void __usercall _L110793(int a1@<ebp>);
// void __usercall _L110839(int a1@<ebp>);
// void __usercall _L112636(int a1@<ebp>);
// void __usercall _L112637(int a1@<ebp>);
// void __usercall _L112640(int a1@<ebp>);
// void __usercall _L112641(int a1@<ebp>);
// void __usercall _L113126(int a1@<ebp>);
// void __usercall _L113309(int a1@<ebp>);
// void __usercall _L113310(int a1@<ebp>);
// void __usercall _L113389(int a1@<ebp>);
// void __usercall _L114579(int a1@<ebp>);
// void __usercall _L114580(int a1@<ebp>);
// void __usercall _L114891(int a1@<ebp>);
// void __usercall _L114892(int a1@<ebp>);
// void __usercall _L114942(int a1@<ebp>);
// void __usercall _L115184(int a1@<ebp>);
// void __usercall _L115294(int a1@<ebp>);
// void __usercall _L115295_0(int a1@<ebp>);
// void __usercall _L115296(int a1@<ebp>);
// void __usercall _L115297(int a1@<ebp>);
// void __usercall _L115298(int a1@<ebp>);
// void __usercall _L115299(int a1@<ebp>);
// void __usercall _L115300(int a1@<ebp>);
// void __usercall _L115519(int a1@<ebp>);
// void __usercall _L115641(int a1@<ebp>);
// void __usercall _L115642(int a1@<ebp>);
// void __usercall _L115643(int a1@<ebp>);
// void __usercall _L115644(int a1@<ebp>);
// void __usercall _L115645(int a1@<ebp>);
// void __usercall _L115868_0(int a1@<ebp>);
// void __usercall _L115648(int a1@<ebp>);
// void __usercall _L115647(int a1@<ebp>);
// void __usercall _L115649(int a1@<ebp>);
// void __usercall _L116522(int a1@<ebp>);
// void __usercall _L116523(int a1@<ebp>);
// void __usercall _L116524(int a1@<ebp>);
// void __usercall _L116672(int a1@<ebp>);
// void __usercall _L116956(int a1@<ebp>);
// void __usercall _L116957(int a1@<ebp>);
// void __usercall _L119839(int a1@<ebp>);
// void __usercall _L120296(int a1@<ebp>);
// void __usercall _L120360_0(int a1@<ebp>);
// void __usercall _L121499(int a1@<ebp>);
// void __usercall _L121500(int a1@<ebp>);
// void __usercall _L121579(int a1@<ebp>);
// void __usercall _L123638(int a1@<ebp>);
// void __usercall _L123639(int a1@<ebp>);
// void __usercall _L122492(int a1@<ebp>);
// void __usercall _L122760(int a1@<ebp>);
// void __usercall _L122761(int a1@<ebp>);
// void __usercall _L122762(int a1@<ebp>);
// void __usercall _L122763(int a1@<ebp>);
// void __usercall _L122764(int a1@<ebp>);
// void __usercall _L122765(int a1@<ebp>);
// void __usercall _L122766(int a1@<ebp>);
// void __usercall _L122767(int a1@<ebp>);
// void __usercall _L123035(int a1@<ebp>);
// void __usercall _L123036(int a1@<ebp>);
// void __usercall _L123037(int a1@<ebp>);
// void __usercall _L123038(int a1@<ebp>);
// void __usercall _L123039(int a1@<ebp>);
// void __usercall _L123040(int a1@<ebp>);
// void __usercall _L123041(int a1@<ebp>);
// void __usercall _L123042(int a1@<ebp>);
// void __usercall _L123043(int a1@<ebp>);
// void __usercall _L123044(int a1@<ebp>);
// void __usercall _L123045(int a1@<ebp>);
// void __usercall _L123291(int a1@<ebp>);
// void __usercall _L123292(int a1@<ebp>);
// void __usercall _L123293(int a1@<ebp>);
// void __usercall _L123294(int a1@<ebp>);
// void __usercall _L123295(int a1@<ebp>);
// void __usercall _L123296(int a1@<ebp>);
// void __usercall _L123297(int a1@<ebp>);
// void __usercall _L123550(int a1@<ebp>);
// void __usercall _L123551(int a1@<ebp>);
// void __usercall _L123552(int a1@<ebp>);
// void __usercall _L123553(int a1@<ebp>);
// void __usercall _L123768(int a1@<ebp>);
// void __usercall _L123769(int a1@<ebp>);
// void __usercall _L123770(int a1@<ebp>);
// void __usercall _L123771(int a1@<ebp>);
// void __usercall _L123772(int a1@<ebp>);
// void __usercall _L123773(int a1@<ebp>);
// void __usercall _L123774(int a1@<ebp>);
// void __usercall _L123775(int a1@<ebp>);
// void __usercall _L123776(int a1@<ebp>);
// void __usercall _L123777(int a1@<ebp>);
// void __usercall _L123778(int a1@<ebp>);
// void __usercall _L123779(int a1@<ebp>);
// void __usercall _L123780(int a1@<ebp>);
// void __usercall _L123781(int a1@<ebp>);
// void __usercall _L123782(int a1@<ebp>);
// void __usercall _L123783(int a1@<ebp>);
// void __usercall _L123784(int a1@<ebp>);
// void __usercall _L123785(int a1@<ebp>);
// void __usercall _L123786(int a1@<ebp>);
// void __usercall _L123787(int a1@<ebp>);
// void __usercall _L123788(int a1@<ebp>);
// void __usercall _L123789(int a1@<ebp>);
// void __usercall _L123790(int a1@<ebp>);
// void __usercall _L123791(int a1@<ebp>);
// void __usercall _L123792(int a1@<ebp>);
// void __usercall _L123793(int a1@<ebp>);
// void __usercall _L123794(int a1@<ebp>);
// void __usercall _L123795(int a1@<ebp>);
// void __usercall _L123796(int a1@<ebp>);
// void __usercall _L123797(int a1@<ebp>);
// void __usercall _L124477_0(int a1@<ebp>);
// void __usercall _L124914(int a1@<ebp>);
// void __usercall _L124930(int a1@<ebp>);
// void __usercall _L124931(int a1@<ebp>);
// void __usercall _L125056(int a1@<ebp>);
// void __usercall _L125057(int a1@<ebp>);
// void __usercall _L125290(int a1@<ebp>);
// void __usercall _L125483(int a1@<ebp>);
// void __usercall _L125484(int a1@<ebp>);
// void __usercall _L128706(int a1@<ebp>);
// void __usercall _L128939(int a1@<ebp>);
// void __usercall _L130414(int a1@<ebp>);
// void __usercall _L109533(int a1@<ebp>);
// void __usercall _L109553(int a1@<ebp>);
// void __usercall _L109554(int a1@<ebp>);
// void __usercall _L109692(int a1@<ebp>);
// void __usercall _L109694(int a1@<ebp>);
// void __usercall _L109695(int a1@<ebp>);
// void __usercall _L115078(int a1@<ebp>);
// void __usercall _L110341(int a1@<ebp>);
// void __usercall _L110802(int a1@<ebp>);
// void __usercall _L110803(int a1@<ebp>);
// void __usercall _L110913(int a1@<ebp>);
// void __usercall _L111253(int a1@<ebp>);
// void __usercall _L111651(int a1@<ebp>);
// void __usercall _L111652(int a1@<ebp>);
// void __usercall _L110490(int a1@<ebp>);
// void __usercall _L110255(int a1@<ebp>);
// void __usercall _L110256(int a1@<ebp>);
// void __usercall _L110257(int a1@<ebp>);
// void __usercall _L110258(int a1@<ebp>);
// void __usercall _L110259(int a1@<ebp>);
// void __usercall _L110260(int a1@<ebp>);
// void __usercall _L110261(int a1@<ebp>);
// void __usercall _L110262(int a1@<ebp>);
// void __usercall _L110263(int a1@<ebp>);
// void __usercall _L112911(int a1@<ebp>);
// void __usercall _L112989(int a1@<ebp>);
// void __usercall _L109752(int a1@<ebp>);
// void __usercall _L109882(int a1@<ebp>);
// void __usercall _L110005(int a1@<ebp>);
// void __usercall _L110048(int a1@<ebp>);
// void __usercall _L110106(int a1@<ebp>);
// void __usercall _L111221(int a1@<ebp>);
// void __usercall _L111651_0(int a1@<ebp>);
// void __usercall _L111698(int a1@<ebp>);
void _L113216();
// void __usercall _L113217(int a1@<ebp>);
// void __usercall _L113218(int a1@<ebp>);
// void __usercall _L113219(int a1@<ebp>);
// void __usercall _L110124_0(int a1@<ebp>);
// void __usercall _L110125(int a1@<ebp>);
// void __usercall _L110390(int a1@<ebp>);
// void __usercall _L110391(int a1@<ebp>);
// void __usercall _L110497(int a1@<ebp>);
// void __usercall _L110498(int a1@<ebp>);
// void __usercall _L110499(int a1@<ebp>);
// void __usercall _L110500_0(int a1@<ebp>);
// void __usercall _L110501(int a1@<ebp>);
// void __usercall _L110502(int a1@<ebp>);
// void __usercall _L110733(int a1@<ebp>);
// void __usercall _L110749(int a1@<ebp>);
// void __usercall _L110752(int a1@<ebp>);
// void __usercall _L110856(int a1@<ebp>);
// void __usercall _L110857(int a1@<ebp>);
// void __usercall _L110858(int a1@<ebp>);
// void __usercall _L110859(int a1@<ebp>);
// void __usercall _L110860(int a1@<ebp>);
// void __usercall _L110861(int a1@<ebp>);
// void __usercall _L110864(int a1@<ebp>);
// void __usercall _L110865(int a1@<ebp>);
// void __usercall _L111049(int a1@<ebp>);
// void __usercall _L111050(int a1@<ebp>);
// void __usercall _L111051(int a1@<ebp>);
// void __usercall _L111052(int a1@<ebp>);
// void __usercall _L111053(int a1@<ebp>);
// void __usercall _L111054(int a1@<ebp>);
// void __usercall _L111055(int a1@<ebp>);
// void __usercall _L111058_0(int a1@<ebp>);
// void __usercall _L111059(int a1@<ebp>);
// void __usercall _L109433(int a1@<ebp>);
// void __usercall _L109434(int a1@<ebp>);
// void __usercall _L109485(int a1@<ebp>);
// void __usercall _L110527(int a1@<ebp>);
// void __usercall _L110596(int a1@<ebp>);
// void __usercall _L110597(int a1@<ebp>);
// void __usercall _L110598(int a1@<ebp>);
// void __usercall _L110599(int a1@<ebp>);
// void __usercall _L110600(int a1@<ebp>);
// void __usercall _L110601(int a1@<ebp>);
// void __usercall _L110602(int a1@<ebp>);
// void __usercall _L110603_0(int a1@<ebp>);
// void __usercall _L110604_0(int a1@<ebp>);
// void __usercall _L110605(int a1@<ebp>);
// void __usercall _L110606(int a1@<ebp>);
// void __usercall _L110607(int a1@<ebp>);
// void __usercall _L110608_0(int a1@<ebp>);
// void __usercall _L110609_0(int a1@<ebp>);
// void __usercall _L110610(int a1@<ebp>);
// void __usercall _L110611(int a1@<ebp>);
// void __usercall _L110612(int a1@<ebp>);
// void __usercall _L110613(int a1@<ebp>);
// void __usercall _L112012(int a1@<ebp>);
// void __usercall _L112013_0(int a1@<ebp>);
void _L112135_0();
// void __usercall _L112586(int a1@<ebp>);
// void __usercall _L112626(int a1@<ebp>);
void _L112627();
// void __usercall _L112628(int a1@<ebp>);
void _L112830();
// void __usercall _L112831(int a1@<ebp>);
// void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall Sleep(DWORD dwMilliseconds);
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend);
// LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend);
// HANDLE __stdcall CreateIoCompletionPort(HANDLE FileHandle, HANDLE ExistingCompletionPort, ULONG_PTR CompletionKey, DWORD NumberOfConcurrentThreads);
// BOOL __stdcall GetQueuedCompletionStatus(HANDLE CompletionPort, LPDWORD lpNumberOfBytesTransferred, PULONG_PTR lpCompletionKey, LPOVERLAPPED *lpOverlapped, DWORD dwMilliseconds);
// LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value);
// BOOL __stdcall PostQueuedCompletionStatus(HANDLE CompletionPort, DWORD dwNumberOfBytesTransferred, ULONG_PTR dwCompletionKey, LPOVERLAPPED lpOverlapped);
// LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination, LONG Exchange, LONG Comperand);
// void __stdcall GetLocalTime(LPSYSTEMTIME lpSystemTime);
// LPSTR __stdcall lstrcpyA(LPSTR lpString1, LPCSTR lpString2);
// DWORD __stdcall SetFilePointer(HANDLE hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod);
// HLOCAL __stdcall LocalFree(HLOCAL hMem);
// DWORD __stdcall GetLastError();
// DWORD __stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds);
// HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName);
// BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA lpVersionInformation);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// BOOL __stdcall IsDBCSLeadByte(BYTE TestChar);
// BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes);
// BOOL __stdcall CloseHandle(HANDLE hObject);
// HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// int __stdcall WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCSTR lpDefaultChar, LPBOOL lpUsedDefaultChar);
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetFileAttributesA(LPCSTR lpFileName);
// BOOL __stdcall FreeLibrary(HMODULE hLibModule);
// LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);
// BOOL __stdcall IsBadWritePtr(LPVOID lp, UINT_PTR ucb);
// BOOL __stdcall SetEvent(HANDLE hEvent);
// HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName);
// HGLOBAL __stdcall GlobalFree(HGLOBAL hMem);
// LPWSTR __stdcall GetCommandLineW();
// HLOCAL __stdcall LocalAlloc(UINT uFlags, SIZE_T uBytes);
// int __stdcall lstrlenA(LPCSTR lpString);
// DWORD __stdcall FormatMessageA(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments);
// int __stdcall lstrlenW(LPCWSTR lpString);
// BOOL __stdcall GetCPInfo(UINT CodePage, LPCPINFO lpCPInfo);
// BOOL __stdcall IsBadReadPtr(const void *lp, UINT_PTR ucb);
// HANDLE __stdcall GetStdHandle(DWORD nStdHandle);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue);
// LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex);
// BOOL __stdcall HeapFree(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes);
// BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType);
// HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize);
// BOOL __stdcall HeapDestroy(HANDLE hHeap);
// DWORD __stdcall GetEnvironmentVariableA(LPCSTR lpName, LPSTR lpBuffer, DWORD nSize);
// DWORD __stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// SIZE_T __stdcall HeapSize(HANDLE hHeap, DWORD dwFlags, LPCVOID lpMem);
// LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes);
// HRESULT __stdcall CreateErrorInfo(ICreateErrorInfo **pperrinfo);
// HRESULT __stdcall SetErrorInfo(ULONG dwReserved, IErrorInfo *perrinfo);
// HRESULT __stdcall VariantCopy(VARIANTARG *pvargDest, const VARIANTARG *pvargSrc);
// HRESULT __stdcall GetErrorInfo(ULONG dwReserved, IErrorInfo **pperrinfo);
// HRESULT __stdcall VariantClear(VARIANTARG *pvarg);
// void __stdcall VariantInit(VARIANTARG *pvarg);
// void __stdcall SysFreeString(BSTR bstrString);
// HRESULT __stdcall VariantChangeType(VARIANTARG *pvargDest, const VARIANTARG *pvarSrc, USHORT wFlags, VARTYPE vt);
// BSTR __stdcall SysAllocString(const OLECHAR *psz);
// LPWSTR *__stdcall CommandLineToArgvW(LPCWSTR lpCmdLine, int *pNumArgs);
// BOOL __stdcall DestroyWindow(HWND hWnd);
// UINT_PTR __stdcall SetTimer(HWND hWnd, UINT_PTR nIDEvent, UINT uElapse, TIMERPROC lpTimerFunc);
// BOOL __stdcall DestroyIcon(HICON hIcon);
// DWORD __stdcall GetWindowThreadProcessId(HWND hWnd, LPDWORD lpdwProcessId);
// void __stdcall PostQuitMessage(int nExitCode);
// int __stdcall MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType);
// int __stdcall GetWindowTextLengthA(HWND hWnd);
// int __stdcall wvsprintfA(LPSTR, LPCSTR, va_list arglist);
// HWND __stdcall FindWindowExA(HWND hWndParent, HWND hWndChildAfter, LPCSTR lpszClass, LPCSTR lpszWindow);
// BOOL __stdcall KillTimer(HWND hWnd, UINT_PTR uIDEvent);
// int _wsprintfA(LPSTR, LPCSTR, ...);
// BOOL __stdcall GetMessageA(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);
// LRESULT __stdcall SendMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// BOOL __stdcall TranslateMessage(const MSG *lpMsg);
// LRESULT __stdcall DispatchMessageA(const MSG *lpMsg);
// BOOL __stdcall SetWindowTextA(HWND hWnd, LPCSTR lpString);
// BOOL __stdcall PostMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// DWORD __stdcall timeGetTime();
// MMRESULT __stdcall timeEndPeriod(UINT uPeriod);
// MMRESULT __stdcall timeBeginPeriod(UINT uPeriod);
// int __stdcall WSAGetLastError();
// SOCKET __stdcall socket(int af, int type, int protocol);
// int __stdcall recv(SOCKET s, char *buf, int len, int flags);
// u_short __stdcall ntohs(u_short netshort);
// int __stdcall closesocket(SOCKET s);
// int __stdcall bind(SOCKET s, const struct sockaddr *name, int namelen);
// char *__stdcall inet_ntoa(struct in_addr in);
// int __stdcall listen(SOCKET s, int backlog);
// int __stdcall ioctlsocket(SOCKET s, __int32 cmd, u_long *argp);
// int __stdcall setsockopt(SOCKET s, int level, int optname, const char *optval, int optlen);
// int __stdcall WSARecv(SOCKET s, LPWSABUF lpBuffers, DWORD dwBufferCount, LPDWORD lpNumberOfBytesRecvd, LPDWORD lpFlags, LPWSAOVERLAPPED lpOverlapped, LPWSAOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine);
// int __stdcall WSASend(SOCKET s, LPWSABUF lpBuffers, DWORD dwBufferCount, LPDWORD lpNumberOfBytesSent, DWORD dwFlags, LPWSAOVERLAPPED lpOverlapped, LPWSAOVERLAPPED_COMPLETION_ROUTINE lpCompletionRoutine);
// struct hostent *__stdcall gethostbyname(const char *name);
// unsigned __int32 __stdcall inet_addr(const char *cp);
// u_short __stdcall htons(u_short hostshort);
// u_long __stdcall htonl(u_long hostlong);
// BOOL __stdcall WSACloseEvent(HANDLE hEvent);
// DWORD __stdcall WSAWaitForMultipleEvents(DWORD cEvents, const HANDLE *lphEvents, BOOL fWaitAll, DWORD dwTimeout, BOOL fAlertable);
// BOOL __stdcall WSASetEvent(HANDLE hEvent);
// HANDLE __stdcall WSACreateEvent();
// BOOL __stdcall WSAResetEvent(HANDLE hEvent);
// int __stdcall WSAEnumNetworkEvents(SOCKET s, HANDLE hEventObject, LPWSANETWORKEVENTS lpNetworkEvents);
// int __stdcall WSAEventSelect(SOCKET s, HANDLE hEventObject, __int32 lNetworkEvents);
// int __stdcall connect(SOCKET s, const struct sockaddr *name, int namelen);
// int __stdcall send(SOCKET s, const char *buf, int len, int flags);
// void __stdcall WSASetLastError(int iError);
// u_long __stdcall ntohl(u_long netlong);
// int __stdcall WSAStartup(WORD wVersionRequested, LPWSADATA lpWSAData);
// int __stdcall WSACleanup();
// HRESULT __stdcall CoInitialize(LPVOID pvReserved);
// void __stdcall CoUninitialize();
// void __stdcall CoTaskMemFree(LPVOID pv);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN _L112206; // weak
_UNKNOWN _L107869; // weak
_UNKNOWN _L108139; // weak
_UNKNOWN _L109806; // weak
_UNKNOWN _L109881; // weak
_UNKNOWN _L92283; // weak
_UNKNOWN _L115553; // weak
_UNKNOWN _L109086; // weak
_UNKNOWN _L109168; // weak
_UNKNOWN _L105130; // weak
_UNKNOWN loc_41D2FA; // weak
_UNKNOWN _L108827; // weak
_UNKNOWN _L110561; // weak
_UNKNOWN _L122495; // weak
int (__cdecl *CAdminAcceptor::`vftable')(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr) = &ZSocketAcceptor<CAdminSocket>::OnComplete; // weak
int (__thiscall *ZList<ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags) = &ZList<ZRef<CAdminSocket>>::`scalar deleting destructor'; // weak
int (__cdecl *ZSocketAcceptor<CAdminSocket>::`vftable')(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr) = &ZSocketAcceptor<CAdminSocket>::OnComplete; // weak
int (__thiscall *ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags) = &ZRecyclableStatic::CallBack::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vector deleting destructor'; // weak
void *ZRefCountedDummy<ZRef<CAdminSocket>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>'} = &ZRefCountedDummy<ZRef<CAdminSocket>>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<ZRef<CAdminSocket>>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<ZRef<CAdminSocket>>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`scalar deleting destructor'; // weak
int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags) = &ZRefCounted::`vector deleting destructor'; // weak
int (__thiscall *ZList<ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags) = &ZList<ZPort::ZPortThread *>::`vector deleting destructor'; // weak
int (__thiscall *ZPort::`vftable')(void *p, unsigned int __flags) = &ZPort::`vector deleting destructor'; // weak
int (__thiscall *ZSocketBuffer::`vftable')(void *p, unsigned int __flags) = &ZSocketBuffer::`vector deleting destructor'; // weak
int (__thiscall *ZPort::ZPortThread::`vftable')(void *p, unsigned int __flags) = &ZPort::ZPortThread::`vector deleting destructor'; // weak
void *ZRefCountedDummy<ZPort::ZPortThread *>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>'} = &ZRefCountedDummy<ZPort::ZPortThread *>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<ZPort::ZPortThread *>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<ZPort::ZPortThread *>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`scalar deleting destructor'; // weak
int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags) = &ZThread::`vector deleting destructor'; // weak
const char *(__thiscall *CAdminSocket::`vftable')(CVerboseObj *__hidden this) = &CVerboseObj::GetLogTail; // weak
void (__thiscall *CAdminSocket::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32) = &ZSocketEx::OnComplete; // weak
int (__thiscall *CAdminSocket::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &CAdminSocket::`vector deleting destructor'; // weak
const char *(__thiscall *CVerboseObj::`vftable')(CVerboseObj *__hidden this) = &CVerboseObj::GetLogTail; // weak
int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags) = &ZList<ZRef<ZSocketBuffer>>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`scalar deleting destructor'; // weak
int (__thiscall *ZSocketEx::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZSocketEx::`vector deleting destructor'; // weak
void (__thiscall *ZSocketEx::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32) = &ZSocketEx::OnComplete; // weak
int (*ZOverlapped::ZICallBack::`vftable'[2])() = { &_purecall, &_purecall }; // weak
void *ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>'} = &ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`scalar deleting destructor'; // weak
_UNKNOWN CAESCipher::bDefaultAESKeyValue; // weak
int (__thiscall *ZMap<long,int,long>::`vftable')(void *p, unsigned int __flags) = &ZMap<long,int,long>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<long,int,long>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<long,int,long>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vector deleting destructor'; // weak
const char *(__thiscall *CCenterSocket::`vftable'{for `CVerboseObj'})(CCenterSocket *__hidden this) = &CCenterSocket::GetLogTail; // weak
void (__thiscall *CCenterSocket::`vftable'{for `ZISocketCallBack'}[6])(CCenterSocket *this, ZSocket *pSocket, int) =
{
  &CCenterSocket::OnSocketAccept,
  &CCenterSocket::OnSocketConnect,
  &CCenterSocket::OnSocketReceive,
  &CCenterSocket::OnSocketSend,
  &CCenterSocket::OnSocketOOB,
  &CCenterSocket::OnSocketClose
}; // weak
int (__thiscall *ZSocket::`vftable')(void *p, unsigned int __flags) = &ZSocket::`vector deleting destructor'; // weak
void (__thiscall *ZISocketCallBack::`vftable'[6])(ZISocketCallBack *this, ZSocket *pSocket, int) =
{
  &ZISocketCallBack::OnSocketAccept,
  &ZISocketCallBack::OnSocketConnect,
  &ZISocketCallBack::OnSocketReceive,
  &ZISocketCallBack::OnSocketSend,
  &ZISocketCallBack::OnSocketOOB,
  &ZISocketCallBack::OnSocketClose
}; // weak
int (__thiscall *ZFixedArray<unsigned char,65536,0>::_ArrayData::`vftable')(void *p, unsigned int __flags) = &ZFixedArray<unsigned char,65536,0>::_ArrayData::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`scalar deleting destructor'; // weak
int (__thiscall *ZIStream::`vftable')(void *p, unsigned int __flags) = &ZIStream::`scalar deleting destructor'; // weak
void *ZRefCountedDummy<ZSocketThread::REQ>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>'} = &ZRefCountedDummy<ZSocketThread::REQ>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<ZSocketThread::REQ>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<ZSocketThread::REQ>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vector deleting destructor'; // weak
void *ZSocketThread::`vftable'{for `ZThread'} = &ZSocketThread::`vector deleting destructor'; // weak
int (__thiscall *ZSocketThread::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZSocketThread::`scalar deleting destructor'; // weak
int (__thiscall *ZList<ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags) = &ZList<ZSocketThread::REQ>::`scalar deleting destructor'; // weak
int (__thiscall *ZMap<void *,ZSocket *,void *>::`vftable')(void *p, unsigned int __flags) = &ZMap<void *,ZSocket *,void *>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<void *,ZSocket *,void *>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<void *,ZSocket *,void *>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZMap<char const *,int,ZXString<char>>::`vftable')(void *p, unsigned int __flags) = &ZMap<char const *,int,ZXString<char>>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable')(void *p, unsigned int __flags) = &ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vector deleting destructor'; // weak
const char *(__thiscall *CClientSocket::`vftable')(CClientSocket *__hidden this) = &CClientSocket::GetLogTail; // weak
void (__thiscall *CClientSocket::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32) = &ZSocketEx::OnComplete; // weak
int (__thiscall *CClientSocket::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &CClientSocket::`vector deleting destructor'; // weak
int (__thiscall *ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable')(void *p, unsigned int __flags) = &ZMap<ZXString<char>,unsigned long,ZXString<char>>::`scalar deleting destructor'; // weak
int (__thiscall *ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable')(void *p, unsigned int __flags) = &ZMap<unsigned long,ZXString<char>,unsigned long>::`scalar deleting destructor'; // weak
int (__thiscall *ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<char const *,int,ZXString<char>>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<char const *,int,ZXString<char>>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`scalar deleting destructor'; // weak
int (__thiscall *GW_ItemSlotEquip::`vftable')(void *p, unsigned int __flags) = &GW_ItemSlotEquip::`scalar deleting destructor'; // weak
int (__thiscall *GW_ItemSlotBundle::`vftable')(void *p, unsigned int __flags) = &GW_ItemSlotBundle::`vector deleting destructor'; // weak
int (__thiscall *GW_ItemSlotPet::`vftable')(void *p, unsigned int __flags) = &GW_ItemSlotPet::`vector deleting destructor'; // weak
int (__thiscall *GW_ItemSlotBase::`vftable')(void *p, unsigned int __flags) = &GW_ItemSlotBase::`vector deleting destructor'; // weak
int (__thiscall *ZMap<long,long,long>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<long,long,long>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<long,unsigned short,long>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<long,unsigned short,long>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`scalar deleting destructor'; // weak
int (__thiscall *ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vector deleting destructor'; // weak
void *ZRefCountedDummy<GW_MiniGameRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>'} = &ZRefCountedDummy<GW_MiniGameRecord>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<GW_MiniGameRecord>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<GW_MiniGameRecord>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable')(void *p, unsigned int __flags) = &ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vector deleting destructor'; // weak
void *ZRefCountedDummy<GW_CoupleRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>'} = &ZRefCountedDummy<GW_CoupleRecord>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<GW_CoupleRecord>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<GW_CoupleRecord>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`scalar deleting destructor'; // weak
void *ZRefCountedDummy<GW_FriendRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>'} = &ZRefCountedDummy<GW_FriendRecord>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<GW_FriendRecord>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<GW_FriendRecord>::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`scalar deleting destructor'; // weak
void *ZRefCountedDummy<GW_MarriageRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>'} = &ZRefCountedDummy<GW_MarriageRecord>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<GW_MarriageRecord>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<GW_MarriageRecord>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vector deleting destructor'; // weak
const char *(__thiscall *CIPCheckerServer::`vftable'{for `CVerboseObj'})(CIPCheckerServer *__hidden this) = &CIPCheckerServer::GetLogTail; // weak
void (__thiscall *CIPCheckerServer::`vftable'{for `ZISocketCallBack'}[6])(CIPCheckerServer *this, ZSocket *pSocket, int) =
{
  &CIPCheckerServer::OnSocketAccept,
  &CIPCheckerServer::OnSocketConnect,
  &CIPCheckerServer::OnSocketReceive,
  &CIPCheckerServer::OnSocketSend,
  &CIPCheckerServer::OnSocketOOB,
  &CIPCheckerServer::OnSocketClose
}; // weak
int (__thiscall *ZList<CLog::FILELOG>::`vftable')(void *p, unsigned int __flags) = &ZList<CLog::FILELOG>::`vector deleting destructor'; // weak
int (__thiscall *CLog::`vftable')(void *p, unsigned int __flags) = &CLog::`scalar deleting destructor'; // weak
int (__stdcall *ZRefCountedDummy<ZFileStream>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>'})(int) = &ZRefCountedDummy<ZFileStream>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<ZFileStream>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<ZFileStream>::`scalar deleting destructor'; // weak
int (__thiscall *ZFileStream::`vftable')(void *p, unsigned int __flags) = &ZFileStream::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`scalar deleting destructor'; // weak
int (__thiscall *_com_error::`vftable')(void *p, unsigned int __flags) = &_com_error::`scalar deleting destructor'; // weak
void *ZRefCountedDummy<CLog::FILELOG>::`vftable'{for `ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>'} = &ZRefCountedDummy<CLog::FILELOG>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<CLog::FILELOG>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<CLog::FILELOG>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`scalar deleting destructor'; // weak
int (__cdecl *CLoginAcceptor::`vftable')(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr) = &ZSocketAcceptor<CClientSocket>::OnComplete; // weak
int (__thiscall *ZMap<unsigned long,unsigned long,unsigned long>::`vftable')(void *p, unsigned int __flags) = &ZMap<unsigned long,unsigned long,unsigned long>::`vector deleting destructor'; // weak
int (__thiscall *ZList<ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags) = &ZList<ZRef<CClientSocket>>::`scalar deleting destructor'; // weak
int (__cdecl *ZSocketAcceptor<CClientSocket>::`vftable')(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr) = &ZSocketAcceptor<CClientSocket>::OnComplete; // weak
int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vector deleting destructor'; // weak
int (__thiscall *ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::`vftable')(void *p, unsigned int __flags) = &ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::`scalar deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vector deleting destructor'; // weak
void *ZRefCountedDummy<ZRef<CClientSocket>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>'} = &ZRefCountedDummy<ZRef<CClientSocket>>::`vector deleting destructor'; // weak
int (__thiscall *ZRefCountedDummy<ZRef<CClientSocket>>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags) = &ZRefCountedDummy<ZRef<CClientSocket>>::`vector deleting destructor'; // weak
int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags) = &ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vector deleting destructor'; // weak
int (__thiscall *CLoginApp::`vftable')(void *p, unsigned int __flags) = &CLoginApp::`scalar deleting destructor'; // weak
int (__thiscall *CSecurityServer::`vftable')(void *p, unsigned int __flags) = &CSecurityServer::`scalar deleting destructor'; // weak
int (__thiscall *TSelfTestThread<CLoginAcceptor>::`vftable')(void *p, unsigned int __flags) = &TSelfTestThread<CLoginAcceptor>::`vector deleting destructor'; // weak
int (__thiscall *CLoginDialog::`vftable')(void *p, unsigned int __flags) = &CLoginDialog::`scalar deleting destructor'; // weak
int (__thiscall *CMachineIDHelper::`vftable')(void *p, unsigned int __flags) = &CMachineIDHelper::`vector deleting destructor'; // weak
int (__thiscall *CMxHelperServerManager::`vftable')(void *p, unsigned int __flags) = &CMxHelperServerManager::`scalar deleting destructor'; // weak
int (__thiscall *CServerApp::`vftable')(void *p, unsigned int __flags) = &CServerApp::`vector deleting destructor'; // weak
int (__thiscall *CServerDialog::`vftable')(void *p, unsigned int __flags) = &CServerDialog::`scalar deleting destructor'; // weak
int ``anonymous namespace'::ZAPILoader::MakeRawKey'::`2'::s_aadwp2[] = { 0 }; // weak
int dword_443AF8[] = { 0 }; // weak
int dword_443BF8[] = { 0 }; // weak
int dword_443CF8[] = { 0 }; // weak
int dword_443DF8[] = { 0 }; // weak
int dword_443EF8[] = { 0 }; // weak
int dword_443FF8[] = { 0 }; // weak
int dword_4440F8[] = { 0 }; // weak
int ``anonymous namespace'::ZAPILoader::_GetS'::`2'::s_aadw[] = { 8520192 }; // weak
int dword_4442F8[] = { 268705796 }; // weak
int dword_4443F8[] = { 1090519040 }; // weak
int dword_4444F8[] = { 1049602 }; // weak
int dword_4445F8[] = { 33554432 }; // weak
int dword_4446F8[] = { 536870928 }; // weak
int dword_4447F8[] = { 4096 }; // weak
int dword_4448F8[] = { 136314912 }; // weak
int (__thiscall *CTimerThread::`vftable')(void *p, unsigned int __flags) = &CTimerThread::`vector deleting destructor'; // weak
_UNKNOWN unk_444A04; // weak
_UNKNOWN unk_444A4C; // weak
void *off_445A4C = &type_info::`RTTI Complete Object Locator'; // weak
char byte_445B80[] = { '' }; // weak
char __lookuptable[] = { '\x06' }; // weak
_UNKNOWN _TI1_AVZException__; // weak
_UNKNOWN _TI1_AV_com_error__; // weak
char aExceptionOccur[] = "Exception occured while accepting local connection"; // idb
char aUncertainAdmin[] = "Uncertain admintool host tried to connect [%s]"; // idb
char aSuspiciousAdmi[62] = "Suspicious admintool host disconnected while identifying [%s]"; // weak
char aUnregisteredHo[] = "Unregistered host tried to connect [%s]"; // idb
char sFormat[] = "%s:%d"; // idb
char aReceivedPacket[] = "Received packet length overflow"; // idb
char aIncorrectPacke[] = "Incorrect packet header sequencing"; // idb
char aIplistGeoiplis[] = "IPList, GeoIPList was reloaded by %s"; // idb
char aSpwModeS[] = "SPW mode %s"; // idb
char aEnabled[8] = "Enabled"; // weak
char aDisabled[9] = "Disabled"; // weak
char aCheckSsnOnCrea[] = "Check SSN On CreateNewCharacter mode %s"; // idb
unsigned int CAESCipher::UserKey = 19u; // idb
unsigned __int16 aAdult[] = { 97u, 100u, 117u, 108u, 116u, 0u }; // idb
unsigned __int16 aBlockcharcreat[] =
{
  66u,
  108u,
  111u,
  99u,
  107u,
  67u,
  104u,
  97u,
  114u,
  67u,
  114u,
  101u,
  97u,
  116u,
  105u,
  111u,
  110u,
  0u
}; // idb
unsigned __int16 aEventdesc[] = { 101u, 118u, 101u, 110u, 116u, 68u, 101u, 115u, 99u, 0u }; // idb
unsigned __int16 aWorldstate[] = { 119u, 111u, 114u, 108u, 100u, 83u, 116u, 97u, 116u, 101u, 0u }; // idb
unsigned __int16 aChannelno[] = { 99u, 104u, 97u, 110u, 110u, 101u, 108u, 78u, 111u, 0u }; // idb
unsigned __int16 aWorld[] = { 119u, 111u, 114u, 108u, 100u, 0u }; // idb
unsigned __int16 aPort[] = { 112u, 111u, 114u, 116u, 0u }; // idb
unsigned __int16 s[] = { 105u, 112u, 0u }; // idb
GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92 = { 2556761561u, 2571u, 18729u, "Oq\x17{" };
GUID _GUID_00020404_0000_0000_c000_000000000046 = { 132100u, 0u, 0u, "F" };
char aLu[] = "%lu"; // idb
char aLi[4] = "%li"; // weak
char asc_4543B8[3] = "%f"; // weak
char Format[] = "%lf"; // idb
char aCenterSocketCl[] = "Center socket closed"; // idb
char aFailedInConn_1[] = "Failed in connecting to center socket"; // idb
char aCenterSocketCo[] = "Center socket connected successfully"; // idb
char aCentersocketip[] = "CenterSocketIP is missing"; // idb
unsigned __int16 aPrivateip[] = { 80u, 114u, 105u, 118u, 97u, 116u, 101u, 73u, 80u, 0u }; // idb
char aSD_1[6] = "%s-%d"; // weak
char aSOver20[10] = "%s-Over20"; // weak
char aSOver20d[11] = "%s-Over20d"; // weak
char aDecryptdataFai[] = "DecryptData Failed"; // idb
unsigned __int16 aNumber[] = { 78u, 117u, 109u, 98u, 101u, 114u, 0u }; // idb
unsigned __int16 aStringTesteula[] =
{
  83u,
  116u,
  114u,
  105u,
  110u,
  103u,
  47u,
  84u,
  101u,
  115u,
  116u,
  69u,
  85u,
  76u,
  65u,
  46u,
  105u,
  109u,
  103u,
  47u,
  86u,
  101u,
  114u,
  115u,
  105u,
  111u,
  110u,
  0u
}; // idb
GUID _GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38 = { 2533930999u, 3430u, 18406u, "xLo8" };
char aInvalidChannel[] = "Invalid channel id"; // idb
char aUserTriedToLog[] = "User tried to login with invalid account."; // idb
char aNewCharacterHa[] = "New character has invalid stat value (%d,%s):%d,%d,%d,%d"; // idb
char aAliveCheckFail[] = "Alive check failed : Time-out"; // idb
char aAdminJobFoundI[] = "Admin-job found in non-admin account : %s"; // idb
char aAdminclientWit[] = "Adminclient with not-internal IP detected."; // idb
char aPincodeCheckFa[] = "Pincode Check failed 5 times. Last tried AccountID : %d"; // idb
char aInvalidAccount[] = "Invalid AccountID. origin : %d, received: %d"; // idb
char aVacRequestDoub[] = "VAC Request doubled."; // idb
char aAliveCheckFa_1[] = "Alive check failed : Ack lost"; // idb
char aClientSocketDi[] = "Client socket disconnected"; // idb
char aSS[] = "(%s)\r\n%s\r\n\r\n"; // idb
char aUserTriedToSel[] = "User tried to select world without PinCode Check."; // idb
char asc_454C8C[5] = " \t\r\n"; // weak
GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf = { 1474290699u, 15904u, 19900u, "ZP" };
unsigned __int32 *CCrc32::ms_adwCrc32Table = NULL; // weak
char aDI64d[] = "%d:%I64d"; // idb
char aDDDDDDDDDDDDDD[] = "-%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%s,%d"; // idb
char aDSD[] = "-%d,%s,%d"; // idb
char aSDDDI64dDD[] = "-%s,%d,%d,%d,%I64d,%d,%d"; // idb
char aCashItemPositi[] = "Cash item position crashed while decoding [CID:%d,%d->%d]"; // idb
char aLackOfCashItem[] = "Lack of cash item info from game server while decoding [CID:%d,%d]"; // idb
char aDDD[] = "%d/%d/%d"; // idb
unsigned __int16 aIpcheck_img[] = { 73u, 80u, 67u, 104u, 101u, 99u, 107u, 46u, 105u, 109u, 103u, 0u }; // idb
unsigned __int16 aSkipcrc[] = { 115u, 107u, 105u, 112u, 99u, 114u, 99u, 0u }; // idb
unsigned __int16 aMaster[] = { 109u, 97u, 115u, 116u, 101u, 114u, 0u }; // idb
unsigned __int16 aInternal[] = { 105u, 110u, 116u, 101u, 114u, 110u, 97u, 108u, 0u }; // idb
unsigned __int16 aMask[] = { 109u, 97u, 115u, 107u, 0u }; // idb
char aIpcheckerserve[16] = "IPCheckerServer"; // weak
char aFailedInConnec[] = "Failed in connecting to IPCheckerServer-server"; // idb
char aIpcheckerser_2[] = "IPCheckerServer-server connected"; // idb
char aNoIpcheckerser[] = "No IPCheckerServer address in configuration file"; // idb
unsigned __int16 aIpcheckerser_1[] =
{
  105u,
  112u,
  67u,
  104u,
  101u,
  99u,
  107u,
  101u,
  114u,
  83u,
  101u,
  114u,
  118u,
  101u,
  114u,
  0u
}; // idb
unsigned __int16 aEndip[] = { 101u, 110u, 100u, 73u, 112u, 0u }; // idb
unsigned __int16 aBeginip[] = { 98u, 101u, 103u, 105u, 110u, 73u, 112u, 0u }; // idb
unsigned __int16 aBlockS[] = { 66u, 108u, 111u, 99u, 107u, 47u, 37u, 115u, 0u }; // idb
unsigned __int16 aData[] = { 68u, 97u, 116u, 97u, 0u }; // idb
unsigned __int16 aDwmaxunlimited[] =
{
  100u,
  119u,
  77u,
  97u,
  120u,
  85u,
  110u,
  108u,
  105u,
  109u,
  105u,
  116u,
  101u,
  100u,
  65u,
  99u,
  99u,
  111u,
  117u,
  110u,
  116u,
  73u,
  68u,
  0u
}; // idb
unsigned __int16 aBblocktypeever[] =
{
  98u,
  66u,
  108u,
  111u,
  99u,
  107u,
  84u,
  121u,
  112u,
  101u,
  69u,
  118u,
  101u,
  114u,
  121u,
  119u,
  104u,
  101u,
  114u,
  101u,
  0u
}; // idb
unsigned __int16 aInfo[] = { 73u, 110u, 102u, 111u, 0u }; // idb
unsigned __int16 aIplist_img[] = { 73u, 80u, 76u, 105u, 115u, 116u, 46u, 105u, 109u, 103u, 0u }; // idb
unsigned __int16 aGeoiplist_img[] = { 71u, 101u, 111u, 73u, 80u, 76u, 105u, 115u, 116u, 46u, 105u, 109u, 103u, 0u }; // idb
char aMismatchedGeog[] = "Mismatched Geographical IP info on IP [%s] - IPList : %d  GeoIP : %d"; // idb
char aInCiprangeSetr[] = "In CIPRange::SetRange(), Begin > End (%s, %s)"; // idb
char aCMslogS_02d02d[] = "C:\\MSLog\\%s_%02d%02d%02d%02d%02d.log"; // idb
char aCMslog[9] = "C:\\MSLog"; // weak
char Str[] = " "; // idb
char aAcceptError2U[] = "Accept error(2) : [%u]"; // idb
char aAcceptError3U[] = "Accept error(3) : [%u]"; // idb
char aConnectionAcce[] = "Connection accepted [%s]"; // idb
char aIpConnection_2[] = "IP Connection Counting > 10 [%s]"; // idb
char aIpConnection_1[] = "IP Connection Counting > 30 [%s]"; // idb
char aIpConnectionCo[] = "IP Connection Counting > 5000"; // idb
char aConnectionRefu[] = "Connection refused [%s]"; // idb
char aAcceptError1U[] = "Accept error(1) : [%u]"; // idb
char aIpblock[8] = "IPBlock"; // weak
char aGuard[6] = "Guard"; // weak
char aElog[5] = "ELog"; // weak
unsigned __int16 aDbglobalaccoun[] =
{
  100u,
  98u,
  71u,
  108u,
  111u,
  98u,
  97u,
  108u,
  65u,
  99u,
  99u,
  111u,
  117u,
  110u,
  116u,
  83u,
  111u,
  117u,
  114u,
  99u,
  101u,
  0u
}; // idb
unsigned __int16 aDbcataloggloba[] =
{
  100u,
  98u,
  67u,
  97u,
  116u,
  97u,
  108u,
  111u,
  103u,
  71u,
  108u,
  111u,
  98u,
  97u,
  108u,
  65u,
  99u,
  99u,
  111u,
  117u,
  110u,
  116u,
  0u
}; // idb
unsigned __int16 sUOL[] =
{
  68u,
  97u,
  116u,
  97u,
  98u,
  97u,
  115u,
  101u,
  35u,
  85u,
  110u,
  105u,
  102u,
  105u,
  101u,
  100u,
  68u,
  66u,
  0u
}; // idb
char aInvalidConfigu[] = "Invalid configuration file format"; // idb
char aConfigurationP[] = "Configuration parsed successfully"; // idb
unsigned __int16 aCenter[] = { 99u, 101u, 110u, 116u, 101u, 114u, 0u }; // idb
char aClientsocketip[] = "ClientSocketIP is missing"; // idb
char aSocketAcceptor[] = "Socket acceptor started"; // idb
char aFailedInInitia[] = "Failed in initializing socket acceptor"; // idb
unsigned __int16 aPublicip[] = { 80u, 117u, 98u, 108u, 105u, 99u, 73u, 80u, 0u }; // idb
char aAdminToolAccep[] = "Admin Tool acceptor started"; // idb
char aFailedInCreati[] = "Failed in creating admin acceptor"; // idb
unsigned __int16 aAdminport[] = { 97u, 100u, 109u, 105u, 110u, 80u, 111u, 114u, 116u, 0u }; // idb
char aTimerThreadSta[] = "Timer thread started"; // idb
char aFailedInInit_1[] = "Failed in initializing timer thread"; // idb
unsigned __int16 aEtcMakechari_1[] =
{
  69u,
  116u,
  99u,
  47u,
  77u,
  97u,
  107u,
  101u,
  67u,
  104u,
  97u,
  114u,
  73u,
  110u,
  102u,
  111u,
  46u,
  105u,
  109u,
  103u,
  47u,
  73u,
  110u,
  102u,
  111u,
  47u,
  67u,
  104u,
  97u,
  114u,
  70u,
  101u,
  109u,
  97u,
  108u,
  101u,
  0u
}; // idb
unsigned __int16 aEtcMakecharinf[] =
{
  69u,
  116u,
  99u,
  47u,
  77u,
  97u,
  107u,
  101u,
  67u,
  104u,
  97u,
  114u,
  73u,
  110u,
  102u,
  111u,
  46u,
  105u,
  109u,
  103u,
  47u,
  73u,
  110u,
  102u,
  111u,
  47u,
  67u,
  104u,
  97u,
  114u,
  77u,
  97u,
  108u,
  101u,
  0u
}; // idb
unsigned __int16 aEtcCurse_img[] = { 69u, 116u, 99u, 47u, 67u, 117u, 114u, 115u, 101u, 46u, 105u, 109u, 103u, 0u }; // idb
unsigned __int16 aEtcForbiddenna[] =
{
  69u,
  116u,
  99u,
  47u,
  70u,
  111u,
  114u,
  98u,
  105u,
  100u,
  100u,
  101u,
  110u,
  78u,
  97u,
  109u,
  101u,
  46u,
  105u,
  109u,
  103u,
  0u
}; // idb
char aSelfTestThread[] = "Self test thread started %d"; // idb
char aFailedInInit_2[] = "Failed in initializing self test thread"; // idb
char aSymsetoptions[] = "SymSetOptions"; // idb
char aMinidumpwrited[] = "MiniDumpWriteDump"; // idb
char aSymgetlinefrom[] = "SymGetLineFromAddr"; // idb
char aSymgetsymfroma[] = "SymGetSymFromAddr"; // idb
char aSymgetmoduleba[] = "SymGetModuleBase"; // idb
char aSymfunctiontab[] = "SymFunctionTableAccess"; // idb
char aStackwalk[] = "StackWalk"; // idb
char aSymcleanup[] = "SymCleanup"; // idb
char ProcName[] = "SymInitialize"; // idb
char LibFileName[] = "DBGHELP.DLL"; // idb
_UNKNOWN aD02d02d02d02d0; // weak
char PathName[] = "C:\\MachineId"; // idb
char aCMachineidMi04[] = "C:\\MachineId\\Mi%04d%02d%02d"; // idb
char PADDING[64] =
{
  '',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // idb
char isName[] = "MI"; // idb
char aMd[] = "MD"; // idb
char aWy[] = "WY"; // idb
char aLp[] = "LP"; // idb
char aMl[] = "ML"; // idb
char *g_aTxtCodeReverse = NULL; // weak
char a02x[] = "%02x "; // idb
_UNKNOWN g_aScramble16; // weak
char byte_45912D[] = { '' }; // weak
_UNKNOWN g_aReverse16; // weak
char byte_47912D[] = { '' }; // weak
unsigned __int16 sDesc[] =
{
  67u,
  97u,
  110u,
  110u,
  111u,
  116u,
  32u,
  102u,
  105u,
  110u,
  100u,
  32u,
  100u,
  97u,
  116u,
  97u,
  32u,
  102u,
  111u,
  108u,
  100u,
  101u,
  114u,
  0u
}; // idb
char aS_img[] = "%s.img"; // idb
char asc_499164[] = "/"; // idb
unsigned __int16 a__Datasvr_1[] = { 46u, 46u, 47u, 68u, 97u, 116u, 97u, 83u, 118u, 114u, 0u }; // idb
char FileName[] = "../DataSvr"; // idb
unsigned __int16 aNamespaceFiles[] =
{
  78u,
  97u,
  109u,
  101u,
  83u,
  112u,
  97u,
  99u,
  101u,
  35u,
  70u,
  105u,
  108u,
  101u,
  83u,
  121u,
  115u,
  116u,
  101u,
  109u,
  0u
}; // idb
unsigned __int16 aNamespace[] = { 78u, 97u, 109u, 101u, 83u, 112u, 97u, 99u, 101u, 0u }; // idb
unsigned __int16 aResman[] = { 82u, 101u, 115u, 77u, 97u, 110u, 0u }; // idb
GUID _GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d = { 720300854u, 42209u, 20011u, "o.{=" };
GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5 = { 892175957u, 20964u, 18024u, "\bf" };
GUID _GUID_1cf2b120_547d_101b_8e65_08002b2bd119 = { 485667104u, 21629u, 4123u, "e\b++\x19" };
char aDDD02d02d02d[] = "%d/%d/%d %02d:%02d:%02d"; // idb
char Text[] = "This server is running now!\r\nAre you sure to close the server?"; // idb
char Caption[] = "Confirm to close"; // idb
char *`anonymous namespace'::s_asDllName[9] =
{
  "Kernel32.dll",
  "User32.dll",
  "Ole32.dll",
  "GDI32.dll",
  "ADVAPI32.dll",
  "SHELL32.dll",
  "IMM32.dll",
  "WINMM.dll",
  "WS2_32.DLL"
}; // weak
int (__thiscall *ZFatalSection::_s_pfnTry)(_DWORD) = &ZFatalSection::_TryI; // weak
char aPcinitmodule[] = "PcInitModule"; // idb
wchar_t aPcom_dll[9] = L"PCOM.DLL"; // weak
char aPcrootnamespac[] = "PcRootNameSpace"; // idb
char aPcserializestr[] = "PcSerializeString"; // idb
char aPcserializeobj[] = "PcSerializeObject"; // idb
char aPcfreeunusedli[] = "PcFreeUnusedLibraries"; // idb
char aPccreateobject[] = "PcCreateObject"; // idb
char aPctermmodule[] = "PcTermModule"; // idb
char aZtl_deadlock[13] = "ZTL_DEADLOCK"; // weak
char aNtdll_dll[10] = "NTDLL.DLL"; // weak
char aStack_overflow[15] = "STACK_OVERFLOW"; // weak
char aPriv_instructi[17] = "PRIV_INSTRUCTION"; // weak
char aInt_overflow[13] = "INT_OVERFLOW"; // weak
char aInt_divide_by_[19] = "INT_DIVIDE_BY_ZERO"; // weak
char aFlt_underflow[14] = "FLT_UNDERFLOW"; // weak
char aFlt_stack_chec[16] = "FLT_STACK_CHECK"; // weak
char aFlt_overflow[13] = "FLT_OVERFLOW"; // weak
char aFlt_invalid_op[22] = "FLT_INVALID_OPERATION"; // weak
char aFlt_inexact_re[19] = "FLT_INEXACT_RESULT"; // weak
char aFlt_divide_by_[19] = "FLT_DIVIDE_BY_ZERO"; // weak
char aFlt_denormal_o[21] = "FLT_DENORMAL_OPERAND"; // weak
char aInvalid_handle[15] = "INVALID_HANDLE"; // weak
char aIllegal_instru[20] = "ILLEGAL_INSTRUCTION"; // weak
char aNoncontinuable[25] = "NONCONTINUABLE_EXCEPTION"; // weak
char aInvalid_dispos[20] = "INVALID_DISPOSITION"; // weak
char aArray_bounds_e[22] = "ARRAY_BOUNDS_EXCEEDED"; // weak
char aIn_page_error[14] = "IN_PAGE_ERROR"; // weak
char aGuard_page[11] = "GUARD_PAGE"; // weak
char aDatatype_misal[22] = "DATATYPE_MISALIGNMENT"; // weak
char aBreakpoint[11] = "BREAKPOINT"; // weak
char aSingle_step[12] = "SINGLE_STEP"; // weak
char aAccess_violati[17] = "ACCESS_VIOLATION"; // weak
char a08x08x04x08xS[] = "%08X  %08X  %04X:%08X %s\r\n"; // idb
char aAddressFrameLo[] = "Address   Frame     Logical addr  Module\r\n"; // idb
char aCallStack[] = "\r\nCall stack:\r\n"; // idb
char a04x08xS[] = "%04X:%08X [%s]\r\n"; // idb
char aHsXS[16] = "%hs()+%X [%s]\r\n"; // weak
char aHsHsLuS[] = "%hs() %hs(%lu) [%s]\r\n"; // idb
char a08x08x[] = "%08X  %08X  "; // idb
char aAddressFrame[] = "Address   Frame\r\n"; // idb
char aGamestartmodeW[] = "GameStartMode: Web : %d, Game : %d, Total Percentage Web : %.4f%%, Game : %.4f%%"; // idb
char aCheckpasswordD[] = "CheckPassword: %d called, total: %d ms, avg: %.2lf ms"; // idb
LPCSTR s_sMsgBoxCaption = "Error Message"; // idb
char sText[] = "! cannot create system-wide mutex"; // idb
char aWvsmutexS[] = "WvsMutex/%s"; // idb
char aErrorCodeDSS[] = "error code : %d (%s) - %s"; // idb
char aErrorCodeDS[] = "error code : %d (%s)"; // idb
char aUnknownError0x[] = "Unknown error 0x%0lX"; // idb
char aIdispatchError[20] = "IDispatch error #%d"; // weak
unsigned __int8 *CIGCipher::bShuffle = (unsigned __int8 *)0xA4773FEC; // weak
char aInitgameguarda[] = "InitGameguardAuth failed. (err: %d)"; // idb
unsigned __int16 aExe[] = { 101u, 120u, 101u, 0u }; // idb
unsigned __int16 aLD[] = { 108u, 37u, 100u, 0u }; // idb
unsigned __int16 aPD[] = { 112u, 37u, 100u, 0u }; // idb
unsigned __int16 aDiff[] = { 100u, 105u, 102u, 102u, 0u }; // idb
char aNoCrcInfo[] = "No CRC info"; // idb
unsigned __int16 aCmap_img[] = { 99u, 109u, 97u, 112u, 46u, 105u, 109u, 103u, 0u }; // idb
char aSecurityFailed[] = "Security failed: No Memory Hash [%s]"; // idb
char aSecurityFail_2[] = "Security failed: GameGuardAuth packet didn't returned [%s]"; // idb
char aSecurityFail_1[] = "Security failed: GameGuardAuthHash(%d) [%s]"; // idb
char aSecurityFail_3[] = "Security failed: GameGuardAuth packet came in wrong sequence [%s]"; // idb
char aSecurityFail_4[] = "Security failed: GameGuardAuth(%d) [%s]"; // idb
char sTail[] = "GGAuth"; // idb
char aS[] = "%s"; // idb
char aGgauthVersionU[] = "GGAuth version update [%s] : [%ld] -> [%ld] \n"; // idb
char aProtocolNum[13] = "Protocol Num"; // weak
char aGameguardVer[14] = "GameGuard Ver"; // weak
char aCSLibInitgam_0[] = "[C$][S lib] InitGameguardAuth(%s) COMPLETED!"; // idb
unsigned __int8 a_sauT2Ky[] = { 64u, 83u, 65u, 85u, 94u, 84u, 50u, 42u, 75u, 89u, 0u }; // idb
char aCSLibInvalid_0[] = "[C$][S lib] Invalid GGVer Limit value[%ld]. Disabled GGVer limitation."; // idb
char aCSLibFailToLoa[68] = "[C$][S lib] Fail to load GGVer Limit file(%s) FAIL TO OPEN CFG FILE"; // weak
char aCSLibSuccessLo[] = "[C$][S lib] SUCCESS LOAD CFG : %s"; // idb
char aCSLibFailLdLoa[] = "[C$][S lib] Fail[%ld] LoadAuthProtocol(%s)"; // idb
char aCSLibFailToL_0[] = "[C$][S lib] Fail to load GGVer Limit at file(%s). Disabled GGVer limitation."; // idb
char aCsver_cfg[10] = "csver.cfg"; // weak
char aCSLibLoadAddit[] = "[C$][S lib] LOAD ADDITIONAL PROTOCOL : %s"; // idb
char aCSLibLoadDefau[] = "[C$][S lib] LOAD DEFAULT PROTOCOL : %s"; // idb
char aSggauthD_dll[] = "%sggauth%d.dll"; // idb
char aCSLibInitgameg[] = "[C$][S lib] InitGameguardAuth() LOAD PROTOCOL NUMBER LIST : %d"; // idb
char aCSLibFailLoa_0[] = "[C$][S lib] Fail LoadAuthProtocol(%s) FAIL TO LOAD CFG FILE"; // idb
char aCSLibBeforeCle[] = "[C$][S lib] Before CleanupGameguardAuth() "; // idb
char aD[] = "%d"; // idb
char aCSLibSuccessOp[] = "[C$][S lib] SUCCESS OPEN CFG FILE : %s"; // idb
char aCSLibFailLoada[] = "[C$][S lib] Fail LoadAuthProtocol(%s) FAIL TO OPEN CFG FILE"; // idb
char Mode[] = "r"; // idb
char aSS_0[] = "%s%s"; // idb
char aCsauth2_cfg[12] = "csauth2.cfg"; // weak
char aSC[] = "%s%c"; // idb
char aCSLibCleanupga[] = "[C$][S lib] CleanupGameguardAuth()"; // idb
char aCSLibCleanup_0[] = "[C$][S lib] CleanupGameguardAuth() FREE LIST pProtocol[0x%x] dwVersion[0x%lx] pNext[0x%x] pProtocol->pBefore[0x%x]"; // idb
char aCSLibUpdatetim[] = "[C$][S lib] UpdateTimer Call [%lx] %d/%d/%d %d:%d:%d"; // idb
char aCSLibAddauthpr[] = "[C$][S lib] AddAuthProtocol(%s)"; // idb
char aCSLibInvalidGg[] = "[C$][S lib] Invalid GGVer Limit value[%ld]. Set the default value."; // idb
char aLd[] = "%ld"; // idb
char aCSLibSFailToOp[] = "[C$][S lib] (%s) FAIL TO OPEN CFG FILE"; // idb
char aW[] = "w"; // idb
char aCSLibTooLowerV[] = "[C$][S lib] Too lower value [%ld] <= default [%ld]. Set the default value."; // idb
char aCSLibFailGetpr[] = "[C$][S lib] Fail GetProc() [0x%x][0x%x][0x%x][0x%x][0x%x] : %s\n"; // idb
char aCSLib[] = "[C$][S lib] --------------------------------"; // idb
char aCSLibTotalLoad[] = "[C$][S lib] ## TOTAL LOADED PROTOCOL NUM : %ld"; // idb
char aCSLib_0[] = "[C$][S lib] ==>"; // idb
char aCSLibVer0xLxPt[] = "[C$][S lib] ## [ver 0x%lx][ptr 0x%x] : pN [0x%x], pB[0x%x]"; // idb
char aCSLibLoadauthp[] = "[C$][S lib] ## LoadAuthProtocol PATH : %s"; // idb
char aCSLibProtocolS[] = "[C$][S lib] ---------PROTOCOL STATE---------"; // idb
char aCSLibAddANewPr[] = "[C$][S lib] Add a new protocol : [ver 0x%lx][ptr 0x%x] : pN [0x%x], pB[0x%x]"; // idb
char aCSLibGgglobal_[] = "[C$][S lib] ggGlobal.pProtocolHead : 0x%lx"; // idb
char aPrtcupdatetime[] = "PrtcUpdateTimer"; // idb
char aPrtcdecryptans[] = "PrtcDecryptAnswer"; // idb
char aPrtcencryptque[] = "PrtcEncryptQuery"; // idb
char aPrtccheckautha[] = "PrtcCheckAuthAnswer"; // idb
char aPrtcgetauthque[] = "PrtcGetAuthQuery"; // idb
char aPrtcgetversion[] = "PrtcGetVersion"; // idb
char aCSLibFailLoadl[] = "[C$][S lib] Fail LoadLibrary : %s\n"; // idb
char aCSLibUnloadaut[] = "[C$][S lib] UnloadAuthProtocol(0x%x)"; // idb
char aCSLibUpdateg_4[] = "[C$][S lib] UpdateGGVersion() : Invalid gamegaurd version [%ld] "; // idb
char aCSLibUpdateg_8[] = "[C$][S lib] UpdateGGVersion() error #1026 [%ld]"; // idb
char aCSLibLdLdLdL_0[] = "[C$][S lib] [%ld]:[%ld][%ld][%ld][%ld], "; // idb
char aCSLibUpdate_15[] = "[C$][S lib] UpdateGGVersion() : insert new GG version to new GG version list [%ld]:[%ld][%ld][%ld][%ld], "; // idb
char aCSLibLdLdLdLdL[65] = "[C$][S lib]                      -> [%ld]:[%ld][%ld][%ld][%ld], "; // weak
char aCSLibUpdateg_6[] = "[C$][S lib] UpdateGGVersion() : add a new GG version to the GGversion list[%ld] . 1hour time out and lower users [%ld]:[%ld][%ld][%ld][%ld], "; // idb
char aCSLibUpdateg_2[127] = "[C$][S lib] UpdateGGVersion() : add a new GG version to the GG version list[%ld] . OLDEST VERSION [%ld]:[%ld][%ld][%ld][%ld], "; // weak
char aCSLibUpdate_14[] = "[C$][S lib] UpdateGGVersion() : GGVer < new Version[%ld] NEW VERSION count up [%ld]:[%ld][%ld][%ld][%ld]"; // idb
char aCSLibUpdateggv[] = "[C$][S lib] UpdateGGVersion() : New GGVer can not find at list that it accepted condition. Reset all of data."; // idb
char aCSLibUpdateg_0[] = "[C$][S lib] UpdateGGVersion() : New GG version accept[%ld] !!!!!!!!!!!!!!!!!"; // idb
char aCSLibUpdateg_7[] = "[C$][S lib] UpdateGGVersion() ------------------------------"; // idb
char aCSLibCurrentVe[] = "[C$][S lib] CURRENT VER : %ld"; // idb
char aCSLibLdLdLdL_1[] = "[C$][S lib] [%ld]:[%ld][%ld][%ld][%ld]: %ld%%, "; // idb
char aCSLibUpdateg_5[] = "[C$][S lib] UpdateGGVersion() -----GG Ver Update RESULT-----"; // idb
char aCSLibUpdateg_1[] = "[C$][S lib] UpdateGGVersion() : New GGVer[%ld] find that it accepted condition[%ld/%ld]  [%ld%%] > [%d%%]"; // idb
char aCSLibUpdateg_9[] = "[C$][S lib] UpdateGGVersion() : New GG version Count start [%ld]:[%ld]"; // idb
char aCSLibUpdateg_3[] = "[C$][S lib] UpdateGGVersion() : Limited gamegaurd version [%ld] > [%ld] "; // idb
char aCSLibUpdate_12[] = "[C$][S lib] UpdateProtocol() : Invalid protocol version [%lx] "; // idb
char aCSLibUpdatep_9[] = "[C$][S lib] UpdateProtocol() error #1036 [%lx]"; // idb
char aCSLibUpdatep_4[] = "[C$][S lib] UpdateProtocol() ------------------------------------"; // idb
char aCSLibCurrent_0[] = "[C$][S lib] CURRENT VER : %lx"; // idb
char aCSLibLdLxLdLdL[] = "[C$][S lib] [%ld]:[%lx][%ld][%ld][%ld], "; // idb
char aCSLibUpdate_13[] = "[C$][S lib] UpdateProtocol() -----Protocol Ver Update RESULT-----"; // idb
char aCSLibUpdatep_0[] = "[C$][S lib] UpdateProtocol() : insert a new Protocol version to the Protocol version list [%ld]:[%lx][%ld][%ld][%ld], "; // idb
char aCSLibLdLxLdL_1[65] = "[C$][S lib]                      -> [%ld]:[%lx][%ld][%ld][%ld], "; // weak
char aCSLibUpdatep_6[] = "[C$][S lib] UpdateProtocol() : add a new Protocol version to the Protocol version list[%lx] . 1hour time out and lower users [%ld]:[%lx][%ld][%ld][%ld], "; // idb
char aCSLibUpdatep_8[138] = "[C$][S lib] UpdateProtocol() : add a new Protocol version to the Protocol version list[%lx] . OLDEST VERSION [%ld]:[%lx][%ld][%ld][%ld], "; // weak
char aCSLibUpdate_16[] = "[C$][S lib] UpdateProtocol() : PrtcVer < new Version[%lx] NEW VERSION count up [%ld]:[%lx][%ld][%ld][%ld]"; // idb
char aCSLibUpdatep_3[] = "[C$][S lib] UpdateProtocol() : New Protocol version can not find at list that it accepted condition. Reset all of data."; // idb
char aCSLibUpdatepro[] = "[C$][S lib] UpdateProtocol() : NEW PROTOCOL ACTIVE!!!!!!! [0x%lx]:[%ld][%ld], "; // idb
char aCSLibUpdate_10[] = "[C$][S lib] UpdateProtocol() error #1035 [%d]:[%lx]"; // idb
char aCSLibUpdatep_1[] = "[C$][S lib] UpdateProtocol() ------------------------------"; // idb
char aCSLibCurrentPr[] = "[C$][S lib] CURRENT PRTC : %lx"; // idb
char aCSLibLdLxLdL_0[] = "[C$][S lib] [%ld]:[%lx][%ld][%ld][%ld]: %ld%%, "; // idb
char aCSLibUpdatep_7[] = "[C$][S lib] UpdateProtocol() -----GG Ver Update RESULT-----"; // idb
char aCSLibUpdatep_2[] = "[C$][S lib] UpdateProtocol() : New PrtcNew[%lx] find that it accepted condition[%ld/%ld] and [%ld%%] > [%d%%]"; // idb
char aCSLibUpdatep_5[] = "[C$][S lib] UpdateProtocol() : New Protocol version Count start [%lx]:[%ld]"; // idb
char aCSLibUpdate_11[63] = "[C$][S lib] UpdateProtocol() : Invalid protocol instance [%p] "; // weak
char aCSLibCloseDwre[] = "[C$][S lib] Close() : dwReferCount does not decrement(m_dwUserFlag & PRTC_USER_NEW_PRTC) : %ld"; // idb
char aCSLibServerCcs[] = "[C$][S lib] [SERVER] ~CCSAuth2() CALL DENIED m_dwUserFlag != PRTC_USER_ACTIVE "; // idb
char aCSLibPrtcgetau[] = "[C$][S lib] PrtcGetAuthQuery() : ERROR_UNKNOWN [%ld]"; // idb
char aCSLibPrtcget_0[] = "[C$][S lib] PrtcGetAuthQuery() : ERROR_GGAUTH_NO_REPLY"; // idb
char aCSLibGetauthqu[] = "[C$][S lib] GetAuthQuery() m_pProtocol = NULL"; // idb
char aCSLibGetauth_0[41] = "[C$][S lib] GetAuthQuery() m_bActive = 0"; // weak
char aCSLibCheckau_3[] = "[C$][S lib] CheckAuthAnswer() : New GGVer Receive [%ld]. "; // idb
char aCSLibPrtcche_0[] = "[C$][S lib] PrtcCheckAuthAnswer() : ERROR_UNKNOWN [%ld]"; // idb
char aCSLibPrtccheck[] = "[C$][S lib] PrtcCheckAuthAnswer() : ERROR_GGAUTH_INVALID_REPLY"; // idb
char aCSLibCheckau_6[] = "[C$][S lib] CheckAuthAnswer() : GGVerLimit[%ld] > tmpAnswer.dwValue2[%ld] ERROR_GGAUTH_INVALID_GAMEGUARD_VER"; // idb
char aCSLibCheckau_0[104] = "[C$][S lib] CheckAuthAnswer() : GGVer[%ld] > tmpAnswer.dwValue2[%ld] ERROR_GGAUTH_INVALID_GAMEGUARD_VER"; // weak
char aCSLibCheckau_2[] = "[C$][S lib] CheckAuthAnswer() : PROTOCOL CHECKER tmpAnswer.dwIndex[0x%lx] < m_pProtocol->dwVersion[0x%lx] "; // idb
char aCSLibCheckauth[158] = "[C$][S lib] CheckAuthAnswer() : PROTOCOL CHECKER tmpAnswer.dwIndex[0x%lx] != m_pProtocol->dwVersion[0x%lx] && m_AuthQueryTmp.dwIndex != PROTOCOL_INDEX_CHKVER"; // weak
char aCSLibCheckau_4[143] = "[C$][S lib] CheckAuthAnswer() : PROTOCOL CHECKER tmpAnswer.dwIndex[0x%lx] != m_pProtocol->dwVersion[0x%lx] && PROTOCOL IS NOT IN PROTOCOL LIST"; // weak
char aCSLibCheckau_5[] = "[C$][S lib] CheckAuthAnswer() : PROTOCOL CHECKER tmpAnswer.dwIndex[0x%lx] == m_pProtocol->dwVersion[0x%lx] && FIND AT PROTOCOL LIST"; // idb
char aCSLibCheckau_1[] = "[C$][S lib] CheckAuthAnswer() : PROTOCOL CHECKER tmpAnswer.dwIndex[0x%lx] != m_pProtocol->dwVersion[0x%p] && FIND NEXT => : [%lx]"; // idb
char aCSLibCcsauth2C[] = "[C$][S lib] CCSAuth2::CheckAuthAnswer() [%08lx][%08lx][%08lx][%08lx]"; // idb
char aCSLibCheckau_7[] = "[C$][S lib] CheckAuthAnswer() m_pProtocol = NULL"; // idb
char aCSLibCheckau_8[44] = "[C$][S lib] CheckAuthAnswer() m_bActive = 0"; // weak
char aCSLibSetcsau_0[] = "[C$][S lib] SetCSAuthState() : 'm_PrtcTemp' is NULL!!!"; // idb
char aCSLibSetcsauth[58] = "[C$][S lib] SetCSAuthState() : 'm_CSAuthState' is NULL!!!"; // weak
char aPrtc0x08lxC0x0[] = "PRTC[0x%08lx]C[0x%08lx]G[0x%08lx]E[0x%08lx]D[0x%08lx]U[0x%08lx] : state[%s] ==> "; // idb
char aDisuse[7] = "DISUSE"; // weak
char aStandby[8] = "STANDBY"; // weak
char aActive[7] = "ACTIVE"; // weak
GUID _GUID_df0b3d60_548f_101b_8e65_08002b2bd119 = { 3742055776u, 21647u, 4123u, "e\b++\x19" };
GUID _GUID_00020400_0000_0000_c000_000000000046 = { 132096u, 0u, 0u, "F" };
int (*_FPmtinit)(void) = &_fpclear; // weak
int __app_type = 2; // weak
DWORD __tlsindex = 4294967295u; // idb
char *__nullstring = "(null)"; // idb
wchar_t *__wnullstring = L"(null)"; // weak
_UNKNOWN unk_49C760; // weak
int dword_49C764[] = { 22 }; // weak
_UNKNOWN _XcptActTab; // weak
void *__old_small_block_heap = &__old_small_block_heap; // weak
LPVOID lpMem = &__old_small_block_heap; // idb
int dword_49C968 = 4294967295; // weak
void **off_49E978 = &__old_small_block_heap; // weak
int __old_sbh_threshold = 480; // weak
int (__cdecl *_cfltcvt_tab)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = &_fptrap; // weak
const unsigned __int16 *_pctype = &word_49EB02;
const wctype_t *_pwctype = &word_49EB02;
__int16 word_49EB02[] = { 32 }; // weak
int __mb_cur_max = 1;
int dword_49ED38[] = { 2 }; // weak
_DWORD off_49ED3C[34] =
{
  4480904,
  8,
  4480860,
  9,
  4480816,
  10,
  4480780,
  16,
  4480736,
  17,
  4480688,
  18,
  4480652,
  19,
  4480608,
  24,
  4480552,
  25,
  4480512,
  26,
  4480456,
  27,
  4480400,
  28,
  4480360,
  120,
  4480344,
  121,
  4480328,
  122,
  4480312,
  252,
  4546876,
  255
}; // idb
FILE _iob[] = ;
_UNKNOWN unk_49F110; // weak
_UNKNOWN unk_49F128; // weak
_UNKNOWN __rglangidNotDefault; // weak
char *__rg_country = "america"; // weak
void *__lc_time_curr = &__lc_time_c; // idb
CAdminAcceptor g_adminAcceptor =
{
  { { NULL }, NULL, { 0u }, { NULL } },,
  {
    NULL,
    NULL,
    0,
    0,
    { { NULL, 0, 0, NULL, NULL, 0u } },
    { NULL, {  }, { 0 }, {  }, 0u, NULL, NULL }
  },
  { { NULL, 0, 0, NULL, NULL, 0u } },
  { NULL, {  }, { 0 }, {  }, 0u, NULL, NULL }
}; // idb
CAdminAcceptor *TSingleton<CAdminAcceptor>::ms_pInstance = NULL; // idb
CIPChecker *TSingleton<CIPChecker>::ms_pInstance = NULL; // idb
CLoginAcceptor *TSingleton<CLoginAcceptor>::ms_pInstance = NULL; // idb
CIPFilter *TSingleton<CIPFilter>::ms_pInstance = NULL; // idb
char sLog = '\0'; // idb
unsigned int il_tab[4][256] =
{
  {
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    0u,
    
  }
}; // idb
unsigned int fl_tab[4][256]; // idb
unsigned int it_tab[4][256]; // idb
unsigned int ft_tab[4][256]; // idb
unsigned int rco_tab[10]; // idb
char isb_tab[256]; // idb
char sbx_tab[256]; // idb
char pow_tab[256]; // idb
char log_tab[256]; // idb
unsigned __int8 CAESCipher::tab_gen; // weak
unsigned __int16 sDefault; // idb
int TSingleton<CServerDialog>::ms_pInstance; // weak
struct _RTL_CRITICAL_SECTION CClientSocket::ms_lockStat; // idb
ZMap<char const *,int,ZXString<char> > CClientSocket::ms_mWhiteProcessName; // idb
struct _RTL_CRITICAL_SECTION CClientSocket::ms_lockGuardData; // idb
char _S30_0; // idb
ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> CClientSocket::ms_mClient; // idb
struct _RTL_CRITICAL_SECTION CClientSocket::ms_lockClient; // idb
__int32 CClientSocket::ms_nCheckPassword; // weak
__int32 CClientSocket::ms_tCheckPassword_SP; // weak
__int32 CClientSocket::ms_nGameLaunching; // weak
__int32 CClientSocket::ms_nWebLaunching; // weak
__int64 CClientSocket::ms_nTotalGameLaunching; // weak
int dword_4A432C; // weak
__int64 CClientSocket::ms_nTotalWebLaunching; // weak
CLoginApp *TSingleton<CServerApp>::ms_pInstance; // idb
CLog *TSingleton<CLog>::ms_pInstance; // idb
CIPCheckerServer g_IPCheckerServer; // idb
int TSingleton<CIPCheckerServer>::ms_pInstance; // weak
CLog g_log; // idb
CLoginAcceptor g_loginAcceptor; // idb
ZXString<char> s_sPatchLocation; // idb
CSecurityServer *TSingleton<CSecurityServer>::ms_pInstance; // idb
CTimerThread *TSingleton<CTimerThread>::ms_pInstance; // idb
ZThread *TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance; // idb
int dword_4A44F4; // weak
char __S26__1__OnTimer_CLoginDialog__MAEXXZ_4EA; // idb
CRand32 g_rand; // idb
ZXString<char> CServerDialog::ms_sLog; // idb
char _S15_5; // idb
struct _RTL_CRITICAL_SECTION CServerDialog::ms_lockLog; // idb
int (__stdcall *CServerDialog::ms_editProcOld)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
ZAPILoader `anonymous namespace'::_s_zapiloader; // idb
_UNKNOWN ZAPI; // weak
int (__stdcall *dword_4A4630)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A4634)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A4638)(_DWORD); // weak
int (__cdecl *dword_4A463C)(_DWORD); // weak
int (__cdecl *dword_4A4640)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A4648)(_DWORD); // weak
int (__stdcall *dword_4A464C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A4658)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (*dword_4A465C)(void); // weak
int (__stdcall *dword_4A4660)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A4664)(_DWORD); // weak
int (__stdcall *dword_4A4668)(_DWORD); // weak
int (__stdcall *dword_4A4684)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A4688)(_DWORD); // weak
int (__stdcall *dword_4A4694)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A469C)(_DWORD); // weak
int (__stdcall *dword_4A46CC)(_DWORD); // weak
int (__stdcall *dword_4A46D0)(_DWORD); // weak
int (__stdcall *dword_4A46D4)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A46E4)(_DWORD); // weak
int (__stdcall *dword_4A46E8)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A46EC)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A46FC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__thiscall *dword_4A4700)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A4704)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A4708)(_DWORD); // weak
int (__stdcall *dword_4A470C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A4710)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__fastcall *dword_4A4714)(_DWORD, _DWORD); // weak
int (__cdecl *dword_4A474C)(_DWORD); // weak
int (__stdcall *dword_4A4750)(_DWORD); // weak
int (*dword_4A4754)(void); // weak
int (__stdcall *dword_4A4758)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A4778)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A477C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4A4788)(_DWORD); // weak
int (__stdcall *dword_4A4798)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A47A0)(_DWORD, _DWORD, _DWORD); // weak
int (*dword_4A47BC)(_DWORD, const char *, ...); // weak
int (__stdcall *dword_4A4884)(_DWORD); // weak
int (__thiscall *dword_4A48F8)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4A4900)(_DWORD); // weak
int (*dword_4A49B4)(void); // weak
ZExceptionHandler _g_zeh; // idb
ZRecyclableStatic ZRecyclableStatic::_s_sStatic; // idb
ZAllocEx<ZAllocStrSelector<char> > ZAllocEx<ZAllocStrSelector<char>>::_s_alloc; // idb
ZAllocEx<ZAllocAnonSelector> ZAllocEx<ZAllocAnonSelector>::_s_alloc; // idb
Ztl_variant_t vtEmpty; // idb
volatile LONG _g_nPCOMModuleRef; // idb
ZAllocEx<ZAllocStrSelector<unsigned short> > ZAllocEx<ZAllocStrSelector<unsigned short>>::_s_alloc; // idb
volatile LONG ZSocketBase::_s_init; // idb
char _S16_2; // idb
int (__cdecl *_g_apfnPCOMAPIs)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int dword_4A4C58; // weak
int dword_4A4C5C; // weak
int dword_4A4C60; // weak
int (__cdecl *dword_4A4C64)(_DWORD, _DWORD); // weak
HMODULE _g_hPCOMModule; // idb
_com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > g_pDB; // idb
_com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > g_pRoot; // idb
_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > g_pPropConf; // idb
_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > g_rm; // idb
SingleInstance _g_si; // idb
_UNKNOWN ctx; // weak
struct _RTL_CRITICAL_SECTION ggauth_lock; // idb
char msgBuf[512]; // idb
_UNKNOWN ggGlobal; // weak
int dword_4A5EEC; // weak
void *Memory; // idb
char Dest; // idb
_UNKNOWN unk_4A5FEC; // weak
int dword_4A5FF8; // weak
int dword_4A5FFC[]; // weak
int dword_4A6000[]; // weak
int dword_4A6004[]; // weak
int dword_4A6008[]; // weak
_UNKNOWN unk_4A6044; // weak
int dword_4A604C; // weak
char byte_4A6050; // weak
int dword_4A6054[]; // weak
int dword_4A6058[]; // weak
int dword_4A605C[]; // weak
int dword_4A6060[]; // weak
char byte_4A60A4; // weak
int dword_4A60A8; // weak
int dword_4A60AC; // weak
int dword_4A60B0; // weak
int dword_4A60B4; // weak
int dword_4A60B8; // weak
int dword_4A60BC; // weak
GUID _GUID_00000000_0000_0000_0000_000000000000;
_variant_t vtMissing; // idb
int __error_mode; // weak
LPTOP_LEVEL_EXCEPTION_FILTER lpfn; // idb
int dword_4A61BC; // weak
int _newmode; // weak
int (__cdecl *_pnhHeap)(unsigned int); // weak
LCID dword_4A61E0; // idb
UINT __lc_codepage; // idb
void *dword_4A6408; // idb
void *dword_4A640C; // idb
__int16 word_4A641C; // weak
char `ZExceptionHandler::GetExceptionString'::`4'::sBuffer; // weak
ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::s_pInstance; // idb
ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance; // idb
ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance; // idb
ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance; // idb
char ___B_1____s_sEmpty___ZXString_D___D__9_51; // weak
ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::s_pInstance; // idb
ZXString<char> ZXString<char>::_s_sEmpty; // idb
ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance; // idb
int `ZPort::GetProcessorCount'::`2'::s_uProcessorCount; // weak
ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance; // idb
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::s_pInstance; // idb
ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance; // idb
int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance; // weak
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance; // idb
ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance; // idb
ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance; // idb
int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance; // weak
ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance; // idb
ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance; // idb
int __alternate_form; // weak
int __no_lead_zeros; // weak
char byte_4A66E1[]; // weak
int __setlc_active; // weak
volatile LONG __unguarded_readlc_active; // idb
int __sbh_indGroupDefer; // weak
int __sbh_pHeaderScan; // weak
void *__sbh_pHeaderDefer; // idb
int __sbh_cntHeaderList; // weak
LPVOID __sbh_pHeaderList; // idb
int __sbh_threshold; // weak
HANDLE _crtheap; // idb
int __active_heap; // weak


//----- (00401000) --------------------------------------------------------
int __cdecl operator new(unsigned int uSize)
{
  return ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, uSize);
}

//----- (0040100F) --------------------------------------------------------
void __cdecl operator delete(void *p)
{
  ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, p);
}

//----- (0040101E) --------------------------------------------------------
int _E14()
{
  _E11();
  return _E13();
}

//----- (00401028) --------------------------------------------------------
void _E11()
{
  CAdminAcceptor::CAdminAcceptor(&g_adminAcceptor);
}

//----- (00401032) --------------------------------------------------------
int _E13()
{
  return atexit(_E12);
}

//----- (0040103E) --------------------------------------------------------
void __cdecl _E12()
{
  CAdminAcceptor::~CAdminAcceptor(&g_adminAcceptor);
}

//----- (00401048) --------------------------------------------------------
void __thiscall CAdminAcceptor::CAdminAcceptor(CAdminAcceptor *this)
{
  CAdminAcceptor *v1; // esi@1
  ZPort *v2; // ecx@1

  v1 = this;
  this->_m_pPort = 0;
  this->_m_sockListen._m_hSocket = -1;
  this->_m_aolAccepts.a = 0;
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&ZSocketAcceptor<CAdminSocket>::`vftable';
  v2 = &this->m_port;
  TSingleton<CAdminAcceptor>::ms_pInstance = (CAdminAcceptor *)(v2 != 0 ? (unsigned int)v2[-1]._m_lpThreads.gap4 : 0);
  ZPort::ZPort(v2);
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  v1->m_lpSocket._m_uCount = 0;
  v1->m_lpSocket._m_pHead = 0;
  v1->m_lpSocket._m_pTail = 0;
  v1->m_lpSocket.vfptr = (ZList<ZRef<CAdminSocket> >Vtbl *)&ZList<ZRef<CAdminSocket>>::`vftable';
  v1->vfptr = (ZOverlapped::ZICallBackVtbl *)&CAdminAcceptor::`vftable';
}
// 443300: using guessed type int (__cdecl *CAdminAcceptor::`vftable')(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr);
// 443318: using guessed type int (__thiscall *ZList<ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);
// 443320: using guessed type int (__cdecl *ZSocketAcceptor<CAdminSocket>::`vftable')(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr);

//----- (004010BB) --------------------------------------------------------
CAdminAcceptor *__thiscall CAdminAcceptor::`scalar deleting destructor'(CAdminAcceptor *this, unsigned int __flags)
{
  CAdminAcceptor *v2; // esi@1

  v2 = this;
  CAdminAcceptor::~CAdminAcceptor(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004010DB) --------------------------------------------------------
void __thiscall CAdminAcceptor::~CAdminAcceptor(CAdminAcceptor *this)
{
  CAdminAcceptor *v1; // esi@1

  v1 = this;
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&CAdminAcceptor::`vftable';
  CAdminAcceptor::Terminate(this);
  v1->m_lpSocket.vfptr = (ZList<ZRef<CAdminSocket> >Vtbl *)&ZList<ZRef<CAdminSocket>>::`vftable';
  ZList<ZRef<CAdminSocket>>::RemoveAll(&v1->m_lpSocket);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  ZPort::~ZPort(&v1->m_port);
  TSingleton<CAdminAcceptor>::ms_pInstance = 0;
  ZSocketAcceptor<CAdminSocket>::~ZSocketAcceptor<CAdminSocket>((ZSocketAcceptor<CAdminSocket> *)&v1->vfptr);
}
// 443300: using guessed type int (__cdecl *CAdminAcceptor::`vftable')(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr);
// 443318: using guessed type int (__thiscall *ZList<ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (00401145) --------------------------------------------------------
BOOL __thiscall CAdminAcceptor::Begin(CAdminAcceptor *this, ZInetAddr *sockaddr)
{
  CAdminAcceptor *v2; // esi@1
  ZPort *v3; // edi@1

  v2 = this;
  v3 = &this->m_port;
  return ZPort::BeginPort(&this->m_port, 1u)
      && ZSocketAcceptor<CAdminSocket>::BeginAcceptor(
           (ZSocketAcceptor<CAdminSocket> *)&v2->vfptr,
           (sockaddr_in *)&sockaddr->sin_family,
           v3,
           10,
           0x7FFFFFFF);
}

//----- (0040117C) --------------------------------------------------------
void __thiscall CAdminAcceptor::Terminate(CAdminAcceptor *this)
{
  CAdminAcceptor *v1; // edi@1
  int v2; // esi@1
  CAdminSocket *v3; // ecx@3
  int v4; // eax@3

  v1 = this;
  ZSocketAcceptor<CAdminSocket>::CloseAcceptor((ZSocketAcceptor<CAdminSocket> *)&this->vfptr);
  EnterCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  v2 = (int)v1->m_lpSocket._m_pHead;
  while ( v2 )
  {
    v3 = *(CAdminSocket **)(v2 + 4);
    v4 = *(_DWORD *)(v2 != 0 ? v2 - 16 + 4 : 4);
    v2 = v4 != 0 ? v4 + 16 : 0;
    CAdminSocket::PostClose(v3);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  while ( v1->m_lpSocket._m_uCount )
    Sleep(0x64u);
  ZPort::ClosePort(&v1->m_port, 1);
}

//----- (00401204) --------------------------------------------------------
void __thiscall CAdminAcceptor::RemoveSocket(CAdminAcceptor *this, CAdminSocket *pSocket)
{
  CAdminAcceptor *v2; // edi@1
  struct _RTL_CRITICAL_SECTION *v3; // esi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  ZList<ZRef<CAdminSocket>>::RemoveAt(&v2->m_lpSocket, pSocket->m_posList);
  LeaveCriticalSection(v3);
}

//----- (0040124C) --------------------------------------------------------
void __thiscall CAdminAcceptor::OnAccept(CAdminAcceptor *this, unsigned int dwErr, CAdminSocket *pSocket, sockaddr_in *pAddr)
{
  CAdminSocket *v4; // esi@1
  ZInetAddr *v5; // edi@3
  int v6; // ST0C_4@3
  char *v7; // eax@3
  ZSocketBuffer *v8; // eax@8
  char *v9; // edi@10
  char *v10; // ebx@10
  int v11; // eax@11
  int v12; // edi@17
  int v13; // ebx@27
  struct _RTL_CRITICAL_SECTION *v14; // edi@27
  ZRef<CAdminSocket> *v15; // eax@29
  bool v16; // zf@29
  int v17; // [sp+0h] [bp-38h]@1
  ZRef<CAdminSocket> d; // [sp+Ch] [bp-2Ch]@27
  ZRef<ZSocketBuffer> v19; // [sp+14h] [bp-24h]@8
  ZRef<CAdminSocket> v20; // [sp+1Ch] [bp-1Ch]@1
  CAdminAcceptor *v21; // [sp+24h] [bp-14h]@1
  int *v22; // [sp+28h] [bp-10h]@1
  int v23; // [sp+34h] [bp-4h]@1

  v4 = pSocket;
  v21 = this;
  v22 = &v17;
  v20.p = pSocket;
  ZRef<CAdminSocket>::_AddRef(&v20);
  v23 = 0;
  if ( dwErr )
  {
    v23 = -1;
    ZRef<CAdminSocket>::_Release(&v20);
    return;
  }
  v5 = (ZInetAddr *)pAddr;
  v6 = ntohs(pAddr->sin_port);
  v7 = ZInetAddr::GetAddr(v5);
  ZXString<char>::Format(&v4->m_sAddr, sFormat, v7, v6);
  if ( !(CIPChecker::GetFlag(TSingleton<CIPChecker>::ms_pInstance, v5->sin_addr.S_un.S_addr) & 1) )
  {
    LogError(aUnregisteredHo, v4->m_sAddr._m_pStr);
$L112206:
    v23 = -1;
    if ( v20.p )
      goto LABEL_6;
    return;
  }
  LOBYTE(v23) = 1;
  ZSocketBase::SetNonBlocking((ZSocketBase *)&v4->_m_hSocket, 1);
  ZSocketBuffer::Alloc(0x5B4u);
  v19.p = v8;
  if ( v8 )
  {
    InterlockedIncrement(&v8->_m_nRef);
    v8 = v19.p;
  }
  v9 = v8->buf;
  LOBYTE(v23) = 2;
  v10 = v9;
  pAddr = (sockaddr_in *)300;
  while ( 1 )
  {
    v11 = recv(*(_DWORD *)(v4 != 0 ? (unsigned int)&v4->_m_hSocket : 0), v10, 4, 0);
    if ( v11 != -1 )
      goto LABEL_15;
    if ( WSAGetLastError() == 10035 )
    {
      Sleep(0x64u);
      pAddr = (sockaddr_in *)((char *)pAddr - 1);
      if ( (signed int)pAddr >= 0 )
        continue;
    }
    v11 = 0;
LABEL_15:
    v10 += v11;
    if ( !v11 )
      goto LABEL_18;
    if ( v10 - v9 == 4 )
      break;
  }
  v12 = *(_DWORD *)v9;
  if ( !v11 )
  {
LABEL_18:
    LogError(aSuspiciousAdmi, v4->m_sAddr._m_pStr);
    goto LABEL_21;
  }
  if ( v12 == 1 )
  {
    LOBYTE(v23) = 1;
    if ( v19.p )
      ZRef<ZSocketBuffer>::_ReleaseRaw(&v19, 0);
    v13 = (int)v21;
    v23 = 0;
    v14 = (struct _RTL_CRITICAL_SECTION *)&v21->m_lock.DebugInfo;
    dwErr = (unsigned int)&v21->m_lock;
    pAddr = (sockaddr_in *)&v21->m_lock;
    EnterCriticalSection((LPCRITICAL_SECTION)&v21->m_lock.DebugInfo);
    d.p = v4;
    if ( v4 )
      InterlockedIncrement(&v4->_m_nRef);
    LOBYTE(v23) = 6;
    v15 = ZList<ZRef<CAdminSocket>>::AddTail((ZList<ZRef<CAdminSocket> > *)(v13 + 100), &d);
    v16 = d.p == 0;
    v4->m_posList = (__POSITION *)v15;
    LOBYTE(v23) = 5;
    if ( !v16 )
    {
      ZRef<CAdminSocket>::_ReleaseRaw(&d, 0);
      d.p = 0;
    }
    ZSocketEx::AttachPort((ZSocketEx *)&v4->vfptr, (ZPort *)(v13 + 16));
    LeaveCriticalSection(v14);
    goto $L112206;
  }
  LogError(aUncertainAdmin, v4->m_sAddr._m_pStr);
LABEL_21:
  LOBYTE(v23) = 1;
  if ( v19.p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(&v19, 0);
    v19.p = 0;
  }
  v23 = -1;
  if ( !v20.p )
    return;
LABEL_6:
  ZRef<CAdminSocket>::_ReleaseRaw(&v20, 0);
}

//----- (00401486) --------------------------------------------------------
void *_L112199()
{
  LogError(aExceptionOccur);
  return &_L112206;
}

//----- (00401497) --------------------------------------------------------
void __thiscall ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>(ZCriticalSectionEx<4000> *this)
{
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->DebugInfo);
}

//----- (0040149F) --------------------------------------------------------
void __thiscall ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>(ZSynchronizedHelper<ZCriticalSectionEx<4000> > *this)
{
  LeaveCriticalSection((LPCRITICAL_SECTION)&this->m_pLock->DebugInfo);
}

//----- (004014A8) --------------------------------------------------------
void __thiscall ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>(ZRef<ZSocketBuffer> *this)
{
  ZRef<ZSocketBuffer> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (004014BE) --------------------------------------------------------
void __thiscall ZSocketAcceptor<CAdminSocket>::~ZSocketAcceptor<CAdminSocket>(ZSocketAcceptor<CAdminSocket> *this)
{
  ZSocketAcceptor<CAdminSocket> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&ZSocketAcceptor<CAdminSocket>::`vftable';
  ZSocketAcceptor<CAdminSocket>::CloseAcceptor(this);
  ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::RemoveAll(&v1->_m_aolAccepts);
  if ( v1->_m_sockListen._m_hSocket != -1 )
  {
    closesocket(v1->_m_sockListen._m_hSocket);
    v1->_m_sockListen._m_hSocket = -1;
  }
}
// 443320: using guessed type int (__cdecl *ZSocketAcceptor<CAdminSocket>::`vftable')(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr);

//----- (0040150D) --------------------------------------------------------
void __stdcall ZSocketAcceptor<CAdminSocket>::OnAccept(unsigned int dwErr, CAdminSocket *pSocket, sockaddr_in *pAddr)
{
  ((void (*)(void))pSocket->vfptr[1].__vecDelDtor)();
}

//----- (0040151C) --------------------------------------------------------
int ZSocketAcceptor<CAdminSocket>::GetType()
{
  return -1;
}

//----- (00401520) --------------------------------------------------------
void TSingleton<CAdminAcceptor>::~TSingleton<CAdminAcceptor>()
{
  TSingleton<CAdminAcceptor>::ms_pInstance = 0;
}

//----- (00401528) --------------------------------------------------------
void __thiscall ZList<ZRef<CAdminSocket>>::~ZList<ZRef<CAdminSocket>>(ZList<ZRef<CAdminSocket> > *this)
{
  this->vfptr = (ZList<ZRef<CAdminSocket> >Vtbl *)&ZList<ZRef<CAdminSocket>>::`vftable';
  ZList<ZRef<CAdminSocket>>::RemoveAll(this);
}
// 443318: using guessed type int (__thiscall *ZList<ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (00401533) --------------------------------------------------------
ZRef<CAdminSocket> *__thiscall ZList<ZRef<CAdminSocket>>::AddTail(ZList<ZRef<CAdminSocket> > *this, ZRef<CAdminSocket> *d)
{
  ZRef<CAdminSocket> *v2; // esi@1

  v2 = ZList<ZRef<CAdminSocket>>::AddTail(this);
  ZRef<CAdminSocket>::operator=(v2, d);
  return v2;
}

//----- (0040154C) --------------------------------------------------------
void __thiscall ZRef<CAdminSocket>::~ZRef<CAdminSocket>(ZRef<CAdminSocket> *this)
{
  ZRef<CAdminSocket> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<CAdminSocket>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (00401562) --------------------------------------------------------
ZSocketAcceptor<CAdminSocket> *__thiscall ZSocketAcceptor<CAdminSocket>::`vector deleting destructor'(ZSocketAcceptor<CAdminSocket> *this, unsigned int __flags)
{
  ZSocketAcceptor<CAdminSocket> *v2; // esi@1

  v2 = this;
  ZSocketAcceptor<CAdminSocket>::~ZSocketAcceptor<CAdminSocket>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00401582) --------------------------------------------------------
ZList<ZRef<CAdminSocket> > *__thiscall ZList<ZRef<CAdminSocket>>::`scalar deleting destructor'(ZList<ZRef<CAdminSocket> > *this, unsigned int __flags)
{
  ZList<ZRef<CAdminSocket> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZList<ZRef<CAdminSocket> >Vtbl *)&ZList<ZRef<CAdminSocket>>::`vftable';
  ZList<ZRef<CAdminSocket>>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 443318: using guessed type int (__thiscall *ZList<ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (004015AD) --------------------------------------------------------
ZRef<CAdminSocket> *__thiscall ZRef<CAdminSocket>::operator=(ZRef<CAdminSocket> *this, ZRef<CAdminSocket> *r)
{
  CAdminSocket *v2; // eax@1
  ZRef<CAdminSocket> *v3; // esi@1

  v2 = r->p;
  v3 = this;
  if ( v2 )
    InterlockedIncrement(&v2->_m_nRef);
  if ( v3->p )
  {
    ZRef<CAdminSocket>::_ReleaseRaw(v3, 0);
    v3->p = 0;
  }
  v3->p = r->p;
  return v3;
}

//----- (004015E6) --------------------------------------------------------
void __thiscall ZRef<CAdminSocket>::_AddRef(ZRef<CAdminSocket> *this)
{
  CAdminSocket *v1; // eax@1

  v1 = this->p;
  if ( v1 )
    InterlockedIncrement(&v1->_m_nRef);
}

//----- (004015F8) --------------------------------------------------------
void __thiscall ZRef<CAdminSocket>::_Release(ZRef<CAdminSocket> *this)
{
  ZRef<CAdminSocket> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<CAdminSocket>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (0040160E) --------------------------------------------------------
void __thiscall ZRef<ZSocketBuffer>::_ReleaseRaw(ZRef<ZSocketBuffer> *this, ZRefCounted *__formal)
{
  ZRef<ZSocketBuffer> *v2; // esi@1

  v2 = this;
  if ( !InterlockedDecrement(&this->p->_m_nRef) )
  {
    InterlockedIncrement(&v2->p->_m_nRef);
    ZRefCountedAccessorBase::_Delete((ZRefCounted *)&v2->p->vfptr);
  }
}

//----- (0040163C) --------------------------------------------------------
void __cdecl ZRefCountedAccessorBase::_Delete(ZRefCounted *p)
{
  if ( p )
    ((void (__stdcall *)(_DWORD))p->vfptr->__vecDelDtor)(1);
}

//----- (0040164B) --------------------------------------------------------
void __thiscall ZRef<CAdminSocket>::_ReleaseRaw(ZRef<CAdminSocket> *this, ZRefCounted *__formal)
{
  ZRef<CAdminSocket> *v2; // esi@1

  v2 = this;
  if ( !InterlockedDecrement(&this->p->_m_nRef) )
  {
    InterlockedIncrement(&v2->p->_m_nRef);
    ((void (*)(void))v2->p->vfptr[1].__vecDelDtor)();
  }
}

//----- (00401678) --------------------------------------------------------
int __thiscall ZAllocEx<ZAllocAnonSelector>::Alloc(ZAllocEx<ZAllocAnonSelector> *this, unsigned int uSize)
{
  ZAllocEx<ZAllocAnonSelector> *v2; // edi@1
  signed int v3; // esi@2
  int v4; // eax@12
  unsigned int *v5; // eax@12
  struct _RTL_CRITICAL_SECTION *v7; // ebx@17
  bool v8; // zf@17
  char **v9; // edi@17
  char *v10; // eax@18
  char *v11; // esi@19
  ZAllocEx<ZAllocAnonSelector> *v12; // [sp+10h] [bp-14h]@1
  signed int uBlockSize; // [sp+14h] [bp-10h]@9
  signed int u; // [sp+2Ch] [bp+8h]@9

  v2 = this;
  v12 = this;
  if ( uSize > 0x20 )
  {
    if ( uSize <= 0x40 )
    {
      v3 = 2;
      goto LABEL_5;
    }
    v3 = uSize > 0x80 ? -1 : 3;
  }
  else
  {
    v3 = uSize > 0x10;
  }
  if ( v3 < 0 )
  {
    v4 = dword_4A46D4(0, uSize + 4);
    v5 = (unsigned int *)dword_4A46CC(v4);
    *v5 = uSize;
    return (int)(v5 + 1);
  }
LABEL_5:
  if ( v3 )
  {
    switch ( v3 )
    {
      case 1:
        u = 32;
        uBlockSize = 32;
        break;
      case 2:
        u = 16;
        uBlockSize = 64;
        break;
      case 3:
        u = 8;
        uBlockSize = 128;
        break;
      default:
        u = 0;
        uBlockSize = 0;
        break;
    }
  }
  else
  {
    u = 64;
    uBlockSize = 16;
  }
  v7 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v8 = v2->m_apBuff[v3] == 0;
  v9 = (char **)&v2->m_apBuff[v3];
  if ( v8 )
  {
    v10 = ZAllocBase::_AllocRawBlocks(uBlockSize, u);
    *((_DWORD *)v10 - 2) = v12->m_apBlockHead[v3];
    v12->m_apBlockHead[v3] = v10;
    *v9 = v10;
  }
  v11 = *v9;
  *v9 = *(char **)*v9;
  LeaveCriticalSection(v7);
  return (int)v11;
}
// 4A46CC: using guessed type int (__stdcall *dword_4A46CC)(_DWORD);
// 4A46D4: using guessed type int (__stdcall *dword_4A46D4)(_DWORD, _DWORD);

//----- (0040177A) --------------------------------------------------------
char *__cdecl ZAllocBase::_AllocRawBlocks(unsigned int uBlockSize, unsigned int u)
{
  unsigned int v2; // ebx@1
  int v3; // eax@1
  int v4; // eax@1
  char *result; // eax@1
  unsigned int v6; // edx@1
  char *v7; // ecx@1

  v2 = uBlockSize + 4;
  v3 = dword_4A46D4(0, u * (uBlockSize + 4) + 8);
  v4 = dword_4A46CC(v3);
  *(_DWORD *)v4 = u * (uBlockSize + 4) + 4;
  *(_DWORD *)(v4 + 4) = 0;
  v4 += 8;
  *(_DWORD *)v4 = uBlockSize;
  result = (char *)(v4 + 4);
  v6 = u - 1;
  v7 = result;
  if ( u != 1 )
  {
    do
    {
      --v6;
      *(_DWORD *)v7 = &v7[v2];
      v7 += v2;
      *((_DWORD *)v7 - 1) = uBlockSize;
    }
    while ( v6 );
  }
  *(_DWORD *)v7 = 0;
  return result;
}
// 4A46CC: using guessed type int (__stdcall *dword_4A46CC)(_DWORD);
// 4A46D4: using guessed type int (__stdcall *dword_4A46D4)(_DWORD, _DWORD);

//----- (004017D1) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocAnonSelector>::Free(ZAllocEx<ZAllocAnonSelector> *this, void *p)
{
  ZAllocEx<ZAllocAnonSelector> *v2; // ebp@1
  unsigned int v3; // eax@2
  signed int v4; // esi@5
  int v5; // eax@12

  v2 = this;
  if ( p )
  {
    v3 = *((_DWORD *)p - 1);
    if ( (v3 & 0x80000000) != 0 )
      v3 = ~v3;
    if ( v3 > 0x20 )
    {
      if ( v3 <= 0x40 )
      {
        v4 = 2;
        goto LABEL_8;
      }
      v4 = v3 > 0x80 ? -1 : 3;
    }
    else
    {
      v4 = v3 > 0x10;
    }
    if ( v4 < 0 )
    {
      v5 = dword_4A46D4(0, (char *)p - 4);
      dword_4A46D0(v5);
      return;
    }
LABEL_8:
    EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
    *(_DWORD *)p = v2->m_apBuff[v4];
    v2->m_apBuff[v4] = p;
    LeaveCriticalSection((LPCRITICAL_SECTION)&v2->m_lock.DebugInfo);
  }
}
// 4A46D0: using guessed type int (__stdcall *dword_4A46D0)(_DWORD);
// 4A46D4: using guessed type int (__stdcall *dword_4A46D4)(_DWORD, _DWORD);

//----- (0040184C) --------------------------------------------------------
ZXString<char> *ZXString<char>::Format(ZXString<char> *this, const char *sFormat, ...)
{
  va_list va; // [sp+Ch] [bp+Ch]@1

  va_start(va, sFormat);
  ZXString<char>::_FormatV(this, sFormat, va);
  return this;
}

//----- (00401863) --------------------------------------------------------
void __thiscall ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::RemoveAll(ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped> *this)
{
  ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped> *v1; // ebx@1
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v2; // esi@2
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *i; // edi@2

  v1 = this;
  if ( this->a )
  {
    v2 = &this->a[*(_DWORD *)&this->a[-1].acAcceptBuff[60]];
    for ( i = this->a; i < v2; ++i )
      ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped::~ZAcceptOverlapped(i);
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v1->a[-1].acAcceptBuff[60]);
    v1->a = 0;
  }
}

//----- (004018A2) --------------------------------------------------------
int __thiscall ZSocketAcceptor<CAdminSocket>::BeginAcceptor(ZSocketAcceptor<CAdminSocket> *this, sockaddr_in *pAddr, ZPort *pPort, int nAccepts, int backlog)
{
  ZSocketAcceptor<CAdminSocket> *v5; // edi@1
  char *v6; // ebx@1
  SOCKET *v7; // esi@1
  SOCKET v8; // eax@1
  void *v9; // ST08_4@5
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v10; // esi@5
  int i; // ebx@5
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v12; // ST08_4@7
  int v14; // [sp+0h] [bp-30h]@1
  ZSocketAcceptor<CAdminSocket> *v15; // [sp+10h] [bp-20h]@1
  int v16; // [sp+14h] [bp-1Ch]@4
  int v17; // [sp+18h] [bp-18h]@2
  char v18; // [sp+1Fh] [bp-11h]@1
  int *v19; // [sp+20h] [bp-10h]@1
  int v20; // [sp+2Ch] [bp-4h]@1

  v20 = 0;
  v5 = this;
  v19 = &v14;
  v6 = (char *)&this->_m_aolAccepts;
  v15 = this;
  ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::_Alloc(&this->_m_aolAccepts, nAccepts, (ZAllocHelper *)&v18);
  v7 = &v5->_m_sockListen._m_hSocket;
  v8 = socket(2, 1, 0);
  v5->_m_sockListen._m_hSocket = v8;
  if ( v8 == -1 )
  {
    v17 = WSAGetLastError();
    _CxxThrowException(&v17, &_TI1_AVZException__);
  }
  if ( bind(*v7, (const struct sockaddr *)pAddr, 16) == -1 )
  {
    v16 = WSAGetLastError();
    _CxxThrowException(&v16, &_TI1_AVZException__);
  }
  ((void (__thiscall *)(ZSocketAcceptor<CAdminSocket> *, int))v5->vfptr[2].OnComplete)(v5, (int)&v5->_m_sockListen);
  ZSocketBase::Listen(&v5->_m_sockListen, backlog);
  v9 = (void *)*v7;
  v5->_m_pPort = pPort;
  ZPort::Attach(pPort, v9);
  v10 = *(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped **)v6;
  for ( i = 0; i < nAccepts; ++i )
  {
    v12 = v10;
    ++v10;
    ZSocketAcceptor<CAdminSocket>::_BeginAccept(v5, v12);
  }
  return 1;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00401990) --------------------------------------------------------
void __thiscall ZSocketAcceptor<CAdminSocket>::CloseAcceptor(ZSocketAcceptor<CAdminSocket> *this)
{
  ZSocketAcceptor<CAdminSocket> *v1; // esi@1
  ZPort *v2; // eax@1

  v1 = this;
  v2 = this->_m_pPort;
  if ( v2 )
  {
    InterlockedDecrement(&v2->_m_nAttachedHandles);
    v1->_m_pPort = 0;
  }
  if ( v1->_m_sockListen._m_hSocket != -1 )
  {
    closesocket(v1->_m_sockListen._m_hSocket);
    v1->_m_sockListen._m_hSocket = -1;
  }
}

//----- (004019C3) --------------------------------------------------------
void __cdecl ZSocketAcceptor<CAdminSocket>::OnComplete(void *pUser, unsigned int key, unsigned int dwErr)
{
  ZSocketAcceptor<CAdminSocket> *this; // ecx@0
  ZSocketAcceptor<CAdminSocket> *v4; // edi@1
  bool v5; // zf@1
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v6; // esi@2
  ZOverlapped::ZICallBackVtbl *v7; // eax@2
  int v8; // ST18_4@2
  int v9; // ST18_4@4
  ZSocketEx *v10; // ecx@7
  int v11; // [sp+0h] [bp-30h]@1
  ZSocketAcceptor<CAdminSocket> *v12; // [sp+Ch] [bp-24h]@1
  struct sockaddr *LocalSockaddr; // [sp+10h] [bp-20h]@2
  int LocalSockaddrLength; // [sp+14h] [bp-1Ch]@2
  int RemoteSockaddrLength; // [sp+18h] [bp-18h]@2
  int v16; // [sp+1Ch] [bp-14h]@1
  int *v17; // [sp+20h] [bp-10h]@1
  int v18; // [sp+2Ch] [bp-4h]@1

  v4 = this;
  v5 = this->_m_pPort == 0;
  v17 = &v11;
  v12 = this;
  v18 = 0;
  v16 = v5;
  if ( !dwErr )
  {
    v6 = (ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *)pUser;
    LocalSockaddrLength = 0;
    RemoteSockaddrLength = 0;
    LocalSockaddr = 0;
    dwErr = 0;
    GetAcceptExSockaddrs(
      (char *)pUser + 32,
      0,
      0x20u,
      0x20u,
      &LocalSockaddr,
      &LocalSockaddrLength,
      (struct sockaddr **)&dwErr,
      &RemoteSockaddrLength);
    ZSocketBase::UpdateAcceptContext((ZSocketBase *)(*((_DWORD *)pUser + 7) + 16), v4->_m_sockListen._m_hSocket);
    v7 = v4->vfptr;
    v8 = *((_DWORD *)pUser + 7);
LABEL_5:
    v7[1].GetType((ZOverlapped::ZICallBack *)v4);
    goto LABEL_7;
  }
  if ( !v16 )
  {
    v6 = (ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *)pUser;
    v7 = this->vfptr;
    v9 = *((_DWORD *)pUser + 7);
    goto LABEL_5;
  }
  v6 = (ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *)pUser;
LABEL_7:
  v10 = (ZSocketEx *)&v6->pSocket->vfptr;
  v18 = -1;
  ZSocketEx::_SockRelease(v10);
  v5 = v16 == 0;
  v6->pSocket = 0;
  if ( v5 )
  {
    v18 = 2;
    ZSocketAcceptor<CAdminSocket>::_BeginAccept(v4, v6);
  }
}

//----- (00401A92) --------------------------------------------------------
void *_L113873()
{
  return &_L107869;
}

//----- (00401A98) --------------------------------------------------------
ZRef<CAdminSocket> *__thiscall ZList<ZRef<CAdminSocket>>::AddTail(ZList<ZRef<CAdminSocket> > *this)
{
  ZList<ZRef<CAdminSocket> > *v1; // esi@1
  ZRef<CAdminSocket> *result; // eax@1
  ZRef<CAdminSocket> *v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<ZRef<CAdminSocket>>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)&result[-2] : 0;
    *(v3 != 0 ? &v3[-2].p : 4) = (CAdminSocket *)v4;
    result = (ZRef<CAdminSocket> *)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (00401AD6) --------------------------------------------------------
void __thiscall ZList<ZRef<CAdminSocket>>::RemoveAt(ZList<ZRef<CAdminSocket> > *this, __POSITION *pos)
{
  int v2; // edx@1
  int v3; // eax@2
  int v4; // eax@4
  int v5; // eax@5
  int v6; // eax@6
  int v7; // eax@7
  int v8; // edx@7
  int v9; // eax@7
  int v10; // edx@7

  v2 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8);
  if ( *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? v2 + 16 : 0 )
  {
    v5 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v5 + 16 : 0 )
    {
      v7 = v5 != 0 ? v5 + 16 : 0;
      v8 = v2 != 0 ? v2 + 16 : 0;
      *(_DWORD *)(v8 != 0 ? v8 - 16 + 4 : 4) = v7 != 0 ? v7 - 16 : 0;
      v9 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      v10 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v10 != 0 ? v10 - 16 + 8 : 8) = v9 != 0 ? v9 - 16 : 0;
    }
    else
    {
      this->_m_pTail = (ZRef<CAdminSocket> *)(v2 != 0 ? v2 + 16 : 0);
      v6 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      *(_DWORD *)(v6 != 0 ? v6 - 16 + 4 : 4) = 0;
    }
  }
  else
  {
    v3 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v3 + 16 : 0 )
    {
      this->_m_pHead = (ZRef<CAdminSocket> *)(v3 != 0 ? v3 + 16 : 0);
      v4 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v4 != 0 ? v4 - 16 + 8 : 8) = 0;
    }
    else
    {
      this->_m_pTail = 0;
      this->_m_pHead = 0;
    }
  }
  --this->_m_uCount;
  ZRefCountedAccessorBase::_Delete((ZRefCounted *)(pos != 0 ? (unsigned int)&pos[-16] : 0));
}

//----- (00401BE8) --------------------------------------------------------
void __thiscall ZList<ZRef<CAdminSocket>>::RemoveAll(ZList<ZRef<CAdminSocket> > *this)
{
  ZList<ZRef<CAdminSocket> > *v1; // esi@1
  ZRef<CAdminSocket> *i; // eax@1
  ZRefCounted *v3; // eax@2
  int v4; // edi@2

  v1 = this;
  for ( i = this->_m_pHead; i; i = (ZRef<CAdminSocket> *)(v4 != 0 ? v4 + 16 : 0) )
  {
    v3 = (ZRefCounted *)(i != 0 ? (unsigned int)&i[-2] : 0);
    v4 = v3->_m_nRef;
    ZRefCountedAccessorBase::_Delete(v3);
  }
  v1->_m_pTail = 0;
  v1->_m_pHead = 0;
  v1->_m_uCount = 0;
}

//----- (00401C22) --------------------------------------------------------
void _E20()
{
  _E18();
  _E19();
}

//----- (00401C2C) --------------------------------------------------------
void _E18()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00401C67) --------------------------------------------------------
void _E19()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00401CA2) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this)
{
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vftable';
}
// 443338: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vftable')(void *p, unsigned int __flags);
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00401CD5) --------------------------------------------------------
ZRecyclableStatic::CallBack *__thiscall ZRecyclableStatic::CallBack::`vector deleting destructor'(ZRecyclableStatic::CallBack *this, unsigned int __flags)
{
  ZRecyclableStatic::CallBack *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this);
  return v2;
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00401CF6) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443348: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00401D29) --------------------------------------------------------
ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *__thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vector deleting destructor'(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::~ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00401D49) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::~ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00401D69) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::~ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this)
{
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00401D7E) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::~ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00401D93) --------------------------------------------------------
void __thiscall ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped::~ZAcceptOverlapped(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *this)
{
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v1; // esi@1
  CAdminSocket *v2; // ecx@1

  v1 = this;
  v2 = this->pSocket;
  if ( v2 )
  {
    ZSocketEx::_SockRelease((ZSocketEx *)&v2->vfptr);
    ((void (*)(void))v1->pSocket->vfptr[1].__vecDelDtor)();
  }
}

//----- (00401DAC) --------------------------------------------------------
void __thiscall ZXString<char>::_FormatV(ZXString<char> *this, const char *lpszFormat, char *argList)
{
  signed int v3; // edi@1
  signed int v4; // esi@1
  char *v5; // eax@3
  int v6; // eax@3
  ZXString<char> *v7; // [sp+8h] [bp-14h]@1
  ZXString<char> s; // [sp+Ch] [bp-10h]@1
  int v9; // [sp+18h] [bp-4h]@1

  s._m_pStr = 0;
  v7 = this;
  v3 = -1;
  v9 = 0;
  v4 = 16;
  do
  {
    if ( v3 >= 0 )
      break;
    v5 = ZXString<char>::GetBuffer(&s, v4, 0);
    v6 = _vsnprintf(v5, v4, lpszFormat, argList);
    v3 = v6;
    if ( v6 < 0 )
      v6 = 0;
    ZXString<char>::ReleaseBuffer(&s, v6);
    v4 *= 2;
  }
  while ( v4 <= 1024 );
  ZXString<char>::operator=(v7, &s);
  v9 = -1;
  ZXString<char>::~ZXString<char>(&s);
}

//----- (00401E31) --------------------------------------------------------
void __thiscall ZXString<char>::~ZXString<char>(ZXString<char> *this)
{
  char *v1; // eax@1
  char *v2; // esi@2

  v1 = this->_m_pStr;
  if ( this->_m_pStr )
  {
    v2 = v1 - 12;
    if ( InterlockedDecrement((volatile LONG *)v1 - 3) <= 0 )
      ZAllocEx<ZAllocStrSelector<char>>::Free(&ZAllocEx<ZAllocStrSelector<char>>::_s_alloc, v2);
  }
}

//----- (00401E53) --------------------------------------------------------
ZXString<char> *__thiscall ZXString<char>::operator=(ZXString<char> *this, ZXString<char> *s)
{
  ZXString<char> *v2; // esi@1
  ZXString<char> *result; // eax@2
  char *v4; // eax@3
  volatile LONG *v5; // edi@4
  char *v6; // eax@7
  char *v7; // edi@8
  ZXString<char> v8; // eax@13
  char *v9; // ebx@14

  v2 = this;
  if ( this == s )
  {
    result = this;
  }
  else
  {
    v4 = s->_m_pStr;
    if ( s->_m_pStr )
      v5 = (volatile LONG *)(v4 - 12);
    else
      v5 = 0;
    if ( v5 )
    {
      if ( *v5 == -1 )
      {
        ZXString<char>::Assign(this, v4, -1);
      }
      else
      {
        InterlockedIncrement(v5);
        v8._m_pStr = v2->_m_pStr;
        if ( v2->_m_pStr )
        {
          v9 = v8._m_pStr - 12;
          if ( InterlockedDecrement((volatile LONG *)v8._m_pStr - 3) <= 0 )
            ZAllocEx<ZAllocStrSelector<char>>::Free(&ZAllocEx<ZAllocStrSelector<char>>::_s_alloc, v9);
        }
        v2->_m_pStr = (char *)(v5 + 3);
      }
    }
    else
    {
      v6 = this->_m_pStr;
      if ( this->_m_pStr )
      {
        v7 = v6 - 12;
        if ( InterlockedDecrement((volatile LONG *)v6 - 3) <= 0 )
          ZAllocEx<ZAllocStrSelector<char>>::Free(&ZAllocEx<ZAllocStrSelector<char>>::_s_alloc, v7);
        v2->_m_pStr = 0;
      }
    }
    result = v2;
  }
  return result;
}

//----- (00401EDD) --------------------------------------------------------
void __thiscall ZXString<char>::Assign(ZXString<char> *this, const char *s, int n)
{
  ZXString<char> *v3; // edi@1
  size_t v4; // esi@3
  char *v5; // eax@5

  v3 = this;
  if ( s )
  {
    v4 = n;
    if ( n == -1 )
      v4 = strlen(s);
    v5 = ZXString<char>::GetBuffer(v3, v4, 0);
    memcpy(v5, s, v4);
    ZXString<char>::ReleaseBuffer(v3, v4);
  }
  else
  {
    ZXString<char>::Empty(this);
  }
}

//----- (00401F29) --------------------------------------------------------
void __thiscall ZXString<char>::Empty(ZXString<char> *this)
{
  ZXString<char> *v1; // esi@1
  char *v2; // eax@1
  char *v3; // edi@2

  v1 = this;
  v2 = this->_m_pStr;
  if ( this->_m_pStr )
  {
    v3 = v2 - 12;
    if ( InterlockedDecrement((volatile LONG *)v2 - 3) <= 0 )
      ZAllocEx<ZAllocStrSelector<char>>::Free(&ZAllocEx<ZAllocStrSelector<char>>::_s_alloc, v3);
    v1->_m_pStr = 0;
  }
}

//----- (00401F52) --------------------------------------------------------
char *__thiscall ZXString<char>::GetBuffer(ZXString<char> *this, int nMinLength, int bRetain)
{
  char *v3; // edi@2
  int v4; // ebx@4
  int v5; // eax@8
  _DWORD *v6; // eax@12
  _DWORD *v7; // esi@12
  char *v8; // eax@12
  ZXString<char> *v10; // [sp+8h] [bp-4h]@1

  v10 = this;
  if ( this->_m_pStr )
    v3 = this->_m_pStr - 12;
  else
    v3 = 0;
  v4 = nMinLength;
  if ( v3 )
  {
    if ( *(_DWORD *)v3 <= 1 && *((_DWORD *)v3 + 1) >= nMinLength )
    {
      *(_DWORD *)v3 = -1;
      return v10->_m_pStr;
    }
    v5 = *((_DWORD *)v3 + 2);
  }
  else
  {
    v5 = 0;
  }
  if ( v5 >= nMinLength )
    v4 = v5;
  v6 = (_DWORD *)ZAllocEx<ZAllocStrSelector<char>>::Alloc(&ZAllocEx<ZAllocStrSelector<char>>::_s_alloc, v4 + 13);
  v7 = v6;
  *v6 = -1;
  v8 = (char *)(v6 + 3);
  v7[1] = v4;
  v10->_m_pStr = v8;
  if ( bRetain && v3 )
  {
    memcpy(v8, v3 + 12, *((_DWORD *)v3 + 2) + 1);
    v7[2] = *((_DWORD *)v3 + 2);
  }
  else
  {
    v7[2] = 0;
    *v10->_m_pStr = 0;
  }
  if ( v3 && InterlockedDecrement((volatile LONG *)v3) <= 0 )
    ZAllocEx<ZAllocStrSelector<char>>::Free(&ZAllocEx<ZAllocStrSelector<char>>::_s_alloc, v3);
  return v10->_m_pStr;
}

//----- (00401FFD) --------------------------------------------------------
void __thiscall ZXString<char>::ReleaseBuffer(ZXString<char> *this, int nLength)
{
  size_t v2; // eax@1
  char *v3; // esi@1

  v2 = nLength;
  v3 = this->_m_pStr - 12;
  *(_DWORD *)v3 = 1;
  if ( nLength == -1 )
    v2 = strlen(v3 + 12);
  else
    this->_m_pStr[nLength] = 0;
  *((_DWORD *)v3 + 2) = v2;
}

//----- (0040202B) --------------------------------------------------------
ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *__thiscall ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::_Alloc(ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped> *v3; // ebx@1
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *result; // eax@2
  int v5; // eax@3
  unsigned int v6; // esi@3
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v7; // edi@3
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v8; // ST00_4@5

  v3 = this;
  ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 96 * u + 4) + 4;
    v3->a = (ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *)v5;
    *(_DWORD *)(v5 - 4) = u;
    v6 = (unsigned int)&v3->a[u].Internal;
    v7 = v3->a;
    while ( (unsigned int)v7 < v6 )
    {
      v8 = v7;
      ++v7;
      construct(v8);
    }
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0040207D) --------------------------------------------------------
void __thiscall ZSocketAcceptor<CAdminSocket>::_BeginAccept(ZSocketAcceptor<CAdminSocket> *this, ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *pOverlapped)
{
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v2; // esi@1
  ZSocketAcceptor<CAdminSocket> *v3; // ebx@1
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *v4; // eax@1
  CAdminSocket *v5; // edi@1
  CAdminSocket *v6; // eax@2
  SOCKET v7; // eax@3
  CAdminSocket *v8; // eax@5
  SOCKET *v9; // eax@6
  int v10; // eax@9
  int v11; // [sp+Ch] [bp-14h]@10
  unsigned int dwBytesReceived; // [sp+10h] [bp-10h]@5
  int v13; // [sp+1Ch] [bp-4h]@1

  v2 = pOverlapped;
  v3 = this;
  pOverlapped->pCallBack = (ZOverlapped::ZICallBack *)this;
  v2->pUser = v2;
  v4 = (ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                             &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                             0x174u);
  pOverlapped = v4;
  v5 = 0;
  v13 = 0;
  if ( v4 )
  {
    CAdminSocket::CAdminSocket((CAdminSocket *)v4);
    v5 = v6;
  }
  v13 = -1;
  v2->pSocket = v5;
  v7 = socket(2, 1, 0);
  v5->_m_hSocket = v7;
  if ( v7 == -1 )
  {
    pOverlapped = (ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *)WSAGetLastError();
    _CxxThrowException(&pOverlapped, &_TI1_AVZException__);
  }
  InterlockedIncrement(&v2->pSocket->_m_nRef);
  v8 = v2->pSocket;
  dwBytesReceived = 0;
  if ( v8 )
    v9 = &v8->_m_hSocket;
  else
    v9 = 0;
  if ( !AcceptEx(
          v3->_m_sockListen._m_hSocket,
          *v9,
          v2->acAcceptBuff,
          0,
          0x20u,
          0x20u,
          &dwBytesReceived,
          (LPOVERLAPPED)&v2->Internal) )
  {
    v10 = WSAGetLastError();
    if ( v10 != 997 )
    {
      v11 = v10;
      _CxxThrowException(&v11, &_TI1_AVZException__);
    }
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040215A) --------------------------------------------------------
ZRef<CAdminSocket> *__thiscall ZList<ZRef<CAdminSocket>>::_New(ZList<ZRef<CAdminSocket> > *this, void *pPrev, void *pNext)
{
  ZList<ZRef<CAdminSocket> > *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (ZRef<CAdminSocket> *)(v4 != 0 ? v4 + 16 : 0);
}

//----- (00402199) --------------------------------------------------------
void _E39()
{
  _E31();
  _E32();
  _E33();
  _E34();
  _E35();
  _E36();
  _E37();
  _E38();
}

//----- (004021C1) --------------------------------------------------------
void _E31()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004021FC) --------------------------------------------------------
void _E32()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00402237) --------------------------------------------------------
void _E33()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00402272) --------------------------------------------------------
void _E34()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (004022AD) --------------------------------------------------------
void _E35()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004022E8) --------------------------------------------------------
void _E36()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00402323) --------------------------------------------------------
void _E37()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::s_pInstance = v3;
}

//----- (0040235E) --------------------------------------------------------
void _E38()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00402399) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443350: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::`vftable')(void *p, unsigned int __flags);

//----- (004023CC) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443358: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags);

//----- (004023FF) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443360: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags);

//----- (00402432) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443368: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (00402465) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443370: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::`vftable')(void *p, unsigned int __flags);

//----- (00402498) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443378: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);

//----- (004024CB) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443380: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (004024FE) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443388: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable')(void *p, unsigned int __flags);

//----- (00402531) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00402551) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00402571) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00402591) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004025B1) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::~ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004025D1) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::~ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004025F1) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00402611) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00402631) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00402646) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (0040265B) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00402670) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00402685) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::~ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (0040269A) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::~ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (004026AF) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (004026C4) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (004026D9) --------------------------------------------------------
int __thiscall ZAllocEx<ZAllocStrSelector<char>>::Alloc(ZAllocEx<ZAllocStrSelector<char> > *this, unsigned int uSize)
{
  ZAllocEx<ZAllocStrSelector<char> > *v2; // edi@1
  signed int v3; // esi@2
  int v4; // eax@12
  unsigned int *v5; // eax@12
  struct _RTL_CRITICAL_SECTION *v7; // ebx@17
  bool v8; // zf@17
  char **v9; // edi@17
  char *v10; // eax@18
  char *v11; // esi@19
  ZAllocEx<ZAllocStrSelector<char> > *v12; // [sp+10h] [bp-14h]@1
  signed int uBlockSize; // [sp+14h] [bp-10h]@9
  signed int u; // [sp+2Ch] [bp+8h]@9

  v2 = this;
  v12 = this;
  if ( uSize > 0x2D )
  {
    if ( uSize <= 0x4D )
    {
      v3 = 2;
      goto LABEL_5;
    }
    v3 = uSize > 0x8D ? -1 : 3;
  }
  else
  {
    v3 = uSize > 0x1D;
  }
  if ( v3 < 0 )
  {
    v4 = dword_4A46D4(0, uSize + 4);
    v5 = (unsigned int *)dword_4A46CC(v4);
    *v5 = uSize;
    return (int)(v5 + 1);
  }
LABEL_5:
  if ( v3 )
  {
    switch ( v3 )
    {
      case 1:
        u = 32;
        uBlockSize = 45;
        break;
      case 2:
        u = 16;
        uBlockSize = 77;
        break;
      case 3:
        u = 8;
        uBlockSize = 141;
        break;
      default:
        u = 0;
        uBlockSize = 0;
        break;
    }
  }
  else
  {
    u = 64;
    uBlockSize = 29;
  }
  v7 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v8 = v2->m_apBuff[v3] == 0;
  v9 = (char **)&v2->m_apBuff[v3];
  if ( v8 )
  {
    v10 = ZAllocBase::_AllocRawBlocks(uBlockSize, u);
    *((_DWORD *)v10 - 2) = v12->m_apBlockHead[v3];
    v12->m_apBlockHead[v3] = v10;
    *v9 = v10;
  }
  v11 = *v9;
  *v9 = *(char **)*v9;
  LeaveCriticalSection(v7);
  return (int)v11;
}
// 4A46CC: using guessed type int (__stdcall *dword_4A46CC)(_DWORD);
// 4A46D4: using guessed type int (__stdcall *dword_4A46D4)(_DWORD, _DWORD);

//----- (004027E7) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocStrSelector<char>>::Free(ZAllocEx<ZAllocStrSelector<char> > *this, void *p)
{
  ZAllocEx<ZAllocStrSelector<char> > *v2; // ebp@1
  unsigned int v3; // eax@2
  signed int v4; // esi@5
  int v5; // eax@12

  v2 = this;
  if ( p )
  {
    v3 = *((_DWORD *)p - 1);
    if ( (v3 & 0x80000000) != 0 )
      v3 = ~v3;
    if ( v3 > 0x2D )
    {
      if ( v3 <= 0x4D )
      {
        v4 = 2;
        goto LABEL_8;
      }
      v4 = v3 > 0x8D ? -1 : 3;
    }
    else
    {
      v4 = v3 > 0x1D;
    }
    if ( v4 < 0 )
    {
      v5 = dword_4A46D4(0, (char *)p - 4);
      dword_4A46D0(v5);
      return;
    }
LABEL_8:
    EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
    *(_DWORD *)p = v2->m_apBuff[v4];
    v2->m_apBuff[v4] = p;
    LeaveCriticalSection((LPCRITICAL_SECTION)&v2->m_lock.DebugInfo);
  }
}
// 4A46D0: using guessed type int (__stdcall *dword_4A46D0)(_DWORD);
// 4A46D4: using guessed type int (__stdcall *dword_4A46D4)(_DWORD, _DWORD);

//----- (00402862) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<ZRef<CAdminSocket> > *v0; // ecx@1

  v0 = (ZRefCountedDummy<ZRef<CAdminSocket> > *)ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<ZRef<CAdminSocket>>::ZRefCountedDummy<ZRef<CAdminSocket>>(v0);
}

//----- (00402897) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::s_pInstance,
    p);
}

//----- (004028A7) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (004028CD) --------------------------------------------------------
ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *__cdecl construct(ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *p)
{
  ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped *result; // eax@2

  if ( p )
  {
    memset(p, 0, 0x1Cu);
    p->pSocket = 0;
    result = p;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (004028EF) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZRef<CAdminSocket>>::ZRefCountedDummy<ZRef<CAdminSocket>>(ZRefCountedDummy<ZRef<CAdminSocket> > *this)
{
  ZRefCountedDummy<ZRef<CAdminSocket> > *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable';
  v1->t.p = 0;
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<ZRef<CAdminSocket>>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> >Vtbl *)&ZRefCountedDummy<ZRef<CAdminSocket>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>'};
}
// 443390: using guessed type void *ZRefCountedDummy<ZRef<CAdminSocket>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>'};
// 443398: using guessed type int (__thiscall *ZRefCountedDummy<ZRef<CAdminSocket>>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 4433A0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);

//----- (00402921) --------------------------------------------------------
ZRefCounted *__thiscall ZRefCounted::`vector deleting destructor'(ZRefCounted *this, unsigned int __flags)
{
  ZRefCounted *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this);
  return v2;
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);

//----- (00402942) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *__thiscall ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::s_pInstance,
      this);
  return v2;
}
// 4433A0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (00402964) --------------------------------------------------------
ZRefCountedDummy<ZRef<CAdminSocket> > *__thiscall ZRefCountedDummy<ZRef<CAdminSocket>>::`vector deleting destructor'(ZRefCountedDummy<ZRef<CAdminSocket> > *this, unsigned int __flags)
{
  ZRefCountedDummy<ZRef<CAdminSocket> > *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<ZRef<CAdminSocket>>::~ZRefCountedDummy<ZRef<CAdminSocket>>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::s_pInstance,
      v2);
  return v2;
}

//----- (00402985) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZRef<CAdminSocket>>::~ZRefCountedDummy<ZRef<CAdminSocket>>(ZRefCountedDummy<ZRef<CAdminSocket> > *this)
{
  ZRefCountedDummy<ZRef<CAdminSocket> > *v1; // edi@1
  char *v2; // esi@1

  v1 = this;
  v2 = this->t.gap0;
  if ( this->t.p )
  {
    ZRef<CAdminSocket>::_ReleaseRaw(&this->t, 0);
    *((_DWORD *)v2 + 1) = 0;
  }
  *(_DWORD *)(v1 != 0 ? (unsigned int)&v1->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);

//----- (004029D9) --------------------------------------------------------
void __thiscall ZRefCounted::~ZRefCounted(ZRefCounted *this)
{
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);

//----- (004029E0) --------------------------------------------------------
void __thiscall ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::~ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this)
{
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable';
}
// 4433A0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (004029E7) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x18u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (00402A43) --------------------------------------------------------
char *__thiscall ZInetAddr::GetAddr(ZInetAddr *this)
{
  char *result; // eax@1
  ZInetAddr *v2; // [sp+0h] [bp-4h]@1

  v2 = this;
  result = inet_ntoa(this->sin_addr);
  if ( !result )
  {
    v2 = (ZInetAddr *)10022;
    _CxxThrowException(&v2, &_TI1_AVZException__);
  }
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00402A6B) --------------------------------------------------------
void __thiscall ZSocketBase::~ZSocketBase(ZSocketBase *this)
{
  ZSocketBase *v1; // esi@1

  v1 = this;
  if ( this->_m_hSocket != -1 )
  {
    closesocket(this->_m_hSocket);
    v1->_m_hSocket = -1;
  }
}

//----- (00402A81) --------------------------------------------------------
void __thiscall ZSocketBase::Listen(ZSocketBase *this, int backlog)
{
  if ( listen(this->_m_hSocket, backlog) == -1 )
  {
    backlog = WSAGetLastError();
    _CxxThrowException(&backlog, &_TI1_AVZException__);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00402AB0) --------------------------------------------------------
void __thiscall ZSocketBase::SetNonBlocking(ZSocketBase *this, int bNonBlocking)
{
  unsigned int v2; // ecx@1
  ZSocketBase *v3; // [sp+0h] [bp-4h]@1

  v3 = this;
  v2 = this->_m_hSocket;
  bNonBlocking = bNonBlocking != 0;
  if ( ioctlsocket(v2, -2147195266, (u_long *)&bNonBlocking) == -1 )
  {
    v3 = (ZSocketBase *)WSAGetLastError();
    _CxxThrowException(&v3, &_TI1_AVZException__);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00402AF1) --------------------------------------------------------
void __thiscall ZSocketBase::UpdateAcceptContext(ZSocketBase *this, unsigned int hListenSocket)
{
  ZSocketBase *v2; // [sp+0h] [bp-4h]@1

  v2 = this;
  if ( setsockopt(this->_m_hSocket, 0xFFFF, 28683, (const char *)&hListenSocket, 4) == -1 )
  {
    v2 = (ZSocketBase *)WSAGetLastError();
    _CxxThrowException(&v2, &_TI1_AVZException__);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00402B2E) --------------------------------------------------------
void __thiscall ZPort::~ZPort(ZPort *this)
{
  ZPort *v1; // esi@1

  v1 = this;
  this->vfptr = (ZPortVtbl *)&ZPort::`vftable';
  ZPort::ClosePort(this, 0);
  v1->_m_lpThreads.vfptr = (ZList<ZPort::ZPortThread *>Vtbl *)&ZList<ZPort::ZPortThread *>::`vftable';
  ZList<ZPort::ZPortThread *>::RemoveAll(&v1->_m_lpThreads);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->_m_lockThreads.DebugInfo);
}
// 4433B0: using guessed type int (__thiscall *ZList<ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags);
// 4433B8: using guessed type int (__thiscall *ZPort::`vftable')(void *p, unsigned int __flags);

//----- (00402B87) --------------------------------------------------------
ZList<ZPort::ZPortThread *> *__thiscall ZList<ZPort::ZPortThread *>::`vector deleting destructor'(ZList<ZPort::ZPortThread *> *this, unsigned int __flags)
{
  ZList<ZPort::ZPortThread *> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZList<ZPort::ZPortThread *>Vtbl *)&ZList<ZPort::ZPortThread *>::`vftable';
  ZList<ZPort::ZPortThread *>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 4433B0: using guessed type int (__thiscall *ZList<ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags);

//----- (00402BAD) --------------------------------------------------------
void __thiscall ZList<ZPort::ZPortThread *>::RemoveAll(ZList<ZPort::ZPortThread *> *this)
{
  ZList<ZPort::ZPortThread *> *v1; // esi@1
  ZPort::ZPortThread **i; // eax@1
  ZRefCounted *v3; // eax@2
  int v4; // edi@2

  v1 = this;
  for ( i = this->_m_pHead; i; i = (ZPort::ZPortThread **)(v4 != 0 ? v4 + 16 : 0) )
  {
    v3 = (ZRefCounted *)(i != 0 ? (unsigned int)(i - 4) : 0);
    v4 = v3->_m_nRef;
    ZRefCountedAccessorBase::_Delete(v3);
  }
  v1->_m_pTail = 0;
  v1->_m_pHead = 0;
  v1->_m_uCount = 0;
}

//----- (00402BE7) --------------------------------------------------------
ZPort *__thiscall ZPort::`vector deleting destructor'(ZPort *this, unsigned int __flags)
{
  ZPort *v2; // esi@1

  v2 = this;
  ZPort::~ZPort(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00402C07) --------------------------------------------------------
void __thiscall ZSocketEx::_SockRelease(ZSocketEx *this)
{
  ZSocketEx *v1; // esi@1

  v1 = this;
  if ( !InterlockedDecrement(&this->_m_nRef) )
  {
    if ( v1 )
      v1->vfptr->__vecDelDtor((ZRefCounted *)v1, 1u);
  }
}

//----- (00402C26) --------------------------------------------------------
void __cdecl ZSocketBuffer::Alloc(unsigned int u)
{
  char *v1; // edi@1
  ZSocketBuffer *v2; // ecx@1

  v1 = (char *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, u);
  v2 = (ZSocketBuffer *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x1Cu);
  if ( v2 )
    ZSocketBuffer::ZSocketBuffer(v2, u, v1, 0);
}

//----- (00402C73) --------------------------------------------------------
void __thiscall ZSocketBuffer::ZSocketBuffer(ZSocketBuffer *this, unsigned int len, char *buf, ZSocketBuffer *pParent)
{
  ZSocketBuffer *v4; // esi@1

  v4 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v4->_m_pParent.p = 0;
  v4->len = len;
  v4->vfptr = (ZRefCountedVtbl *)&ZSocketBuffer::`vftable';
  v4->buf = buf;
  ZRef<ZSocketBuffer>::operator=(&v4->_m_pParent, pParent);
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4433C0: using guessed type int (__thiscall *ZSocketBuffer::`vftable')(void *p, unsigned int __flags);

//----- (00402CD1) --------------------------------------------------------
ZRef<ZSocketBuffer> *__thiscall ZRef<ZSocketBuffer>::operator=(ZRef<ZSocketBuffer> *this, ZSocketBuffer *pT)
{
  ZRef<ZSocketBuffer> *v2; // esi@1
  ZSocketBuffer *v3; // eax@3
  ZRef<ZSocketBuffer> r; // [sp+4h] [bp-8h]@1

  v2 = this;
  r.p = pT;
  if ( pT )
    InterlockedIncrement(&pT->_m_nRef);
  v3 = v2->p;
  v2->p = r.p;
  r.p = v3;
  if ( v3 )
    ZRef<ZSocketBuffer>::_ReleaseRaw(&r, 0);
  return v2;
}

//----- (00402D0E) --------------------------------------------------------
ZSocketBuffer *__thiscall ZSocketBuffer::`vector deleting destructor'(ZSocketBuffer *this, unsigned int __flags)
{
  ZSocketBuffer *v2; // esi@1

  v2 = this;
  ZSocketBuffer::~ZSocketBuffer(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00402D2E) --------------------------------------------------------
void __thiscall ZSocketBuffer::~ZSocketBuffer(ZSocketBuffer *this)
{
  ZSocketBuffer *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZSocketBuffer::`vftable';
  if ( !this->_m_pParent.p )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this->buf);
  if ( v1->_m_pParent.p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(&v1->_m_pParent, 0);
    v1->_m_pParent.p = 0;
  }
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4433C0: using guessed type int (__thiscall *ZSocketBuffer::`vftable')(void *p, unsigned int __flags);

//----- (00402D8D) --------------------------------------------------------
void __thiscall ZPort::ZPort(ZPort *this)
{
  ZPort *v1; // esi@1

  v1 = this;
  this->_m_hPort = 0;
  this->_m_nAttachedHandles = 0;
  this->_m_nTerminatingThreads = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->_m_lockThreads.DebugInfo);
  v1->_m_lpThreads._m_uCount = 0;
  v1->_m_lpThreads._m_pHead = 0;
  v1->_m_lpThreads._m_pTail = 0;
  v1->_m_lpThreads.vfptr = (ZList<ZPort::ZPortThread *>Vtbl *)&ZList<ZPort::ZPortThread *>::`vftable';
  v1->vfptr = (ZPortVtbl *)&ZPort::`vftable';
}
// 4433B0: using guessed type int (__thiscall *ZList<ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags);
// 4433B8: using guessed type int (__thiscall *ZPort::`vftable')(void *p, unsigned int __flags);

//----- (00402DC1) --------------------------------------------------------
void __thiscall ZPort::Attach(ZPort *this, void *hFile)
{
  ZPort *v2; // esi@1

  v2 = this;
  if ( !CreateIoCompletionPort(hFile, this->_m_hPort, 0, 0) )
  {
    hFile = (void *)((int (__cdecl *)())dword_4A474C)();
    _CxxThrowException(&hFile, &_TI1_AVZException__);
  }
  InterlockedIncrement(&v2->_m_nAttachedHandles);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (00402E01) --------------------------------------------------------
int __thiscall ZPort::BeginPort(ZPort *this, unsigned int uThreads)
{
  ZPort *v2; // esi@1
  HANDLE v3; // eax@1
  unsigned int v4; // eax@2
  int v5; // eax@3
  int v6; // ebx@6
  int result; // eax@12
  int v8; // [sp+8h] [bp-24h]@4
  int v9; // [sp+1Ch] [bp-10h]@4
  unsigned int uThreadsa; // [sp+34h] [bp+8h]@7

  v2 = this;
  dword_4A4754();
  v2->_m_nTerminatingThreads = 0;
  v3 = CreateIoCompletionPort((HANDLE)0xFFFFFFFF, 0, 0, 0);
  v2->_m_hPort = v3;
  if ( !v3 )
    goto LABEL_16;
  v4 = uThreads;
  if ( !uThreads )
  {
    v5 = `ZPort::GetProcessorCount'::`2'::s_uProcessorCount;
    if ( !`ZPort::GetProcessorCount'::`2'::s_uProcessorCount )
    {
      dword_4A4788(&v8);
      v5 = v9;
      `ZPort::GetProcessorCount'::`2'::s_uProcessorCount = v9;
    }
    v4 = 2 * v5 + 2;
  }
  v6 = 0;
  if ( !v4 )
    goto LABEL_16;
  uThreadsa = v4;
  do
  {
    if ( ZPort::_AddThread(v2) )
      ++v6;
    --uThreadsa;
  }
  while ( uThreadsa );
  if ( v6 )
    result = 1;
  else
LABEL_16:
    result = 0;
  return result;
}
// 4A4754: using guessed type int (*dword_4A4754)(void);
// 4A4788: using guessed type int (__stdcall *dword_4A4788)(_DWORD);
// 4A6588: using guessed type int `ZPort::GetProcessorCount'::`2'::s_uProcessorCount;

//----- (00402E7E) --------------------------------------------------------
int __thiscall ZPort::_AddThread(ZPort *this)
{
  ZPort *v1; // edi@1
  signed int v2; // ebx@1
  int v3; // eax@1
  ZPort::ZPortThread *v4; // esi@2
  struct _RTL_CRITICAL_SECTION *lpCriticalSection; // [sp+10h] [bp-10h]@1

  v1 = this;
  lpCriticalSection = (struct _RTL_CRITICAL_SECTION *)&this->_m_lockThreads.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lockThreads.DebugInfo);
  v2 = 0;
  v3 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x1Cu);
  if ( v3 )
  {
    *(_DWORD *)(v3 + 4) = 0;
    *(_DWORD *)(v3 + 8) = 0;
    *(_DWORD *)(v3 + 12) = v1;
    *(_DWORD *)(v3 + 20) = 0;
    *(_DWORD *)v3 = &ZPort::ZPortThread::`vftable';
    v4 = (ZPort::ZPortThread *)v3;
  }
  else
  {
    v4 = 0;
  }
  if ( v4 )
  {
    if ( ZThread::BeginThread((ZThread *)&v4->vfptr, 0, 0, 0, 0, 0) )
    {
      *ZList<ZPort::ZPortThread *>::AddTail(&v1->_m_lpThreads) = v4;
      v2 = 1;
    }
    else
    {
      v4->vfptr->__vecDelDtor((ZThread *)v4, 1u);
    }
  }
  LeaveCriticalSection(lpCriticalSection);
  return v2;
}
// 4433C8: using guessed type int (__thiscall *ZPort::ZPortThread::`vftable')(void *p, unsigned int __flags);

//----- (00402F11) --------------------------------------------------------
int __thiscall ZThread::BeginThread(ZThread *this, void *pParam, int nPriority, int bSuspended, unsigned int dwStackSize, _SECURITY_ATTRIBUTES *lpThreadAttributes)
{
  ZThread *v6; // esi@1
  void *v7; // eax@1
  int v8; // eax@3
  int v9; // esi@4
  unsigned int v10; // ST14_4@8
  ZThread::_ZTS zts; // [sp+8h] [bp-1Ch]@1
  unsigned int tid; // [sp+20h] [bp-4h]@3

  v6 = this;
  memset(&zts, 0, 0x18u);
  zts.pParam = pParam;
  zts.pThis = v6;
  zts.uInitFlag = bSuspended != 0 ? 4 : 0;
  zts.hEvent = (void *)dword_4A4684(0, 1, 0, 0);
  v7 = (void *)dword_4A4684(0, 1, 0, 0);
  zts.hEvent2 = v7;
  zts.dwError = 0;
  if ( !zts.hEvent || !v7 )
  {
    v9 = ((int (__cdecl *)())dword_4A474C)();
    if ( zts.hEvent )
      dword_4A4638(zts.hEvent);
    if ( !zts.hEvent2 )
      goto LABEL_16;
    goto LABEL_15;
  }
  tid = 0;
  v8 = _beginthreadex(lpThreadAttributes, dwStackSize, (int)ZThread::_ZTE, (int)&zts, zts.uInitFlag | 4, &tid);
  v6->_m_hThread = (void *)v8;
  if ( !v8 )
  {
    v9 = ((int (__cdecl *)())dword_4A474C)();
    dword_4A4638(zts.hEvent);
LABEL_15:
    dword_4A4638(zts.hEvent2);
LABEL_16:
    dword_4A4750(v9);
    return 0;
  }
  v6->_m_dwThreadId = tid;
  if ( nPriority )
    dword_4A4660(v8, nPriority);
  dword_4A4664(v6->_m_hThread);
  dword_4A4694(zts.hEvent, -1);
  dword_4A4638(zts.hEvent);
  if ( zts.dwError )
  {
    dword_4A4638(v6->_m_hThread);
    v10 = zts.dwError;
    v6->_m_hThread = 0;
    v6->_m_dwThreadId = 0;
    dword_4A4750(v10);
    return 0;
  }
  if ( zts.uInitFlag & 4 )
    dword_4A4668(v6->_m_hThread);
  dword_4A4688(zts.hEvent2);
  return 1;
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);
// 4A4660: using guessed type int (__stdcall *dword_4A4660)(_DWORD, _DWORD);
// 4A4664: using guessed type int (__stdcall *dword_4A4664)(_DWORD);
// 4A4668: using guessed type int (__stdcall *dword_4A4668)(_DWORD);
// 4A4684: using guessed type int (__stdcall *dword_4A4684)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4A4688: using guessed type int (__stdcall *dword_4A4688)(_DWORD);
// 4A4694: using guessed type int (__stdcall *dword_4A4694)(_DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);
// 4A4750: using guessed type int (__stdcall *dword_4A4750)(_DWORD);

//----- (0040304F) --------------------------------------------------------
int __stdcall ZThread::_ZTE(void *pVoid)
{
  return (*(int (__stdcall **)(_DWORD, void *))(**(_DWORD **)pVoid + 4))(*((_DWORD *)pVoid + 1), pVoid);
}

//----- (00403061) --------------------------------------------------------
ZPort::ZPortThread **__thiscall ZList<ZPort::ZPortThread *>::AddTail(ZList<ZPort::ZPortThread *> *this)
{
  ZList<ZPort::ZPortThread *> *v1; // esi@1
  ZPort::ZPortThread **result; // eax@1
  ZPort::ZPortThread **v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<ZPort::ZPortThread *>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)(result - 4) : 0;
    *(v3 != 0 ? v3 - 3 : 4) = (ZPort::ZPortThread *)v4;
    result = (ZPort::ZPortThread **)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (0040309F) --------------------------------------------------------
ZPort::ZPortThread **__thiscall ZList<ZPort::ZPortThread *>::_New(ZList<ZPort::ZPortThread *> *this, void *pPrev, void *pNext)
{
  ZList<ZPort::ZPortThread *> *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (ZPort::ZPortThread **)(v4 != 0 ? v4 + 16 : 0);
}

//----- (004030DE) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<ZPort::ZPortThread *> *v0; // ecx@1

  v0 = (ZRefCountedDummy<ZPort::ZPortThread *> *)ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<ZPort::ZPortThread *>::ZRefCountedDummy<ZPort::ZPortThread *>(v0);
}

//----- (00403113) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance,
    p);
}

//----- (00403123) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (00403149) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZPort::ZPortThread *>::ZRefCountedDummy<ZPort::ZPortThread *>(ZRefCountedDummy<ZPort::ZPortThread *> *this)
{
  ZRefCountedDummy<ZPort::ZPortThread *> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>Vtbl *)&ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<ZPort::ZPortThread *>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>Vtbl *)&ZRefCountedDummy<ZPort::ZPortThread *>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4433D4: using guessed type void *ZRefCountedDummy<ZPort::ZPortThread *>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>'};
// 4433DC: using guessed type int (__thiscall *ZRefCountedDummy<ZPort::ZPortThread *>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 4433E4: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags);

//----- (00403177) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *__thiscall ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>Vtbl *)&ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance,
      this);
  return v2;
}
// 4433E4: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags);

//----- (00403199) --------------------------------------------------------
ZRefCountedDummy<ZPort::ZPortThread *> *__thiscall ZRefCountedDummy<ZPort::ZPortThread *>::`vector deleting destructor'(ZRefCountedDummy<ZPort::ZPortThread *> *this, unsigned int __flags)
{
  ZRefCountedDummy<ZPort::ZPortThread *> *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<ZPort::ZPortThread *>::~ZRefCountedDummy<ZPort::ZPortThread *>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance,
      v2);
  return v2;
}

//----- (004031BA) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZPort::ZPortThread *>::~ZRefCountedDummy<ZPort::ZPortThread *>(ZRefCountedDummy<ZPort::ZPortThread *> *this)
{
  *(_DWORD *)(this != 0 ? (unsigned int)&this->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable';
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4433E4: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags);

//----- (004031D2) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x14u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (0040322E) --------------------------------------------------------
int __thiscall ZPort::ZPortThread::Run(ZPort::ZPortThread *this, void *__formal, ZThread::ZThreadResult *pResult)
{
  ZPort::ZPortThread *v3; // esi@1
  int v4; // edi@6
  int v6; // [sp+0h] [bp-10h]@0
  unsigned int key; // [sp+8h] [bp-8h]@5
  unsigned int dwBytes; // [sp+Ch] [bp-4h]@1

  v3 = this;
  ZThread::ZThreadResult::Succeeded(pResult);
  dwBytes = 0;
  while ( 1 )
  {
    if ( v3->m_pPort->_m_nTerminatingThreads <= 0 )
      goto LABEL_5;
    if ( InterlockedDecrement(&v3->m_pPort->_m_nTerminatingThreads) >= 0 )
      break;
    InterlockedIncrement(&v3->m_pPort->_m_nTerminatingThreads);
LABEL_5:
    pResult = 0;
    if ( GetQueuedCompletionStatus(v3->m_pPort->_m_hPort, &dwBytes, &key, (LPOVERLAPPED *)&pResult, 0xFFFFFFFF) )
      v4 = 0;
    else
      v4 = dword_4A474C(v6);
    if ( pResult )
    {
      v3->m_pOverlapped = (ZOverlapped *)pResult;
      v3->m_tProcessStart = dword_4A4754();
      v3->m_bProcessing = 1;
      (***(void (__stdcall ****)(_DWORD, _DWORD, _DWORD, _DWORD))&pResult[20])(
        *(_DWORD *)&pResult[24],
        key,
        v4,
        dwBytes);
      v3->m_bProcessing = 0;
    }
  }
  ZPort::_ThreadExit(v3->m_pPort, v3);
  return 0;
}
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);
// 4A4754: using guessed type int (*dword_4A4754)(void);

//----- (004032DF) --------------------------------------------------------
void __thiscall ZThread::ZThreadResult::Succeeded(ZThread::ZThreadResult *this)
{
  int v1; // esi@1

  *(_DWORD *)&this[20] = 0;
  v1 = *(_DWORD *)&this[16];
  dword_4A4688(*(_DWORD *)&this[12]);
  dword_4A4694(v1, -1);
  dword_4A4638(v1);
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);
// 4A4688: using guessed type int (__stdcall *dword_4A4688)(_DWORD);
// 4A4694: using guessed type int (__stdcall *dword_4A4694)(_DWORD, _DWORD);

//----- (00403302) --------------------------------------------------------
ZPort::ZPortThread *__thiscall ZPort::ZPortThread::`vector deleting destructor'(ZPort::ZPortThread *this, unsigned int __flags)
{
  ZPort::ZPortThread *v2; // esi@1

  v2 = this;
  ZPort::ZPortThread::~ZPortThread(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00403322) --------------------------------------------------------
void __thiscall ZPort::ZPortThread::~ZPortThread(ZPort::ZPortThread *this)
{
  this->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  ZThread::CloseThread((ZThread *)&this->vfptr);
}
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);

//----- (0040332D) --------------------------------------------------------
int __stdcall ZThread::Run(void *pParam, ZThread::ZThreadResult *pResult)
{
  ZThread::ZThreadResult::Succeeded(pResult);
  return 0;
}

//----- (0040333B) --------------------------------------------------------
ZThread *__thiscall ZThread::`vector deleting destructor'(ZThread *this, unsigned int __flags)
{
  ZThread *v2; // esi@1

  v2 = this;
  this->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  ZThread::CloseThread(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);

//----- (00403361) --------------------------------------------------------
void __thiscall ZThread::CloseThread(ZThread *this)
{
  LONG v1; // eax@1

  this->_m_dwThreadId = 0;
  v1 = InterlockedExchange((volatile LONG *)&this->_m_hThread, 0);
  if ( v1 )
    dword_4A4638(v1);
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);

//----- (0040337D) --------------------------------------------------------
void __thiscall ZPort::_ThreadExit(ZPort *this, ZPort::ZPortThread *pThread)
{
  ZPort *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1
  ZPort::ZPortThread **v4; // eax@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->_m_lockThreads.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lockThreads.DebugInfo);
  v2 = (ZPort *)((char *)v2 + 40);
  v4 = ZList<ZPort::ZPortThread *>::Find((ZList<ZPort::ZPortThread *> *)v2, &pThread, 0);
  ZList<ZPort::ZPortThread *>::RemoveAt((ZList<ZPort::ZPortThread *> *)v2, (__POSITION *)v4);
  if ( pThread )
    ((void (__stdcall *)(_DWORD))pThread->vfptr->__vecDelDtor)(1);
  LeaveCriticalSection(v3);
}

//----- (004033D9) --------------------------------------------------------
void __thiscall ZList<ZPort::ZPortThread *>::RemoveAt(ZList<ZPort::ZPortThread *> *this, __POSITION *pos)
{
  int v2; // edx@1
  int v3; // eax@2
  int v4; // eax@4
  int v5; // eax@5
  int v6; // eax@6
  int v7; // eax@7
  int v8; // edx@7
  int v9; // eax@7
  int v10; // edx@7

  v2 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8);
  if ( *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? v2 + 16 : 0 )
  {
    v5 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v5 + 16 : 0 )
    {
      v7 = v5 != 0 ? v5 + 16 : 0;
      v8 = v2 != 0 ? v2 + 16 : 0;
      *(_DWORD *)(v8 != 0 ? v8 - 16 + 4 : 4) = v7 != 0 ? v7 - 16 : 0;
      v9 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      v10 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v10 != 0 ? v10 - 16 + 8 : 8) = v9 != 0 ? v9 - 16 : 0;
    }
    else
    {
      this->_m_pTail = (ZPort::ZPortThread **)(v2 != 0 ? v2 + 16 : 0);
      v6 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      *(_DWORD *)(v6 != 0 ? v6 - 16 + 4 : 4) = 0;
    }
  }
  else
  {
    v3 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v3 + 16 : 0 )
    {
      this->_m_pHead = (ZPort::ZPortThread **)(v3 != 0 ? v3 + 16 : 0);
      v4 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v4 != 0 ? v4 - 16 + 8 : 8) = 0;
    }
    else
    {
      this->_m_pTail = 0;
      this->_m_pHead = 0;
    }
  }
  --this->_m_uCount;
  ZRefCountedAccessorBase::_Delete((ZRefCounted *)(pos != 0 ? (unsigned int)&pos[-16] : 0));
}

//----- (004034EB) --------------------------------------------------------
ZPort::ZPortThread **__thiscall ZList<ZPort::ZPortThread *>::Find(ZList<ZPort::ZPortThread *> *this, ZPort::ZPortThread *const *d, __POSITION *posAfter)
{
  ZPort::ZPortThread **result; // eax@2
  int v4; // eax@6

  if ( posAfter )
    result = (ZPort::ZPortThread **)(*(_DWORD *)&posAfter[-12] != 0 ? *(_DWORD *)&posAfter[-12] + 16 : 0);
  else
    result = this->_m_pHead;
  if ( result )
  {
    while ( *result != *d )
    {
      v4 = (int)*(result != 0 ? result - 3 : 4);
      result = (ZPort::ZPortThread **)(v4 != 0 ? v4 + 16 : 0);
      if ( !result )
        goto LABEL_7;
    }
  }
  else
  {
LABEL_7:
    result = 0;
  }
  return result;
}

//----- (00403534) --------------------------------------------------------
void __thiscall ZPort::ClosePort(ZPort *this, int bWait)
{
  ZPort *v2; // esi@1
  unsigned int v3; // [sp+Ch] [bp-10h]@5

  v2 = this;
  if ( bWait )
  {
    while ( v2->_m_nAttachedHandles )
      dword_4A469C(100);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)&v2->_m_lockThreads.DebugInfo);
  if ( v2->_m_lpThreads._m_uCount > 0 )
  {
    v3 = v2->_m_lpThreads._m_uCount;
    do
    {
      ZPort::_RemoveThread(v2);
      --v3;
    }
    while ( v3 );
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&v2->_m_lockThreads.DebugInfo);
  if ( bWait )
  {
    while ( v2->_m_lpThreads._m_uCount )
      dword_4A469C(100);
  }
  if ( v2->_m_hPort )
  {
    dword_4A4638(v2->_m_hPort);
    v2->_m_hPort = 0;
  }
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);
// 4A469C: using guessed type int (__stdcall *dword_4A469C)(_DWORD);

//----- (004035C2) --------------------------------------------------------
int __thiscall ZPort::_RemoveThread(ZPort *this)
{
  ZPort *v1; // esi@1

  v1 = this;
  InterlockedIncrement(&this->_m_nTerminatingThreads);
  PostQueuedCompletionStatus(v1->_m_hPort, 0, 0, 0);
  return 1;
}

//----- (004035E2) --------------------------------------------------------
void __thiscall ZSocketEx::AttachPort(ZSocketEx *this, ZPort *pPort)
{
  ZSocketEx *v2; // esi@1
  ZSocketBase *v3; // edi@1
  ZPort *v4; // ecx@1
  ZPort *v5; // eax@1

  v2 = this;
  v3 = (ZSocketBase *)&this->_m_hSocket;
  ZSocketBase::SetReceiveBufferSize((ZSocketBase *)&this->_m_hSocket, 0);
  ZSocketBase::SetSendBufferSize(v3, 0);
  v4 = pPort;
  v2->_m_pPort = pPort;
  ZPort::Attach(v4, *(void **)(v2 != 0 ? (unsigned int)v3 : 0));
  ZSocketEx::NotifySend(v2);
  EnterCriticalSection((LPCRITICAL_SECTION)&v2->_m_lockSend.DebugInfo);
  v5 = (ZPort *)ZSocketEx::_BeginRecv(v2);
  if ( v5 )
  {
    pPort = v5;
    _CxxThrowException(&pPort, &_TI1_AVZException__);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&v2->_m_lockSend.DebugInfo);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00403666) --------------------------------------------------------
void __thiscall ZSocketBase::SetReceiveBufferSize(ZSocketBase *this, unsigned int uSize)
{
  ZSocketBase *v2; // [sp+0h] [bp-4h]@1

  v2 = this;
  if ( setsockopt(this->_m_hSocket, 0xFFFF, 4098, (const char *)&uSize, 4) == -1 )
  {
    v2 = (ZSocketBase *)WSAGetLastError();
    _CxxThrowException(&v2, &_TI1_AVZException__);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (004036A9) --------------------------------------------------------
void __thiscall ZSocketBase::SetSendBufferSize(ZSocketBase *this, unsigned int uSize)
{
  ZSocketBase *v2; // [sp+0h] [bp-4h]@1

  v2 = this;
  if ( setsockopt(this->_m_hSocket, 0xFFFF, 4097, (const char *)&uSize, 4) == -1 )
  {
    v2 = (ZSocketBase *)WSAGetLastError();
    _CxxThrowException(&v2, &_TI1_AVZException__);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (004036EC) --------------------------------------------------------
void __thiscall ZSocketEx::NotifySend(ZSocketEx *this)
{
  ZSocketEx *v1; // esi@1
  bool v2; // zf@3
  int v3; // [sp+Ch] [bp-14h]@6
  ZCriticalSectionEx<4000> *v4; // [sp+10h] [bp-10h]@2
  int v5; // [sp+1Ch] [bp-4h]@3

  v1 = this;
  if ( !this->_m_pPort )
  {
    v4 = (ZCriticalSectionEx<4000> *)10057;
    _CxxThrowException(&v4, &_TI1_AVZException__);
  }
  v4 = &this->_m_lockSend;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lockSend.DebugInfo);
  v2 = v1->_m_bSendOverlapped == 0;
  v5 = 0;
  if ( v2 )
  {
    InterlockedIncrement(&v1->_m_nRef);
    if ( !PostQueuedCompletionStatus(v1->_m_pPort->_m_hPort, 0, 0, (LPOVERLAPPED)&v1->_m_olSend.Internal) )
    {
      ZSocketEx::_SockRelease(v1);
      v3 = ((int (__cdecl *)())dword_4A474C)();
      _CxxThrowException(&v3, &_TI1_AVZException__);
    }
    v1->_m_bSendOverlapped = 1;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&v1->_m_lockSend.DebugInfo);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (00403790) --------------------------------------------------------
unsigned int __thiscall ZSocketEx::_BeginRecv(ZSocketEx *this)
{
  ZSocketEx *v1; // esi@1
  unsigned int result; // eax@1
  ZSocketBuffer *v3; // ecx@4
  unsigned int v4; // edx@5
  bool v5; // cf@5
  char *v6; // eax@6
  ZSocketBuffer *v7; // eax@7
  ZSocketBuffer *v8; // eax@7
  SOCKET v9; // ST00_4@10
  int v10; // edi@11
  _WSABUF buf; // [sp+8h] [bp-14h]@5
  unsigned int dwReceived; // [sp+10h] [bp-Ch]@10
  unsigned int dwFlags; // [sp+14h] [bp-8h]@10

  v1 = this;
  result = this->_m_dwErrRecv;
  if ( !result )
  {
    if ( this->_m_bDeleted )
      return 10054;
    v3 = this->_m_pRecvBuff.p;
    if ( !v3 || (v4 = v1->_m_uRecvBegin, v5 = v3->len - v4 < v1->_m_uMinRecv, buf.len = v3->len - v4, v5) )
    {
      buf.len = 1460;
      ZSocketBuffer::Alloc(0x5B4u);
      ZRef<ZSocketBuffer>::operator=(&v1->_m_pRecvBuff, v7);
      v1->_m_uRecvBegin = 0;
      v8 = v1->_m_pRecvBuff.p;
      if ( !v8 )
        return 14;
      v6 = v8->buf;
    }
    else
    {
      v6 = &v3->buf[v4];
    }
    buf.buf = v6;
    InterlockedIncrement(&v1->_m_nRef);
    v1->_m_olRecv.Offset = 0;
    v9 = *(_DWORD *)(v1 != 0 ? (unsigned int)&v1->_m_hSocket : 0);
    dwReceived = 0;
    dwFlags = 0;
    if ( WSARecv(v9, &buf, 1u, &dwReceived, &dwFlags, (LPWSAOVERLAPPED)&v1->_m_olRecv, 0) != -1
      || (v10 = WSAGetLastError(), v10 == 997) )
    {
      result = 0;
    }
    else
    {
      ZSocketEx::_SockRelease(v1);
      result = v10;
    }
  }
  return result;
}

//----- (00403881) --------------------------------------------------------
void __thiscall CAdminSocket::CAdminSocket(CAdminSocket *this)
{
  CAdminSocket *v1; // esi@1

  v1 = this;
  ZSocketEx::ZSocketEx((ZSocketEx *)&this->vfptr);
  v1->vfptr = (CVerboseObjVtbl *)&CVerboseObj::`vftable';
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->m_lockSend.DebugInfo);
  v1->m_bClosePosted = 0;
  CInPacket::CInPacket(&v1->m_packetRecv, 0);
  CInPacket::CInPacket(&v1->m_packetLoopback, 1);
  v1->m_posList = 0;
  v1->m_sAddr._m_pStr = 0;
  v1->vfptr = (ZRefCountedVtbl *)&CAdminSocket::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZOverlapped::ZICallBackVtbl *)&CAdminSocket::`vftable'{for `ZOverlapped::ZICallBack'};
  v1->vfptr = (CVerboseObjVtbl *)&CAdminSocket::`vftable';
}
// 4433F8: using guessed type const char *(__thiscall *CAdminSocket::`vftable')(CVerboseObj *__hidden this);
// 443400: using guessed type void (__thiscall *CAdminSocket::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32);
// 44340C: using guessed type int (__thiscall *CAdminSocket::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443420: using guessed type const char *(__thiscall *CVerboseObj::`vftable')(CVerboseObj *__hidden this);

//----- (0040390E) --------------------------------------------------------
void __thiscall CInPacket::CInPacket(CInPacket *this, int bLoopback)
{
  CInPacket *v2; // esi@1

  v2 = this;
  this->m_bLoopback = bLoopback;
  this->m_aRecvBuff.a = 0;
  ZArray<unsigned char>::_Alloc(&this->m_aRecvBuff, 0x100u, (ZAllocHelper *)&bLoopback + 3);
  v2->m_nState = 0;
  v2->m_uLength = 0;
  v2->m_uOffset = 0;
}

//----- (00403942) --------------------------------------------------------
void __thiscall CInPacket::~CInPacket(CInPacket *this)
{
  ZArray<unsigned char>::RemoveAll(&this->m_aRecvBuff);
}

//----- (0040394A) --------------------------------------------------------
CAdminSocket *__thiscall CAdminSocket::`vector deleting destructor'(CAdminSocket *this, unsigned int __flags)
{
  CAdminSocket *v2; // esi@1

  v2 = this;
  CAdminSocket::~CAdminSocket(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0040396A) --------------------------------------------------------
void __thiscall CAdminSocket::~CAdminSocket(CAdminSocket *this)
{
  CAdminSocket *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&CAdminSocket::`vftable'{for `ZRefCounted'};
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&CAdminSocket::`vftable'{for `ZOverlapped::ZICallBack'};
  this->vfptr = (CVerboseObjVtbl *)&CAdminSocket::`vftable';
  ZXString<char>::~ZXString<char>(&this->m_sAddr);
  ZArray<unsigned char>::RemoveAll(&v1->m_packetLoopback.m_aRecvBuff);
  ZArray<unsigned char>::RemoveAll(&v1->m_packetRecv.m_aRecvBuff);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lockSend.DebugInfo);
  ZSocketEx::~ZSocketEx((ZSocketEx *)&v1->vfptr);
}
// 4433F8: using guessed type const char *(__thiscall *CAdminSocket::`vftable')(CVerboseObj *__hidden this);
// 443400: using guessed type void (__thiscall *CAdminSocket::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32);
// 44340C: using guessed type int (__thiscall *CAdminSocket::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);

//----- (004039E7) --------------------------------------------------------
int __thiscall CAdminSocket::PostClose(CAdminSocket *this)
{
  CAdminSocket *v1; // esi@1
  int result; // eax@2
  COutPacket oPacket; // [sp+4h] [bp-1Ch]@3
  int v4; // [sp+1Ch] [bp-4h]@3

  v1 = this;
  if ( InterlockedCompareExchange(&this->m_bClosePosted, 1, 0) )
  {
    result = 0;
  }
  else
  {
    COutPacket::COutPacket(&oPacket, 2, 1);
    v4 = 0;
    CAdminSocket::SendPacket(v1, &oPacket, 1);
    v4 = -1;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
    result = 1;
  }
  return result;
}

//----- (00403A51) --------------------------------------------------------
void __thiscall CAdminSocket::SendPacket(CAdminSocket *this, COutPacket *oPacket, int bForce)
{
  int v3; // ebp@0
  CAdminSocket *v4; // ebx@1
  struct _RTL_CRITICAL_SECTION *v5; // edi@1
  bool v6; // zf@1
  ZRef<ZSocketBuffer> *v7; // edi@6
  ZSocketBuffer *v8; // ST10_4@8
  int v9; // [sp+0h] [bp-3Ch]@1
  ZList<ZRef<ZSocketBuffer> > l; // [sp+Ch] [bp-30h]@5
  CAdminSocket *v11; // [sp+24h] [bp-18h]@1
  ZCriticalSectionEx<4000> *v12; // [sp+28h] [bp-14h]@1
  int *v13; // [sp+2Ch] [bp-10h]@1
  int v14; // [sp+38h] [bp-4h]@1

  v4 = this;
  v5 = (struct _RTL_CRITICAL_SECTION *)&this->m_lockSend.DebugInfo;
  v13 = &v9;
  v11 = this;
  v14 = 0;
  v12 = &this->m_lockSend;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo);
  v6 = v4->m_bClosePosted == 0;
  LOBYTE(v14) = 1;
  if ( v6 || bForce )
  {
    l._m_uCount = 0;
    l._m_pHead = 0;
    l._m_pTail = 0;
    l.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
    v6 = oPacket->m_bLoopback == 0;
    LOBYTE(v14) = 2;
    if ( v6 )
    {
      COutPacket::MakeBufferList(oPacket, v3, &l, 0x1234u, 0, 0, 0);
      ZSocketEx::SendPacket((ZSocketEx *)&v4->vfptr, &l);
    }
    else
    {
      COutPacket::MakeBufferList(oPacket, v3, &l, 0, 0, 0, 0);
      v7 = l._m_pHead;
      while ( v7 )
      {
        v8 = v7->p;
        v7 = (ZRef<ZSocketBuffer> *)(v7[-2].p != 0 ? &v7[-2].p->buf : 0);
        ZSocketEx::LoopBackPacket((ZSocketEx *)&v4->vfptr, v8);
      }
    }
    LOBYTE(v14) = 1;
    l.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
    ZList<ZRef<ZSocketBuffer>>::RemoveAll(&l);
    LeaveCriticalSection((LPCRITICAL_SECTION)&v12->DebugInfo);
  }
  else
  {
    LeaveCriticalSection(v5);
  }
}
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (00403B28) --------------------------------------------------------
void *__usercall _L114803@<eax>(int a1@<ebp>)
{
  CAdminSocket *v1; // esi@1

  v1 = *(CAdminSocket **)(a1 - 24);
  CVerboseObj::LogException((CVerboseObj *)&v1->vfptr, *(ZException **)(a1 - 28));
  CAdminSocket::PostClose(v1);
  return &_L108139;
}

//----- (00403B46) --------------------------------------------------------
void __cdecl CAdminSocket::OnReceive(unsigned int dwErr, ZSocketBuffer *pBuff)
{
  CAdminSocket *this; // ecx@0
  CAdminSocket *v3; // esi@1
  bool v4; // zf@4
  int v5; // eax@9
  int v6; // [sp+0h] [bp-34h]@1
  ZRef<ZSocketBuffer> pBuffa; // [sp+Ch] [bp-28h]@4
  int v8; // [sp+18h] [bp-1Ch]@16
  int v9; // [sp+1Ch] [bp-18h]@13
  CAdminSocket *v10; // [sp+20h] [bp-14h]@1
  int *v11; // [sp+24h] [bp-10h]@1
  int v12; // [sp+30h] [bp-4h]@4

  v3 = this;
  v11 = &v6;
  v10 = this;
  if ( dwErr )
  {
    CVerboseObj::LogException((CVerboseObj *)&this->vfptr, (ZException *)&dwErr);
LABEL_22:
    CAdminSocket::PostClose(v3);
    return;
  }
  if ( !pBuff || !this->m_posList )
    goto LABEL_22;
  pBuffa.p = pBuff;
  v12 = 0;
  InterlockedIncrement(&pBuff->_m_nRef);
  v4 = pBuffa.p->_m_pPrev == 0;
  LOBYTE(v12) = 1;
  if ( v4 )
  {
    while ( pBuffa.p )
    {
      v5 = CInPacket::AppendBuffer(&v3->m_packetRecv, &pBuffa, (int *)&dwErr, 0);
      if ( v5 > 0 && (signed int)dwErr <= 0 )
      {
        if ( v3->m_packetRecv.m_uRawSeq != 4660 )
        {
          CVerboseObj::LogError((CVerboseObj *)&v3->vfptr, aIncorrectPacke);
          v9 = -2147467259;
          _CxxThrowException(&v9, &_TI1_AVZException__);
        }
        if ( v3->m_packetRecv.m_uDataLen > 0x1000u )
        {
          CVerboseObj::LogError((CVerboseObj *)&v3->vfptr, aReceivedPacket);
          v8 = -2147467259;
          _CxxThrowException(&v8, &_TI1_AVZException__);
        }
      }
      if ( v5 == 2 )
        CAdminSocket::ProcessPacket(v3, &v3->m_packetRecv);
    }
  }
  else
  {
    while ( pBuffa.p )
    {
      if ( CInPacket::AppendBuffer(&v3->m_packetLoopback, &pBuffa, 0, 0) == 2 )
        CAdminSocket::ProcessPacket(v3, &v3->m_packetLoopback);
    }
  }
  LOBYTE(v12) = 0;
  if ( pBuffa.p )
    ZRef<ZSocketBuffer>::_ReleaseRaw(&pBuffa, 0);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00403CE8) --------------------------------------------------------
void __thiscall CAdminSocket::ProcessPacket(CAdminSocket *this, CInPacket *iPacket)
{
  CAdminSocket *v2; // edi@1
  int v3; // eax@1
  int v4; // eax@2
  int v5; // eax@3
  int v6; // eax@4
  int v7; // eax@5

  v2 = this;
  v3 = (unsigned __int8)CInPacket::Decode1(iPacket);
  if ( iPacket->m_bLoopback )
  {
    if ( v3 == 2 )
      CAdminSocket::OnClose(v2, iPacket);
  }
  else
  {
    v4 = v3 - 5;
    if ( v4 )
    {
      v5 = v4 - 10;
      if ( v5 )
      {
        v6 = v5 - 17;
        if ( v6 )
        {
          v7 = v6 - 2;
          if ( v7 )
          {
            if ( v7 == 1 )
              CAdminSocket::OnIgnoreSSNOnCreateNewCharacter(v2, iPacket);
          }
          else
          {
            CAdminSocket::OnIgnoreSPW(v2, iPacket);
          }
        }
        else
        {
          CAdminSocket::OnReloadIPListRequest(v2, iPacket);
        }
      }
      else
      {
        CAdminSocket::OnBanUser(v2, iPacket);
      }
    }
    else
    {
      CAdminSocket::OnUserRequest(v2, iPacket);
    }
  }
  iPacket->m_nState = 0;
  iPacket->m_uLength = 0;
  iPacket->m_uOffset = 0;
}

//----- (00403D88) --------------------------------------------------------
void __thiscall CInPacket::AUTO_CLEAR::~AUTO_CLEAR(CInPacket::AUTO_CLEAR *this)
{
  CInPacket *v1; // eax@2

  if ( this->m_bClear )
  {
    v1 = this->m_pPacket;
    v1->m_nState = 0;
    v1->m_uLength = 0;
    v1->m_uOffset = 0;
  }
}

//----- (00403D9C) --------------------------------------------------------
char __thiscall CInPacket::Decode1(CInPacket *this)
{
  unsigned int v1; // edx@1
  char result; // al@3
  int v3; // [sp+4h] [bp-4h]@2

  v1 = this->m_uOffset;
  if ( this->m_uLength - v1 < 1 )
  {
    v3 = 38;
    _CxxThrowException(&v3, &_TI1_AVZException__);
  }
  result = this->m_aRecvBuff.a[v1];
  this->m_uOffset = v1 + 1;
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00403DD2) --------------------------------------------------------
void __thiscall CAdminSocket::OnClose(CAdminSocket *this, CInPacket *iPacket)
{
  CAdminSocket *v2; // esi@1
  ZRef<CAdminSocket> v3; // [sp+4h] [bp-14h]@1
  int v4; // [sp+14h] [bp-4h]@3

  v2 = this;
  v3.p = this;
  if ( this )
    InterlockedIncrement(&this->_m_nRef);
  CAdminAcceptor::RemoveSocket(TSingleton<CAdminAcceptor>::ms_pInstance, v2);
  v2->m_posList = 0;
  v4 = -1;
  if ( v3.p )
    ZRef<CAdminSocket>::_ReleaseRaw(&v3, 0);
}

//----- (00403E2C) --------------------------------------------------------
void __thiscall CAdminSocket::OnUserRequest(CAdminSocket *this, CInPacket *iPacket)
{
  CAdminSocket *v2; // ebx@1
  unsigned int v3; // edi@2
  COutPacket oPacket; // [sp+8h] [bp-1Ch]@4
  int v5; // [sp+20h] [bp-4h]@4

  v2 = this;
  if ( TSingleton<CLoginAcceptor>::ms_pInstance )
    v3 = TSingleton<CLoginAcceptor>::ms_pInstance->m_lpSocket._m_uCount;
  else
    v3 = 0;
  COutPacket::COutPacket(&oPacket, 4, 0);
  v5 = 0;
  COutPacket::InitByte(&oPacket, 4, 0);
  COutPacket::Encode4(&oPacket, v3);
  CAdminSocket::SendPacket(v2, &oPacket, 0);
  v5 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (00403E9E) --------------------------------------------------------
void __thiscall COutPacket::Encode4(COutPacket *this, unsigned int n)
{
  COutPacket *v2; // esi@1

  v2 = this;
  COutPacket::EnlargeBuffer(this, 4u);
  *(_DWORD *)&v2->m_aSendBuff.a[v2->m_uOffset] = n;
  v2->m_uOffset += 4;
}

//----- (00403EBD) --------------------------------------------------------
void __thiscall COutPacket::EnlargeBuffer(COutPacket *this, unsigned int uSize)
{
  COutPacket *v2; // eax@1
  char *v3; // edx@1
  ZArray<unsigned char> *v4; // ecx@1
  unsigned int v5; // esi@3
  unsigned int v6; // eax@4

  v2 = this;
  v3 = this->m_aSendBuff.a;
  v4 = &this->m_aSendBuff;
  if ( v3 )
    v3 = (char *)*((_DWORD *)v3 - 1);
  v5 = v2->m_uOffset + uSize;
  if ( v5 > (unsigned int)v3 )
  {
    v6 = (unsigned int)v4->a;
    if ( v4->a )
      v6 = *(_DWORD *)(v6 - 4);
    do
      v6 *= 2;
    while ( v5 > v6 );
    ZArray<unsigned char>::_Realloc(v4, v6, 0, (ZAllocHelper *)&uSize + 3);
  }
}

//----- (00403EFC) --------------------------------------------------------
void __thiscall CAdminSocket::OnBanUser(CAdminSocket *this, CInPacket *iPacket)
{
  unsigned int v2; // esi@1
  char v3; // di@1
  ZRef<CClientSocket> *v4; // eax@1
  COutPacket oPacket; // [sp+Ch] [bp-30h]@1
  ZRef<CClientSocket> result; // [sp+1Ch] [bp-20h]@1
  ZRef<CClientSocket> v7; // [sp+24h] [bp-18h]@1
  CAdminSocket *v8; // [sp+2Ch] [bp-10h]@1
  int v9; // [sp+38h] [bp-4h]@1

  v8 = this;
  v2 = CInPacket::Decode4(iPacket);
  v3 = 0;
  COutPacket::COutPacket(&oPacket, 6, 0);
  v9 = 0;
  v7.p = 0;
  LOBYTE(v9) = 1;
  v4 = CClientSocket::FindClinetSocketByAccountID(&result, v2);
  LOBYTE(v9) = 2;
  ZRef<CClientSocket>::operator=(&v7, v4);
  LOBYTE(v9) = 1;
  if ( result.p )
  {
    ZRef<CClientSocket>::_ReleaseRaw(&result, 0);
    result.p = 0;
  }
  if ( v7.p )
  {
    CClientSocket::PostClose(v7.p);
    v3 = 1;
  }
  COutPacket::Encode1(&oPacket, v3);
  CAdminSocket::SendPacket(v8, &oPacket, 0);
  LOBYTE(v9) = 0;
  if ( v7.p )
  {
    ZRef<CClientSocket>::_ReleaseRaw(&v7, 0);
    v7.p = 0;
  }
  v9 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (00403FB6) --------------------------------------------------------
unsigned int __thiscall CInPacket::Decode4(CInPacket *this)
{
  unsigned int v1; // edx@1
  unsigned int result; // eax@3
  int v3; // [sp+4h] [bp-4h]@2

  v1 = this->m_uOffset;
  if ( this->m_uLength - v1 < 4 )
  {
    v3 = 38;
    _CxxThrowException(&v3, &_TI1_AVZException__);
  }
  result = *(_DWORD *)&this->m_aRecvBuff.a[v1];
  this->m_uOffset = v1 + 4;
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00403FEE) --------------------------------------------------------
void __thiscall COutPacket::Encode1(COutPacket *this, char n)
{
  COutPacket *v2; // esi@1

  v2 = this;
  COutPacket::EnlargeBuffer(this, 1u);
  v2->m_aSendBuff.a[v2->m_uOffset++] = n;
}

//----- (0040400C) --------------------------------------------------------
ZRef<CClientSocket> *__cdecl CClientSocket::FindClinetSocketByAccountID(ZRef<CClientSocket> *result, const unsigned int __$ReturnUdt)
{
  CClientSocket *v2; // eax@1
  bool v3; // zf@1
  ZRef<CClientSocket> value; // [sp+8h] [bp-1Ch]@1
  struct _RTL_CRITICAL_SECTION *v6; // [sp+10h] [bp-14h]@1
  int v7; // [sp+14h] [bp-10h]@1
  int v8; // [sp+20h] [bp-4h]@1

  v7 = 0;
  value.p = 0;
  v8 = 1;
  v6 = &CClientSocket::ms_lockClient;
  EnterCriticalSection(&CClientSocket::ms_lockClient);
  LOBYTE(v8) = 2;
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::GetAt(&CClientSocket::ms_mClient, &__$ReturnUdt, &value);
  LeaveCriticalSection(&CClientSocket::ms_lockClient);
  v2 = value.p;
  v3 = value.p == 0;
  result->p = value.p;
  if ( !v3 )
  {
    InterlockedIncrement(&v2->_m_nRef);
    v2 = value.p;
  }
  v7 = 1;
  LOBYTE(v8) = 0;
  if ( v2 )
    ZRef<CClientSocket>::_ReleaseRaw(&value, 0);
  return result;
}

//----- (00404094) --------------------------------------------------------
void __thiscall CAdminSocket::OnReloadIPListRequest(CAdminSocket *this, CInPacket *iPacket)
{
  CAdminSocket *v2; // esi@1

  v2 = this;
  CIPFilter::ReloadIPList(TSingleton<CIPFilter>::ms_pInstance);
  CVerboseObj::LogReport((CVerboseObj *)&v2->vfptr, aIplistGeoiplis, v2->m_sAddr._m_pStr);
}

//----- (004040C0) --------------------------------------------------------
void __thiscall CIPFilter::ReloadIPList(CIPFilter *this)
{
  CIPFilter *v1; // esi@1

  v1 = this;
  CIPFilter::SetReloadingStatus(this, 1);
  CIPFilter::LoadIPList(v1);
  CIPFilter::LoadGeoIPList(v1);
  CIPFilter::SetReloadingStatus(v1, 0);
}

//----- (004040E3) --------------------------------------------------------
void __thiscall CIPFilter::SetReloadingStatus(CIPFilter *this, int bIsReloading)
{
  CIPFilter *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v2->m_bIsReloadingIPList = bIsReloading;
  LeaveCriticalSection(v3);
}

//----- (00404103) --------------------------------------------------------
void __thiscall CAdminSocket::OnIgnoreSPW(CAdminSocket *this, CInPacket *iPacket)
{
  CAdminSocket *v2; // esi@1
  char v3; // al@1
  bool v4; // zf@1
  char *v5; // eax@1

  v2 = this;
  v3 = CInPacket::Decode1(iPacket);
  TSingleton<CLoginAcceptor>::ms_pInstance->m_bIgnoreSPW = (unsigned __int8)v3;
  v4 = v3 == 0;
  v5 = aDisabled;
  if ( v4 )
    v5 = aEnabled;
  CVerboseObj::LogReport((CVerboseObj *)&v2->vfptr, aSpwModeS, v5);
}

//----- (00404145) --------------------------------------------------------
void __thiscall CAdminSocket::OnIgnoreSSNOnCreateNewCharacter(CAdminSocket *this, CInPacket *iPacket)
{
  CAdminSocket *v2; // esi@1
  char v3; // al@1
  int v4; // ecx@1
  bool v5; // zf@1
  char *v6; // eax@1

  v2 = this;
  v3 = CInPacket::Decode1(iPacket);
  v4 = v3 == 0;
  v5 = v3 == 0;
  v6 = aDisabled;
  TSingleton<CLoginAcceptor>::ms_pInstance->m_bQuerySSNOnCreateNewCharacter = v4;
  if ( v5 )
    v6 = aEnabled;
  CVerboseObj::LogReport((CVerboseObj *)&v2->vfptr, aCheckSsnOnCrea, v6);
}

//----- (0040418E) --------------------------------------------------------
void __thiscall ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>(ZList<ZRef<ZSocketBuffer> > *this)
{
  this->vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  ZList<ZRef<ZSocketBuffer>>::RemoveAll(this);
}
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (00404199) --------------------------------------------------------
void __thiscall ZRef<CClientSocket>::~ZRef<CClientSocket>(ZRef<CClientSocket> *this)
{
  ZRef<CClientSocket> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<CClientSocket>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (004041AF) --------------------------------------------------------
ZRef<CClientSocket> *__thiscall ZRef<CClientSocket>::operator=(ZRef<CClientSocket> *this, ZRef<CClientSocket> *r)
{
  CClientSocket *v2; // eax@1
  ZRef<CClientSocket> *v3; // esi@1

  v2 = r->p;
  v3 = this;
  if ( v2 )
    InterlockedIncrement(&v2->_m_nRef);
  if ( v3->p )
  {
    ZRef<CClientSocket>::_ReleaseRaw(v3, 0);
    v3->p = 0;
  }
  v3->p = r->p;
  return v3;
}

//----- (004041E8) --------------------------------------------------------
ZList<ZRef<ZSocketBuffer> > *__thiscall ZList<ZRef<ZSocketBuffer>>::`vector deleting destructor'(ZList<ZRef<ZSocketBuffer> > *this, unsigned int __flags)
{
  ZList<ZRef<ZSocketBuffer> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  ZList<ZRef<ZSocketBuffer>>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (0040420E) --------------------------------------------------------
void __thiscall ZRef<CClientSocket>::_ReleaseRaw(ZRef<CClientSocket> *this, ZRefCounted *__formal)
{
  ZRef<CClientSocket> *v2; // esi@1

  v2 = this;
  if ( !InterlockedDecrement(&this->p->_m_nRef) )
  {
    InterlockedIncrement(&v2->p->_m_nRef);
    ((void (*)(void))v2->p->vfptr[1].__vecDelDtor)();
  }
}

//----- (0040423B) --------------------------------------------------------
void __thiscall ZArray<unsigned char>::RemoveAll(ZArray<unsigned char> *this)
{
  ZArray<unsigned char> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this->a - 4);
    v1->a = 0;
  }
}

//----- (0040425D) --------------------------------------------------------
char *__thiscall ZArray<unsigned char>::_Alloc(ZArray<unsigned char> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<unsigned char> *v3; // esi@1
  char *result; // eax@2
  int v5; // eax@3

  v3 = this;
  ZArray<unsigned char>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, u + 4) + 4;
    v3->a = (char *)v5;
    *(_DWORD *)(v5 - 4) = u;
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00404295) --------------------------------------------------------
char *__thiscall ZArray<unsigned char>::_Realloc(ZArray<unsigned char> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<unsigned char> *v4; // edi@1
  unsigned int v5; // esi@4
  void *v6; // esi@8
  size_t c; // [sp+10h] [bp-4h]@2
  int nModea; // [sp+20h] [bp+Ch]@7

  v4 = this;
  if ( this->a )
    c = *((_DWORD *)this->a - 1);
  else
    c = 0;
  v5 = u;
  if ( u > c )
  {
    if ( u > (unsigned int)ZArray<unsigned char>::GetCapacity(this) )
    {
      v6 = (void *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, u + 4) + 4);
      if ( v4->a )
      {
        if ( !(nMode & 1) )
          memcpy(v6, v4->a, c);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v4->a - 4);
      }
      v4->a = (char *)v6;
      v5 = u;
    }
    else if ( !(nMode & 2) )
    {
      nModea = (int)&v4->a[c];
    }
  }
  if ( v4->a )
    *((_DWORD *)v4->a - 1) = v5;
  return v4->a;
}

//----- (0040433B) --------------------------------------------------------
void __thiscall ZList<ZRef<ZSocketBuffer>>::RemoveAll(ZList<ZRef<ZSocketBuffer> > *this)
{
  ZList<ZRef<ZSocketBuffer> > *v1; // esi@1
  ZRef<ZSocketBuffer> *i; // eax@1
  ZRefCounted *v3; // eax@2
  int v4; // edi@2

  v1 = this;
  for ( i = this->_m_pHead; i; i = (ZRef<ZSocketBuffer> *)(v4 != 0 ? v4 + 16 : 0) )
  {
    v3 = (ZRefCounted *)(i != 0 ? (unsigned int)&i[-2] : 0);
    v4 = v3->_m_nRef;
    ZRefCountedAccessorBase::_Delete(v3);
  }
  v1->_m_pTail = 0;
  v1->_m_pHead = 0;
  v1->_m_uCount = 0;
}

//----- (00404375) --------------------------------------------------------
ZRef<CClientSocket> *__thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::GetAt(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, const unsigned int *key, ZRef<CClientSocket> *value)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v3; // esi@2
  ZRef<CClientSocket> *result; // eax@5

  if ( this->_m_apTable && (v3 = this->_m_apTable[_lrotr(*key, 5) % this->_m_uTableSize]) != 0 )
  {
    while ( v3->key != *key )
    {
      v3 = v3->pNext;
      if ( !v3 )
        goto LABEL_5;
    }
    if ( value )
      ZRef<CClientSocket>::operator=(value, &v3->value);
    result = &v3->value;
  }
  else
  {
LABEL_5:
    result = 0;
  }
  return result;
}

//----- (004043C9) --------------------------------------------------------
void _E37_0()
{
  _E30();
  _E31_0();
  _E32_0();
  _E33_0();
  _E34_0();
  _E35_0();
  _E36_0();
}

//----- (004043EC) --------------------------------------------------------
void _E30()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00404427) --------------------------------------------------------
void _E31_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00404462) --------------------------------------------------------
void _E32_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0040449D) --------------------------------------------------------
void _E33_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (004044D8) --------------------------------------------------------
void _E34_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00404513) --------------------------------------------------------
void _E35_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (0040454E) --------------------------------------------------------
void _E36_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00404589) --------------------------------------------------------
char *__thiscall ZArray<unsigned char>::GetCapacity(ZArray<unsigned char> *this)
{
  char *result; // eax@1
  int v2; // eax@2

  result = this->a;
  if ( this->a )
  {
    v2 = *((_DWORD *)result - 2);
    if ( v2 < 0 )
      v2 = ~v2;
    result = (char *)(v2 - 4);
  }
  return result;
}

//----- (0040459D) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443430: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004045D0) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443438: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00404603) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443440: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00404636) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443448: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00404669) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443450: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0040469C) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004046BC) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::~ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004046DC) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004046FC) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::~ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0040471C) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0040473C) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00404751) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::~ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00404766) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (0040477B) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::~ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00404790) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (004047A5) --------------------------------------------------------
void _E58()
{
  _E49();
  _E50();
  _E51();
  _E52();
  _E53();
  _E54();
  _E55();
  _E56();
  _E57();
}

//----- (004047D2) --------------------------------------------------------
void _E49()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0040480D) --------------------------------------------------------
void _E50()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00404848) --------------------------------------------------------
void _E51()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00404883) --------------------------------------------------------
void _E52()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (004048BE) --------------------------------------------------------
void _E53()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004048F9) --------------------------------------------------------
void _E54()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00404934) --------------------------------------------------------
void _E55()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::s_pInstance = v3;
}

//----- (0040496F) --------------------------------------------------------
void _E56()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (004049AA) --------------------------------------------------------
void _E57()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (004049E5) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443458: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (00404A18) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00404A38) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::~ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00404A4D) --------------------------------------------------------
unsigned int __thiscall ZSocketEx::GetType(ZSocketEx *this)
{
  return this->_m_hSocket;
}

//----- (00404A51) --------------------------------------------------------
void __thiscall ZSocketEx::ZSocketEx(ZSocketEx *this)
{
  ZSocketEx *v1; // esi@1
  int v2; // eax@1
  int v3; // eax@1
  _DWORD *v4; // edx@2
  int v5; // eax@3
  signed int v6; // [sp+Ch] [bp-8h]@1
  int v7; // [sp+10h] [bp-4h]@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->_m_hSocket = -1;
  v1->vfptr = (ZOverlapped::ZICallBackVtbl *)ZOverlapped::ZICallBack::`vftable';
  v1->_m_pPort = 0;
  v1->_m_bDeleted = 0;
  v1->_m_nType = -1;
  v1->_m_nRef = 1;
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->_m_lockSend.DebugInfo);
  memset(&v1->_m_olSend, 0, 0x1Cu);
  v1->_m_dwErrSend = 0;
  v1->_m_lSending._m_uCount = 0;
  v1->_m_lSending._m_pHead = 0;
  v1->_m_lSending._m_pTail = 0;
  v2 = (int)&v1->_m_lToSend;
  v1->_m_lSending.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  *(_DWORD *)(v2 + 8) = 0;
  *(_DWORD *)(v2 + 12) = 0;
  *(_DWORD *)(v2 + 16) = 0;
  *(_DWORD *)v2 = &ZList<ZRef<ZSocketBuffer>>::`vftable';
  v1->_m_uToSend0 = 0;
  v1->_m_bSendOverlapped = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->_m_lockRecv.DebugInfo);
  memset(&v1->_m_olRecv, 0, 0x1Cu);
  v1->_m_dwErrRecv = 0;
  v1->_m_pRecvBuff.p = 0;
  v3 = (int)&v1->_m_meanBuff;
  v1->_m_uRecvBegin = 0;
  v1->_m_uMinRecv = 1460;
  v1->_m_bFixedRecvBuffer = 0;
  *(_DWORD *)(v3 + 16) = 0;
  *(_DWORD *)(v3 + 20) = 0;
  v7 = (int)&v1->_m_meanBuff;
  v6 = 4;
  do
  {
    v4 = (_DWORD *)v7;
    v7 += 4;
    *v4 = 1460;
    v1->_m_meanBuff.m_sum += 1460;
    --v6;
  }
  while ( v6 );
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->_m_lockLoopBack.DebugInfo);
  v1->_m_lpLoopBack._m_uCount = 0;
  v1->_m_lpLoopBack._m_pHead = 0;
  v1->_m_lpLoopBack._m_pTail = 0;
  v1->_m_lpLoopBack.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  v5 = v1 != 0 ? (unsigned int)&v1->vfptr : 0;
  v1->_m_olSend.pCallBack = (ZOverlapped::ZICallBack *)v5;
  v1->_m_olRecv.pCallBack = (ZOverlapped::ZICallBack *)v5;
  v1->vfptr = (ZOverlapped::ZICallBackVtbl *)&ZSocketEx::`vftable'{for `ZOverlapped::ZICallBack'};
  v1->_m_olRecv.pUser = &v1->_m_olRecv;
  v1->vfptr = (ZRefCountedVtbl *)&ZSocketEx::`vftable'{for `ZRefCounted'};
  v1->_m_olSend.pUser = &v1->_m_olSend;
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);
// 443460: using guessed type int (__thiscall *ZSocketEx::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443474: using guessed type void (__thiscall *ZSocketEx::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32);
// 443480: using guessed type int (*ZOverlapped::ZICallBack::`vftable'[2])();

//----- (00404BA0) --------------------------------------------------------
ZSocketEx *__thiscall ZSocketEx::`vector deleting destructor'(ZSocketEx *this, unsigned int __flags)
{
  ZSocketEx *v2; // esi@1

  v2 = this;
  ZSocketEx::~ZSocketEx(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00404BC0) --------------------------------------------------------
void __thiscall ZSocketEx::Delete(ZSocketEx *this)
{
  ZSocketEx *v1; // esi@1

  v1 = this;
  if ( this )
  {
    InterlockedIncrement(&ZSocketBase::_s_init);
    v1->_m_bDeleted = 1;
    ZSocketEx::Close(v1);
    ZSocketEx::_SockRelease(v1);
  }
}

//----- (00404BE9) --------------------------------------------------------
void __thiscall ZSocketEx::~ZSocketEx(ZSocketEx *this)
{
  ZSocketEx *v1; // esi@1
  SOCKET *v2; // edi@3

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZSocketEx::`vftable'{for `ZRefCounted'};
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&ZSocketEx::`vftable'{for `ZOverlapped::ZICallBack'};
  InterlockedDecrement(&ZSocketBase::_s_init);
  v1->_m_lpLoopBack.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  ZList<ZRef<ZSocketBuffer>>::RemoveAll(&v1->_m_lpLoopBack);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->_m_lockLoopBack.DebugInfo);
  if ( v1->_m_pRecvBuff.p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(&v1->_m_pRecvBuff, 0);
    v1->_m_pRecvBuff.p = 0;
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->_m_lockRecv.DebugInfo);
  v1->_m_lToSend.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  ZList<ZRef<ZSocketBuffer>>::RemoveAll(&v1->_m_lToSend);
  v1->_m_lSending.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  ZList<ZRef<ZSocketBuffer>>::RemoveAll(&v1->_m_lSending);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->_m_lockSend.DebugInfo);
  v2 = (SOCKET *)(v1 != 0 ? (unsigned int)&v1->_m_hSocket : 0);
  if ( *v2 != -1 )
  {
    closesocket(*v2);
    *v2 = -1;
  }
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);
// 443460: using guessed type int (__thiscall *ZSocketEx::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443474: using guessed type void (__thiscall *ZSocketEx::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32);

//----- (00404CB9) --------------------------------------------------------
void __thiscall ZSocketEx::Close(ZSocketEx *this)
{
  ZSocketEx *v1; // esi@1
  ZPort *v2; // eax@1

  v1 = this;
  v2 = this->_m_pPort;
  if ( v2 )
  {
    InterlockedDecrement(&v2->_m_nAttachedHandles);
    v1->_m_pPort = 0;
  }
  if ( v1->_m_hSocket != -1 )
  {
    closesocket(v1->_m_hSocket);
    v1->_m_hSocket = -1;
  }
}

//----- (00404CE6) --------------------------------------------------------
void __thiscall ZSocketEx::SendPacket(ZSocketEx *this, ZList<ZRef<ZSocketBuffer> > *lpBuff)
{
  ZSocketEx *v2; // edi@1
  ZList<ZRef<ZSocketBuffer> > *v3; // esi@3
  int v4; // eax@5
  ZRef<ZSocketBuffer> *v5; // eax@5

  v2 = this;
  if ( this->_m_dwErrSend )
  {
    lpBuff = (ZList<ZRef<ZSocketBuffer> > *)this->_m_dwErrSend;
    _CxxThrowException(&lpBuff, &_TI1_AVZException__);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lockSend.DebugInfo);
  v3 = (ZList<ZRef<ZSocketBuffer> > *)lpBuff->_m_pHead;
  while ( v3 )
  {
    lpBuff = v3;
    v4 = *(_DWORD *)(v3 != 0 ? (unsigned int)v3[-1].gap4 + 4 : 4);
    v3 = (ZList<ZRef<ZSocketBuffer> > *)(v4 != 0 ? v4 + 16 : 0);
    v5 = ZList<ZRef<ZSocketBuffer>>::AddTail(&v2->_m_lToSend);
    ZRef<ZSocketBuffer>::operator=(v5, (ZRef<ZSocketBuffer> *)lpBuff);
  }
  if ( !v2->_m_bSendOverlapped )
    ZSocketEx::NotifySend(v2);
  LeaveCriticalSection((LPCRITICAL_SECTION)&v2->_m_lockSend.DebugInfo);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00404D83) --------------------------------------------------------
ZRef<ZSocketBuffer> *__thiscall ZRef<ZSocketBuffer>::operator=(ZRef<ZSocketBuffer> *this, ZRef<ZSocketBuffer> *r)
{
  ZSocketBuffer *v2; // eax@1
  ZRef<ZSocketBuffer> *v3; // esi@1

  v2 = r->p;
  v3 = this;
  if ( v2 )
    InterlockedIncrement(&v2->_m_nRef);
  if ( v3->p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(v3, 0);
    v3->p = 0;
  }
  v3->p = r->p;
  return v3;
}

//----- (00404DBC) --------------------------------------------------------
ZRef<ZSocketBuffer> *__thiscall ZList<ZRef<ZSocketBuffer>>::AddTail(ZList<ZRef<ZSocketBuffer> > *this)
{
  ZList<ZRef<ZSocketBuffer> > *v1; // esi@1
  ZRef<ZSocketBuffer> *result; // eax@1
  ZRef<ZSocketBuffer> *v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<ZRef<ZSocketBuffer>>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)&result[-2] : 0;
    *(v3 != 0 ? &v3[-2].p : 4) = (ZSocketBuffer *)v4;
    result = (ZRef<ZSocketBuffer> *)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (00404DFA) --------------------------------------------------------
ZRef<ZSocketBuffer> *__thiscall ZList<ZRef<ZSocketBuffer>>::_New(ZList<ZRef<ZSocketBuffer> > *this, void *pPrev, void *pNext)
{
  ZList<ZRef<ZSocketBuffer> > *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (ZRef<ZSocketBuffer> *)(v4 != 0 ? v4 + 16 : 0);
}

//----- (00404E39) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<ZRef<ZSocketBuffer> > *v0; // ecx@1

  v0 = (ZRefCountedDummy<ZRef<ZSocketBuffer> > *)ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<ZRef<ZSocketBuffer>>::ZRefCountedDummy<ZRef<ZSocketBuffer>>(v0);
}

//----- (00404E6E) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance,
    p);
}

//----- (00404E7E) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (00404EA4) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZRef<ZSocketBuffer>>::ZRefCountedDummy<ZRef<ZSocketBuffer>>(ZRefCountedDummy<ZRef<ZSocketBuffer> > *this)
{
  ZRefCountedDummy<ZRef<ZSocketBuffer> > *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable';
  v1->t.p = 0;
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> >Vtbl *)&ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 44348C: using guessed type void *ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>'};
// 443494: using guessed type int (__thiscall *ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 44349C: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (00404ED6) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *__thiscall ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance,
      this);
  return v2;
}
// 44349C: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (00404EF8) --------------------------------------------------------
ZRefCountedDummy<ZRef<ZSocketBuffer> > *__thiscall ZRefCountedDummy<ZRef<ZSocketBuffer>>::`vector deleting destructor'(ZRefCountedDummy<ZRef<ZSocketBuffer> > *this, unsigned int __flags)
{
  ZRefCountedDummy<ZRef<ZSocketBuffer> > *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<ZRef<ZSocketBuffer>>::~ZRefCountedDummy<ZRef<ZSocketBuffer>>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance,
      v2);
  return v2;
}

//----- (00404F19) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZRef<ZSocketBuffer>>::~ZRefCountedDummy<ZRef<ZSocketBuffer>>(ZRefCountedDummy<ZRef<ZSocketBuffer> > *this)
{
  ZRefCountedDummy<ZRef<ZSocketBuffer> > *v1; // edi@1
  char *v2; // esi@1

  v1 = this;
  v2 = this->t.gap0;
  if ( this->t.p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(&this->t, 0);
    *((_DWORD *)v2 + 1) = 0;
  }
  *(_DWORD *)(v1 != 0 ? (unsigned int)&v1->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 44349C: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (00404F6D) --------------------------------------------------------
void __thiscall ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::~ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this)
{
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable';
}
// 44349C: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (00404F74) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x18u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (00404FD0) --------------------------------------------------------
void __thiscall ZSocketEx::LoopBackPacket(ZSocketEx *this, ZSocketBuffer *pBuff)
{
  ZSocketEx *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1
  ZRef<ZSocketBuffer> *v4; // eax@3
  ZRef<ZSocketBuffer> r; // [sp+Ch] [bp-18h]@1
  ZCriticalSectionEx<4000> *v6; // [sp+14h] [bp-10h]@1
  int v7; // [sp+20h] [bp-4h]@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->_m_lockLoopBack.DebugInfo;
  v6 = &this->_m_lockLoopBack;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lockLoopBack.DebugInfo);
  v7 = 0;
  r.p = pBuff;
  if ( pBuff )
    InterlockedIncrement(&pBuff->_m_nRef);
  LOBYTE(v7) = 1;
  v4 = ZList<ZRef<ZSocketBuffer>>::AddTail(&v2->_m_lpLoopBack);
  ZRef<ZSocketBuffer>::operator=(v4, &r);
  LOBYTE(v7) = 0;
  if ( r.p )
    ZRef<ZSocketBuffer>::_ReleaseRaw(&r, 0);
  v7 = -1;
  LeaveCriticalSection(v3);
  InterlockedIncrement(&v2->_m_nRef);
  if ( !PostQueuedCompletionStatus(v2->_m_pPort->_m_hPort, 0, 1u, (LPOVERLAPPED)&v2->_m_olRecv.Internal) )
  {
    ZSocketEx::_SockRelease(v2);
    pBuff = (ZSocketBuffer *)((int (__cdecl *)())dword_4A474C)();
    _CxxThrowException(&pBuff, &_TI1_AVZException__);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (00405096) --------------------------------------------------------
int __thiscall ZSocketEx::OnSend(ZSocketEx *this, ZList<ZRef<ZSocketBuffer> > *l)
{
  ZSocketEx *v2; // esi@1
  void *v4; // esp@8
  int v5; // eax@8
  _WSABUF *v6; // ebx@8
  int *v7; // ecx@8
  int v8; // edx@9
  int v9; // eax@9
  int v10; // ST08_4@11
  SOCKET v11; // ST00_4@11
  int v12; // ebx@12
  int v13; // [sp+0h] [bp-1Ch]@8
  int nBuf; // [sp+Ch] [bp-10h]@8
  unsigned int dwSent; // [sp+10h] [bp-Ch]@11
  _WSABUF *aBuf; // [sp+14h] [bp-8h]@8
  __POSITION *posPrev; // [sp+18h] [bp-4h]@6

  v2 = this;
  if ( !this->_m_lSending._m_uCount && !l->_m_uCount )
  {
    this->_m_bSendOverlapped = 0;
    return 0;
  }
  posPrev = (__POSITION *)l->_m_pHead;
  if ( posPrev )
    ZList<ZRef<ZSocketBuffer>>::MoveAfter(&this->_m_lSending, l, 0, 0, 0);
  nBuf = v2->_m_lSending._m_uCount;
  v4 = alloca(8 * nBuf);
  v5 = (int)v2->_m_lSending._m_pHead;
  v6 = (_WSABUF *)&v13;
  aBuf = (_WSABUF *)&v13;
  v7 = &v13;
  if ( v5 )
  {
    do
    {
      v8 = *(_DWORD *)(v5 + 4);
      v9 = *(_DWORD *)(v5 != 0 ? v5 - 16 + 4 : 4);
      v5 = v9 != 0 ? v9 + 16 : 0;
      *v7 = *(_DWORD *)(v8 != 0 ? v8 + 12 : 0);
      v7[1] = *(_DWORD *)(v8 != 0 ? v8 + 12 + 4 : 4);
      v7 += 2;
    }
    while ( v5 );
    v6 = aBuf;
  }
  v6->buf += v2->_m_uToSend0;
  InterlockedIncrement(&v2->_m_nRef);
  v10 = nBuf;
  v2->_m_olSend.Offset = 0;
  v11 = *(_DWORD *)(v2 != 0 ? (unsigned int)&v2->_m_hSocket : 0);
  dwSent = 0;
  if ( WSASend(v11, v6, v10, &dwSent, 0, (LPWSAOVERLAPPED)&v2->_m_olSend, 0) != -1 )
    return 0;
  v12 = WSAGetLastError();
  if ( v12 == 997 )
    return 0;
  if ( posPrev )
    ZList<ZRef<ZSocketBuffer>>::MoveBefore(l, &v2->_m_lSending, posPrev, 0, 0);
  ZSocketEx::_SockRelease(v2);
  return v12;
}

//----- (004051B3) --------------------------------------------------------
void __thiscall ZList<ZRef<ZSocketBuffer>>::MoveBefore(ZList<ZRef<ZSocketBuffer> > *this, ZList<ZRef<ZSocketBuffer> > *l, __POSITION *posFrom, __POSITION *posTo, __POSITION *pos)
{
  ZRef<ZSocketBuffer> *v5; // edi@2
  ZRef<ZSocketBuffer> *v6; // edx@4
  int v7; // eax@8
  int v8; // eax@9
  int v9; // edi@10
  int v10; // esi@10
  int v11; // eax@11
  int v12; // edx@12
  int v13; // esi@12
  ZList<ZRef<ZSocketBuffer> > *v14; // esi@14
  int v15; // edx@15
  int v16; // esi@15
  int v17; // ebx@15
  int v18; // edx@15
  _DWORD *v19; // esi@16
  int v20; // edx@19
  int v21; // esi@19
  int v22; // edx@19
  int v23; // edx@21
  int v24; // edx@21
  int v25; // eax@22
  ZRef<ZSocketBuffer> *pFrom; // [sp+Ch] [bp-4h]@4
  unsigned int uCount; // [sp+1Ch] [bp+Ch]@7
  ZRef<ZSocketBuffer> *pTo; // [sp+20h] [bp+10h]@6

  if ( l->_m_uCount )
  {
    v5 = (ZRef<ZSocketBuffer> *)posFrom;
    if ( !posFrom )
      v5 = l->_m_pHead;
    v6 = (ZRef<ZSocketBuffer> *)posTo;
    pFrom = v5;
    if ( !posTo )
      v6 = l->_m_pTail;
    pTo = v6;
    if ( v5 == v6 )
    {
      uCount = 1;
    }
    else
    {
      v7 = (int)v5;
      uCount = 1;
      do
      {
        v8 = *(_DWORD *)(v7 != 0 ? v7 - 16 + 4 : 4);
        v7 = v8 != 0 ? v8 + 16 : 0;
        ++uCount;
      }
      while ( (ZRef<ZSocketBuffer> *)v7 != v6 );
    }
    v9 = v5 != 0 ? (unsigned int)&v5[-2] : 0;
    v10 = *(_DWORD *)(v9 + 8);
    if ( *(_DWORD *)(v9 + 8) != 0 ? v10 + 16 : 0 )
    {
      v11 = v6 != 0 ? (unsigned int)&v6[-2] : 0;
      v12 = *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0;
      v13 = v10 != 0 ? v10 + 16 : 0;
      *(_DWORD *)(v13 != 0 ? v13 - 16 + 4 : 4) = v12 != 0 ? v12 - 16 : 0;
      v6 = pTo;
    }
    else
    {
      v11 = v6 != 0 ? (unsigned int)&v6[-2] : 0;
      l->_m_pHead = (ZRef<ZSocketBuffer> *)(*(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0);
    }
    if ( *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0 )
    {
      v15 = *(_DWORD *)(v9 + 8) != 0 ? *(_DWORD *)(v9 + 8) + 16 : 0;
      v16 = *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0;
      v17 = v15 != 0 ? v15 - 16 : 0;
      v18 = v16 != 0 ? v16 - 16 : 0;
      v14 = l;
      *(_DWORD *)(v18 + 8) = v17;
      v6 = pTo;
    }
    else
    {
      v14 = l;
      l->_m_pTail = (ZRef<ZSocketBuffer> *)(*(_DWORD *)(v9 + 8) != 0 ? *(_DWORD *)(v9 + 8) + 16 : 0);
    }
    v14->_m_uCount -= uCount;
    v19 = pos;
    if ( pos || (v19 = (_DWORD *)this->_m_pHead->gap0) != 0 )
    {
      v20 = *(v19 - 2);
      v21 = (int)(v19 - 4);
      v22 = v20 != 0 ? v20 + 16 : 0;
      if ( v22 )
      {
        v23 = v22 - 16;
        *(_DWORD *)(v9 + 8) = v23;
        v24 = v23 != 0 ? v23 + 16 : 0;
        *(_DWORD *)(v24 != 0 ? v24 - 16 + 4 : 4) = v9;
      }
      else
      {
        this->_m_pHead = pFrom;
        *(_DWORD *)(v9 + 8) = 0;
      }
      *(_DWORD *)(v21 + 8) = v11;
      v25 = v11 != 0 ? v11 + 16 : 0;
      *(_DWORD *)(v25 != 0 ? v25 - 16 + 4 : 4) = v21;
      this->_m_uCount += uCount;
    }
    else
    {
      this->_m_pHead = pFrom;
      this->_m_pTail = v6;
      this->_m_uCount = uCount;
      *(_DWORD *)(v9 + 8) = 0;
      *(_DWORD *)(v11 + 4) = 0;
    }
  }
}

//----- (00405373) --------------------------------------------------------
void __thiscall ZList<ZRef<ZSocketBuffer>>::MoveAfter(ZList<ZRef<ZSocketBuffer> > *this, ZList<ZRef<ZSocketBuffer> > *l, __POSITION *posFrom, __POSITION *posTo, __POSITION *pos)
{
  ZRef<ZSocketBuffer> *v5; // edi@2
  ZRef<ZSocketBuffer> *v6; // ebx@4
  int v7; // eax@8
  int v8; // eax@9
  int v9; // edi@10
  int v10; // esi@10
  int v11; // eax@11
  int v12; // edx@12
  int v13; // esi@12
  int v14; // edx@13
  ZRef<ZSocketBuffer> *v15; // esi@14
  ZList<ZRef<ZSocketBuffer> > *v16; // edx@14
  int v17; // edx@15
  int v18; // esi@15
  char *v19; // edx@16
  int v20; // edx@19
  int v21; // edx@19
  int v22; // edx@21
  int v23; // eax@21
  int v24; // eax@22
  ZRef<ZSocketBuffer> *pFrom; // [sp+Ch] [bp-8h]@4
  ZList<ZRef<ZSocketBuffer> > *la; // [sp+1Ch] [bp+8h]@19
  unsigned int uCount; // [sp+20h] [bp+Ch]@7

  if ( l->_m_uCount )
  {
    v5 = (ZRef<ZSocketBuffer> *)posFrom;
    if ( !posFrom )
      v5 = l->_m_pHead;
    v6 = (ZRef<ZSocketBuffer> *)posTo;
    pFrom = v5;
    if ( !posTo )
      v6 = l->_m_pTail;
    if ( v5 == v6 )
    {
      uCount = 1;
    }
    else
    {
      v7 = (int)v5;
      uCount = 1;
      do
      {
        v8 = *(_DWORD *)(v7 != 0 ? v7 - 16 + 4 : 4);
        v7 = v8 != 0 ? v8 + 16 : 0;
        ++uCount;
      }
      while ( (ZRef<ZSocketBuffer> *)v7 != v6 );
    }
    v9 = v5 != 0 ? (unsigned int)&v5[-2] : 0;
    v10 = *(_DWORD *)(v9 + 8);
    if ( *(_DWORD *)(v9 + 8) != 0 ? v10 + 16 : 0 )
    {
      v11 = v6 != 0 ? (unsigned int)&v6[-2] : 0;
      v12 = *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0;
      v13 = v10 != 0 ? v10 + 16 : 0;
      *(_DWORD *)(v13 != 0 ? v13 - 16 + 4 : 4) = v12 != 0 ? v12 - 16 : 0;
    }
    else
    {
      v11 = v6 != 0 ? (unsigned int)&v6[-2] : 0;
      l->_m_pHead = (ZRef<ZSocketBuffer> *)(*(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0);
    }
    v14 = *(_DWORD *)(v9 + 8);
    if ( *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0 )
    {
      v17 = v14 != 0 ? v14 + 16 : 0;
      v18 = *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0;
      *(_DWORD *)(v18 != 0 ? v18 - 16 + 8 : 8) = v17 != 0 ? v17 - 16 : 0;
      v16 = l;
    }
    else
    {
      v15 = (ZRef<ZSocketBuffer> *)(v14 != 0 ? v14 + 16 : 0);
      v16 = l;
      l->_m_pTail = v15;
    }
    v16->_m_uCount -= uCount;
    v19 = (char *)pos;
    if ( pos || (v19 = this->_m_pTail->gap0) != 0 )
    {
      v20 = (int)(v19 - 16);
      la = (ZList<ZRef<ZSocketBuffer> > *)v20;
      v21 = *(_DWORD *)(v20 + 4) != 0 ? *(_DWORD *)(v20 + 4) + 16 : 0;
      if ( v21 )
      {
        v22 = v21 - 16;
        *(_DWORD *)(v22 + 8) = v11;
        v23 = v11 != 0 ? v11 + 16 : 0;
        *(_DWORD *)(v23 != 0 ? v23 - 16 + 4 : 4) = v22;
      }
      else
      {
        this->_m_pTail = v6;
        *(_DWORD *)(v11 + 4) = 0;
      }
      *(_DWORD *)(v9 + 8) = la;
      v24 = la != 0 ? (unsigned int)&la->_m_pTail : 0;
      *(_DWORD *)(v24 != 0 ? v24 - 16 + 4 : 4) = v9;
      this->_m_uCount += uCount;
    }
    else
    {
      this->_m_pHead = pFrom;
      this->_m_pTail = v6;
      this->_m_uCount = uCount;
      *(_DWORD *)(v9 + 8) = 0;
      *(_DWORD *)(v11 + 4) = 0;
    }
  }
}

//----- (00405534) --------------------------------------------------------
void __thiscall ZSocketEx::OnComplete(ZSocketEx *this, void *pUser, unsigned int key, unsigned int dwErr, unsigned int dwTransfered)
{
  ZSocketEx *v5; // esi@1
  bool v6; // zf@1
  ZRef<ZSocketBuffer> *v7; // ST08_4@5
  unsigned int v8; // edi@5
  unsigned int v9; // eax@15
  ZSocketBuffer *v10; // edi@24
  unsigned int v11; // ebx@24
  ZSocketBuffer *v12; // eax@24
  ZSocketBuffer *v13; // eax@25
  ZSocketBuffer *v14; // ST08_4@27
  struct _RTL_CRITICAL_SECTION *v15; // eax@38
  unsigned int v16; // ebx@40
  int v17; // edi@40
  int v18; // ecx@43
  __POSITION *v19; // edx@43
  int v20; // eax@43
  unsigned int v21; // eax@43
  unsigned int v22; // eax@58
  int v23; // [sp+0h] [bp-28h]@1
  ZRef<ZSocketBuffer> v24; // [sp+Ch] [bp-1Ch]@5
  ZSocketEx *v25; // [sp+14h] [bp-14h]@1
  int *v26; // [sp+18h] [bp-10h]@1
  int v27; // [sp+24h] [bp-4h]@5

  v5 = this;
  v6 = this->_m_pPrev == 0;
  v26 = &v23;
  v25 = this;
  if ( v6 || this->vfptr )
  {
    this->_m_olRecv.hEvent = (void *)10057;
    this->_m_olSend.hEvent = (void *)10057;
    v8 = 0;
    goto LABEL_56;
  }
  if ( pUser != &this->_m_lockRecv.OwningThread )
  {
    EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_bDeleted);
    v8 = dwErr;
    v27 = 7;
    if ( !dwErr )
    {
      v16 = v5->_m_lToSend._m_uCount + dwTransfered;
      v5->_m_lToSend._m_uCount = 0;
      v17 = (int)v5->_m_lSending.vfptr;
      while ( v17 && v16 )
      {
        v18 = v17;
        v19 = (__POSITION *)v17;
        v20 = *(_DWORD *)(v17 != 0 ? v17 - 16 + 4 : 4);
        v17 = v20 != 0 ? v20 + 16 : 0;
        v21 = *(_DWORD *)(*(_DWORD *)(v18 + 4) + 12);
        if ( v16 < v21 )
        {
          v5->_m_lToSend._m_uCount = v16;
          break;
        }
        v16 -= v21;
        ZList<ZRef<ZSocketBuffer>>::RemoveAt((ZList<ZRef<ZSocketBuffer> > *)&v5->_m_olSend.pCallBack, v19);
      }
      v8 = ZSocketEx::_BeginSend((ZSocketEx *)((char *)v5 - 12));
    }
    if ( v8 == 995 || v8 == 1450 || v8 == 10055 )
      v8 = ZSocketEx::_BeginSend((ZSocketEx *)((char *)v5 - 12));
    if ( v8 )
    {
      v5->_m_lToSend._m_pHead = 0;
      v5->_m_olSend.hEvent = (void *)v8;
    }
    v27 = -1;
    v15 = (struct _RTL_CRITICAL_SECTION *)&v5->_m_bDeleted;
    goto LABEL_54;
  }
  if ( key )
  {
    EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lToSend._m_pTail);
    v27 = 0;
    v24.p = 0;
    EnterCriticalSection((LPCRITICAL_SECTION)&v5->_m_meanBuff.m_aSamples[3]);
    v7 = (ZRef<ZSocketBuffer> *)v5->_m_lpLoopBack.vfptr;
    LOBYTE(v27) = 2;
    ZRef<ZSocketBuffer>::operator=(&v24, v7);
    ZList<ZRef<ZSocketBuffer>>::RemoveAt(
      (ZList<ZRef<ZSocketBuffer> > *)&v5->_m_lockLoopBack.OwningThread,
      (__POSITION *)v5->_m_lpLoopBack.vfptr);
    LOBYTE(v27) = 1;
    LeaveCriticalSection((LPCRITICAL_SECTION)&v5->_m_meanBuff.m_aSamples[3]);
    v8 = dwErr;
    if ( !dwErr )
      v8 = ZSocketEx::_SafeOnReceive((ZSocketEx *)((char *)v5 - 12), dwErr, v24.p);
    LOBYTE(v27) = 0;
    if ( v24.p )
      ZRef<ZSocketBuffer>::_ReleaseRaw(&v24, 0);
    v27 = -1;
    LeaveCriticalSection((LPCRITICAL_SECTION)&v5->_m_lToSend._m_pTail);
LABEL_56:
    if ( !v8 )
      goto LABEL_59;
    goto LABEL_57;
  }
  v8 = dwErr;
  if ( !dwErr )
  {
    if ( !dwTransfered )
    {
      v8 = 10054;
LABEL_57:
      if ( !v5->vfptr )
      {
        v27 = 8;
        EnterCriticalSection((LPCRITICAL_SECTION)&v5->_m_lToSend._m_pTail);
        v22 = v5[-1]._m_lpLoopBack._m_uCount;
        LOBYTE(v27) = 9;
        (*(void (__thiscall **)(int, unsigned int, _DWORD))(v22 + 8))((int)&v5[-1]._m_lpLoopBack._m_uCount, v8, 0);
        LeaveCriticalSection((LPCRITICAL_SECTION)&v5->_m_lToSend._m_pTail);
        v27 = -1;
      }
      goto LABEL_59;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lToSend._m_pTail);
    v27 = 4;
    v24.p = 0;
    v6 = v5->_m_pRecvBuff.p == 0;
    LOBYTE(v27) = 5;
    if ( v6 )
    {
      if ( dwTransfered + v5->_m_dwErrRecv >= *((_DWORD *)v5->_m_olRecv.pUser + 3) )
        *(_DWORD *)&v5->_m_pRecvBuff.gap0[0] = 1460;
      else
        *(_DWORD *)&v5->_m_pRecvBuff.gap0[0] = ZMeanBuff<unsigned int,4,1460>::Next(
                                                 (ZMeanBuff<unsigned int,4,1460> *)&v5->_m_uRecvBegin,
                                                 dwTransfered);
    }
    v10 = (ZSocketBuffer *)v5->_m_olRecv.pUser;
    v11 = v5->_m_dwErrRecv;
    v12 = (ZSocketBuffer *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x1Cu);
    LOBYTE(v27) = 6;
    if ( v12 )
      ZSocketBuffer::ZSocketBuffer(v12, dwTransfered, &v10->buf[v11], v10);
    else
      v13 = 0;
    LOBYTE(v27) = 5;
    ZRef<ZSocketBuffer>::operator=(&v24, v13);
    v14 = v24.p;
    v5->_m_dwErrRecv += dwTransfered;
    v8 = ZSocketEx::_SafeOnReceive((ZSocketEx *)((char *)v5 - 12), 0, v14);
    if ( !v8 )
    {
      if ( v5->vfptr )
      {
LABEL_36:
        LOBYTE(v27) = 4;
        if ( v24.p )
          ZRef<ZSocketBuffer>::_ReleaseRaw(&v24, 0);
        v27 = -1;
        v15 = (struct _RTL_CRITICAL_SECTION *)&v5->_m_lToSend._m_pTail;
LABEL_54:
        LeaveCriticalSection(v15);
        goto LABEL_56;
      }
      v8 = ZSocketEx::_BeginRecv((ZSocketEx *)((char *)v5 - 12));
    }
    if ( v8 == 995 || v8 == 1450 || v8 == 10055 )
      v8 = ZSocketEx::_BeginRecv((ZSocketEx *)((char *)v5 - 12));
    if ( v8 )
      v5->_m_olRecv.hEvent = (void *)v8;
    goto LABEL_36;
  }
  if ( dwErr == 995 || dwErr == 1450 || dwErr == 10055 )
  {
    EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lToSend._m_pTail);
    v27 = 3;
    v9 = ZSocketEx::_BeginRecv((ZSocketEx *)((char *)v5 - 12));
    v27 = -1;
    v8 = v9;
    LeaveCriticalSection((LPCRITICAL_SECTION)&v5->_m_lToSend._m_pTail);
  }
  if ( v8 )
  {
    v5->_m_olRecv.hEvent = (void *)v8;
    goto LABEL_56;
  }
LABEL_59:
  ZSocketEx::_SockRelease((ZSocketEx *)((char *)v5 - 12));
}

//----- (004058BE) --------------------------------------------------------
unsigned int __thiscall ZMeanBuff<unsigned int,4,1460>::Next(ZMeanBuff<unsigned int,4,1460> *this, unsigned int t)
{
  char *v2; // eax@1

  v2 = (char *)this + 4 * this->m_uIndex;
  this->m_sum += t - *(_DWORD *)v2;
  *(_DWORD *)v2 = t;
  if ( ++this->m_uIndex >= 4 )
    this->m_uIndex = 0;
  return this->m_sum >> 2;
}

//----- (004058E9) --------------------------------------------------------
void __thiscall ZList<ZRef<ZSocketBuffer>>::RemoveAt(ZList<ZRef<ZSocketBuffer> > *this, __POSITION *pos)
{
  int v2; // edx@1
  int v3; // eax@2
  int v4; // eax@4
  int v5; // eax@5
  int v6; // eax@6
  int v7; // eax@7
  int v8; // edx@7
  int v9; // eax@7
  int v10; // edx@7

  v2 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8);
  if ( *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? v2 + 16 : 0 )
  {
    v5 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v5 + 16 : 0 )
    {
      v7 = v5 != 0 ? v5 + 16 : 0;
      v8 = v2 != 0 ? v2 + 16 : 0;
      *(_DWORD *)(v8 != 0 ? v8 - 16 + 4 : 4) = v7 != 0 ? v7 - 16 : 0;
      v9 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      v10 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v10 != 0 ? v10 - 16 + 8 : 8) = v9 != 0 ? v9 - 16 : 0;
    }
    else
    {
      this->_m_pTail = (ZRef<ZSocketBuffer> *)(v2 != 0 ? v2 + 16 : 0);
      v6 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      *(_DWORD *)(v6 != 0 ? v6 - 16 + 4 : 4) = 0;
    }
  }
  else
  {
    v3 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v3 + 16 : 0 )
    {
      this->_m_pHead = (ZRef<ZSocketBuffer> *)(v3 != 0 ? v3 + 16 : 0);
      v4 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v4 != 0 ? v4 - 16 + 8 : 8) = 0;
    }
    else
    {
      this->_m_pTail = 0;
      this->_m_pHead = 0;
    }
  }
  --this->_m_uCount;
  ZRefCountedAccessorBase::_Delete((ZRefCounted *)(pos != 0 ? (unsigned int)&pos[-16] : 0));
}

//----- (004059FB) --------------------------------------------------------
unsigned int __thiscall ZSocketEx::_BeginSend(ZSocketEx *this)
{
  unsigned int result; // eax@1
  ZRefCountedVtbl *v2; // eax@4
  int v3; // [sp+0h] [bp-20h]@1
  int *v4; // [sp+10h] [bp-10h]@1
  int v5; // [sp+1Ch] [bp-4h]@4

  result = this->_m_dwErrSend;
  v4 = &v3;
  if ( !result )
  {
    if ( this->_m_bDeleted )
    {
      result = 10054;
    }
    else
    {
      v2 = this->vfptr;
      v5 = 0;
      result = ((int (__stdcall *)(ZList<ZRef<ZSocketBuffer> > *))v2[3].__vecDelDtor)(&this->_m_lToSend);
    }
  }
  return result;
}

//----- (00405A4F) --------------------------------------------------------
unsigned int __thiscall ZSocketEx::_SafeOnReceive(ZSocketEx *this, unsigned int dwErr, ZSocketBuffer *pBuff)
{
  ZRefCountedVtbl *v3; // eax@1
  int v5; // [sp+0h] [bp-20h]@1
  int *v6; // [sp+10h] [bp-10h]@1
  int v7; // [sp+1Ch] [bp-4h]@1

  v3 = this->vfptr;
  v7 = 0;
  v6 = &v5;
  ((void (__stdcall *)(unsigned int, ZSocketBuffer *))v3[2].__vecDelDtor)(dwErr, pBuff);
  return 0;
}

//----- (00405A96) --------------------------------------------------------
char *CVerboseObj::GetLogTail()
{
  return &sLog;
}

//----- (00405A9C) --------------------------------------------------------
void __cdecl CAESCipher::Encrypt(char *pDest, char *pSrc, int nLen, unsigned int *pdwKey)
{
  CAESCipher::AES_ALG_INFO AlgInfo; // [sp+4h] [bp-138h]@1
  unsigned int DstLen; // [sp+138h] [bp-4h]@1

  DstLen = 0;
  CAESCipher::AES_EncKeySchedule(&CAESCipher::UserKey, &AlgInfo);
  CAESCipher::AES_EncInit(&AlgInfo, pdwKey);
  if ( nLen )
    CAESCipher::OFB_EncUpdate(&AlgInfo, pSrc, nLen, pDest, &DstLen);
  CAESCipher::OFB_EncFinal(&AlgInfo, &pDest[DstLen], &DstLen);
}

//----- (00405B12) --------------------------------------------------------
void __cdecl CAESCipher::Decrypt(char *pDest, char *pSrc, int nLen, unsigned int *pdwKey)
{
  CAESCipher::AES_ALG_INFO AlgInfo; // [sp+4h] [bp-138h]@1
  unsigned int DstLen; // [sp+138h] [bp-4h]@1

  DstLen = 0;
  CAESCipher::AES_EncKeySchedule(&CAESCipher::UserKey, &AlgInfo);
  CAESCipher::AES_DecInit(&AlgInfo, pdwKey);
  if ( nLen )
    CAESCipher::OFB_DecUpdate(&AlgInfo, pSrc, nLen, pDest, &DstLen);
  CAESCipher::OFB_DecFinal(&AlgInfo, &pDest[DstLen], &DstLen);
}

//----- (00405B88) --------------------------------------------------------
void __cdecl CAESCipher::gen_tabs()
{
  unsigned int v0; // ecx@1
  int v1; // eax@1
  int v2; // eax@3
  unsigned int *v3; // ecx@3
  unsigned int v4; // ebx@5
  unsigned __int8 v5; // al@7
  int v6; // edx@9
  unsigned int v7; // eax@9
  unsigned int v8; // ecx@9
  int v9; // edx@9
  unsigned int v10; // eax@9
  int v11; // ecx@9
  unsigned int v12; // ebx@10
  unsigned __int32 v13; // edi@11
  unsigned int v14; // esi@11
  int v15; // ecx@12
  int v16; // eax@15
  int v17; // edi@17
  unsigned __int32 v18; // eax@17
  unsigned __int32 v19; // edi@17
  int v20; // ebp@17
  int v21; // ecx@23
  int v22; // eax@26
  int v23; // edi@28
  int v24; // [sp+10h] [bp-4h]@18

  log_tab[7] = 0;
  v0 = 0;
  v1 = 1;
  do
  {
    pow_tab[v0] = v1;
    log_tab[v1] = v0;
    v1 = (unsigned __int8)(2 * v1) ^ ((v1 & 0x80) != 0 ? 0x1B : 0) ^ (unsigned __int8)v1;
    ++v0;
  }
  while ( v0 < 0x100 );
  log_tab[1] = 0;
  v2 = 1;
  v3 = rco_tab;
  do
  {
    *v3 = v2;
    ++v3;
    v2 = ((v2 & 0x80) != 0 ? 0x1B : 0) ^ (unsigned __int8)(2 * v2);
  }
  while ( v3 < (unsigned int *)isb_tab );
  v4 = 0;
  do
  {
    if ( v4 )
      v5 = *(_BYTE *)(4866435 - (unsigned __int8)log_tab[v4]);
    else
      v5 = 0;
    v6 = v5;
    v7 = (unsigned __int8)(2 * v5) | (v5 >> 7);
    v8 = (unsigned __int8)(2 * v7) | (unsigned __int8)(v7 >> 7);
    v9 = v8 ^ v7 ^ v6;
    v10 = (unsigned __int8)(2 * v8) | (unsigned __int8)(v8 >> 7);
    v11 = v10 ^ v9 ^ ((unsigned __int8)(2 * v10) | (unsigned __int8)(v10 >> 7)) ^ 0x63;
    sbx_tab[v4] = v11;
    isb_tab[v11] = v4++;
  }
  while ( v4 < 0x100 );
  v12 = 0;
  do
  {
    v13 = (unsigned __int8)sbx_tab[v12];
    v14 = v12;
    fl_tab[0][v12] = v13;
    fl_tab[1][v12] = _lrotl(v13, 8);
    fl_tab[2][v12] = _lrotl(v13, 16);
    fl_tab[3][v12] = _lrotl(v13, 24);
    if ( v13 )
      v15 = (unsigned __int8)pow_tab[((unsigned __int8)log_tab[2] + (unsigned __int8)log_tab[v13]) % 255];
    else
      v15 = 0;
    if ( v13 )
      v16 = (unsigned __int8)pow_tab[((unsigned __int8)log_tab[3] + (unsigned __int8)log_tab[v13]) % 255];
    else
      v16 = 0;
    v17 = v15 | ((v13 | ((v13 | (v16 << 8)) << 8)) << 8);
    ft_tab[0][v14] = v17;
    ft_tab[1][v12] = _lrotl(v17, 8);
    ft_tab[2][v12] = _lrotl(v17, 16);
    v18 = _lrotl(v17, 24);
    v19 = (unsigned __int8)isb_tab[v12];
    ft_tab[3][v12] = v18;
    il_tab[0][v14] = v19;
    il_tab[1][v12] = _lrotl(v19, 8);
    il_tab[2][v12] = _lrotl(v19, 16);
    v20 = 0;
    il_tab[3][v12] = _lrotl(v19, 24);
    if ( v19 )
      v24 = (unsigned __int8)pow_tab[((unsigned __int8)log_tab[14] + (unsigned __int8)log_tab[v19]) % 255];
    else
      v24 = 0;
    if ( v19 )
      v20 = (unsigned __int8)pow_tab[((unsigned __int8)log_tab[9] + (unsigned __int8)log_tab[v19]) % 255];
    if ( v19 )
      v21 = (unsigned __int8)pow_tab[((unsigned __int8)log_tab[13] + (unsigned __int8)log_tab[v19]) % 255];
    else
      v21 = 0;
    if ( v19 )
      v22 = (unsigned __int8)pow_tab[((unsigned __int8)log_tab[11] + (unsigned __int8)log_tab[v19]) % 255];
    else
      v22 = 0;
    v23 = v24 | ((v20 | ((v21 | (v22 << 8)) << 8)) << 8);
    it_tab[0][v14] = v23;
    it_tab[1][v12] = _lrotl(v23, 8);
    it_tab[2][v12++] = _lrotl(v23, 16);
    *(_DWORD *)(v14 * 4 + 4860508) = _lrotl(v23, 24);
  }
  while ( v12 < 0x100 );
  CAESCipher::tab_gen = 1;
}
// 4A4284: using guessed type unsigned __int8 CAESCipher::tab_gen;

//----- (00405E84) --------------------------------------------------------
void __cdecl CAESCipher::AES_EncInit(CAESCipher::AES_ALG_INFO *AlgInfo, unsigned int *pdwKey)
{
  CAESCipher::AES_ALG_INFO *v2; // esi@2
  signed int v3; // edi@2

  AlgInfo->BufLen = 0;
  if ( pdwKey )
  {
    v2 = AlgInfo;
    v3 = 4;
    do
    {
      memcpy(v2, pdwKey, 4u);
      v2 = (CAESCipher::AES_ALG_INFO *)((char *)v2 + 4);
      --v3;
    }
    while ( v3 );
  }
  else
  {
    memcpy(AlgInfo, &CAESCipher::bDefaultAESKeyValue, 0x10u);
  }
}

//----- (00405EC3) --------------------------------------------------------
void __cdecl CAESCipher::AES_DecInit(CAESCipher::AES_ALG_INFO *AlgInfo, unsigned int *pdwKey)
{
  CAESCipher::AES_ALG_INFO *v2; // esi@2
  signed int v3; // edi@2

  AlgInfo->BufLen = 0;
  if ( pdwKey )
  {
    v2 = AlgInfo;
    v3 = 4;
    do
    {
      memcpy(v2, pdwKey, 4u);
      v2 = (CAESCipher::AES_ALG_INFO *)((char *)v2 + 4);
      --v3;
    }
    while ( v3 );
  }
  else
  {
    memcpy(AlgInfo, &CAESCipher::bDefaultAESKeyValue, 0x10u);
  }
}

//----- (00405F02) --------------------------------------------------------
void __cdecl CAESCipher::AES_EncKeySchedule(unsigned int *UserKey, CAESCipher::AES_ALG_INFO *AlgInfo)
{
  AlgInfo->RoundKey[0] = 8;
  CAESCipher::RIJNDAEL_KeySchedule(UserKey, &AlgInfo->RoundKey[1]);
}

//----- (00405F1D) --------------------------------------------------------
void __cdecl CAESCipher::AES_DecKeySchedule(unsigned int *UserKey, CAESCipher::AES_ALG_INFO *AlgInfo)
{
  unsigned int v2; // ebx@2
  unsigned int v3; // ecx@2
  unsigned int v4; // eax@2
  int v5; // ST30_4@2
  unsigned __int32 v6; // ebx@2
  unsigned __int32 v7; // ebx@2
  unsigned __int32 v8; // eax@2
  unsigned int v9; // ebx@2
  unsigned int v10; // ecx@2
  unsigned int v11; // eax@2
  int v12; // ST18_4@2
  unsigned __int32 v13; // ebx@2
  unsigned __int32 v14; // ebx@2
  unsigned __int32 v15; // eax@2
  unsigned int v16; // ebx@2
  unsigned int v17; // ecx@2
  unsigned int v18; // eax@2
  int v19; // ST00_4@2
  unsigned __int32 v20; // ebx@2
  unsigned __int32 v21; // ebx@2
  unsigned __int32 v22; // eax@2
  unsigned int v23; // ebx@2
  unsigned int v24; // ecx@2
  unsigned int v25; // eax@2
  int v26; // ST28_4@2
  unsigned __int32 v27; // ebx@2
  unsigned __int32 v28; // ebx@2
  unsigned __int32 v29; // eax@2
  int v30; // ebx@2
  unsigned int *v31; // eax@2
  bool v32; // zf@2
  unsigned int t_key[64]; // [sp+Ch] [bp-110h]@1
  int v34; // [sp+10Ch] [bp-10h]@1
  unsigned int *v35; // [sp+110h] [bp-Ch]@1
  unsigned int *v36; // [sp+118h] [bp-4h]@1
  unsigned int t; // [sp+124h] [bp+8h]@2
  int ta; // [sp+124h] [bp+8h]@2
  int tb; // [sp+124h] [bp+8h]@2
  unsigned int tc; // [sp+124h] [bp+8h]@2
  int td; // [sp+124h] [bp+8h]@2
  unsigned int te; // [sp+124h] [bp+8h]@2
  int tf; // [sp+124h] [bp+8h]@2

  AlgInfo->RoundKey[0] = 8;
  CAESCipher::RIJNDAEL_KeySchedule(UserKey, t_key);
  AlgInfo->RoundKey[1] = t_key[56];
  AlgInfo->RoundKey[2] = t_key[57];
  AlgInfo->RoundKey[3] = t_key[58];
  AlgInfo->RoundKey[4] = t_key[59];
  v36 = &AlgInfo->RoundKey[7];
  v35 = &t_key[53];
  v34 = 13;
  do
  {
    t = *(v35 - 1);
    v2 = 2 * (t & 0xFF7F7F7F) ^ 27 * ((t >> 7) & 0x1010101);
    v3 = 2 * (v2 & 0xFF7F7F7F) ^ 27 * ((v2 >> 7) & 0x1010101);
    v4 = 2 * ((2 * (v2 & 0xFF7F7F7F) ^ 27 * ((v2 >> 7) & 0x1010101)) & 0xFF7F7F7F) ^ 27
                                                                                   * (((2 * (v2 & 0xFF7F7F7F) ^ 27 * ((v2 >> 7) & 0x1010101)) >> 7) & 0x1010101);
    ta = v4 ^ t;
    *(v36 - 2) = v2 ^ v3 ^ v4;
    v5 = v2 ^ ta;
    v6 = _lrotr(v3 ^ ta, 16);
    v7 = _lrotr(v5, 8) ^ v6;
    v8 = _lrotr(ta, 24);
    *(v36 - 2) ^= v8 ^ v7;
    v9 = 2 * (*v35 & 0xFF7F7F7F) ^ 27 * ((*v35 >> 7) & 0x1010101);
    v10 = 2 * (v9 & 0xFF7F7F7F) ^ 27 * ((v9 >> 7) & 0x1010101);
    v11 = 2 * (v10 & 0xFF7F7F7F) ^ 27 * ((v10 >> 7) & 0x1010101);
    tb = v11 ^ *v35;
    *(v36 - 1) = v9 ^ v10 ^ v11;
    v12 = v9 ^ tb;
    v13 = _lrotr(v10 ^ tb, 16);
    v14 = _lrotr(v12, 8) ^ v13;
    v15 = _lrotr(tb, 24);
    *(v36 - 1) ^= v15 ^ v14;
    tc = v35[1];
    v16 = 2 * (tc & 0xFF7F7F7F) ^ 27 * ((tc >> 7) & 0x1010101);
    v17 = 2 * (v16 & 0xFF7F7F7F) ^ 27 * ((v16 >> 7) & 0x1010101);
    v18 = 2 * ((2 * (v16 & 0xFF7F7F7F) ^ 27 * ((v16 >> 7) & 0x1010101)) & 0xFF7F7F7F) ^ 27
                                                                                      * (((2 * (v16 & 0xFF7F7F7F) ^ 27 * ((v16 >> 7) & 0x1010101)) >> 7) & 0x1010101);
    td = v18 ^ tc;
    *v36 = v16 ^ v17 ^ v18;
    v19 = v16 ^ td;
    v20 = _lrotr(v17 ^ td, 16);
    v21 = _lrotr(v19, 8) ^ v20;
    v22 = _lrotr(td, 24);
    *v36 ^= v22 ^ v21;
    te = v35[2];
    v23 = 2 * (te & 0xFF7F7F7F) ^ 27 * ((te >> 7) & 0x1010101);
    v24 = 2 * (v23 & 0xFF7F7F7F) ^ 27 * ((v23 >> 7) & 0x1010101);
    v25 = 2 * ((2 * (v23 & 0xFF7F7F7F) ^ 27 * ((v23 >> 7) & 0x1010101)) & 0xFF7F7F7F) ^ 27
                                                                                      * (((2 * (v23 & 0xFF7F7F7F) ^ 27 * ((v23 >> 7) & 0x1010101)) >> 7) & 0x1010101);
    tf = v25 ^ te;
    v36[1] = v23 ^ v24 ^ v25;
    v26 = v23 ^ tf;
    v27 = _lrotr(v24 ^ tf, 16);
    v28 = _lrotr(v26, 8) ^ v27;
    v29 = _lrotr(tf, 24);
    v35 -= 4;
    v30 = v29 ^ v28;
    v31 = v36;
    v31[1] ^= v30;
    v32 = v34-- == 1;
    v36 = v31 + 4;
  }
  while ( !v32 );
  AlgInfo->RoundKey[57] = t_key[0];
  AlgInfo->RoundKey[58] = t_key[1];
  AlgInfo->RoundKey[59] = t_key[2];
  AlgInfo->RoundKey[60] = t_key[3];
}

//----- (004061CB) --------------------------------------------------------
void __cdecl CAESCipher::RIJNDAEL_KeySchedule(unsigned int *UserKey, unsigned int *e_key)
{
  unsigned int *v2; // esi@3
  unsigned int v3; // eax@3
  int v4; // edi@3
  unsigned __int32 v5; // ebx@4
  unsigned int v6; // ebx@4
  unsigned __int32 v7; // eax@4
  unsigned int v8; // ebx@4
  unsigned int v9; // ebx@4
  int v10; // ebx@4
  int v11; // ebx@4
  unsigned int v12; // ebx@4
  unsigned int v13; // edi@4
  int v14; // edi@4
  int v15; // edi@4
  unsigned int *UserKeya; // [sp+8h] [bp+8h]@3

  if ( !CAESCipher::tab_gen )
    CAESCipher::gen_tabs();
  *e_key = *UserKey;
  e_key[1] = UserKey[4];
  v2 = e_key + 1;
  e_key[2] = UserKey[8];
  e_key[3] = UserKey[12];
  e_key[4] = UserKey[16];
  e_key[5] = UserKey[20];
  e_key[6] = UserKey[24];
  v3 = UserKey[28];
  e_key[7] = v3;
  v4 = v3;
  UserKeya = rco_tab;
  do
  {
    v5 = _lrotr(v4, 8) >> 24;
    v6 = fl_tab[2][(unsigned __int8)(_lrotr(v4, 8) >> 16)] ^ fl_tab[3][v5];
    v7 = _lrotr(v4, 8);
    v8 = fl_tab[1][BYTE1(v7)] ^ v6;
    v9 = *(v2 - 1) ^ *UserKeya ^ fl_tab[0][(unsigned __int8)_lrotr(v4, 8)] ^ v8;
    ++UserKeya;
    v2[7] = v9;
    v10 = *v2 ^ v9;
    v2[8] = v10;
    v11 = v2[1] ^ v10;
    v2[9] = v11;
    v12 = v2[2] ^ v11;
    v2[10] = v12;
    v13 = v2[3] ^ fl_tab[0][(unsigned __int8)v12] ^ fl_tab[1][BYTE1(v12)] ^ fl_tab[2][(unsigned __int8)(v12 >> 16)] ^ fl_tab[3][v12 >> 24];
    v2[11] = v13;
    v14 = v2[4] ^ v13;
    v2[12] = v14;
    v15 = v2[5] ^ v14;
    v2[13] = v15;
    v4 = v2[6] ^ v15;
    v2[14] = v4;
    v2 += 8;
  }
  while ( (unsigned int)UserKeya < 0x4A3E78 );
}
// 4A4284: using guessed type unsigned __int8 CAESCipher::tab_gen;

//----- (004062F5) --------------------------------------------------------
void __cdecl CAESCipher::AES_Encrypt(void *CipherKey, char *Data)
{
  unsigned int v2; // edx@1
  unsigned int v3; // esi@1
  unsigned int b0_4; // ST20_4@1
  unsigned int v5; // edi@1
  unsigned int b1_4; // ST10_4@1
  unsigned int v7; // ebx@1
  unsigned int v8; // ecx@1
  unsigned int v9; // esi@1
  unsigned int b0; // ST1C_4@1
  unsigned int v11; // edx@1
  unsigned int v12; // ST20_4@1
  unsigned int v13; // esi@1
  unsigned int b1; // ST0C_4@1
  unsigned int v15; // edi@1
  unsigned int v16; // ST10_4@1
  unsigned int v17; // ebx@1
  unsigned int v18; // esi@1
  unsigned int v19; // ST1C_4@1
  unsigned int v20; // edi@1
  unsigned int v21; // ST20_4@1
  unsigned int v22; // ecx@1
  unsigned int v23; // esi@1
  unsigned int v24; // ST0C_4@1
  unsigned int v25; // edi@1
  unsigned int v26; // edx@1
  unsigned int v27; // esi@1
  unsigned int v28; // ST1C_4@1
  unsigned int v29; // ST20_4@1
  unsigned int v30; // ebx@1
  unsigned int v31; // esi@1
  unsigned int v32; // ST0C_4@1
  unsigned int v33; // ST10_4@1
  unsigned int v34; // ecx@1
  unsigned int v35; // esi@1
  unsigned int v36; // ST1C_4@1
  unsigned int v37; // ST20_4@1
  unsigned int v38; // edx@1
  unsigned int v39; // esi@1
  unsigned int v40; // ST0C_4@1
  unsigned int v41; // edi@1
  unsigned int v42; // ebx@1
  unsigned int v43; // esi@1
  unsigned int v44; // ST1C_4@1
  unsigned int v45; // ST20_4@1
  unsigned int v46; // ecx@1
  unsigned int v47; // esi@1
  unsigned int v48; // ST0C_4@1
  unsigned int v49; // edx@1
  unsigned int v50; // ST10_4@1
  unsigned int v51; // esi@1
  unsigned int v52; // ST1C_4@1
  unsigned int v53; // ST20_4@1
  unsigned int v54; // ebx@1
  unsigned int v55; // esi@1
  unsigned int v56; // ST0C_4@1
  unsigned int v57; // ST10_4@1
  unsigned int v58; // ecx@1
  unsigned int v59; // ebx@1
  unsigned int v60; // ST20_4@1
  unsigned int v61; // esi@1
  unsigned int v62; // edi@1
  unsigned int v63; // ecx@1

  v2 = *((_DWORD *)CipherKey + 1) ^ *(_DWORD *)Data;
  v3 = *((_DWORD *)CipherKey + 3) ^ *((_DWORD *)Data + 2);
  b0_4 = *((_DWORD *)CipherKey + 2) ^ *((_DWORD *)Data + 1);
  v5 = *((_DWORD *)CipherKey + 4) ^ *((_DWORD *)Data + 3);
  b1_4 = *((_DWORD *)CipherKey + 6) ^ ft_tab[0][(unsigned __int8)b0_4] ^ ft_tab[3][v2 >> 24] ^ ft_tab[1][BYTE1(v3)] ^ ft_tab[2][(unsigned __int8)(v5 >> 16)];
  v7 = *((_DWORD *)CipherKey + 5) ^ ft_tab[0][(unsigned __int8)v2] ^ ft_tab[1][BYTE1(b0_4)] ^ ft_tab[2][(unsigned __int8)(v3 >> 16)] ^ ft_tab[3][v5 >> 24];
  v8 = *((_DWORD *)CipherKey + 7) ^ ft_tab[0][(unsigned __int8)v3] ^ ft_tab[2][(unsigned __int8)(v2 >> 16)] ^ ft_tab[3][b0_4 >> 24] ^ ft_tab[1][BYTE1(v5)];
  v9 = *((_DWORD *)CipherKey + 8) ^ ft_tab[0][(unsigned __int8)v5] ^ ft_tab[1][BYTE1(v2)] ^ ft_tab[2][(unsigned __int8)(b0_4 >> 16)] ^ ft_tab[3][v3 >> 24];
  b0 = *((_DWORD *)CipherKey + 9) ^ ft_tab[0][(unsigned __int8)v7] ^ ft_tab[1][BYTE1(b1_4)] ^ ft_tab[2][(unsigned __int8)(v8 >> 16)] ^ ft_tab[3][v9 >> 24];
  v11 = *((_DWORD *)CipherKey + 11) ^ ft_tab[0][(unsigned __int8)v8] ^ ft_tab[2][(unsigned __int8)(v7 >> 16)] ^ ft_tab[3][b1_4 >> 24] ^ ft_tab[1][BYTE1(v9)];
  v12 = *((_DWORD *)CipherKey + 10) ^ ft_tab[0][(unsigned __int8)b1_4] ^ ft_tab[3][v7 >> 24] ^ ft_tab[1][BYTE1(v8)] ^ ft_tab[2][(unsigned __int8)(v9 >> 16)];
  v13 = *((_DWORD *)CipherKey + 12) ^ ft_tab[0][(unsigned __int8)v9] ^ ft_tab[1][BYTE1(v7)] ^ ft_tab[2][(unsigned __int8)(b1_4 >> 16)] ^ ft_tab[3][v8 >> 24];
  b1 = *((_DWORD *)CipherKey + 13) ^ ft_tab[0][(unsigned __int8)b0] ^ ft_tab[1][BYTE1(v12)] ^ ft_tab[2][(unsigned __int8)(v11 >> 16)] ^ ft_tab[3][v13 >> 24];
  v15 = *((_DWORD *)CipherKey + 14) ^ ft_tab[0][(unsigned __int8)v12] ^ ft_tab[3][b0 >> 24] ^ ft_tab[1][BYTE1(v11)] ^ ft_tab[2][(unsigned __int8)(v13 >> 16)];
  v16 = v15;
  v17 = *((_DWORD *)CipherKey + 15) ^ ft_tab[0][(unsigned __int8)v11] ^ ft_tab[2][(unsigned __int8)(b0 >> 16)] ^ ft_tab[3][v12 >> 24] ^ ft_tab[1][BYTE1(v13)];
  v18 = *((_DWORD *)CipherKey + 16) ^ ft_tab[0][(unsigned __int8)v13] ^ ft_tab[1][BYTE1(b0)] ^ ft_tab[2][(unsigned __int8)(v12 >> 16)] ^ ft_tab[3][v11 >> 24];
  v19 = *((_DWORD *)CipherKey + 17) ^ ft_tab[0][(unsigned __int8)b1] ^ ft_tab[1][BYTE1(v16)] ^ ft_tab[2][(unsigned __int8)(v17 >> 16)] ^ ft_tab[3][v18 >> 24];
  v20 = *((_DWORD *)CipherKey + 18) ^ ft_tab[0][(unsigned __int8)v15] ^ ft_tab[3][b1 >> 24] ^ ft_tab[1][BYTE1(v17)] ^ ft_tab[2][(unsigned __int8)(v18 >> 16)];
  v21 = v20;
  v22 = *((_DWORD *)CipherKey + 19) ^ ft_tab[0][(unsigned __int8)v17] ^ ft_tab[2][(unsigned __int8)(b1 >> 16)] ^ ft_tab[3][v16 >> 24] ^ ft_tab[1][BYTE1(v18)];
  v23 = *((_DWORD *)CipherKey + 20) ^ ft_tab[0][(unsigned __int8)v18] ^ ft_tab[1][BYTE1(b1)] ^ ft_tab[2][(unsigned __int8)(v16 >> 16)] ^ ft_tab[3][v17 >> 24];
  v24 = *((_DWORD *)CipherKey + 21) ^ ft_tab[0][(unsigned __int8)v19] ^ ft_tab[1][BYTE1(v21)] ^ ft_tab[2][(unsigned __int8)(v22 >> 16)] ^ ft_tab[3][v23 >> 24];
  v25 = *((_DWORD *)CipherKey + 22) ^ ft_tab[0][(unsigned __int8)v20] ^ ft_tab[3][v19 >> 24] ^ ft_tab[1][BYTE1(v22)] ^ ft_tab[2][(unsigned __int8)(v23 >> 16)];
  v26 = *((_DWORD *)CipherKey + 23) ^ ft_tab[0][(unsigned __int8)v22] ^ ft_tab[2][(unsigned __int8)(v19 >> 16)] ^ ft_tab[3][v21 >> 24] ^ ft_tab[1][BYTE1(v23)];
  v27 = *((_DWORD *)CipherKey + 24) ^ ft_tab[0][(unsigned __int8)v23] ^ ft_tab[1][BYTE1(v19)] ^ ft_tab[2][(unsigned __int8)(v21 >> 16)] ^ ft_tab[3][v22 >> 24];
  v28 = *((_DWORD *)CipherKey + 25) ^ ft_tab[0][(unsigned __int8)v24] ^ ft_tab[1][BYTE1(v25)] ^ ft_tab[2][(unsigned __int8)(v26 >> 16)] ^ ft_tab[3][v27 >> 24];
  v29 = *((_DWORD *)CipherKey + 26) ^ ft_tab[0][(unsigned __int8)v25] ^ ft_tab[3][v24 >> 24] ^ ft_tab[1][BYTE1(v26)] ^ ft_tab[2][(unsigned __int8)(v27 >> 16)];
  v30 = *((_DWORD *)CipherKey + 27) ^ ft_tab[0][(unsigned __int8)v26] ^ ft_tab[2][(unsigned __int8)(v24 >> 16)] ^ ft_tab[3][v25 >> 24] ^ ft_tab[1][BYTE1(v27)];
  v31 = *((_DWORD *)CipherKey + 28) ^ ft_tab[0][(unsigned __int8)v27] ^ ft_tab[1][BYTE1(v24)] ^ ft_tab[2][(unsigned __int8)(v25 >> 16)] ^ ft_tab[3][v26 >> 24];
  v32 = *((_DWORD *)CipherKey + 29) ^ ft_tab[0][(unsigned __int8)v28] ^ ft_tab[1][BYTE1(v29)] ^ ft_tab[2][(unsigned __int8)(v30 >> 16)] ^ ft_tab[3][v31 >> 24];
  v33 = *((_DWORD *)CipherKey + 30) ^ ft_tab[0][(unsigned __int8)v29] ^ ft_tab[3][v28 >> 24] ^ ft_tab[1][BYTE1(v30)] ^ ft_tab[2][(unsigned __int8)(v31 >> 16)];
  v34 = *((_DWORD *)CipherKey + 31) ^ ft_tab[0][(unsigned __int8)v30] ^ ft_tab[2][(unsigned __int8)(v28 >> 16)] ^ ft_tab[3][v29 >> 24] ^ ft_tab[1][BYTE1(v31)];
  v35 = *((_DWORD *)CipherKey + 32) ^ ft_tab[0][(unsigned __int8)v31] ^ ft_tab[1][BYTE1(v28)] ^ ft_tab[2][(unsigned __int8)(v29 >> 16)] ^ ft_tab[3][v30 >> 24];
  v36 = *((_DWORD *)CipherKey + 33) ^ ft_tab[0][(unsigned __int8)v32] ^ ft_tab[1][BYTE1(v33)] ^ ft_tab[2][(unsigned __int8)(v34 >> 16)] ^ ft_tab[3][v35 >> 24];
  v37 = *((_DWORD *)CipherKey + 34) ^ ft_tab[0][(unsigned __int8)v33] ^ ft_tab[3][v32 >> 24] ^ ft_tab[1][BYTE1(v34)] ^ ft_tab[2][(unsigned __int8)(v35 >> 16)];
  v38 = *((_DWORD *)CipherKey + 35) ^ ft_tab[0][(unsigned __int8)v34] ^ ft_tab[2][(unsigned __int8)(v32 >> 16)] ^ ft_tab[3][v33 >> 24] ^ ft_tab[1][BYTE1(v35)];
  v39 = *((_DWORD *)CipherKey + 36) ^ ft_tab[0][(unsigned __int8)v35] ^ ft_tab[1][BYTE1(v32)] ^ ft_tab[2][(unsigned __int8)(v33 >> 16)] ^ ft_tab[3][v34 >> 24];
  v40 = *((_DWORD *)CipherKey + 37) ^ ft_tab[0][(unsigned __int8)v36] ^ ft_tab[1][BYTE1(v37)] ^ ft_tab[2][(unsigned __int8)(v38 >> 16)] ^ ft_tab[3][v39 >> 24];
  v41 = *((_DWORD *)CipherKey + 38) ^ ft_tab[0][(unsigned __int8)v37] ^ ft_tab[3][v36 >> 24] ^ ft_tab[1][BYTE1(v38)] ^ ft_tab[2][(unsigned __int8)(v39 >> 16)];
  v42 = *((_DWORD *)CipherKey + 39) ^ ft_tab[0][(unsigned __int8)v38] ^ ft_tab[2][(unsigned __int8)(v36 >> 16)] ^ ft_tab[3][v37 >> 24] ^ ft_tab[1][BYTE1(v39)];
  v43 = *((_DWORD *)CipherKey + 40) ^ ft_tab[0][(unsigned __int8)v39] ^ ft_tab[1][BYTE1(v36)] ^ ft_tab[2][(unsigned __int8)(v37 >> 16)] ^ ft_tab[3][v38 >> 24];
  v44 = *((_DWORD *)CipherKey + 41) ^ ft_tab[0][(unsigned __int8)v40] ^ ft_tab[1][BYTE1(v41)] ^ ft_tab[2][(unsigned __int8)(v42 >> 16)] ^ ft_tab[3][v43 >> 24];
  v45 = *((_DWORD *)CipherKey + 42) ^ ft_tab[0][(unsigned __int8)v41] ^ ft_tab[3][v40 >> 24] ^ ft_tab[1][BYTE1(v42)] ^ ft_tab[2][(unsigned __int8)(v43 >> 16)];
  v46 = *((_DWORD *)CipherKey + 43) ^ ft_tab[0][(unsigned __int8)v42] ^ ft_tab[2][(unsigned __int8)(v40 >> 16)] ^ ft_tab[3][v41 >> 24] ^ ft_tab[1][BYTE1(v43)];
  v47 = *((_DWORD *)CipherKey + 44) ^ ft_tab[0][(unsigned __int8)v43] ^ ft_tab[1][BYTE1(v40)] ^ ft_tab[2][(unsigned __int8)(v41 >> 16)] ^ ft_tab[3][v42 >> 24];
  v48 = *((_DWORD *)CipherKey + 45) ^ ft_tab[0][(unsigned __int8)v44] ^ ft_tab[1][BYTE1(v45)] ^ ft_tab[2][(unsigned __int8)(v46 >> 16)] ^ ft_tab[3][v47 >> 24];
  v49 = *((_DWORD *)CipherKey + 47) ^ ft_tab[0][(unsigned __int8)v46] ^ ft_tab[2][(unsigned __int8)(v44 >> 16)] ^ ft_tab[3][v45 >> 24] ^ ft_tab[1][BYTE1(v47)];
  v50 = *((_DWORD *)CipherKey + 46) ^ ft_tab[0][(unsigned __int8)v45] ^ ft_tab[3][v44 >> 24] ^ ft_tab[1][BYTE1(v46)] ^ ft_tab[2][(unsigned __int8)(v47 >> 16)];
  v51 = *((_DWORD *)CipherKey + 48) ^ ft_tab[0][(unsigned __int8)v47] ^ ft_tab[1][BYTE1(v44)] ^ ft_tab[2][(unsigned __int8)(v45 >> 16)] ^ ft_tab[3][v46 >> 24];
  v52 = *((_DWORD *)CipherKey + 49) ^ ft_tab[0][(unsigned __int8)v48] ^ ft_tab[1][BYTE1(v50)] ^ ft_tab[2][(unsigned __int8)(v49 >> 16)] ^ ft_tab[3][v51 >> 24];
  v53 = *((_DWORD *)CipherKey + 50) ^ ft_tab[0][(unsigned __int8)v50] ^ ft_tab[3][v48 >> 24] ^ ft_tab[1][BYTE1(v49)] ^ ft_tab[2][(unsigned __int8)(v51 >> 16)];
  v54 = *((_DWORD *)CipherKey + 51) ^ ft_tab[0][(unsigned __int8)v49] ^ ft_tab[2][(unsigned __int8)(v48 >> 16)] ^ ft_tab[3][v50 >> 24] ^ ft_tab[1][BYTE1(v51)];
  v55 = *((_DWORD *)CipherKey + 52) ^ ft_tab[0][(unsigned __int8)v51] ^ ft_tab[1][BYTE1(v48)] ^ ft_tab[2][(unsigned __int8)(v50 >> 16)] ^ ft_tab[3][v49 >> 24];
  v56 = *((_DWORD *)CipherKey + 53) ^ ft_tab[0][(unsigned __int8)v52] ^ ft_tab[1][BYTE1(v53)] ^ ft_tab[2][(unsigned __int8)(v54 >> 16)] ^ ft_tab[3][v55 >> 24];
  v57 = *((_DWORD *)CipherKey + 54) ^ ft_tab[0][(unsigned __int8)v53] ^ ft_tab[3][v52 >> 24] ^ ft_tab[1][BYTE1(v54)] ^ ft_tab[2][(unsigned __int8)(v55 >> 16)];
  v58 = *((_DWORD *)CipherKey + 55) ^ ft_tab[0][(unsigned __int8)v54] ^ ft_tab[2][(unsigned __int8)(v52 >> 16)] ^ ft_tab[3][v53 >> 24] ^ ft_tab[1][BYTE1(v55)];
  v59 = *((_DWORD *)CipherKey + 56) ^ ft_tab[0][(unsigned __int8)v55] ^ ft_tab[1][BYTE1(v52)] ^ ft_tab[2][(unsigned __int8)(v53 >> 16)] ^ ft_tab[3][v54 >> 24];
  v60 = *((_DWORD *)CipherKey + 58) ^ fl_tab[0][(unsigned __int8)v57] ^ fl_tab[3][v56 >> 24] ^ fl_tab[1][BYTE1(v58)] ^ fl_tab[2][(unsigned __int8)(v59 >> 16)];
  v61 = *((_DWORD *)CipherKey + 57) ^ fl_tab[0][(unsigned __int8)v56] ^ fl_tab[1][BYTE1(v57)] ^ fl_tab[2][(unsigned __int8)(v58 >> 16)] ^ fl_tab[3][v59 >> 24];
  v62 = *((_DWORD *)CipherKey + 59) ^ fl_tab[0][(unsigned __int8)v58] ^ fl_tab[2][(unsigned __int8)(v56 >> 16)] ^ fl_tab[3][v57 >> 24] ^ fl_tab[1][BYTE1(v59)];
  v63 = *((_DWORD *)CipherKey + 60) ^ fl_tab[0][(unsigned __int8)v59] ^ fl_tab[1][BYTE1(v56)] ^ fl_tab[2][(unsigned __int8)(v57 >> 16)] ^ fl_tab[3][v58 >> 24];
  *((_DWORD *)Data + 2) = v62;
  *(_DWORD *)Data = v61;
  *((_DWORD *)Data + 1) = v60;
  *((_DWORD *)Data + 3) = v63;
}

//----- (00407050) --------------------------------------------------------
void __cdecl CAESCipher::AES_Decrypt(void *CipherKey, char *Data)
{
  unsigned int v2; // esi@1
  unsigned int v3; // edx@1
  unsigned int v4; // edi@1
  __int16 b0_8; // ST28_2@1
  unsigned int b0; // ST20_4@1
  unsigned int v7; // ecx@1
  unsigned int b1_4; // ST14_4@1
  unsigned int b1_8; // ST18_4@1
  unsigned int v10; // esi@1
  unsigned int b0_4; // ST24_4@1
  unsigned int v12; // ST28_4@1
  unsigned int v13; // edx@1
  unsigned int v14; // esi@1
  unsigned int v15; // ecx@1
  unsigned int v16; // ST14_4@1
  unsigned int v17; // ST18_4@1
  unsigned int v18; // esi@1
  unsigned int v19; // edx@1
  unsigned int v20; // ST24_4@1
  unsigned int v21; // ST28_4@1
  unsigned int v22; // esi@1
  unsigned int v23; // ecx@1
  unsigned int v24; // ST14_4@1
  unsigned int v25; // ST18_4@1
  unsigned int v26; // esi@1
  unsigned int v27; // ST24_4@1
  unsigned int v28; // edx@1
  unsigned int v29; // ST28_4@1
  unsigned int v30; // esi@1
  unsigned int v31; // ST14_4@1
  unsigned int v32; // ST18_4@1
  unsigned int v33; // ecx@1
  unsigned int v34; // esi@1
  unsigned int v35; // edx@1
  unsigned int v36; // ST24_4@1
  unsigned int v37; // ST28_4@1
  unsigned int v38; // esi@1
  unsigned int v39; // ecx@1
  unsigned int v40; // ST14_4@1
  unsigned int v41; // ST18_4@1
  unsigned int v42; // esi@1
  unsigned int v43; // edx@1
  unsigned int v44; // ST24_4@1
  unsigned int v45; // ST28_4@1
  unsigned int v46; // esi@1
  unsigned int v47; // ST14_4@1
  unsigned int v48; // ecx@1
  unsigned int v49; // ST18_4@1
  unsigned int b1_12; // ST1C_4@1
  unsigned int v51; // ST24_4@1
  unsigned int v52; // ST28_4@1
  unsigned int v53; // edx@1
  unsigned int b0_12; // ST2C_4@1
  unsigned int v55; // ecx@1
  unsigned int v56; // ST14_4@1
  unsigned int v57; // ST18_4@1
  unsigned int v58; // ebx@1
  unsigned int v59; // ST24_4@1
  unsigned int v60; // ST28_4@1
  unsigned int v61; // edx@1

  v2 = *((_DWORD *)CipherKey + 3) ^ *((_DWORD *)Data + 2);
  v3 = *((_DWORD *)CipherKey + 2) ^ *((_DWORD *)Data + 1);
  v4 = *((_DWORD *)CipherKey + 4) ^ *((_DWORD *)Data + 3);
  b0_8 = *((_WORD *)CipherKey + 6) ^ *((_WORD *)Data + 4);
  b0 = *((_DWORD *)CipherKey + 1) ^ *(_DWORD *)Data;
  v7 = *((_DWORD *)CipherKey + 5) ^ it_tab[0][(unsigned __int8)b0] ^ it_tab[3][v3 >> 24] ^ it_tab[2][(unsigned __int8)(v2 >> 16)] ^ it_tab[1][BYTE1(v4)];
  b1_4 = *((_DWORD *)CipherKey + 6) ^ it_tab[0][(unsigned __int8)v3] ^ it_tab[1][BYTE1(b0)] ^ it_tab[3][v2 >> 24] ^ it_tab[2][(unsigned __int8)(v4 >> 16)];
  b1_8 = *((_DWORD *)CipherKey + 7) ^ it_tab[0][(unsigned __int8)b0_8] ^ it_tab[2][(unsigned __int8)(b0 >> 16)] ^ it_tab[1][BYTE1(v3)] ^ it_tab[3][v4 >> 24];
  v10 = *((_DWORD *)CipherKey + 8) ^ it_tab[0][(unsigned __int8)v4] ^ it_tab[3][b0 >> 24] ^ it_tab[2][(unsigned __int8)(v3 >> 16)] ^ it_tab[1][HIBYTE(b0_8)];
  b0_4 = *((_DWORD *)CipherKey + 10) ^ it_tab[0][(unsigned __int8)b1_4] ^ it_tab[1][BYTE1(v7)] ^ it_tab[3][b1_8 >> 24] ^ it_tab[2][(unsigned __int8)(v10 >> 16)];
  v12 = *((_DWORD *)CipherKey + 11) ^ it_tab[0][(unsigned __int8)b1_8] ^ it_tab[2][(unsigned __int8)(v7 >> 16)] ^ it_tab[1][BYTE1(b1_4)] ^ it_tab[3][v10 >> 24];
  v13 = *((_DWORD *)CipherKey + 9) ^ it_tab[0][(unsigned __int8)v7] ^ it_tab[3][b1_4 >> 24] ^ it_tab[2][(unsigned __int8)(b1_8 >> 16)] ^ it_tab[1][BYTE1(v10)];
  v14 = *((_DWORD *)CipherKey + 12) ^ it_tab[0][(unsigned __int8)v10] ^ it_tab[3][v7 >> 24] ^ it_tab[2][(unsigned __int8)(b1_4 >> 16)] ^ it_tab[1][BYTE1(b1_8)];
  v15 = *((_DWORD *)CipherKey + 13) ^ it_tab[0][(unsigned __int8)v13] ^ it_tab[3][b0_4 >> 24] ^ it_tab[2][(unsigned __int8)(v12 >> 16)] ^ it_tab[1][BYTE1(v14)];
  v16 = *((_DWORD *)CipherKey + 14) ^ it_tab[0][(unsigned __int8)b0_4] ^ it_tab[1][BYTE1(v13)] ^ it_tab[3][v12 >> 24] ^ it_tab[2][(unsigned __int8)(v14 >> 16)];
  v17 = *((_DWORD *)CipherKey + 15) ^ it_tab[0][(unsigned __int8)v12] ^ it_tab[2][(unsigned __int8)(v13 >> 16)] ^ it_tab[1][BYTE1(b0_4)] ^ it_tab[3][v14 >> 24];
  v18 = *((_DWORD *)CipherKey + 16) ^ it_tab[0][(unsigned __int8)v14] ^ it_tab[3][v13 >> 24] ^ it_tab[2][(unsigned __int8)(b0_4 >> 16)] ^ it_tab[1][BYTE1(v12)];
  v19 = *((_DWORD *)CipherKey + 17) ^ it_tab[0][(unsigned __int8)v15] ^ it_tab[3][v16 >> 24] ^ it_tab[2][(unsigned __int8)(v17 >> 16)] ^ it_tab[1][BYTE1(v18)];
  v20 = *((_DWORD *)CipherKey + 18) ^ it_tab[0][(unsigned __int8)v16] ^ it_tab[1][BYTE1(v15)] ^ it_tab[3][v17 >> 24] ^ it_tab[2][(unsigned __int8)(v18 >> 16)];
  v21 = *((_DWORD *)CipherKey + 19) ^ it_tab[0][(unsigned __int8)v17] ^ it_tab[2][(unsigned __int8)(v15 >> 16)] ^ it_tab[1][BYTE1(v16)] ^ it_tab[3][v18 >> 24];
  v22 = *((_DWORD *)CipherKey + 20) ^ it_tab[0][(unsigned __int8)v18] ^ it_tab[3][v15 >> 24] ^ it_tab[2][(unsigned __int8)(v16 >> 16)] ^ it_tab[1][BYTE1(v17)];
  v23 = *((_DWORD *)CipherKey + 21) ^ it_tab[0][(unsigned __int8)v19] ^ it_tab[3][v20 >> 24] ^ it_tab[2][(unsigned __int8)(v21 >> 16)] ^ it_tab[1][BYTE1(v22)];
  v24 = *((_DWORD *)CipherKey + 22) ^ it_tab[0][(unsigned __int8)v20] ^ it_tab[1][BYTE1(v19)] ^ it_tab[3][v21 >> 24] ^ it_tab[2][(unsigned __int8)(v22 >> 16)];
  v25 = *((_DWORD *)CipherKey + 23) ^ it_tab[0][(unsigned __int8)v21] ^ it_tab[2][(unsigned __int8)(v19 >> 16)] ^ it_tab[1][BYTE1(v20)] ^ it_tab[3][v22 >> 24];
  v26 = *((_DWORD *)CipherKey + 24) ^ it_tab[0][(unsigned __int8)v22] ^ it_tab[3][v19 >> 24] ^ it_tab[2][(unsigned __int8)(v20 >> 16)] ^ it_tab[1][BYTE1(v21)];
  v27 = *((_DWORD *)CipherKey + 26) ^ it_tab[0][(unsigned __int8)v24] ^ it_tab[1][BYTE1(v23)] ^ it_tab[3][v25 >> 24] ^ it_tab[2][(unsigned __int8)(v26 >> 16)];
  v28 = *((_DWORD *)CipherKey + 25) ^ it_tab[0][(unsigned __int8)v23] ^ it_tab[3][v24 >> 24] ^ it_tab[2][(unsigned __int8)(v25 >> 16)] ^ it_tab[1][BYTE1(v26)];
  v29 = *((_DWORD *)CipherKey + 27) ^ it_tab[0][(unsigned __int8)v25] ^ it_tab[2][(unsigned __int8)(v23 >> 16)] ^ it_tab[1][BYTE1(v24)] ^ it_tab[3][v26 >> 24];
  v30 = *((_DWORD *)CipherKey + 28) ^ it_tab[0][(unsigned __int8)v26] ^ it_tab[3][v23 >> 24] ^ it_tab[2][(unsigned __int8)(v24 >> 16)] ^ it_tab[1][BYTE1(v25)];
  v31 = *((_DWORD *)CipherKey + 30) ^ it_tab[0][(unsigned __int8)v27] ^ it_tab[1][BYTE1(v28)] ^ it_tab[3][v29 >> 24] ^ it_tab[2][(unsigned __int8)(v30 >> 16)];
  v32 = *((_DWORD *)CipherKey + 31) ^ it_tab[0][(unsigned __int8)v29] ^ it_tab[2][(unsigned __int8)(v28 >> 16)] ^ it_tab[1][BYTE1(v27)] ^ it_tab[3][v30 >> 24];
  v33 = *((_DWORD *)CipherKey + 29) ^ it_tab[0][(unsigned __int8)v28] ^ it_tab[3][v27 >> 24] ^ it_tab[2][(unsigned __int8)(v29 >> 16)] ^ it_tab[1][BYTE1(v30)];
  v34 = *((_DWORD *)CipherKey + 32) ^ it_tab[0][(unsigned __int8)v30] ^ it_tab[3][v28 >> 24] ^ it_tab[2][(unsigned __int8)(v27 >> 16)] ^ it_tab[1][BYTE1(v29)];
  v35 = *((_DWORD *)CipherKey + 33) ^ it_tab[0][(unsigned __int8)v33] ^ it_tab[3][v31 >> 24] ^ it_tab[2][(unsigned __int8)(v32 >> 16)] ^ it_tab[1][BYTE1(v34)];
  v36 = *((_DWORD *)CipherKey + 34) ^ it_tab[0][(unsigned __int8)v31] ^ it_tab[1][BYTE1(v33)] ^ it_tab[3][v32 >> 24] ^ it_tab[2][(unsigned __int8)(v34 >> 16)];
  v37 = *((_DWORD *)CipherKey + 35) ^ it_tab[0][(unsigned __int8)v32] ^ it_tab[2][(unsigned __int8)(v33 >> 16)] ^ it_tab[1][BYTE1(v31)] ^ it_tab[3][v34 >> 24];
  v38 = *((_DWORD *)CipherKey + 36) ^ it_tab[0][(unsigned __int8)v34] ^ it_tab[3][v33 >> 24] ^ it_tab[2][(unsigned __int8)(v31 >> 16)] ^ it_tab[1][BYTE1(v32)];
  v39 = *((_DWORD *)CipherKey + 37) ^ it_tab[0][(unsigned __int8)v35] ^ it_tab[3][v36 >> 24] ^ it_tab[2][(unsigned __int8)(v37 >> 16)] ^ it_tab[1][BYTE1(v38)];
  v40 = *((_DWORD *)CipherKey + 38) ^ it_tab[0][(unsigned __int8)v36] ^ it_tab[1][BYTE1(v35)] ^ it_tab[3][v37 >> 24] ^ it_tab[2][(unsigned __int8)(v38 >> 16)];
  v41 = *((_DWORD *)CipherKey + 39) ^ it_tab[0][(unsigned __int8)v37] ^ it_tab[2][(unsigned __int8)(v35 >> 16)] ^ it_tab[1][BYTE1(v36)] ^ it_tab[3][v38 >> 24];
  v42 = *((_DWORD *)CipherKey + 40) ^ it_tab[0][(unsigned __int8)v38] ^ it_tab[3][v35 >> 24] ^ it_tab[2][(unsigned __int8)(v36 >> 16)] ^ it_tab[1][BYTE1(v37)];
  v43 = *((_DWORD *)CipherKey + 41) ^ it_tab[0][(unsigned __int8)v39] ^ it_tab[3][v40 >> 24] ^ it_tab[2][(unsigned __int8)(v41 >> 16)] ^ it_tab[1][BYTE1(v42)];
  v44 = *((_DWORD *)CipherKey + 42) ^ it_tab[0][(unsigned __int8)v40] ^ it_tab[1][BYTE1(v39)] ^ it_tab[3][v41 >> 24] ^ it_tab[2][(unsigned __int8)(v42 >> 16)];
  v45 = *((_DWORD *)CipherKey + 43) ^ it_tab[0][(unsigned __int8)v41] ^ it_tab[2][(unsigned __int8)(v39 >> 16)] ^ it_tab[1][BYTE1(v40)] ^ it_tab[3][v42 >> 24];
  v46 = *((_DWORD *)CipherKey + 44) ^ it_tab[0][(unsigned __int8)v42] ^ it_tab[3][v39 >> 24] ^ it_tab[2][(unsigned __int8)(v40 >> 16)] ^ it_tab[1][BYTE1(v41)];
  v47 = *((_DWORD *)CipherKey + 46) ^ it_tab[0][(unsigned __int8)v44] ^ it_tab[1][BYTE1(v43)] ^ it_tab[3][v45 >> 24] ^ it_tab[2][(unsigned __int8)(v46 >> 16)];
  v48 = *((_DWORD *)CipherKey + 45) ^ it_tab[0][(unsigned __int8)v43] ^ it_tab[3][v44 >> 24] ^ it_tab[2][(unsigned __int8)(v45 >> 16)] ^ it_tab[1][BYTE1(v46)];
  v49 = *((_DWORD *)CipherKey + 47) ^ it_tab[0][(unsigned __int8)v45] ^ it_tab[2][(unsigned __int8)(v43 >> 16)] ^ it_tab[1][BYTE1(v44)] ^ it_tab[3][v46 >> 24];
  b1_12 = *((_DWORD *)CipherKey + 48) ^ it_tab[0][(unsigned __int8)v46] ^ it_tab[3][v43 >> 24] ^ it_tab[2][(unsigned __int8)(v44 >> 16)] ^ it_tab[1][BYTE1(v45)];
  v51 = *((_DWORD *)CipherKey + 50) ^ it_tab[0][(unsigned __int8)v47] ^ it_tab[1][BYTE1(v48)] ^ it_tab[3][v49 >> 24] ^ it_tab[2][(unsigned __int8)(b1_12 >> 16)];
  v52 = *((_DWORD *)CipherKey + 51) ^ it_tab[0][(unsigned __int8)v49] ^ it_tab[2][(unsigned __int8)(v48 >> 16)] ^ it_tab[1][BYTE1(v47)] ^ it_tab[3][b1_12 >> 24];
  v53 = *((_DWORD *)CipherKey + 49) ^ it_tab[0][(unsigned __int8)v48] ^ it_tab[3][v47 >> 24] ^ it_tab[2][(unsigned __int8)(v49 >> 16)] ^ it_tab[1][BYTE1(b1_12)];
  b0_12 = *((_DWORD *)CipherKey + 52) ^ it_tab[0][(unsigned __int8)b1_12] ^ it_tab[3][v48 >> 24] ^ it_tab[2][(unsigned __int8)(v47 >> 16)] ^ it_tab[1][BYTE1(v49)];
  v55 = *((_DWORD *)CipherKey + 53) ^ it_tab[0][(unsigned __int8)v53] ^ it_tab[3][v51 >> 24] ^ it_tab[2][(unsigned __int8)(v52 >> 16)] ^ it_tab[1][BYTE1(b0_12)];
  v56 = *((_DWORD *)CipherKey + 54) ^ it_tab[0][(unsigned __int8)v51] ^ it_tab[1][BYTE1(v53)] ^ it_tab[3][v52 >> 24] ^ it_tab[2][(unsigned __int8)(b0_12 >> 16)];
  v57 = *((_DWORD *)CipherKey + 55) ^ it_tab[0][(unsigned __int8)v52] ^ it_tab[2][(unsigned __int8)(v53 >> 16)] ^ it_tab[1][BYTE1(v51)] ^ it_tab[3][b0_12 >> 24];
  v58 = *((_DWORD *)CipherKey + 56) ^ it_tab[0][(unsigned __int8)b0_12] ^ it_tab[3][v53 >> 24] ^ it_tab[2][(unsigned __int8)(v51 >> 16)] ^ it_tab[1][BYTE1(v52)];
  v59 = *((_DWORD *)CipherKey + 58) ^ il_tab[0][(unsigned __int8)v56] ^ il_tab[1][BYTE1(v55)] ^ il_tab[3][v57 >> 24] ^ il_tab[2][(unsigned __int8)(v58 >> 16)];
  v60 = *((_DWORD *)CipherKey + 59) ^ il_tab[0][(unsigned __int8)v57] ^ il_tab[2][(unsigned __int8)(v55 >> 16)] ^ il_tab[1][BYTE1(v56)] ^ il_tab[3][v58 >> 24];
  v61 = *((_DWORD *)CipherKey + 60) ^ il_tab[0][(unsigned __int8)v58] ^ il_tab[3][v55 >> 24] ^ il_tab[2][(unsigned __int8)(v56 >> 16)] ^ il_tab[1][BYTE1(v57)];
  *(_DWORD *)Data = *((_DWORD *)CipherKey + 57) ^ il_tab[0][(unsigned __int8)v55] ^ il_tab[3][v56 >> 24] ^ il_tab[2][(unsigned __int8)(v57 >> 16)] ^ il_tab[1][BYTE1(v58)];
  *((_DWORD *)Data + 1) = v59;
  *((_DWORD *)Data + 2) = v60;
  *((_DWORD *)Data + 3) = v61;
}

//----- (00407E90) --------------------------------------------------------
char __cdecl CAESCipher::OFB_EncUpdate(CAESCipher::AES_ALG_INFO *AlgInfo, char *PlainTxt, unsigned int PlainTxtLen, char *CipherTxt, unsigned int *CipherTxtLen)
{
  CAESCipher::AES_ALG_INFO *v5; // esi@1
  unsigned int v6; // ebx@1
  unsigned int v7; // ebx@5
  char *v8; // edi@5
  bool v9; // zf@7
  char *tmpPlainTxt; // [sp+Ch] [bp-4h]@0
  char memAllocate_3; // [sp+1Bh] [bp+Bh]@1
  char *PlainTxta; // [sp+1Ch] [bp+Ch]@5
  unsigned int PlainTxtLena; // [sp+20h] [bp+10h]@6

  v5 = AlgInfo;
  v6 = AlgInfo->BufLen;
  memAllocate_3 = 0;
  *CipherTxtLen = v6 + PlainTxtLen;
  if ( v6 + PlainTxtLen >= 0x10 )
  {
    if ( PlainTxt == CipherTxt )
    {
      tmpPlainTxt = (char *)malloc(PlainTxtLen);
      memcpy(tmpPlainTxt, PlainTxt, PlainTxtLen);
      PlainTxt = tmpPlainTxt;
      memAllocate_3 = 1;
    }
    memcpy(&v5->Buffer[v6], PlainTxt, 16 - v6);
    PlainTxta = &PlainTxt[16 - v6];
    v7 = PlainTxtLen + v6 - 16;
    CAESCipher::AES_Encrypt(v5->RoundKey, v5->ChainVar);
    *(_DWORD *)CipherTxt = *(_DWORD *)&v5->Buffer[0] ^ *(_DWORD *)&v5->ChainVar[0];
    v8 = CipherTxt + 16;
    *((_DWORD *)v8 - 3) = *(_DWORD *)&v5->ChainVar[4] ^ *(_DWORD *)&v5->Buffer[4];
    *((_DWORD *)v8 - 2) = *(_DWORD *)&v5->ChainVar[8] ^ *(_DWORD *)&v5->Buffer[8];
    *((_DWORD *)v8 - 1) = *(_DWORD *)&v5->ChainVar[12] ^ *(_DWORD *)&v5->Buffer[12];
    if ( v7 >= 0x10 )
    {
      PlainTxtLena = v7 >> 4;
      do
      {
        CAESCipher::AES_Encrypt(v5->RoundKey, v5->ChainVar);
        *(_DWORD *)v8 = *(_DWORD *)PlainTxta ^ *(_DWORD *)&v5->ChainVar[0];
        v8 += 16;
        *((_DWORD *)v8 - 3) = *(_DWORD *)&v5->ChainVar[4] ^ *((_DWORD *)PlainTxta + 1);
        v7 -= 16;
        *((_DWORD *)v8 - 2) = *(_DWORD *)&v5->ChainVar[8] ^ *((_DWORD *)PlainTxta + 2);
        v9 = PlainTxtLena-- == 1;
        *((_DWORD *)v8 - 1) = *(_DWORD *)&v5->ChainVar[12] ^ *((_DWORD *)PlainTxta + 3);
        PlainTxta += 16;
      }
      while ( !v9 );
    }
    memcpy(v5->Buffer, PlainTxta, v7);
    v5->BufLen = v7 + (v5->BufLen & 0xF0000000);
    *CipherTxtLen -= v7;
    if ( memAllocate_3 )
      free(tmpPlainTxt);
  }
  else
  {
    memcpy(&v5->Buffer[v6], PlainTxt, PlainTxtLen);
    v5->BufLen += PlainTxtLen;
    *CipherTxtLen = 0;
  }
  return 1;
}

//----- (00407FDB) --------------------------------------------------------
char __cdecl CAESCipher::OFB_EncFinal(CAESCipher::AES_ALG_INFO *AlgInfo, char *CipherTxt, unsigned int *CipherTxtLen)
{
  unsigned int v3; // edi@1
  CAESCipher::AES_ALG_INFO *v4; // eax@2
  unsigned int v5; // esi@2

  v3 = AlgInfo->BufLen;
  *CipherTxtLen = 16;
  CAESCipher::AES_Encrypt(AlgInfo->RoundKey, AlgInfo->ChainVar);
  if ( v3 )
  {
    v4 = AlgInfo;
    v5 = v3;
    do
    {
      v4->ChainVar[CipherTxt - (char *)AlgInfo] = v4->ChainVar[0] ^ v4->Buffer[0];
      v4 = (CAESCipher::AES_ALG_INFO *)((char *)v4 + 1);
      --v5;
    }
    while ( v5 );
  }
  *CipherTxtLen = v3;
  return 1;
}

//----- (0040801D) --------------------------------------------------------
char __cdecl CAESCipher::OFB_DecUpdate(CAESCipher::AES_ALG_INFO *AlgInfo, char *CipherTxt, unsigned int CipherTxtLen, char *PlainTxt, unsigned int *PlainTxtLen)
{
  CAESCipher::AES_ALG_INFO *v5; // esi@1
  unsigned int v6; // ebx@1
  size_t v7; // ebx@5
  char *v8; // edi@5
  bool v9; // zf@7
  char *tmpCipherTxt; // [sp+Ch] [bp-4h]@0
  char memAllocate_3; // [sp+1Bh] [bp+Bh]@1
  char *CipherTxta; // [sp+1Ch] [bp+Ch]@5
  unsigned int CipherTxtLena; // [sp+20h] [bp+10h]@6

  v5 = AlgInfo;
  v6 = AlgInfo->BufLen;
  memAllocate_3 = 0;
  *PlainTxtLen = v6 + CipherTxtLen;
  if ( v6 + CipherTxtLen > 0x10 )
  {
    if ( CipherTxt == PlainTxt )
    {
      tmpCipherTxt = (char *)malloc(CipherTxtLen);
      memcpy(tmpCipherTxt, CipherTxt, CipherTxtLen);
      CipherTxt = tmpCipherTxt;
      memAllocate_3 = 1;
    }
    *PlainTxtLen = v6 + CipherTxtLen;
    memcpy(&v5->Buffer[v6], CipherTxt, 16 - v6);
    CipherTxta = &CipherTxt[16 - v6];
    v7 = CipherTxtLen + v6 - 16;
    CAESCipher::AES_Encrypt(v5->RoundKey, v5->ChainVar);
    *(_DWORD *)PlainTxt = *(_DWORD *)&v5->ChainVar[0] ^ *(_DWORD *)&v5->Buffer[0];
    v8 = PlainTxt + 16;
    *((_DWORD *)v8 - 3) = *(_DWORD *)&v5->ChainVar[4] ^ *(_DWORD *)&v5->Buffer[4];
    *((_DWORD *)v8 - 2) = *(_DWORD *)&v5->ChainVar[8] ^ *(_DWORD *)&v5->Buffer[8];
    *((_DWORD *)v8 - 1) = *(_DWORD *)&v5->ChainVar[12] ^ *(_DWORD *)&v5->Buffer[12];
    if ( v7 > 0x10 )
    {
      CipherTxtLena = (v7 - 1) >> 4;
      do
      {
        CAESCipher::AES_Encrypt(v5->RoundKey, v5->ChainVar);
        *(_DWORD *)v8 = *(_DWORD *)CipherTxta ^ *(_DWORD *)&v5->ChainVar[0];
        v8 += 16;
        *((_DWORD *)v8 - 3) = *(_DWORD *)&v5->ChainVar[4] ^ *((_DWORD *)CipherTxta + 1);
        v7 -= 16;
        *((_DWORD *)v8 - 2) = *(_DWORD *)&v5->ChainVar[8] ^ *((_DWORD *)CipherTxta + 2);
        v9 = CipherTxtLena-- == 1;
        *((_DWORD *)v8 - 1) = *(_DWORD *)&v5->ChainVar[12] ^ *((_DWORD *)CipherTxta + 3);
        CipherTxta += 16;
      }
      while ( !v9 );
    }
    memcpy(v5->Buffer, CipherTxta, v7);
    v5->BufLen = v7 + (v5->BufLen & 0xF0000000);
    *PlainTxtLen -= v7;
    if ( memAllocate_3 )
      free(tmpCipherTxt);
  }
  else
  {
    memcpy(&v5->Buffer[v6], CipherTxt, CipherTxtLen);
    v5->BufLen += CipherTxtLen;
    *PlainTxtLen = 0;
  }
  return 1;
}

//----- (00408173) --------------------------------------------------------
char __cdecl CAESCipher::OFB_DecFinal(CAESCipher::AES_ALG_INFO *AlgInfo, char *PlainTxt, unsigned int *PlainTxtLen)
{
  unsigned int v3; // edi@1
  CAESCipher::AES_ALG_INFO *v4; // eax@2
  unsigned int v5; // esi@2

  v3 = AlgInfo->BufLen;
  *PlainTxtLen = v3;
  CAESCipher::AES_Encrypt(AlgInfo->RoundKey, AlgInfo->ChainVar);
  if ( v3 )
  {
    v4 = AlgInfo;
    v5 = v3;
    do
    {
      v4->ChainVar[PlainTxt - (char *)AlgInfo] = v4->ChainVar[0] ^ v4->Buffer[0];
      v4 = (CAESCipher::AES_ALG_INFO *)((char *)v4 + 1);
      --v5;
    }
    while ( v5 );
  }
  *PlainTxtLen = v3;
  return 1;
}

//----- (004081B1) --------------------------------------------------------
void _E19_0()
{
  _E17();
  _E18_0();
}

//----- (004081BB) --------------------------------------------------------
void _E17()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (004081F6) --------------------------------------------------------
void _E18_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00408231) --------------------------------------------------------
void _E36_1()
{
  _E29();
  _E30_0();
  _E31_1();
  _E32_1();
  _E33_1();
  _E34_1();
  _E35_1();
}

//----- (00408254) --------------------------------------------------------
void _E29()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0040828F) --------------------------------------------------------
void _E30_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004082CA) --------------------------------------------------------
void _E31_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00408305) --------------------------------------------------------
void _E32_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00408340) --------------------------------------------------------
void _E33_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0040837B) --------------------------------------------------------
void _E34_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004083B6) --------------------------------------------------------
void _E35_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (004083F1) --------------------------------------------------------
char __cdecl is_correct_bodypart(int nItemID, int nBodyPart, int nGender)
{
  int v3; // edx@2
  int v4; // eax@7
  int v7; // eax@34

  if ( nItemID / 1000000 == 1 )
    v3 = nItemID / 1000 % 10;
  else
    v3 = 2;
  if ( nGender != 2 && v3 != 2 && nGender != v3 )
    return 0;
  v4 = nItemID / 10000;
  if ( nItemID / 10000 > 119 )
  {
    if ( v4 == 180 )
    {
      if ( nItemID != 1802100 )
        return nBodyPart == 14;
    }
    else
    {
      if ( v4 == 181 )
      {
        if ( nItemID == 1812000 )
          return nBodyPart == 23;
        if ( nItemID == 1812001 )
          return nBodyPart == 22;
        if ( nItemID == 1812002 )
          return nBodyPart == 24;
        if ( nItemID == 1812003 )
          return nBodyPart == 25;
        if ( nItemID == 1812004 )
          return nBodyPart == 26;
        if ( nItemID == 1812005 )
          return nBodyPart == 27;
        if ( nItemID == 1812006 )
          return nBodyPart == 28;
        return 0;
      }
      if ( v4 != 182 )
      {
        if ( v4 == 183 )
          return nBodyPart == 29;
        if ( v4 == 190 )
          return nBodyPart == 18;
        if ( v4 == 191 )
          return nBodyPart == 19;
        if ( v4 == 192 )
          return nBodyPart == 20;
LABEL_34:
        v7 = v4 / 10;
        if ( v7 == 13 || v7 == 14 || v7 == 16 || v7 == 17 )
          return nBodyPart == 11;
        return 0;
      }
    }
    return nBodyPart == 21;
  }
  if ( nItemID / 10000 != 119 )
  {
    switch ( v4 )
    {
      case 100:
        return nBodyPart == 1;
      case 101:
        return nBodyPart == 2;
      case 102:
        return nBodyPart == 3;
      case 103:
        return nBodyPart == 4;
      case 104:
      case 105:
        return nBodyPart == 5;
      case 106:
        return nBodyPart == 6;
      case 107:
        return nBodyPart == 7;
      case 108:
        return nBodyPart == 8;
      case 110:
        return nBodyPart == 9;
      case 111:
        if ( nBodyPart != 12 && nBodyPart != 13 && nBodyPart != 15 && nBodyPart != 16 )
          return 0;
        return 1;
      case 112:
        return nBodyPart == 17;
      case 109:
        return nBodyPart == 10;
      default:
        goto LABEL_34;
    }
    goto LABEL_34;
  }
  return nBodyPart == 10;
}

//----- (00408610) --------------------------------------------------------
int __cdecl get_bodypart_from_item(int nItemID, int nGender, int *pnBodyPart, int bAll)
{
  int v4; // edx@2
  int v5; // eax@7
  int v7; // eax@30

  if ( nItemID / 1000000 == 1 )
    v4 = nItemID / 1000 % 10;
  else
    v4 = 2;
  if ( nGender != 2 && v4 != 2 && nGender != v4 )
    return 0;
  v5 = nItemID / 10000;
  if ( nItemID / 10000 > 119 )
  {
    if ( v5 == 180 )
    {
      *pnBodyPart = 14;
      return 1;
    }
    if ( v5 == 181 )
    {
      if ( nItemID == 1812000 )
      {
        *pnBodyPart = 23;
        return 1;
      }
      if ( nItemID == 1812001 )
      {
        *pnBodyPart = 22;
        return 1;
      }
      if ( nItemID == 1812002 )
      {
        *pnBodyPart = 24;
        return 1;
      }
      if ( nItemID == 1812003 )
      {
        *pnBodyPart = 25;
        return 1;
      }
      if ( nItemID == 1812004 )
      {
        *pnBodyPart = 26;
        return 1;
      }
      if ( nItemID == 1812005 )
      {
        *pnBodyPart = 27;
        return 1;
      }
      if ( nItemID == 1812006 )
      {
        *pnBodyPart = 28;
        return 1;
      }
    }
    else if ( v5 != 182 )
    {
      if ( v5 == 183 )
      {
        *pnBodyPart = 29;
        return 1;
      }
      if ( v5 == 190 )
      {
        *pnBodyPart = 18;
        return 1;
      }
      if ( v5 == 191 )
      {
        *pnBodyPart = 19;
        return 1;
      }
      if ( v5 == 192 )
      {
        *pnBodyPart = 20;
        return 1;
      }
      goto LABEL_30;
    }
    *pnBodyPart = 21;
    return 1;
  }
  if ( nItemID / 10000 == 119 )
  {
$L105222:
    *pnBodyPart = 10;
    return 1;
  }
  switch ( v5 )
  {
    case 100:
      *pnBodyPart = 1;
      return 1;
    case 101:
      *pnBodyPart = 2;
      return 1;
    case 102:
      *pnBodyPart = 3;
      return 1;
    case 103:
      *pnBodyPart = 4;
      return 1;
    case 104:
    case 105:
      *pnBodyPart = 5;
      return 1;
    case 106:
      *pnBodyPart = 6;
      return 1;
    case 107:
      *pnBodyPart = 7;
      return 1;
    case 108:
      *pnBodyPart = 8;
      return 1;
    case 110:
      *pnBodyPart = 9;
      return 1;
    case 111:
      *pnBodyPart = 12;
      if ( !bAll )
        return 1;
      pnBodyPart[1] = 13;
      pnBodyPart[2] = 15;
      pnBodyPart[3] = 16;
      return 4;
    case 112:
      *pnBodyPart = 17;
      return 1;
    case 109:
      goto $L105222;
    default:
      break;
  }
LABEL_30:
  v7 = v5 / 10;
  if ( v7 != 13 && v7 != 14 && v7 != 16 && v7 != 17 )
    return 0;
  *pnBodyPart = 11;
  return 1;
}

//----- (00408880) --------------------------------------------------------
int __cdecl get_weapon_type(int nItemID)
{
  int result; // eax@2

  if ( nItemID / 1000000 != 1
    || (result = nItemID / 10000 % 100, result < 30)
    || result > 33 && (result <= 36 || result > 38 && (result <= 39 || result > 47)) )
  {
    result = 0;
  }
  return result;
}

//----- (004088C6) --------------------------------------------------------
void _E13_0()
{
  _E11_0();
  _E12_0();
}

//----- (004088D0) --------------------------------------------------------
void _E11_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0040890B) --------------------------------------------------------
void _E12_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00408946) --------------------------------------------------------
void _E30_1()
{
  _E23();
  _E24();
  _E25();
  _E26();
  _E27();
  _E28();
  _E29_0();
}

//----- (00408969) --------------------------------------------------------
void _E23()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004089A4) --------------------------------------------------------
void _E24()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004089DF) --------------------------------------------------------
void _E25()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00408A1A) --------------------------------------------------------
void _E26()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00408A55) --------------------------------------------------------
void _E27()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00408A90) --------------------------------------------------------
void _E28()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00408ACB) --------------------------------------------------------
void _E29_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00408B06) --------------------------------------------------------
void __thiscall CCenter::CCenter(CCenter *this)
{
  CCenter *v1; // esi@1

  v1 = this;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v1->m_sName._m_pStr = 0;
  v1->m_nWorldState = 0;
  v1->m_nWorldState_WSE = 0;
  v1->m_sWorldEventDesc._m_pStr = 0;
  v1->m_nEventEXP_WSE = 100;
  v1->m_nEventDrop_WSE = 100;
  ZInetAddr::_Init(&v1->m_addr, 0, 0);
  v1->m_sAddr._m_pStr = 0;
  v1->m_pSocket = 0;
  v1->m_aUserNo.a = 0;
  v1->m_aAdultChannel.a = 0;
  v1->m_mServerStatus._m_apTable = 0;
  v1->m_mServerStatus._m_uCount = 0;
  v1->m_mServerStatus._m_uAutoGrowEvery128 = 100;
  v1->m_mServerStatus._m_uTableSize = 31;
  v1->m_mServerStatus.vfptr = (ZMap<long,int,long>Vtbl *)&ZMap<long,int,long>::`vftable';
  v1->m_mServerStatus._m_uAutoGrowLimit = 24;
}
// 4434B4: using guessed type int (__thiscall *ZMap<long,int,long>::`vftable')(void *p, unsigned int __flags);

//----- (00408B83) --------------------------------------------------------
void __thiscall CCenter::~CCenter(CCenter *this)
{
  CCenter *v1; // esi@1
  ZMap<long,int,long> *v2; // ecx@1

  v1 = this;
  v2 = &this->m_mServerStatus;
  v2->vfptr = (ZMap<long,int,long>Vtbl *)&ZMap<long,int,long>::`vftable';
  ZMap<long,int,long>::RemoveAll(v2);
  ZArray<int>::RemoveAll(&v1->m_aAdultChannel);
  ZArray<long>::RemoveAll(&v1->m_aUserNo);
  ZXString<char>::~ZXString<char>(&v1->m_sAddr);
  ZXString<char>::~ZXString<char>(&v1->m_sWorldEventDesc);
  ZXString<char>::~ZXString<char>(&v1->m_sName);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
}
// 4434B4: using guessed type int (__thiscall *ZMap<long,int,long>::`vftable')(void *p, unsigned int __flags);

//----- (00408BF9) --------------------------------------------------------
int __thiscall CCenter::Init(CCenter *this, const unsigned __int16 *sName, int nIndex, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry)
{
  CCenter *v4; // ebx@1
  int *v5; // ecx@1
  IWzProperty *v6; // eax@1
  Ztl_variant_t *v7; // eax@1
  int v8; // eax@1
  IWzProperty *v9; // eax@3
  Ztl_variant_t *v10; // eax@3
  int v11; // eax@3
  unsigned __int16 *v12; // eax@6
  void *v13; // esp@8
  unsigned __int16 *v14; // edi@9
  unsigned __int16 *v15; // eax@12
  int v16; // eax@14
  VARIANTARG *v17; // ecx@14
  IWzProperty *v18; // eax@14
  Ztl_variant_t *v19; // eax@14
  int v20; // eax@14
  int *v21; // ecx@14
  IWzProperty *v22; // eax@16
  Ztl_variant_t *v23; // eax@16
  int v24; // eax@16
  int *v25; // ecx@16
  IWzProperty *v26; // eax@18
  Ztl_variant_t *v27; // eax@18
  int v28; // eax@18
  IWzProperty *v29; // eax@20
  Ztl_variant_t *v30; // eax@20
  bool v31; // zf@20
  unsigned __int16 *v32; // eax@21
  int v33; // eax@23
  int *v34; // ecx@23
  IWzProperty *v35; // eax@25
  Ztl_variant_t *v36; // eax@25
  int v37; // eax@25
  int i; // eax@27
  _bstr_t::Data_t *v39; // ecx@30
  IWzProperty *v40; // eax@30
  Ztl_variant_t *v41; // eax@30
  int v42; // eax@31
  int v43; // eax@34
  int **v44; // edi@36
  int j; // eax@36
  IWzProperty *v46; // ecx@39
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *v47; // eax@40
  IUnknownVtbl *v48; // ecx@41
  int v49; // ecx@45
  int *v50; // ecx@46
  IWzProperty *v51; // eax@46
  Ztl_variant_t *v52; // eax@46
  unsigned int v53; // esi@46
  unsigned __int16 *v54; // eax@46
  int v55; // eax@46
  int *v56; // eax@46
  int v57; // eax@46
  const wchar_t *v58; // eax@49
  int v59; // ecx@56
  IWzProperty v60; // eax@59
  int v61; // eax@60
  IUnknownVtbl *v62; // ecx@67
  Ztl_bstr_t v64; // [sp-Ch] [bp-84h]@30
  VARIANTARG *v65; // [sp-8h] [bp-80h]@1
  int *v66; // [sp-4h] [bp-7Ch]@1
  int v67; // [sp+0h] [bp-78h]@1
  Ztl_variant_t v68; // [sp+Ch] [bp-6Ch]@3
  Ztl_variant_t result; // [sp+1Ch] [bp-5Ch]@1
  ZInetAddr v70; // [sp+2Ch] [bp-4Ch]@14
  VARIANTARG pvarg; // [sp+3Ch] [bp-3Ch]@30
  VARIANTARG **v72; // [sp+4Ch] [bp-2Ch]@46
  int v73; // [sp+50h] [bp-28h]@42
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > v74; // [sp+54h] [bp-24h]@40
  int v75; // [sp+58h] [bp-20h]@30
  Ztl_bstr_t v76; // [sp+5Ch] [bp-1Ch]@3
  Ztl_bstr_t v77; // [sp+60h] [bp-18h]@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v78; // [sp+64h] [bp-14h]@30
  int *v79; // [sp+68h] [bp-10h]@1
  int v80; // [sp+74h] [bp-4h]@1

  v79 = &v67;
  v4 = this;
  v80 = 0;
  LOBYTE(v80) = 1;
  ZXString<char>::Assign(&this->m_sName, (int)sName, -1);
  v66 = v5;
  sName = (const unsigned __int16 *)&v66;
  v65 = (VARIANTARG *)s;
  v4->m_nIndex = nIndex;
  _bstr_t::_bstr_t((_bstr_t *)&v66, &v65->vt);
  LOBYTE(v80) = 2;
  v6 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  LOBYTE(v80) = 1;
  v7 = IWzProperty::Getitem(v6, &result, (Ztl_bstr_t)v66);
  LOBYTE(v80) = 3;
  DetachBSTR(&v77, (tagVARIANT *)&v7->0);
  LOBYTE(v80) = 5;
  v8 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v8 < 0 )
    _com_issue_error(v8);
  sName = (const unsigned __int16 *)&v66;
  _bstr_t::_bstr_t((_bstr_t *)&v66, aPort);
  LOBYTE(v80) = 6;
  v9 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  LOBYTE(v80) = 5;
  v10 = IWzProperty::Getitem(v9, &v68, (Ztl_bstr_t)v66);
  LOBYTE(v80) = 7;
  DetachBSTR(&v76, (tagVARIANT *)&v10->0);
  LOBYTE(v80) = 9;
  v11 = ZComAPI::ZComVariantClear((tagVARIANT *)&v68.0);
  if ( v11 < 0 )
    _com_issue_error(v11);
  if ( v77.m_Data )
    v12 = v77.m_Data->m_wstr;
  else
    v12 = 0;
  v13 = alloca(dword_4A477C(0, 0, v12, -1, 0, 0, 0, 0));
  if ( v76.m_Data )
    v14 = v76.m_Data->m_wstr;
  else
    v14 = 0;
  if ( v77.m_Data )
    v15 = v77.m_Data->m_wstr;
  else
    v15 = 0;
  dword_4A477C(0, 0, v15, -1, &v67, 0x3FFFFFFF, 0, 0);
  v16 = _wtoi(v14);
  ZInetAddr::ZInetAddr(&v70, (const char *)&v67, v16);
  LOBYTE(v80) = 10;
  ZInetAddr::_InitN(&v4->m_addr, v70.sin_port, v70.sin_addr.S_un.S_addr);
  v66 = 0;
  v65 = v17;
  sName = (const unsigned __int16 *)&v65;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v65, aWorld);
  LOBYTE(v80) = 11;
  v18 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  LOBYTE(v80) = 10;
  v19 = IWzProperty::Getitem(v18, &v68, (Ztl_bstr_t)v65);
  LOBYTE(v80) = 12;
  v4->m_nWorldId = get_int32(v19, (int)v66);
  LOBYTE(v80) = 10;
  v20 = ZComAPI::ZComVariantClear((tagVARIANT *)&v68.0);
  v21 = v66;
  if ( v20 < 0 )
    _com_issue_error(v20);
  v66 = (int *)1;
  v65 = (VARIANTARG *)v21;
  sName = (const unsigned __int16 *)&v65;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v65, aChannelno);
  LOBYTE(v80) = 13;
  v22 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  LOBYTE(v80) = 10;
  v23 = IWzProperty::Getitem(v22, &v68, (Ztl_bstr_t)v65);
  LOBYTE(v80) = 14;
  v4->m_nChannelNo = get_int32(v23, (int)v66);
  LOBYTE(v80) = 10;
  v24 = ZComAPI::ZComVariantClear((tagVARIANT *)&v68.0);
  v25 = v66;
  if ( v24 < 0 )
    _com_issue_error(v24);
  v66 = 0;
  v65 = (VARIANTARG *)v25;
  sName = (const unsigned __int16 *)&v65;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v65, aWorldstate);
  LOBYTE(v80) = 15;
  v26 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  LOBYTE(v80) = 10;
  v27 = IWzProperty::Getitem(v26, &v68, (Ztl_bstr_t)v65);
  LOBYTE(v80) = 16;
  v4->m_nWorldState = get_int32(v27, (int)v66);
  LOBYTE(v80) = 10;
  v28 = ZComAPI::ZComVariantClear((tagVARIANT *)&v68.0);
  if ( v28 < 0 )
    _com_issue_error(v28);
  sName = (const unsigned __int16 *)&v66;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v66, aEventdesc);
  LOBYTE(v80) = 17;
  v29 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  LOBYTE(v80) = 10;
  v30 = IWzProperty::Getitem(v29, &v68, (Ztl_bstr_t)v66);
  v31 = v30->vt == 8;
  LOBYTE(v80) = 18;
  if ( v31 )
    v32 = v30->bstrVal;
  else
    v32 = &sDefault;
  ZXString<char>::Assign(&v4->m_sWorldEventDesc, (int)v32, -1);
  LOBYTE(v80) = 10;
  v33 = ZComAPI::ZComVariantClear((tagVARIANT *)&v68.0);
  v34 = v66;
  if ( v33 < 0 )
    _com_issue_error(v33);
  v66 = 0;
  v65 = (VARIANTARG *)v34;
  sName = (const unsigned __int16 *)&v65;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v65, aBlockcharcreat);
  LOBYTE(v80) = 19;
  v35 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  LOBYTE(v80) = 10;
  v36 = IWzProperty::Getitem(v35, &v68, (Ztl_bstr_t)v65);
  LOBYTE(v80) = 20;
  v4->m_nBlockCharCreation = get_int32(v36, (int)v66);
  LOBYTE(v80) = 10;
  v37 = ZComAPI::ZComVariantClear((tagVARIANT *)&v68.0);
  if ( v37 < 0 )
    _com_issue_error(v37);
  ZArray<long>::_Alloc(&v4->m_aUserNo, v4->m_nChannelNo, (ZAllocHelper *)&sName + 3);
  for ( i = 0; i < v4->m_nChannelNo; ++i )
    v4->m_aUserNo.a[i] = 0;
  VariantInit(&pvarg);
  v66 = 0;
  v65 = 0;
  v64.m_Data = v39;
  sName = (const unsigned __int16 *)&v64;
  LOBYTE(v80) = 21;
  Ztl_bstr_t::Ztl_bstr_t(&v64, aAdult);
  LOBYTE(v80) = 22;
  v40 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  LOBYTE(v80) = 21;
  v41 = IWzProperty::Getitem(v40, &v68, v64);
  LOBYTE(v80) = 23;
  v75 = (int)Ztl_variant_t::GetUnknown(v41, (char)v65, (char)v66);
  v78.m_pInterface = 0;
  if ( v75 )
  {
    v42 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
            &v78,
            (int)&v75);
    if ( v42 < 0 && v42 != -2147467262 )
      _com_issue_error(v42);
  }
  LOBYTE(v80) = 25;
  v43 = ZComAPI::ZComVariantClear((tagVARIANT *)&v68.0);
  if ( v43 < 0 )
    _com_issue_error(v43);
  v44 = &v4->m_aAdultChannel.a;
  ZArray<int>::_Alloc(&v4->m_aAdultChannel, v4->m_nChannelNo, (ZAllocHelper *)&sName + 3);
  for ( j = 0; j < v4->m_nChannelNo; ++j )
    (*v44)[j] = 0;
  v46 = v78.m_pInterface;
  v31 = v78.m_pInterface == 0;
  v4->m_nAdultChannelNo = 0;
  if ( !v31 )
  {
    v47 = IWzProperty::Get_NewEnum(v46, &v74);
    LOBYTE(v80) = 26;
    _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(
      (_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *)&nIndex,
      v47);
    LOBYTE(v80) = 28;
    if ( v74.m_pInterface )
    {
      v48 = v74.m_pInterface->vfptr;
      v66 = (int *)v74.m_pInterface;
      v48->Release(v74.m_pInterface);
    }
    v73 = 0;
    while ( 1 )
    {
      if ( !nIndex )
        _com_issue_error(-2147467261);
      v49 = *(_DWORD *)nIndex;
      v66 = &v73;
      v65 = &pvarg;
      v64.m_Data = (_bstr_t::Data_t *)1;
      if ( (*(int (__stdcall **)(int, signed int, VARIANTARG *, int *))(v49 + 12))(nIndex, 1, &pvarg, &v73) )
        break;
      DetachBSTR((Ztl_bstr_t *)&sName, &pvarg);
      v50 = v66;
      v66 = 0;
      v65 = (VARIANTARG *)v50;
      v72 = &v65;
      LOBYTE(v80) = 29;
      Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v65, (Ztl_bstr_t *)&sName);
      LOBYTE(v80) = 30;
      v51 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v78);
      LOBYTE(v80) = 29;
      v52 = IWzProperty::Getitem(v51, &result, (Ztl_bstr_t)v65);
      LOBYTE(v80) = 31;
      v53 = get_int32(v52, (int)v66);
      v54 = _bstr_t::operator unsigned short const *((_bstr_t *)&sName);
      v55 = _wtoi(v54);
      v56 = ZArray<int>::operator[](&v4->m_aAdultChannel, v55);
      LOBYTE(v80) = 29;
      *v56 = v53 != 0;
      v57 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
      if ( v57 < 0 )
        _com_issue_error(v57);
      if ( sName )
        v58 = *(const wchar_t **)sName;
      else
        v58 = 0;
      if ( (*v44)[_wtoi(v58)] )
        ++v4->m_nAdultChannelNo;
      LOBYTE(v80) = 28;
      if ( sName )
      {
        _bstr_t::Data_t::Release((_bstr_t::Data_t *)sName);
        sName = 0;
      }
    }
    LOBYTE(v80) = 25;
    if ( nIndex )
    {
      v59 = *(_DWORD *)nIndex;
      v66 = (int *)nIndex;
      (*(void (__stdcall **)(int))(v59 + 8))(nIndex);
    }
    v46 = v78.m_pInterface;
  }
  LOBYTE(v80) = 21;
  if ( v46 )
  {
    v60.vfptr = v46->vfptr;
    v66 = (int *)v46;
    v60.vfptr->Release((IUnknown *)v46);
  }
  LOBYTE(v80) = 10;
  v61 = ZComAPI::ZComVariantClear(&pvarg);
  if ( v61 < 0 )
    _com_issue_error(v61);
  if ( v76.m_Data )
  {
    _bstr_t::Data_t::Release(v76.m_Data);
    v76.m_Data = 0;
  }
  if ( v77.m_Data )
  {
    _bstr_t::Data_t::Release(v77.m_Data);
    v77.m_Data = 0;
  }
  v80 = -1;
  if ( pEntry.m_pInterface )
  {
    v62 = pEntry.m_pInterface->vfptr;
    v66 = (int *)pEntry.m_pInterface;
    v62->Release((IUnknown *)pEntry.m_pInterface);
  }
  return 1;
}
// 4A477C: using guessed type int (__stdcall *dword_4A477C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00409187) --------------------------------------------------------
void __thiscall CCenter::SendPacket(CCenter *this, COutPacket *oPacket)
{
  CCenter *v2; // esi@1
  CCenterSocket *v3; // ecx@1

  v2 = this;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v3 = v2->m_pSocket;
  if ( v3 )
    CCenterSocket::SendPacket(v3, oPacket);
  LeaveCriticalSection((LPCRITICAL_SECTION)&v2->m_lock.DebugInfo);
}

//----- (004091C8) --------------------------------------------------------
void __thiscall CCenter::OnPacket(CCenter *this, CInPacket *iPacket)
{
  CCenter *v2; // esi@1
  int v3; // eax@1
  int v4; // eax@4
  int v5; // eax@5
  int v6; // eax@6
  int v7; // eax@7
  int v8; // eax@8
  int v9; // eax@18
  int v10; // eax@19
  int v11; // eax@20
  int v12; // eax@21
  int v13; // eax@22

  v2 = this;
  v3 = CInPacket::Decode2(iPacket);
  if ( (signed int)(unsigned __int16)v3 > 16 )
  {
    v9 = v3 - 18;
    if ( v9 )
    {
      v10 = v9 - 1;
      if ( v10 )
      {
        v11 = v10 - 1;
        if ( v11 )
        {
          v12 = v11 - 12;
          if ( v12 )
          {
            v13 = v12 - 17;
            if ( v13 )
            {
              if ( v13 == 6 )
                CCenter::OnSetWorldInfo(v2, iPacket);
            }
            else
            {
              CCenter::OnWorldSpecificBonusRateSet(v2, iPacket);
            }
          }
          else
          {
            CCenter::OnAdminResult(v2, iPacket);
          }
        }
        else
        {
          CCenter::OnAliveReq(v2, iPacket);
        }
      }
      else
      {
        CCenter::SendLoopbackMessage(15, iPacket);
      }
    }
    else
    {
      CCenter::SendLoopbackMessage(16, iPacket);
    }
  }
  else if ( (unsigned __int16)v3 == 16 )
  {
    CCenter::SendLoopbackMessage(9, iPacket);
  }
  else if ( v3 )
  {
    v4 = v3 - 1;
    if ( v4 )
    {
      v5 = v4 - 3;
      if ( v5 )
      {
        v6 = v5 - 6;
        if ( v6 )
        {
          v7 = v6 - 1;
          if ( v7 )
          {
            v8 = v7 - 1;
            if ( v8 )
            {
              if ( v8 == 3 )
                CCenter::OnServerStatusChanged(v2, iPacket);
            }
            else
            {
              CCenter::OnUserNoResult(v2, iPacket);
            }
          }
          else
          {
            CCenter::SendLoopbackMessage(8, iPacket);
          }
        }
        else
        {
          CCenter::SendLoopbackMessage(7, iPacket);
        }
      }
      else
      {
        CCenter::SendLoopbackMessage(3, iPacket);
      }
    }
    else
    {
      CCenter::SendLoopbackMessage(2, iPacket);
    }
  }
  else
  {
    CCenter::SendLoopbackMessage(1, iPacket);
  }
}

//----- (0040928A) --------------------------------------------------------
unsigned __int16 __thiscall CInPacket::Decode2(CInPacket *this)
{
  unsigned int v1; // edx@1
  unsigned __int16 result; // ax@3
  int v3; // [sp+4h] [bp-4h]@2

  v1 = this->m_uOffset;
  if ( this->m_uLength - v1 < 2 )
  {
    v3 = 38;
    _CxxThrowException(&v3, &_TI1_AVZException__);
  }
  result = *(_WORD *)&this->m_aRecvBuff.a[v1];
  this->m_uOffset = v1 + 2;
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (004092C3) --------------------------------------------------------
void __thiscall CCenter::TryConnect(CCenter *this)
{
  CCenter *v1; // edi@1
  CCenterSocket *v2; // ecx@2
  CCenterSocket *v3; // eax@3
  CCenterSocket *v4; // esi@3

  v1 = this;
  if ( !this->m_pSocket )
  {
    v2 = (CCenterSocket *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x9Cu);
    if ( v2 )
    {
      CCenterSocket::CCenterSocket(v2, v1);
      v4 = v3;
    }
    else
    {
      v4 = 0;
    }
    if ( CCenterSocket::Connect(v4) )
    {
      v1->m_pSocket = v4;
    }
    else if ( v4 )
    {
      ((void (__thiscall *)(CCenterSocket *, signed int))v4->vfptr[1].OnSocketAccept)(v4, 1);
    }
  }
}

//----- (0040932F) --------------------------------------------------------
void __thiscall CCenter::Disconnect(CCenter *this)
{
  CCenter *v1; // esi@1
  CCenterSocket *v2; // ecx@1

  v1 = this;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v2 = v1->m_pSocket;
  if ( v2 )
  {
    ((void (__stdcall *)(signed int))v2->vfptr[1].OnSocketAccept)(1);
    v1->m_pSocket = 0;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
}

//----- (00409371) --------------------------------------------------------
void __thiscall CCenter::OnUserNoResult(CCenter *this, CInPacket *iPacket)
{
  CCenter *v2; // ebp@1
  int v3; // ebx@1
  int i; // esi@1
  int *v5; // edi@2

  v2 = this;
  v3 = (unsigned __int8)CInPacket::Decode1(iPacket);
  for ( i = 0; i < v3; *v5 = CInPacket::Decode4(iPacket) )
    v5 = &v2->m_aUserNo.a[i++];
}

//----- (004093A7) --------------------------------------------------------
void __stdcall CCenter::SendLoopbackMessage(int nMsg, CInPacket *iPacket)
{
  unsigned int v3; // eax@1
  COutPacket oPacket; // [sp+4h] [bp-24h]@2
  ZRef<CClientSocket> result; // [sp+14h] [bp-14h]@1
  int v6; // [sp+24h] [bp-4h]@1

  v3 = CInPacket::Decode4(iPacket);
  CLoginAcceptor::GetSocket(TSingleton<CLoginAcceptor>::ms_pInstance, &result, v3);
  v6 = 0;
  if ( result.p )
  {
    COutPacket::COutPacket(&oPacket, nMsg, 1);
    LOBYTE(v6) = 1;
    CInPacket::CopyTo(iPacket, &oPacket);
    CClientSocket::SendPacket(result.p, &oPacket, 0);
    LOBYTE(v6) = 0;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
  }
  v6 = -1;
  if ( result.p )
    ZRef<CClientSocket>::_ReleaseRaw(&result, 0);
}

//----- (0040942D) --------------------------------------------------------
void __thiscall CInPacket::CopyTo(CInPacket *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, &this->m_aRecvBuff.a[this->m_uOffset], this->m_uLength - this->m_uOffset);
}

//----- (00409449) --------------------------------------------------------
void __thiscall COutPacket::EncodeBuffer(COutPacket *this, const void *p, unsigned int uSize)
{
  COutPacket *v3; // esi@1

  v3 = this;
  COutPacket::EnlargeBuffer(this, uSize);
  memcpy(&v3->m_aSendBuff.a[v3->m_uOffset], p, uSize);
  v3->m_uOffset += uSize;
}

//----- (00409473) --------------------------------------------------------
void __thiscall CCenter::OnAliveReq(CCenter *this, CInPacket *iPacket)
{
  CCenter *v2; // esi@1
  unsigned int v3; // edi@1
  COutPacket oPacket; // [sp+8h] [bp-1Ch]@1
  int v5; // [sp+20h] [bp-4h]@1

  v2 = this;
  v3 = CInPacket::Decode4(iPacket);
  COutPacket::COutPacket(&oPacket, 18, 0);
  v5 = 0;
  COutPacket::Encode4(&oPacket, v3);
  CCenter::SendPacket(v2, &oPacket);
  v5 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (004094D1) --------------------------------------------------------
void __thiscall CCenter::OnSetWorldInfo(CCenter *this, CInPacket *iPacket)
{
  CCenter *v2; // esi@1
  char v3; // al@1
  CInPacket *v4; // ecx@1
  ZXString<char> *v5; // eax@1

  v2 = this;
  v3 = CInPacket::Decode1(iPacket);
  v4 = iPacket;
  v2->m_nWorldState = (unsigned __int8)v3;
  v5 = CInPacket::DecodeStr(v4, (ZXString<char> *)&iPacket);
  ZXString<char>::operator=(&v2->m_sWorldEventDesc, v5);
  ZXString<char>::~ZXString<char>((ZXString<char> *)&iPacket);
}

//----- (00409520) --------------------------------------------------------
ZXString<char> *__thiscall CInPacket::DecodeStr(CInPacket *this, ZXString<char> *result)
{
  unsigned int v2; // eax@1
  unsigned int v3; // ST08_4@1
  const char *v4; // ST04_4@1
  ZXString<char> s; // [sp+Ch] [bp-10h]@1
  int v7; // [sp+18h] [bp-4h]@1

  s._m_pStr = 0;
  v2 = this->m_uOffset;
  v3 = this->m_uLength - v2;
  v4 = &this->m_aRecvBuff.a[v2];
  v7 = 1;
  this->m_uOffset += CIOBufferManipulator::DecodeStr(&s, v4, v3);
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, &s);
  LOBYTE(v7) = 0;
  ZXString<char>::~ZXString<char>(&s);
  return result;
}

//----- (0040958F) --------------------------------------------------------
unsigned int __cdecl CIOBufferManipulator::DecodeStr(ZXString<char> *s, const char *pSrc, unsigned int uRemain)
{
  unsigned int v3; // esi@3

  if ( uRemain < 2 )
  {
    uRemain = 38;
    _CxxThrowException(&uRemain, &_TI1_AVZException__);
  }
  v3 = *(_WORD *)pSrc + 2;
  if ( uRemain < v3 )
  {
    uRemain = 38;
    _CxxThrowException(&uRemain, &_TI1_AVZException__);
  }
  ZXString<char>::Assign(s, pSrc + 2, *(_WORD *)pSrc);
  return v3;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (004095E3) --------------------------------------------------------
void __thiscall CCenter::OnServerStatusChanged(CCenter *this, CInPacket *iPacket)
{
  CCenter *v2; // esi@1
  int nIdx; // [sp+4h] [bp-8h]@1
  int bConnected; // [sp+8h] [bp-4h]@1

  v2 = this;
  nIdx = CInPacket::Decode1(iPacket);
  bConnected = CInPacket::Decode1(iPacket) != 0;
  ZMap<long,int,long>::Insert(&v2->m_mServerStatus, &nIdx, &bConnected);
}

//----- (0040961F) --------------------------------------------------------
void __thiscall CCenter::OnWorldSpecificBonusRateSet(CCenter *this, CInPacket *iPacket)
{
  CCenter *v2; // esi@1
  unsigned __int16 v3; // ax@1

  v2 = this;
  this->m_nEventEXP_WSE = CInPacket::Decode2(iPacket);
  v3 = CInPacket::Decode2(iPacket);
  v2->m_nEventDrop_WSE = v3;
  v2->m_nWorldState_WSE = v3 != 100 || v2->m_nEventEXP_WSE != 100;
}

//----- (0040965B) --------------------------------------------------------
int __thiscall CCenter::IsServerConnected(CCenter *this, int nIdx)
{
  int result; // eax@2
  int bConnect; // [sp+0h] [bp-4h]@1

  bConnect = (int)this;
  if ( ZMap<long,int,long>::GetAt(&this->m_mServerStatus, &nIdx, &bConnect) )
    result = bConnect;
  else
    result = 1;
  return result;
}

//----- (0040967F) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>(_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *this)
{
  if ( this->m_pInterface )
    this->m_pInterface->vfptr->Release(this->m_pInterface);
}

//----- (0040968C) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this)
{
  if ( this->m_pInterface )
    this->m_pInterface->vfptr->Release((IUnknown *)this->m_pInterface);
}

//----- (00409699) --------------------------------------------------------
IWzProperty *__thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this)
{
  if ( !this->m_pInterface )
    _com_issue_error(-2147467261);
  return this->m_pInterface;
}

//----- (004096B9) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *this)
{
  if ( this->m_pInterface )
    this->m_pInterface->vfptr->Release((IUnknown *)this->m_pInterface);
}

//----- (004096C6) --------------------------------------------------------
ZMap<long,int,long> *__thiscall ZMap<long,int,long>::`vector deleting destructor'(ZMap<long,int,long> *this, unsigned int __flags)
{
  ZMap<long,int,long> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZMap<long,int,long>Vtbl *)&ZMap<long,int,long>::`vftable';
  ZMap<long,int,long>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 4434B4: using guessed type int (__thiscall *ZMap<long,int,long>::`vftable')(void *p, unsigned int __flags);

//----- (004096EC) --------------------------------------------------------
void __thiscall ZArray<long>::RemoveAll(ZArray<long> *this)
{
  ZArray<long> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this->a - 1);
    v1->a = 0;
  }
}

//----- (0040970E) --------------------------------------------------------
int *__thiscall ZArray<long>::_Alloc(ZArray<long> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<long> *v3; // esi@1
  int *result; // eax@2
  int v5; // eax@3

  v3 = this;
  ZArray<long>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 4 * u + 4) + 4;
    v3->a = (int *)v5;
    *(_DWORD *)(v5 - 4) = u;
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0040974A) --------------------------------------------------------
void __thiscall ZArray<int>::RemoveAll(ZArray<int> *this)
{
  ZArray<int> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this->a - 1);
    v1->a = 0;
  }
}

//----- (0040976C) --------------------------------------------------------
int *__thiscall ZArray<int>::_Alloc(ZArray<int> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<int> *v3; // esi@1
  int *result; // eax@2
  int v5; // eax@3

  v3 = this;
  ZArray<int>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 4 * u + 4) + 4;
    v3->a = (int *)v5;
    *(_DWORD *)(v5 - 4) = u;
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (004097A8) --------------------------------------------------------
int *__thiscall ZMap<long,int,long>::GetAt(ZMap<long,int,long> *this, const int *key, int *value)
{
  ZMap<long,int,long>::_PAIR *v3; // edx@2
  int *result; // eax@5

  if ( this->_m_apTable && (v3 = this->_m_apTable[_lrotr(*key, 5) % this->_m_uTableSize]) != 0 )
  {
    while ( v3->key != *key )
    {
      v3 = v3->pNext;
      if ( !v3 )
        goto LABEL_5;
    }
    if ( value )
      *value = v3->value;
    result = &v3->value;
  }
  else
  {
LABEL_5:
    result = 0;
  }
  return result;
}

//----- (004097F8) --------------------------------------------------------
__POSITION *__thiscall ZMap<long,int,long>::Insert(ZMap<long,int,long> *this, const int *key, const int *value)
{
  ZMap<long,int,long> *v3; // esi@1
  unsigned int v4; // eax@2
  __POSITION **v5; // edi@7
  __POSITION *result; // eax@7
  __POSITION *v7; // ecx@11

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<long,int,long>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = (__POSITION **)&v3->_m_apTable[_lrotr(*key, 5) % v3->_m_uTableSize];
  result = *v5;
  if ( *v5 )
  {
    while ( *(_DWORD *)&result[8] != *key )
    {
      result = *(__POSITION **)&result[4];
      if ( !result )
        goto LABEL_10;
    }
    if ( value )
      *(_DWORD *)&result[12] = *value;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    result = (__POSITION *)ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance);
    if ( result )
    {
      v7 = *v5;
      *(_DWORD *)result = &ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable';
      *(_DWORD *)&result[4] = v7;
      *(_DWORD *)&result[8] = *key;
      *(_DWORD *)result = &ZMap<long,int,long>::_PAIR::`vftable';
    }
    else
    {
      result = 0;
    }
    if ( value )
      *(_DWORD *)&result[12] = *value;
    *v5 = result;
  }
  return result;
}
// 4434BC: using guessed type int (__thiscall *ZMap<long,int,long>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 4434C4: using guessed type int (__thiscall *ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004098A4) --------------------------------------------------------
ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *__thiscall ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`scalar deleting destructor'(ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 4434C4: using guessed type int (__thiscall *ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004098C6) --------------------------------------------------------
void __thiscall ZMap<long,int,long>::RemoveAll(ZMap<long,int,long> *this)
{
  ZMap<long,int,long> *v1; // edi@1
  ZMap<long,int,long>::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<long,int,long>::_PAIR *v4; // ecx@3
  ZMap<long,int,long>::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (00409917) --------------------------------------------------------
int *__thiscall ZArray<int>::operator[](ZArray<int> *this, int i)
{
  return &this->a[i];
}

//----- (00409923) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *this, _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *p)
{
  int v2; // eax@2

  this->m_pInterface = 0;
  if ( p->m_pInterface )
  {
    v2 = _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_QueryInterface(
           this,
           (int)p);
    if ( v2 < 0 && v2 != -2147467262 )
      _com_issue_error(v2);
  }
}

//----- (0040994F) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (00409975) --------------------------------------------------------
void _E37_1()
{
  _E29_1();
  _E30_2();
  _E31_2();
  _E32_2();
  _E33_2();
  _E34_2();
  _E35_2();
  _E36_2();
}

//----- (0040999D) --------------------------------------------------------
void _E29_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (004099D8) --------------------------------------------------------
void _E30_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00409A13) --------------------------------------------------------
void _E31_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance = v3;
}

//----- (00409A4E) --------------------------------------------------------
void _E32_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00409A89) --------------------------------------------------------
void _E33_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (00409AC4) --------------------------------------------------------
void _E34_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00409AFF) --------------------------------------------------------
void _E35_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (00409B3A) --------------------------------------------------------
void _E36_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00409B75) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 4434CC: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00409BA8) --------------------------------------------------------
ZMap<long,int,long>::_PAIR *__thiscall ZMap<long,int,long>::_PAIR::`scalar deleting destructor'(ZMap<long,int,long>::_PAIR *this, unsigned int __flags)
{
  ZMap<long,int,long>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<long,int,long>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (00409BC9) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00409BE9) --------------------------------------------------------
void __thiscall ZMap<long,int,long>::_PAIR::~_PAIR(ZMap<long,int,long>::_PAIR *this)
{
  this->vfptr = (ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable';
}
// 4434C4: using guessed type int (__thiscall *ZRecyclable<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00409BF0) --------------------------------------------------------
int __cdecl ZComAPI::ZComVariantClear(tagVARIANT *pvarg)
{
  unsigned int v1; // eax@2
  int result; // eax@4

  if ( pvarg->vt == 8 )
  {
    pvarg->vt = 0;
    v1 = pvarg->decVal.Lo32;
    if ( v1 )
      dword_4A4900(v1 - 4);
    result = 0;
  }
  else
  {
    result = VariantClear(pvarg);
  }
  return result;
}
// 4A4900: using guessed type int (__stdcall *dword_4A4900)(_DWORD);

//----- (00409C1A) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00409C2F) --------------------------------------------------------
void __thiscall _bstr_t::_bstr_t(_bstr_t *this, const unsigned __int16 *s)
{
  _bstr_t *v2; // esi@1
  _bstr_t::Data_t *v3; // ecx@1
  _bstr_t::Data_t *v4; // eax@2

  v2 = this;
  v3 = (_bstr_t::Data_t *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0xCu);
  if ( v3 )
    _bstr_t::Data_t::Data_t(v3, s);
  else
    v4 = 0;
  v2->m_Data = v4;
  if ( !v4 )
    _com_issue_error(-2147024882);
}

//----- (00409C87) --------------------------------------------------------
unsigned __int16 *__thiscall _bstr_t::operator unsigned short const *(_bstr_t *this)
{
  unsigned __int16 *result; // eax@2

  if ( this->m_Data )
    result = this->m_Data->m_wstr;
  else
    result = 0;
  return result;
}

//----- (00409C93) --------------------------------------------------------
void __thiscall _bstr_t::Data_t::Data_t(_bstr_t::Data_t *this, const unsigned __int16 *s)
{
  _bstr_t::Data_t *v2; // esi@1
  unsigned __int16 *v3; // eax@1

  v2 = this;
  this->m_str = 0;
  this->m_RefCount = 1;
  v3 = ZComAPI::ZComSysAllocString(s);
  v2->m_wstr = v3;
  if ( !v3 )
  {
    if ( s )
      _com_issue_error(-2147024882);
  }
}

//----- (00409CC7) --------------------------------------------------------
unsigned __int16 *__cdecl ZComAPI::ZComSysAllocString(const unsigned __int16 *s)
{
  size_t v1; // eax@2
  size_t v2; // esi@2
  int v3; // ST08_4@2
  int v4; // eax@2
  unsigned __int16 *result; // eax@3
  unsigned __int16 *v6; // edi@4

  if ( s && (v1 = wcslen(s), v2 = v1, (v4 = dword_4A48F8(v3, 2 * v1 + 6)) != 0) )
  {
    *(_DWORD *)v4 = 2 * v2;
    v6 = (unsigned __int16 *)(v4 + 4);
    memcpy((void *)(v4 + 4), s, 2 * v2 + 2);
    result = v6;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 4A48F8: using guessed type int (__thiscall *dword_4A48F8)(_DWORD, _DWORD);

//----- (00409D0D) --------------------------------------------------------
unsigned int __thiscall _bstr_t::Data_t::Release(_bstr_t::Data_t *this)
{
  _bstr_t::Data_t *v1; // esi@1
  unsigned int *v2; // edi@1
  unsigned int result; // eax@4

  v1 = this;
  v2 = &this->m_RefCount;
  if ( InterlockedDecrement((volatile LONG *)&this->m_RefCount) )
  {
    result = *v2;
  }
  else
  {
    if ( v1 )
    {
      _bstr_t::Data_t::_Free(v1);
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1);
    }
    result = 0;
  }
  return result;
}

//----- (00409D3E) --------------------------------------------------------
void __thiscall ZMap<long,int,long>::ResizeHashTable(ZMap<long,int,long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<long,int,long> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<long,int,long>::_PAIR **v5; // edi@3
  ZMap<long,int,long>::_PAIR **v6; // ebx@3
  ZMap<long,int,long>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<long,int,long>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<long,int,long>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<long,int,long>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<long,int,long>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<long,int,long>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                          &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                          4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<long,int,long>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (00409DE9) --------------------------------------------------------
void __thiscall ZMap<long,int,long>::_CalcAutoGrow(ZMap<long,int,long> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (00409E0D) --------------------------------------------------------
void __thiscall ZXString<char>::Assign(ZXString<char> *this, int a2, int a3)
{
  ZXString<char> *v3; // ebx@1
  int v4; // eax@3
  int v5; // edi@3
  char *v6; // eax@3

  v3 = this;
  if ( a2 )
  {
    v4 = dword_4A477C(0, 0, a2, a3, 0, 0, 0, 0);
    v5 = v4 - 1;
    v6 = ZXString<char>::GetBuffer(v3, v4 - 1, 0);
    dword_4A477C(0, 0, a2, -1, v6, 0x3FFFFFFF, 0, 0);
    ZXString<char>::ReleaseBuffer(v3, v5);
  }
  else
  {
    ZXString<char>::Empty(this);
  }
}
// 4A477C: using guessed type int (__stdcall *dword_4A477C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00409E65) --------------------------------------------------------
int __thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this, int a2)
{
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *v2; // esi@1
  int v3; // ebx@2
  int v4; // edi@6

  v2 = this;
  if ( *(_DWORD *)a2 )
  {
    v3 = (***(int (__stdcall ****)(_DWORD, GUID *, int *))a2)(
           *(_DWORD *)a2,
           &_GUID_986515d9_0a0b_4929_8b4f_718682177b92,
           &a2);
    if ( v3 >= 0 )
    {
      v4 = a2;
      if ( v2->m_pInterface )
        v2->m_pInterface->vfptr->Release((IUnknown *)v2->m_pInterface);
      v2->m_pInterface = (IWzProperty *)v4;
    }
    else
    {
      if ( v2->m_pInterface )
        v2->m_pInterface->vfptr->Release((IUnknown *)v2->m_pInterface);
      v2->m_pInterface = 0;
    }
  }
  else
  {
    _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator=(this, 0);
    v3 = -2147467262;
  }
  return v3;
}

//----- (00409EC5) --------------------------------------------------------
void __thiscall _bstr_t::Data_t::_Free(_bstr_t::Data_t *this)
{
  _bstr_t::Data_t *v1; // esi@1
  char *v2; // esi@3

  v1 = this;
  if ( this->m_wstr )
    dword_4A4900(this->m_wstr - 2);
  v2 = v1->m_str;
  if ( v2 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
}
// 4A4900: using guessed type int (__stdcall *dword_4A4900)(_DWORD);

//----- (00409EEC) --------------------------------------------------------
int __thiscall _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_QueryInterface(_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *this, int a2)
{
  _com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *v2; // esi@1
  int v3; // ebx@2
  int v4; // edi@6

  v2 = this;
  if ( *(_DWORD *)a2 )
  {
    v3 = (***(int (__stdcall ****)(_DWORD, GUID *, int *))a2)(
           *(_DWORD *)a2,
           &_GUID_00020404_0000_0000_c000_000000000046,
           &a2);
    if ( v3 >= 0 )
    {
      v4 = a2;
      if ( v2->m_pInterface )
        v2->m_pInterface->vfptr->Release((IUnknown *)v2->m_pInterface);
      v2->m_pInterface = (IEnumVARIANT *)v4;
    }
    else
    {
      if ( v2->m_pInterface )
        v2->m_pInterface->vfptr->Release((IUnknown *)v2->m_pInterface);
      v2->m_pInterface = 0;
    }
  }
  else
  {
    _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::operator=(this, 0);
    v3 = -2147467262;
  }
  return v3;
}

//----- (00409F4C) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (00409FA1) --------------------------------------------------------
void _E56_0()
{
  _E48();
  _E49_0();
  _E50_0();
  _E51_0();
  _E52_0();
  _E53_0();
  _E54_0();
  _E55_0();
}

//----- (00409FC9) --------------------------------------------------------
void _E48()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0040A004) --------------------------------------------------------
void _E49_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0040A03F) --------------------------------------------------------
void _E50_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0040A07A) --------------------------------------------------------
void _E51_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0040A0B5) --------------------------------------------------------
void _E52_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0040A0F0) --------------------------------------------------------
void _E53_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0040A12B) --------------------------------------------------------
void _E54_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (0040A166) --------------------------------------------------------
void _E55_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0040A1F7) --------------------------------------------------------
IUnknown *__thiscall Ztl_variant_t::GetUnknown(Ztl_variant_t *this, char fAddRef, char fTryChangeType)
{
  Ztl_variant_t *v3; // esi@1
  unsigned __int16 v4; // ax@1
  IUnknown *result; // eax@6
  IUnknown *v6; // esi@9
  int v7; // eax@9
  int *v8; // eax@13
  int v9; // eax@14
  IUnknown **v10; // esi@16
  unsigned int v11; // eax@19
  VARIANTARG pvarg; // [sp+4h] [bp-1Ch]@7
  int v13; // [sp+1Ch] [bp-4h]@7

  v3 = this;
  v4 = this->vt;
  if ( this->vt == 9 || v4 == 13 )
  {
    if ( fAddRef )
    {
      v11 = this->decVal.Lo32;
      if ( v11 )
        (*(void (__stdcall **)(unsigned int))(*(_DWORD *)v11 + 4))(this->decVal.Lo32);
    }
    result = v3->punkVal;
  }
  else if ( v4 == 16393 || v4 == 16397 )
  {
    if ( fAddRef )
    {
      v8 = this->plVal;
      if ( v8 )
      {
        v9 = *v8;
        if ( v9 )
          (*(void (__stdcall **)(int))(*(_DWORD *)v9 + 4))(v9);
      }
    }
    v10 = v3->ppunkVal;
    if ( !v10 )
      return 0;
    result = *v10;
  }
  else
  {
    if ( !fTryChangeType )
      return 0;
    VariantInit(&pvarg);
    v13 = 0;
    _variant_t::ChangeType((_variant_t *)&pvarg, 0xDu, (_variant_t *)&v3->0);
    if ( fAddRef )
      (*(void (__stdcall **)(unsigned int))(*pvarg.plVal + 4))(pvarg.decVal.Lo32);
    v6 = pvarg.punkVal;
    v13 = -1;
    v7 = ZComAPI::ZComVariantClear(&pvarg);
    if ( v7 < 0 )
      _com_issue_error(v7);
    result = v6;
  }
  return result;
}

//----- (0040A2C7) --------------------------------------------------------
void __thiscall _variant_t::ChangeType(_variant_t *this, unsigned __int16 vartype, _variant_t *pSrc)
{
  _variant_t *v3; // edx@1
  int v4; // eax@5

  v3 = pSrc;
  if ( !pSrc )
    v3 = this;
  if ( this != v3 || vartype != this->vt )
  {
    v4 = ZComAPI::ZComVariantChangeType((tagVARIANT *)&this->0, (tagVARIANT *)&v3->0, 0, vartype);
    if ( v4 < 0 )
      _com_issue_error(v4);
  }
}

//----- (0040A2F8) --------------------------------------------------------
int __cdecl ZComAPI::ZComVariantChangeType(tagVARIANT *pvargDest, tagVARIANT *pvarSrc, unsigned __int16 wFlags, unsigned __int16 vt)
{
  int result; // eax@2
  HRESULT v5; // esi@5
  tagVARIANT vTemp; // [sp+8h] [bp-10h]@5

  if ( vt == 8 )
  {
    result = ZComAPI::ZComVarBstrFromVariant(pvargDest, pvarSrc);
  }
  else if ( pvargDest != pvarSrc || pvarSrc->vt != 8 )
  {
    if ( pvargDest->vt == 8 )
      ZComAPI::ZComVariantClear(pvargDest);
    result = VariantChangeType(pvargDest, pvarSrc, wFlags, vt);
  }
  else
  {
    vTemp.vt = 0;
    v5 = VariantChangeType(&vTemp, pvarSrc, wFlags, vt);
    if ( v5 >= 0 )
    {
      ZComAPI::ZComVariantClear(pvargDest);
      memcpy(pvargDest, &vTemp, 0x10u);
    }
    result = v5;
  }
  return result;
}

//----- (0040A37A) --------------------------------------------------------
int __cdecl ZComAPI::ZComVarBstrFromVariant(tagVARIANT *pvargDest, tagVARIANT *pvarSrc)
{
  unsigned __int16 v2; // dx@1
  int result; // eax@3
  unsigned int v4; // ebx@3
  const unsigned __int16 *v5; // esi@4
  int v6; // eax@20
  int v7; // eax@29
  int v8; // eax@34
  unsigned __int16 *v9; // edi@34
  unsigned int v10; // [sp+4h] [bp-110h]@19
  unsigned int v11; // [sp+4h] [bp-110h]@28
  char buf[256]; // [sp+14h] [bp-100h]@10

  v2 = pvarSrc->vt;
  if ( pvarSrc->vt == 8 )
  {
    if ( pvargDest != pvarSrc )
    {
      result = ZComAPI::ZComVariantClear(pvargDest);
      v4 = 0;
      if ( result < 0 )
        return result;
      pvargDest->vt = 8;
      v5 = pvarSrc->bstrVal;
      if ( v5 )
        v4 = *((_DWORD *)v5 - 1) >> 1;
      pvargDest->decVal.Lo32 = (unsigned int)ZComAPI::ZComSysAllocStringLen(v5, v4);
    }
    return 0;
  }
  if ( !v2 )
  {
    result = ZComAPI::ZComVariantClear(pvargDest);
    if ( result < 0 )
      return result;
    pvargDest->vt = 8;
    pvargDest->decVal.Lo32 = (unsigned int)ZComAPI::ZComSysAllocStringLen(0, 0);
    return 0;
  }
  buf[0] = 0;
  memset(&buf[1], 0, 0xFCu);
  *(_WORD *)&buf[253] = 0;
  buf[255] = 0;
  if ( (signed int)v2 > 16 )
  {
    if ( v2 == 17 )
    {
      v7 = pvarSrc->bVal;
    }
    else
    {
      if ( v2 != 18 )
      {
        if ( v2 != 19 )
          return -2147352571;
        v11 = pvarSrc->decVal.Lo32;
        goto LABEL_32;
      }
      v7 = pvarSrc->iVal;
    }
    v11 = v7;
LABEL_32:
    dword_4A47BC(buf, aLu, v11);
    goto LABEL_33;
  }
  if ( v2 == 16 )
  {
    v6 = pvarSrc->bVal;
  }
  else
  {
    if ( v2 != 2 )
    {
      if ( v2 != 3 )
      {
        if ( v2 == 4 )
        {
          sprintf(buf, asc_4543B8, pvarSrc->fltVal);
          goto LABEL_33;
        }
        if ( v2 == 5 )
        {
          sprintf(buf, Format, pvarSrc->llVal);
          goto LABEL_33;
        }
        return -2147352571;
      }
      v10 = pvarSrc->decVal.Lo32;
      goto LABEL_23;
    }
    v6 = pvarSrc->iVal;
  }
  v10 = v6;
LABEL_23:
  dword_4A47BC(buf, aLi, v10);
LABEL_33:
  result = ZComAPI::ZComVariantClear(pvargDest);
  if ( result < 0 )
    return result;
  pvargDest->vt = 8;
  v8 = dword_4A4778(0, 0, buf, -1, 0, 0);
  v9 = ZComAPI::ZComSysAllocStringLen(0, ((unsigned int)(2 * v8) >> 1) - 1);
  dword_4A4778(0, 0, buf, -1, v9, 0x3FFFFFFF);
  pvargDest->decVal.Lo32 = (unsigned int)v9;
  return 0;
}
// 4A4778: using guessed type int (__stdcall *dword_4A4778)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A47BC: using guessed type int (*dword_4A47BC)(_DWORD, const char *, ...);

//----- (0040A500) --------------------------------------------------------
unsigned __int16 *__cdecl ZComAPI::ZComSysAllocStringLen(const unsigned __int16 *s, unsigned int u)
{
  int v2; // ecx@0
  unsigned __int16 *result; // eax@1
  size_t v4; // esi@2
  unsigned __int16 *v5; // edi@2

  result = (unsigned __int16 *)dword_4A48F8(v2, 2 * u + 6);
  if ( result )
  {
    v4 = u;
    *(_DWORD *)result = 2 * u;
    v5 = result + 2;
    if ( s )
      memcpy(v5, s, v4 * 2);
    v5[v4] = 0;
    result = v5;
  }
  return result;
}
// 4A48F8: using guessed type int (__thiscall *dword_4A48F8)(_DWORD, _DWORD);

//----- (0040A53D) --------------------------------------------------------
void __thiscall _variant_t::~_variant_t(_variant_t *this)
{
  int v1; // eax@1

  v1 = ZComAPI::ZComVariantClear((tagVARIANT *)&this->0);
  if ( v1 < 0 )
    _com_issue_error(v1);
}

//----- (0040A54F) --------------------------------------------------------
void __thiscall Ztl_bstr_t::Ztl_bstr_t(Ztl_bstr_t *this, const unsigned __int16 *s)
{
  _bstr_t::_bstr_t((_bstr_t *)&this->m_Data, s);
}

//----- (0040A561) --------------------------------------------------------
void __thiscall Ztl_bstr_t::~Ztl_bstr_t(Ztl_bstr_t *this)
{
  Ztl_bstr_t *v1; // esi@1
  _bstr_t::Data_t *v2; // ecx@1

  v1 = this;
  v2 = this->m_Data;
  if ( v2 )
  {
    _bstr_t::Data_t::Release(v2);
    v1->m_Data = 0;
  }
}

//----- (0040A575) --------------------------------------------------------
void __thiscall ZInetAddr::ZInetAddr(ZInetAddr *this, const char *sAddr, unsigned int uPort)
{
  ZInetAddr *v3; // esi@1
  unsigned __int32 v4; // eax@3
  struct hostent *v5; // eax@4

  v3 = this;
  ZInetAddr::_Init(this, uPort, 0);
  if ( sAddr )
  {
    if ( *sAddr )
    {
      v4 = inet_addr(sAddr);
      v3->sin_addr.S_un.S_addr = v4;
      if ( v4 == -1 )
      {
        v5 = gethostbyname(sAddr);
        if ( !v5 )
        {
          uPort = WSAGetLastError();
          _CxxThrowException(&uPort, &_TI1_AVZException__);
        }
        v3->sin_addr.S_un.S_addr = **(_DWORD **)v5->h_addr_list;
      }
    }
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040A5D5) --------------------------------------------------------
void __thiscall ZInetAddr::_Init(ZInetAddr *this, unsigned int uPort, unsigned int uAddr)
{
  ZInetAddr *v3; // esi@1
  u_long v4; // edi@1
  u_short v5; // bx@1

  v3 = this;
  v4 = htonl(uAddr);
  v5 = htons(uPort);
  memset(v3, 0, 0x10u);
  v3->sin_addr.S_un.S_addr = v4;
  v3->sin_port = v5;
  v3->sin_family = 2;
}

//----- (0040A611) --------------------------------------------------------
void __thiscall ZInetAddr::_InitN(ZInetAddr *this, unsigned __int16 uPort, unsigned int uAddr)
{
  ZInetAddr *v3; // esi@1

  v3 = this;
  memset(this, 0, 0x10u);
  v3->sin_port = uPort;
  v3->sin_family = 2;
  v3->sin_addr.S_un.S_addr = uAddr;
}

//----- (0040A63A) --------------------------------------------------------
void __thiscall Ztl_variant_t::~Ztl_variant_t(Ztl_variant_t *this)
{
  int v1; // eax@1

  v1 = ZComAPI::ZComVariantClear((tagVARIANT *)&this->0);
  if ( v1 < 0 )
    _com_issue_error(v1);
}

//----- (0040A64C) --------------------------------------------------------
Ztl_variant_t *__thiscall IWzProperty::Getitem(IWzProperty *this, Ztl_variant_t *result, Ztl_bstr_t __$ReturnUdt)
{
  IWzProperty *v3; // esi@1
  unsigned __int16 *v4; // eax@2
  int v5; // eax@4
  VARIANTARG pvarg; // [sp+8h] [bp-20h]@1
  int v8; // [sp+18h] [bp-10h]@1
  int v9; // [sp+24h] [bp-4h]@1

  v8 = 0;
  v3 = this;
  v9 = 0;
  VariantInit(&pvarg);
  if ( __$ReturnUdt.m_Data )
    v4 = __$ReturnUdt.m_Data->m_wstr;
  else
    v4 = 0;
  v5 = ((int (__stdcall *)(IWzProperty *, unsigned __int16 *, VARIANTARG *))v3->vfptr[1].Release)(v3, v4, &pvarg);
  if ( v5 < 0 )
    _com_issue_errorex(v5, (IUnknown *)&v3->vfptr, &_GUID_986515d9_0a0b_4929_8b4f_718682177b92);
  _variant_t::_variant_t((_variant_t *)&result->0, &pvarg, 0);
  if ( __$ReturnUdt.m_Data )
    _bstr_t::Data_t::Release(__$ReturnUdt.m_Data);
  return result;
}

//----- (0040A6C3) --------------------------------------------------------
void __thiscall _variant_t::_variant_t(_variant_t *this, tagVARIANT *varSrc, char fCopy)
{
  _variant_t *v3; // edi@1
  int v4; // eax@2

  v3 = this;
  if ( fCopy )
  {
    VariantInit((VARIANTARG *)&this->0);
    v4 = ZComAPI::ZComVariantCopy((tagVARIANT *)&v3->0, varSrc);
    if ( v4 < 0 )
      _com_issue_error(v4);
  }
  else
  {
    memcpy(this, varSrc, 0x10u);
    varSrc->vt = 0;
  }
}

//----- (0040A708) --------------------------------------------------------
int __cdecl ZComAPI::ZComVariantCopy(tagVARIANT *pvargDest, tagVARIANT *pvargSrc)
{
  int result; // eax@3
  const unsigned __int16 *v3; // eax@4
  unsigned int v4; // ecx@5

  if ( pvargSrc->vt == 8 )
  {
    if ( pvargDest != pvargSrc )
    {
      result = ZComAPI::ZComVariantClear(pvargDest);
      if ( result < 0 )
        return result;
      pvargDest->vt = 8;
      v3 = pvargSrc->bstrVal;
      if ( v3 )
        v4 = *((_DWORD *)v3 - 1) >> 1;
      else
        v4 = 0;
      pvargDest->decVal.Lo32 = (unsigned int)ZComAPI::ZComSysAllocStringLen(v3, v4);
    }
    result = 0;
  }
  else
  {
    if ( pvargDest->vt == 8 )
      ZComAPI::ZComVariantClear(pvargDest);
    result = VariantCopy(pvargDest, pvargSrc);
  }
  return result;
}

//----- (0040A764) --------------------------------------------------------
_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *__thiscall IWzProperty::Get_NewEnum(IWzProperty *this, _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *result)
{
  IWzProperty *v2; // esi@1
  int v3; // eax@1
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *v4; // eax@3
  IUnknown *_result; // [sp+4h] [bp-4h]@1

  _result = 0;
  v2 = this;
  v3 = ((int (__stdcall *)(IWzProperty *, IUnknown **))this->vfptr[2].AddRef)(this, &_result);
  if ( v3 < 0 )
    _com_issue_errorex(v3, (IUnknown *)&v2->vfptr, &_GUID_986515d9_0a0b_4929_8b4f_718682177b92);
  v4 = result;
  result->m_pInterface = _result;
  return v4;
}

//----- (0040A796) --------------------------------------------------------
void __thiscall Ztl_bstr_t::Ztl_bstr_t(Ztl_bstr_t *this, Ztl_bstr_t *__that)
{
  _bstr_t::Data_t *v2; // eax@1
  bool v3; // zf@1

  v2 = __that->m_Data;
  v3 = __that->m_Data == 0;
  this->m_Data = __that->m_Data;
  if ( !v3 )
    InterlockedIncrement((volatile LONG *)&v2->m_RefCount);
}

//----- (0040A7B5) --------------------------------------------------------
unsigned int __cdecl get_int32(Ztl_variant_t *v, int nDefault)
{
  unsigned __int16 v2; // ax@1
  int v3; // eax@3
  unsigned int v4; // esi@3
  int v5; // eax@5
  VARIANTARG pvarg; // [sp+4h] [bp-1Ch]@1
  int v8; // [sp+1Ch] [bp-4h]@1

  VariantInit(&pvarg);
  v2 = v->vt;
  v8 = 0;
  if ( !v2
    || v2 == 10
    || (v3 = ZComAPI::ZComVariantChangeType(&pvarg, (tagVARIANT *)&v->0, 0, 3u), v4 = pvarg.decVal.Lo32, v3 < 0) )
  {
    v4 = nDefault;
  }
  v8 = -1;
  v5 = ZComAPI::ZComVariantClear(&pvarg);
  if ( v5 < 0 )
    _com_issue_error(v5);
  return v4;
}

//----- (0040A824) --------------------------------------------------------
void __thiscall CCenterSocket::CCenterSocket(CCenterSocket *this, CCenter *pCenter)
{
  CCenterSocket *v2; // esi@1
  int v3; // eax@1
  int v4; // ST0C_4@1
  char *v5; // eax@1

  v2 = this;
  this->vfptr = (ZISocketCallBackVtbl *)ZISocketCallBack::`vftable';
  this->vfptr = (CVerboseObjVtbl *)&CVerboseObj::`vftable';
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v2->m_sAddr._m_pStr = 0;
  v2->m_bClosePosted = 0;
  v2->m_pCenter = pCenter;
  v2->m_sock._m_hSocket = -1;
  v2->m_sock._m_pThread.p = 0;
  v2->m_sock._m_pCallBack = 0;
  v2->m_sock.vfptr = (ZIStreamVtbl *)&ZSocket::`vftable';
  InitializeCriticalSection((LPCRITICAL_SECTION)&v2->m_lockSend.DebugInfo);
  v2->m_lSendBuff._m_uCount = 0;
  v2->m_lSendBuff._m_pHead = 0;
  v2->m_lSendBuff._m_pTail = 0;
  v2->m_lSendBuff.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  v2->m_uSent0 = 0;
  v2->m_pRecvBuff.p = 0;
  v2->m_uRecvOffset = 0;
  CInPacket::CInPacket(&v2->m_packetRecv, 0);
  v3 = (int)&v2->m_pCenter->m_addr.sin_family;
  v2->vfptr = (ZISocketCallBackVtbl *)CCenterSocket::`vftable'{for `ZISocketCallBack'};
  v2->vfptr = (CVerboseObjVtbl *)&CCenterSocket::`vftable'{for `CVerboseObj'};
  v4 = ntohs(*(_WORD *)(v3 + 2));
  v5 = ZInetAddr::GetAddr(&v2->m_pCenter->m_addr);
  ZXString<char>::Format(&v2->m_sAddr, sFormat, v5, v4);
}
// 443420: using guessed type const char *(__thiscall *CVerboseObj::`vftable')(CVerboseObj *__hidden this);
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);
// 4434D4: using guessed type const char *(__thiscall *CCenterSocket::`vftable'{for `CVerboseObj'})(CCenterSocket *__hidden this);
// 4434DC: using guessed type void (__thiscall *CCenterSocket::`vftable'{for `ZISocketCallBack'}[6])(CCenterSocket *this, ZSocket *pSocket, int);
// 4434FC: using guessed type int (__thiscall *ZSocket::`vftable')(void *p, unsigned int __flags);
// 443524: using guessed type void (__thiscall *ZISocketCallBack::`vftable'[6])(ZISocketCallBack *this, ZSocket *pSocket, int);

//----- (0040A8F4) --------------------------------------------------------
unsigned int __stdcall ZIStream::ReadFromSpecificPos(unsigned int uPos, char *pData, unsigned int uSize)
{
  return 0;
}

//----- (0040A905) --------------------------------------------------------
const char *__thiscall CCenterSocket::GetLogTail(CCenterSocket *this)
{
  return (const char *)this->m_lock.SpinCount;
}

//----- (0040A909) --------------------------------------------------------
CCenterSocket *__thiscall CCenterSocket::`vector deleting destructor'(CCenterSocket *this, unsigned int __flags)
{
  CCenterSocket *v2; // esi@1

  v2 = this;
  CCenterSocket::~CCenterSocket(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0040A929) --------------------------------------------------------
void __thiscall CCenterSocket::~CCenterSocket(CCenterSocket *this)
{
  CCenterSocket *v1; // esi@1

  v1 = this;
  this->vfptr = (ZISocketCallBackVtbl *)CCenterSocket::`vftable'{for `ZISocketCallBack'};
  this->vfptr = (CVerboseObjVtbl *)&CCenterSocket::`vftable'{for `CVerboseObj'};
  ZArray<unsigned char>::RemoveAll(&this->m_packetRecv.m_aRecvBuff);
  if ( v1->m_pRecvBuff.p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(&v1->m_pRecvBuff, 0);
    v1->m_pRecvBuff.p = 0;
  }
  v1->m_lSendBuff.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  ZList<ZRef<ZSocketBuffer>>::RemoveAll(&v1->m_lSendBuff);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lockSend.DebugInfo);
  ZSocket::~ZSocket(&v1->m_sock);
  ZXString<char>::~ZXString<char>(&v1->m_sAddr);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
}
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);
// 4434D4: using guessed type const char *(__thiscall *CCenterSocket::`vftable'{for `CVerboseObj'})(CCenterSocket *__hidden this);
// 4434DC: using guessed type void (__thiscall *CCenterSocket::`vftable'{for `ZISocketCallBack'}[6])(CCenterSocket *this, ZSocket *pSocket, int);

//----- (0040A9BE) --------------------------------------------------------
void __cdecl CCenterSocket::OnSocketReceive(ZSocket *pSocket, int nErr)
{
  CCenterSocket *this; // ecx@0
  CCenterSocket *v3; // esi@1
  ZSocketBuffer *v4; // eax@3
  ZSocketBuffer *v5; // eax@5
  ZSocketBuffer *v6; // edi@7
  unsigned int v7; // ebx@7
  ZSocketBuffer *v8; // ecx@7
  ZSocketBuffer *v9; // eax@8
  int v10; // eax@14
  int v11; // [sp+0h] [bp-50h]@1
  int *v12; // [sp+Ch] [bp-44h]@14
  int v13; // [sp+10h] [bp-40h]@14
  ZRef<ZSocketBuffer> pBuff; // [sp+14h] [bp-3Ch]@10
  ZSocketBuffer *v15; // [sp+24h] [bp-2Ch]@7
  int v16; // [sp+28h] [bp-28h]@21
  int v17; // [sp+2Ch] [bp-24h]@18
  int pnLastState; // [sp+30h] [bp-20h]@14
  int v19; // [sp+34h] [bp-1Ch]@2
  CCenterSocket *v20; // [sp+38h] [bp-18h]@1
  unsigned int len; // [sp+3Ch] [bp-14h]@6
  int *v22; // [sp+40h] [bp-10h]@1
  int v23; // [sp+4Ch] [bp-4h]@1

  v23 = 0;
  v3 = this;
  v22 = &v11;
  v20 = this;
  if ( nErr )
  {
    v19 = nErr;
    _CxxThrowException(&v19, &_TI1_AVZException__);
  }
  while ( 1 )
  {
    v4 = v3->m_pRecvBuff.p;
    if ( !v4 || v4->len == v3->m_uRecvOffset )
    {
      ZSocketBuffer::Alloc(0x5B4u);
      ZRef<ZSocketBuffer>::operator=(&v3->m_pRecvBuff, v5);
      v3->m_uRecvOffset = 0;
    }
    len = ZSocket::Receive(
            &v3->m_sock,
            &v3->m_pRecvBuff.p->buf[v3->m_uRecvOffset],
            v3->m_pRecvBuff.p->len - v3->m_uRecvOffset,
            0);
    if ( !len )
      break;
    v6 = v3->m_pRecvBuff.p;
    v7 = v3->m_uRecvOffset;
    v8 = (ZSocketBuffer *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x1Cu);
    v15 = v8;
    LOBYTE(v23) = 1;
    if ( v8 )
      ZSocketBuffer::ZSocketBuffer(v8, len, &v6->buf[v7], v6);
    else
      v9 = 0;
    pBuff.p = v9;
    if ( v9 )
      InterlockedIncrement(&v9->_m_nRef);
    v3->m_uRecvOffset += len;
    while ( pBuff.p )
    {
      v12 = &v3->m_packetRecv.m_bLoopback;
      v13 = 1;
      LOBYTE(v23) = 3;
      v10 = CInPacket::AppendBuffer(&v3->m_packetRecv, &pBuff, &pnLastState, 0);
      if ( v10 > 0 && pnLastState <= 0 )
      {
        if ( (v3->m_packetRecv.m_uRawSeq ^ (v3->m_uSeqRcv >> 16)) != -332 )
        {
          CVerboseObj::LogError((CVerboseObj *)&v3->vfptr, aIncorrectPacke);
          v17 = -2147467259;
          _CxxThrowException(&v17, &_TI1_AVZException__);
        }
        if ( (signed int)v3->m_packetRecv.m_uDataLen > 0x10000 )
        {
          CVerboseObj::LogError((CVerboseObj *)&v3->vfptr, aReceivedPacket);
          v16 = -2147467259;
          _CxxThrowException(&v16, &_TI1_AVZException__);
        }
      }
      if ( v10 == 2 )
      {
        v3->m_uSeqRcv = 214013 * v3->m_uSeqRcv + 2531011;
        CCenterSocket::ProcessPacket(v3, &v3->m_packetRecv);
        v3->m_packetRecv.m_nState = 0;
        v3->m_packetRecv.m_uLength = 0;
        v3->m_packetRecv.m_uOffset = 0;
      }
      else
      {
        v13 = 0;
      }
    }
    LOBYTE(v23) = 0;
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040ABC3) --------------------------------------------------------
void __thiscall CCenterSocket::OnSocketSend(CCenterSocket *this, ZSocket *pSocket, int nErr)
{
  int v3; // [sp+0h] [bp-2Ch]@1
  int v4; // [sp+14h] [bp-18h]@2
  CCenterSocket *v5; // [sp+18h] [bp-14h]@1
  int *v6; // [sp+1Ch] [bp-10h]@1
  int v7; // [sp+28h] [bp-4h]@1

  v7 = 0;
  v6 = &v3;
  v5 = this;
  if ( nErr )
  {
    v4 = nErr;
    _CxxThrowException(&v4, &_TI1_AVZException__);
  }
  CCenterSocket::Flush(this);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040AC0B) --------------------------------------------------------
void *__usercall _L116531@<eax>(int a1@<ebp>)
{
  CCenterSocket *v1; // esi@1

  v1 = *(CCenterSocket **)(a1 - 20);
  CVerboseObj::LogException((CVerboseObj *)&v1->vfptr, *(ZException **)(a1 - 28));
  CCenterSocket::PostCloseMessage(v1);
  return &_L109806;
}

//----- (0040AC26) --------------------------------------------------------
void *__usercall _L116532@<eax>(int a1@<ebp>)
{
  CCenterSocket *v1; // esi@1

  v1 = *(CCenterSocket **)(a1 - 20);
  CVerboseObj::LogException((CVerboseObj *)&v1->vfptr, *(_com_error **)(a1 - 32));
  CCenterSocket::PostCloseMessage(v1);
  return &_L109806;
}

//----- (0040AC41) --------------------------------------------------------
void __thiscall CCenterSocket::OnSocketClose(CCenterSocket *this, ZSocket *pSocket, int nErr)
{
  CCenterSocket *v3; // esi@1

  v3 = this;
  CVerboseObj::LogReport((CVerboseObj *)&this->vfptr, aCenterSocketCl);
  CCenterSocket::PostCloseMessage(v3);
}

//----- (0040AC5F) --------------------------------------------------------
int __thiscall CCenterSocket::Connect(CCenterSocket *this)
{
  CCenterSocket *v1; // edi@1
  SOCKET v2; // eax@1
  int v3; // ecx@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *v4; // eax@3
  IWzProperty *v5; // eax@3
  Ztl_variant_t *v6; // eax@3
  const unsigned __int16 *v7; // eax@3
  int v8; // eax@3
  int v9; // eax@6
  SOCKET v10; // eax@9
  ZSocketBuffer *v11; // eax@15
  const unsigned __int16 *v12; // ecx@15
  char *v13; // ebx@17
  int v14; // esi@17
  int v15; // eax@17
  int v16; // eax@12
  int v17; // [sp-8h] [bp-68h]@1
  const unsigned __int16 *v18; // [sp-4h] [bp-64h]@1
  int v19; // [sp+0h] [bp-60h]@1
  Ztl_variant_t result; // [sp+Ch] [bp-54h]@3
  ZRef<ZSocketBuffer> v21; // [sp+1Ch] [bp-44h]@15
  ZInetAddr v22; // [sp+24h] [bp-3Ch]@9
  int *v23; // [sp+34h] [bp-2Ch]@3
  CCenterSocket *v24; // [sp+38h] [bp-28h]@1
  int v25; // [sp+3Ch] [bp-24h]@14
  int v26; // [sp+40h] [bp-20h]@10
  int v27; // [sp+44h] [bp-1Ch]@2
  ZXString<char> v28; // [sp+48h] [bp-18h]@3
  char v29; // [sp+4Eh] [bp-12h]@17
  char v30; // [sp+4Fh] [bp-11h]@15
  int *v31; // [sp+50h] [bp-10h]@1
  int v32; // [sp+5Ch] [bp-4h]@1

  v1 = this;
  v31 = &v19;
  v24 = this;
  v32 = 0;
  this->m_uSeqRcv = CRand32::Random(&g_rand);
  v18 = 0;
  v17 = 1;
  v1->m_uSeqSnd = CRand32::Random(&g_rand);
  v2 = socket(2, v17, (int)v18);
  v1->m_sock._m_hSocket = v2;
  if ( v2 == -1 )
  {
    v27 = WSAGetLastError();
    _CxxThrowException(&v27, &_TI1_AVZException__);
  }
  v18 = &sDefault;
  v17 = v3;
  v23 = &v17;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v17, aPrivateip);
  LOBYTE(v32) = 1;
  v4 = get_conf();
  v5 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(v4);
  LOBYTE(v32) = 0;
  v6 = IWzProperty::Getitem(v5, &result, (Ztl_bstr_t)v17);
  LOBYTE(v32) = 2;
  v7 = get_string(v6, v18);
  v28._m_pStr = 0;
  ZXString<char>::Assign(&v28, (int)v7, -1);
  LOBYTE(v32) = 4;
  v8 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v8 < 0 )
    _com_issue_error(v8);
  if ( v28._m_pStr )
    v9 = *((_DWORD *)v28._m_pStr - 1);
  else
    v9 = 0;
  if ( !v9 )
  {
    CVerboseObj::LogError((CVerboseObj *)&v1->vfptr, aCentersocketip);
    v25 = -2147467259;
    _CxxThrowException(&v25, &_TI1_AVZException__);
  }
  ZInetAddr::ZInetAddr(&v22, v28._m_pStr, 0);
  v10 = v1->m_sock._m_hSocket;
  LOBYTE(v32) = 5;
  if ( bind(v10, (const struct sockaddr *)&v22, 16) == -1 )
  {
    v26 = WSAGetLastError();
    _CxxThrowException(&v26, &_TI1_AVZException__);
  }
  LOBYTE(v32) = 0;
  ZXString<char>::~ZXString<char>(&v28);
  if ( ZSocket::Connect(&v1->m_sock, (sockaddr_in *)&v1->m_pCenter->m_addr.sin_family) )
  {
    ZSocketBase::SetNonBlocking((ZSocketBase *)&v1->m_sock._m_hSocket, 1);
    v18 = 0;
    v17 = 35;
    v1->m_sock._m_pCallBack = (ZISocketCallBack *)v1;
    ZSocket::AttachThread(&v1->m_sock, v17, (ZSocketThread *)v18);
    v18 = (const unsigned __int16 *)&v30;
    ZSocketBuffer::Alloc(0x5B4u);
    v12 = v18;
    v21.p = v11;
    if ( v11 )
    {
      InterlockedIncrement(&v11->_m_nRef);
      v11 = v21.p;
    }
    v13 = v11->buf;
    v18 = (const unsigned __int16 *)(v13 + 2);
    v17 = (int)v12;
    v23 = &v17;
    LOBYTE(v32) = 6;
    get_cmdline_arg((ZXString<char> *)&v17, 1);
    v14 = (int)&v13[CIOBufferManipulator::EncodeStr((ZXString<char>)v17, (char *)v18) + 2];
    *(_DWORD *)v14 = -2;
    *(_DWORD *)(v14 + 4) = v1->m_uSeqRcv;
    v14 += 4;
    *(_DWORD *)(v14 + 4) = v1->m_uSeqSnd;
    v14 += 8;
    *(_WORD *)v13 = v14 - (_WORD)v13 - 2;
    ZSocketBuffer::Sub(v21.p, 0, v14 - (_DWORD)v13, (ZAllocHelper *)&v29);
    *(_DWORD *)&v22.sin_zero[4] = v15;
    if ( v15 )
      InterlockedIncrement((volatile LONG *)(v15 + 4));
    LOBYTE(v32) = 7;
    ZList<ZRef<ZSocketBuffer>>::AddTail(&v1->m_lSendBuff, (ZRef<ZSocketBuffer> *)v22.sin_zero);
    LOBYTE(v32) = 6;
    if ( *(_DWORD *)&v22.sin_zero[4] )
    {
      ZRef<ZSocketBuffer>::_ReleaseRaw((ZRef<ZSocketBuffer> *)v22.sin_zero, 0);
      *(_DWORD *)&v22.sin_zero[4] = 0;
    }
    CCenterSocket::Flush(v1);
    CVerboseObj::LogReport((CVerboseObj *)&v1->vfptr, aCenterSocketCo);
    LOBYTE(v32) = 0;
    if ( v21.p )
      ZRef<ZSocketBuffer>::_ReleaseRaw(&v21, 0);
    v16 = 1;
  }
  else
  {
    v32 = -1;
    CVerboseObj::LogError((CVerboseObj *)&v1->vfptr, aFailedInConn_1);
    v16 = 0;
  }
  return v16;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040AEF4) --------------------------------------------------------
int __cdecl CIOBufferManipulator::EncodeStr(ZXString<char> s, char *pDes)
{
  char *v2; // edx@1
  int v3; // ecx@2
  char *v4; // eax@4
  size_t v5; // ecx@5
  int v6; // esi@8

  v2 = s._m_pStr;
  if ( s._m_pStr )
    v3 = *((_DWORD *)s._m_pStr - 1);
  else
    LOWORD(v3) = 0;
  v4 = pDes;
  *(_WORD *)pDes = v3;
  if ( v2 )
    v5 = *((_DWORD *)v2 - 1);
  else
    v5 = 0;
  memcpy(v4 + 2, v2, v5);
  if ( s._m_pStr )
    v6 = *((_DWORD *)s._m_pStr - 1);
  else
    v6 = 0;
  ZXString<char>::~ZXString<char>(&s);
  return v6 + 2;
}

//----- (0040AF41) --------------------------------------------------------
void __thiscall CCenterSocket::PostCloseMessage(CCenterSocket *this)
{
  CCenterSocket *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  if ( v1->m_bClosePosted )
  {
    LeaveCriticalSection(v2);
  }
  else
  {
    v1->m_bClosePosted = 1;
    LeaveCriticalSection(v2);
    PostMessageA(*(HWND *)(TSingleton<CServerDialog>::ms_pInstance + 4), 0x464u, v1->m_pCenter->m_nIndex, 0);
  }
}
// 4A428C: using guessed type int TSingleton<CServerDialog>::ms_pInstance;

//----- (0040AF8A) --------------------------------------------------------
void __thiscall CCenterSocket::SendPacket(CCenterSocket *this, COutPacket *oPacket)
{
  int v2; // ebp@0
  CCenterSocket *v3; // esi@1
  int v4; // eax@1
  unsigned int v5; // eax@3
  int v6; // [sp+0h] [bp-28h]@1
  ZCriticalSectionEx<4000> *v7; // [sp+10h] [bp-18h]@3
  CCenterSocket *v8; // [sp+14h] [bp-14h]@1
  int *v9; // [sp+18h] [bp-10h]@1
  int v10; // [sp+24h] [bp-4h]@3

  v3 = this;
  v4 = *(_DWORD *)(&this->m_sock != 0 ? (unsigned int)&this->m_sock._m_hSocket : 0);
  v9 = &v6;
  v8 = this;
  if ( v4 )
  {
    if ( v4 != -1 )
    {
      v10 = 0;
      v7 = &this->m_lockSend;
      EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo);
      LOBYTE(v10) = 1;
      COutPacket::MakeBufferList(oPacket, v2, &v3->m_lSendBuff, 0x14Bu, &v3->m_uSeqSnd, 0, 0);
      v5 = v3->m_uSeqSnd;
      LOBYTE(v10) = 0;
      v3->m_uSeqSnd = 214013 * v5 + 2531011;
      LeaveCriticalSection((LPCRITICAL_SECTION)&v3->m_lockSend.DebugInfo);
      CCenterSocket::Flush(v3);
    }
  }
}

//----- (0040B01C) --------------------------------------------------------
void *__usercall _L117224@<eax>(int a1@<ebp>)
{
  CCenterSocket *v1; // esi@1

  v1 = *(CCenterSocket **)(a1 - 20);
  CVerboseObj::LogException((CVerboseObj *)&v1->vfptr, *(ZException **)(a1 - 28));
  CCenterSocket::PostCloseMessage(v1);
  return &_L109881;
}

//----- (0040B037) --------------------------------------------------------
void __thiscall CCenterSocket::Flush(CCenterSocket *this)
{
  CCenterSocket *v1; // esi@1
  int v2; // eax@1
  ZSocketBuffer *v3; // edi@5
  int v4; // eax@5
  int v5; // [sp+0h] [bp-28h]@1
  LPCRITICAL_SECTION lpCriticalSection; // [sp+10h] [bp-18h]@3
  CCenterSocket *v7; // [sp+14h] [bp-14h]@1
  int *v8; // [sp+18h] [bp-10h]@1
  int v9; // [sp+24h] [bp-4h]@3

  v1 = this;
  v2 = *(_DWORD *)(&this->m_sock != 0 ? (unsigned int)&this->m_sock._m_hSocket : 0);
  v8 = &v5;
  v7 = this;
  if ( v2 && v2 != -1 )
  {
    v9 = 0;
    lpCriticalSection = (LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo;
    EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo);
    LOBYTE(v9) = 1;
    while ( v1->m_lSendBuff._m_uCount )
    {
      v3 = v1->m_lSendBuff._m_pHead->p;
      v4 = ZSocket::Send(&v1->m_sock, &v3->buf[v1->m_uSent0], v3->len - v1->m_uSent0, 0);
      if ( !v4 )
        break;
      v1->m_uSent0 += v4;
      if ( v1->m_uSent0 >= v3->len )
      {
        ZList<ZRef<ZSocketBuffer>>::RemoveAt(&v1->m_lSendBuff, (__POSITION *)v1->m_lSendBuff._m_pHead);
        v1->m_uSent0 = 0;
      }
    }
    LeaveCriticalSection(lpCriticalSection);
  }
}

//----- (0040B0F1) --------------------------------------------------------
void __thiscall CCenterSocket::ProcessPacket(CCenterSocket *this, CInPacket *iPacket)
{
  if ( TSingleton<CLoginAcceptor>::ms_pInstance )
    CCenter::OnPacket(this->m_pCenter, iPacket);
}

//----- (0040B109) --------------------------------------------------------
int __thiscall ZIStream::CopyTo(ZIStream *this, ZIStream *pStream, unsigned int uSize)
{
  return pStream->vfptr->CopyFrom(pStream, this, uSize);
}

//----- (0040B11C) --------------------------------------------------------
ZRef<ZSocketBuffer> *__thiscall ZList<ZRef<ZSocketBuffer>>::AddTail(ZList<ZRef<ZSocketBuffer> > *this, ZRef<ZSocketBuffer> *d)
{
  ZRef<ZSocketBuffer> *v2; // esi@1

  v2 = ZList<ZRef<ZSocketBuffer>>::AddTail(this);
  ZRef<ZSocketBuffer>::operator=(v2, d);
  return v2;
}

//----- (0040B135) --------------------------------------------------------
unsigned int __thiscall ZIStream::CopyFrom(ZIStream *this, ZIStream *pStream, unsigned int uSize)
{
  ZIStream *v3; // esi@1
  char *v4; // eax@1
  unsigned int v5; // eax@1
  unsigned int v6; // esi@1
  ZFixedArray<unsigned char,65536,0> v8; // [sp+4h] [bp-10h]@1
  int v9; // [sp+10h] [bp-4h]@1

  v8.p = 0;
  v3 = this;
  v9 = 0;
  v4 = ZFixedArray<unsigned char,65536,0>::_Alloc(&v8);
  v5 = ZIStream::CopyFromHelper(v3, pStream, uSize, v4, 0x10000u);
  v9 = -1;
  v6 = v5;
  ZFixedArray<unsigned char,65536,0>::~ZFixedArray<unsigned char,65536,0>(&v8);
  return v6;
}

//----- (0040B185) --------------------------------------------------------
void __thiscall ZFixedArray<unsigned char,65536,0>::~ZFixedArray<unsigned char,65536,0>(ZFixedArray<unsigned char,65536,0> *this)
{
  ZFixedArray<unsigned char,65536,0>::_ArrayData *v1; // ecx@1

  v1 = this->p;
  if ( v1 )
    ((void (__stdcall *)(_DWORD))v1->vfptr->__vecDelDtor)(1);
}

//----- (0040B192) --------------------------------------------------------
unsigned int __thiscall ZIStream::CopyFromHelper(ZIStream *this, ZIStream *pStream, unsigned int uSize, void *pBuff, unsigned int uBuff)
{
  unsigned int v5; // edi@1
  unsigned int v6; // ebx@5
  unsigned int v7; // esi@7
  ZIStream *v9; // [sp+Ch] [bp-4h]@1
  unsigned int uReadAll; // [sp+1Ch] [bp+Ch]@3

  v5 = uSize;
  v9 = this;
  if ( !uSize )
    v5 = -1;
  uReadAll = 0;
  do
  {
    if ( !v5 )
      break;
    v6 = uBuff;
    if ( uBuff >= v5 )
      v6 = v5;
    v7 = ((int (__stdcall *)(void *, unsigned int))pStream->vfptr->ReadEOF)(pBuff, v6);
    if ( v7 )
    {
      if ( v7 != ((int (__stdcall *)(void *, unsigned int))v9->vfptr->WriteEOF)(pBuff, v7) )
      {
        pBuff = (void *)38;
        _CxxThrowException(&pBuff, &_TI1_AVZException__);
      }
      if ( v5 != -1 )
        v5 -= v7;
      uReadAll += v7;
    }
  }
  while ( v7 >= v6 );
  return uReadAll;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040B208) --------------------------------------------------------
char *__thiscall ZFixedArray<unsigned char,65536,0>::_Alloc(ZFixedArray<unsigned char,65536,0> *this)
{
  ZFixedArray<unsigned char,65536,0> *v1; // esi@1
  ZFixedArray<unsigned char,65536,0>::_ArrayData *v2; // eax@1

  v1 = this;
  v2 = this->p;
  if ( !this->p )
  {
    v2 = (ZFixedArray<unsigned char,65536,0>::_ArrayData *)ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::raw_new(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance);
    if ( v2 )
      v2->vfptr = (ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> >Vtbl *)&ZFixedArray<unsigned char,65536,0>::_ArrayData::`vftable';
    else
      v2 = 0;
    v1->p = v2;
  }
  return v2->a;
}
// 443540: using guessed type int (__thiscall *ZFixedArray<unsigned char,65536,0>::_ArrayData::`vftable')(void *p, unsigned int __flags);

//----- (0040B231) --------------------------------------------------------
ZFixedArray<unsigned char,65536,0>::_ArrayData *__thiscall ZFixedArray<unsigned char,65536,0>::_ArrayData::`vector deleting destructor'(ZFixedArray<unsigned char,65536,0>::_ArrayData *this, unsigned int __flags)
{
  ZFixedArray<unsigned char,65536,0>::_ArrayData *v2; // esi@1

  v2 = this;
  ZFixedArray<unsigned char,65536,0>::_ArrayData::~_ArrayData(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::raw_delete(
      ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance,
      v2);
  return v2;
}

//----- (0040B252) --------------------------------------------------------
void __thiscall ZFixedArray<unsigned char,65536,0>::_ArrayData::~_ArrayData(ZFixedArray<unsigned char,65536,0>::_ArrayData *this)
{
  this->vfptr = (ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> >Vtbl *)&ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vftable';
}
// 443548: using guessed type int (__thiscall *ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vftable')(void *p, unsigned int __flags);

//----- (0040B259) --------------------------------------------------------
ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *__thiscall ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`scalar deleting destructor'(ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this, unsigned int __flags)
{
  ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> >Vtbl *)&ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::raw_delete(
      ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance,
      this);
  return v2;
}
// 443548: using guessed type int (__thiscall *ZRecyclable<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::`vftable')(void *p, unsigned int __flags);

//----- (0040B27B) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::raw_new(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this)
{
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x10004u, 1u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (0040B2D2) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::raw_delete(ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *this, void *p)
{
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0040B2F8) --------------------------------------------------------
void _E42()
{
  _E34_3();
  _E35_3();
  _E36_3();
  _E37_2();
  _E38_0();
  _E39_0();
  _E40();
  _E41();
}

//----- (0040B320) --------------------------------------------------------
void _E34_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0040B35B) --------------------------------------------------------
void _E35_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (0040B396) --------------------------------------------------------
void _E36_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance = v3;
}

//----- (0040B3D1) --------------------------------------------------------
void _E37_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0040B40C) --------------------------------------------------------
void _E38_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (0040B447) --------------------------------------------------------
void _E39_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0040B482) --------------------------------------------------------
void _E40()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (0040B4BD) --------------------------------------------------------
void _E41()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0040B4F8) --------------------------------------------------------
void _E61()
{
  _E53_1();
  _E54_1();
  _E55_1();
  _E56_1();
  _E57_0();
  _E58_0();
  _E59();
  _E60();
}

//----- (0040B520) --------------------------------------------------------
void _E53_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0040B55B) --------------------------------------------------------
void _E54_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0040B596) --------------------------------------------------------
void _E55_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0040B5D1) --------------------------------------------------------
void _E56_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0040B60C) --------------------------------------------------------
void _E57_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0040B647) --------------------------------------------------------
void _E58_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0040B682) --------------------------------------------------------
void _E59()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (0040B6BD) --------------------------------------------------------
void _E60()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0040B70A) --------------------------------------------------------
void __thiscall ZSocket::~ZSocket(ZSocket *this)
{
  ZSocket *v1; // esi@1
  SOCKET *v2; // esi@3

  v1 = this;
  this->vfptr = (ZIStreamVtbl *)&ZSocket::`vftable';
  ZSocket::Close(this);
  if ( v1->_m_pThread.p )
  {
    ZRef<ZSocketThread>::_ReleaseRaw(&v1->_m_pThread, 0);
    v1->_m_pThread.p = 0;
  }
  v1->vfptr = (ZIStreamVtbl *)&ZIStream::`vftable';
  v2 = (SOCKET *)(v1 != 0 ? (unsigned int)&v1->_m_hSocket : 0);
  if ( *v2 != -1 )
  {
    closesocket(*v2);
    *v2 = -1;
  }
}
// 4434FC: using guessed type int (__thiscall *ZSocket::`vftable')(void *p, unsigned int __flags);
// 443550: using guessed type int (__thiscall *ZIStream::`vftable')(void *p, unsigned int __flags);

//----- (0040B776) --------------------------------------------------------
void __thiscall ZIStream::~ZIStream(ZIStream *this)
{
  this->vfptr = (ZIStreamVtbl *)&ZIStream::`vftable';
}
// 443550: using guessed type int (__thiscall *ZIStream::`vftable')(void *p, unsigned int __flags);

//----- (0040B77D) --------------------------------------------------------
unsigned int __stdcall ZIStream::Read(void *pData, unsigned int uSize)
{
  return 0;
}

//----- (0040B782) --------------------------------------------------------
unsigned int __stdcall ZIStream::Write(const void *pData, unsigned int uSize)
{
  return 0;
}

//----- (0040B787) --------------------------------------------------------
ZIStream *__thiscall ZIStream::`scalar deleting destructor'(ZIStream *this, unsigned int __flags)
{
  ZIStream *v2; // esi@1

  v2 = this;
  this->vfptr = (ZIStreamVtbl *)&ZIStream::`vftable';
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this);
  return v2;
}
// 443550: using guessed type int (__thiscall *ZIStream::`vftable')(void *p, unsigned int __flags);

//----- (0040B7A8) --------------------------------------------------------
void __thiscall ZRef<ZSocketThread>::~ZRef<ZSocketThread>(ZRef<ZSocketThread> *this)
{
  ZRef<ZSocketThread> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<ZSocketThread>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (0040B7BE) --------------------------------------------------------
unsigned int __thiscall ZIStream::ReadEOF(ZIStream *this, void *pData, unsigned int uSize)
{
  unsigned int v3; // edi@1
  ZIStream *v4; // esi@1
  int v5; // eax@2
  unsigned int result; // eax@4

  v3 = uSize;
  v4 = this;
  if ( uSize )
  {
    while ( 1 )
    {
      v5 = (*(int (__thiscall **)(ZIStream *, void *, unsigned int))&v4->vfptr->gap4[0])(v4, pData, v3);
      if ( !v5 )
        break;
      pData = (char *)pData + v5;
      v3 -= v5;
      if ( !v3 )
        goto LABEL_4;
    }
    result = uSize - v3;
  }
  else
  {
LABEL_4:
    result = uSize;
  }
  return result;
}

//----- (0040B7F3) --------------------------------------------------------
unsigned int __thiscall ZIStream::WriteEOF(ZIStream *this, const void *pData, unsigned int uSize)
{
  unsigned int v3; // edi@1
  ZIStream *v4; // esi@1
  int v5; // eax@2
  unsigned int result; // eax@4

  v3 = uSize;
  v4 = this;
  if ( uSize )
  {
    while ( 1 )
    {
      v5 = v4->vfptr->Write(v4, pData, v3);
      if ( !v5 )
        break;
      pData = (char *)pData + v5;
      v3 -= v5;
      if ( !v3 )
        goto LABEL_4;
    }
    result = uSize - v3;
  }
  else
  {
LABEL_4:
    result = uSize;
  }
  return result;
}

//----- (0040B828) --------------------------------------------------------
void __thiscall ZRef<ZSocketThread>::_ReleaseRaw(ZRef<ZSocketThread> *this, ZRefCounted *__formal)
{
  ZRef<ZSocketThread> *v2; // esi@1

  v2 = this;
  if ( !InterlockedDecrement(&this->p->_m_nRef) )
  {
    InterlockedIncrement(&v2->p->_m_nRef);
    ZRefCountedAccessorBase::_Delete((ZRefCounted *)&v2->p->vfptr);
  }
}

//----- (0040B856) --------------------------------------------------------
void __thiscall ZSocket::Close(ZSocket *this)
{
  ZSocket *v1; // esi@1

  v1 = this;
  ZSocket::DetachThread(this);
  if ( v1->_m_hSocket != -1 )
  {
    closesocket(v1->_m_hSocket);
    v1->_m_hSocket = -1;
  }
}

//----- (0040B873) --------------------------------------------------------
ZSocket *__thiscall ZSocket::`vector deleting destructor'(ZSocket *this, unsigned int __flags)
{
  ZSocket *v2; // esi@1

  v2 = this;
  ZSocket::~ZSocket(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0040B893) --------------------------------------------------------
void __thiscall ZSocket::AttachThread(ZSocket *this, int lEvents, ZSocketThread *pThread)
{
  ZSocket *v3; // ebx@1
  HANDLE v4; // ST28_4@4
  int v5; // ST24_4@4
  ZSocketThread *v6; // eax@4
  ZSocketThread::REQ *v7; // eax@4
  HANDLE hEvents; // [sp+18h] [bp-10h]@4
  int v9; // [sp+24h] [bp-4h]@4
  struct _RTL_CRITICAL_SECTION *v10; // [sp+30h] [bp+8h]@4

  v3 = this;
  ZSocket::DetachThread(this);
  if ( pThread )
    ZRef<ZSocketThread>::operator=(&v3->_m_pThread, pThread);
  else
    ZRef<ZSocketThread>::_Alloc(&v3->_m_pThread);
  ZSocketThread::BeginThread(v3->_m_pThread.p);
  hEvents = WSACreateEvent();
  v4 = hEvents;
  v5 = lEvents;
  v10 = (struct _RTL_CRITICAL_SECTION *)&v3->_m_pThread.p->m_lockRequest.DebugInfo;
  EnterCriticalSection(v10);
  v6 = v3->_m_pThread.p;
  v9 = 0;
  v7 = ZList<ZSocketThread::REQ>::AddTail(&v6->m_lRequests);
  v7->pSocket = v3;
  v7->lEvents = v5;
  v7->hEvent = v4;
  LeaveCriticalSection(v10);
  WSASetEvent(*v3->_m_pThread.p->m_ahEvents.a);
  WSAWaitForMultipleEvents(1u, &hEvents, 0, 0xFFFFFFFF, 0);
  WSACloseEvent(hEvents);
}

//----- (0040B94F) --------------------------------------------------------
ZRef<ZSocketThread> *__thiscall ZRef<ZSocketThread>::operator=(ZRef<ZSocketThread> *this, ZSocketThread *pT)
{
  ZRef<ZSocketThread> *v2; // esi@1
  ZSocketThread *v3; // eax@3
  ZRef<ZSocketThread> r; // [sp+4h] [bp-8h]@1

  v2 = this;
  r.p = pT;
  if ( pT )
    InterlockedIncrement(&pT->_m_nRef);
  v3 = v2->p;
  v2->p = r.p;
  r.p = v3;
  if ( v3 )
    ZRef<ZSocketThread>::_ReleaseRaw(&r, 0);
  return v2;
}

//----- (0040B98C) --------------------------------------------------------
void __thiscall ZRef<ZSocketThread>::_Alloc(ZRef<ZSocketThread> *this)
{
  ZRef<ZSocketThread> *v1; // esi@1
  ZSocketThread *v2; // eax@3

  v1 = this;
  if ( this->p )
  {
    ZRef<ZSocketThread>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
  ZRefCounted_Alloc();
  v2->_m_nRef = 1;
  v1->p = v2;
}

//----- (0040B9B4) --------------------------------------------------------
ZSocketThread::REQ *__thiscall ZList<ZSocketThread::REQ>::AddTail(ZList<ZSocketThread::REQ> *this)
{
  ZList<ZSocketThread::REQ> *v1; // esi@1
  ZSocketThread::REQ *result; // eax@1
  ZSocketThread::REQ *v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<ZSocketThread::REQ>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)&result[-2].hEvent : 0;
    (v3 != 0 ? &v3[-1] : 4)->pSocket = (ZSocket *)v4;
    result = (ZSocketThread::REQ *)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (0040B9F2) --------------------------------------------------------
ZSocketThread::REQ *__thiscall ZList<ZSocketThread::REQ>::_New(ZList<ZSocketThread::REQ> *this, void *pPrev, void *pNext)
{
  ZList<ZSocketThread::REQ> *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (ZSocketThread::REQ *)(v4 != 0 ? v4 + 16 : 0);
}

//----- (0040BA31) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<ZSocketThread::REQ> *v0; // ecx@1

  v0 = (ZRefCountedDummy<ZSocketThread::REQ> *)ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<ZSocketThread::REQ>::ZRefCountedDummy<ZSocketThread::REQ>(v0);
}

//----- (0040BA66) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance,
    p);
}

//----- (0040BA76) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0040BA9C) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZSocketThread::REQ>::ZRefCountedDummy<ZSocketThread::REQ>(ZRefCountedDummy<ZSocketThread::REQ> *this)
{
  ZRefCountedDummy<ZSocketThread::REQ> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>Vtbl *)&ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<ZSocketThread::REQ>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>Vtbl *)&ZRefCountedDummy<ZSocketThread::REQ>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443578: using guessed type void *ZRefCountedDummy<ZSocketThread::REQ>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>'};
// 443580: using guessed type int (__thiscall *ZRefCountedDummy<ZSocketThread::REQ>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443588: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags);

//----- (0040BACA) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *__thiscall ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vector deleting destructor'(ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>Vtbl *)&ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance,
      this);
  return v2;
}
// 443588: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags);

//----- (0040BAEC) --------------------------------------------------------
ZRefCountedDummy<ZSocketThread::REQ> *__thiscall ZRefCountedDummy<ZSocketThread::REQ>::`scalar deleting destructor'(ZRefCountedDummy<ZSocketThread::REQ> *this, unsigned int __flags)
{
  ZRefCountedDummy<ZSocketThread::REQ> *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<ZSocketThread::REQ>::~ZRefCountedDummy<ZSocketThread::REQ>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance,
      v2);
  return v2;
}

//----- (0040BB0D) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZSocketThread::REQ>::~ZRefCountedDummy<ZSocketThread::REQ>(ZRefCountedDummy<ZSocketThread::REQ> *this)
{
  *(_DWORD *)(this != 0 ? (unsigned int)&this->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable';
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443588: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags);

//----- (0040BB25) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x1Cu, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (0040BB81) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZSocketThread *v0; // ecx@1

  v0 = (ZSocketThread *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x64u);
  if ( v0 )
    ZSocketThread::ZSocketThread(v0);
}

//----- (0040BBB7) --------------------------------------------------------
void __thiscall ZSocketThread::ZSocketThread(ZSocketThread *this)
{
  ZSocketThread *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->_m_dwThreadId = 0;
  v1->_m_hThread = 0;
  v1->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  v1->m_mSockets._m_apTable = 0;
  v1->m_mSockets._m_uTableSize = 31;
  v1->m_mSockets._m_uCount = 0;
  v1->m_mSockets.vfptr = (ZMap<void *,ZSocket *,void *>Vtbl *)&ZMap<void *,ZSocket *,void *>::`vftable';
  v1->m_mSockets._m_uAutoGrowEvery128 = 100;
  v1->m_mSockets._m_uAutoGrowLimit = 24;
  v1->m_ahEvents.a = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->m_lockRequest.DebugInfo);
  v1->m_lRequests._m_uCount = 0;
  v1->m_lRequests._m_pHead = 0;
  v1->m_lRequests._m_pTail = 0;
  v1->m_lRequests.vfptr = (ZList<ZSocketThread::REQ>Vtbl *)&ZList<ZSocketThread::REQ>::`vftable';
  v1->m_pbTerminate = 0;
  v1->vfptr = (ZRefCountedVtbl *)&ZSocketThread::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZThreadVtbl *)&ZSocketThread::`vftable'{for `ZThread'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);
// 443590: using guessed type void *ZSocketThread::`vftable'{for `ZThread'};
// 44359C: using guessed type int (__thiscall *ZSocketThread::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 4435A4: using guessed type int (__thiscall *ZList<ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags);
// 4435AC: using guessed type int (__thiscall *ZMap<void *,ZSocket *,void *>::`vftable')(void *p, unsigned int __flags);

//----- (0040BC30) --------------------------------------------------------
ZMap<void *,ZSocket *,void *> *__thiscall ZMap<void *,ZSocket *,void *>::`vector deleting destructor'(ZMap<void *,ZSocket *,void *> *this, unsigned int __flags)
{
  ZMap<void *,ZSocket *,void *> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZMap<void *,ZSocket *,void *>Vtbl *)&ZMap<void *,ZSocket *,void *>::`vftable';
  ZMap<void *,ZSocket *,void *>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 4435AC: using guessed type int (__thiscall *ZMap<void *,ZSocket *,void *>::`vftable')(void *p, unsigned int __flags);

//----- (0040BC56) --------------------------------------------------------
ZList<ZSocketThread::REQ> *__thiscall ZList<ZSocketThread::REQ>::`scalar deleting destructor'(ZList<ZSocketThread::REQ> *this, unsigned int __flags)
{
  ZList<ZSocketThread::REQ> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZList<ZSocketThread::REQ>Vtbl *)&ZList<ZSocketThread::REQ>::`vftable';
  ZList<ZSocketThread::REQ>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 4435A4: using guessed type int (__thiscall *ZList<ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags);

//----- (0040BC7C) --------------------------------------------------------
void __thiscall ZMap<void *,ZSocket *,void *>::RemoveAll(ZMap<void *,ZSocket *,void *> *this)
{
  ZMap<void *,ZSocket *,void *> *v1; // edi@1
  ZMap<void *,ZSocket *,void *>::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<void *,ZSocket *,void *>::_PAIR *v4; // ecx@3
  ZMap<void *,ZSocket *,void *>::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (0040BCCD) --------------------------------------------------------
void __thiscall ZList<ZSocketThread::REQ>::RemoveAll(ZList<ZSocketThread::REQ> *this)
{
  ZList<ZSocketThread::REQ> *v1; // esi@1
  ZSocketThread::REQ *i; // eax@1
  ZRefCounted *v3; // eax@2
  int v4; // edi@2

  v1 = this;
  for ( i = this->_m_pHead; i; i = (ZSocketThread::REQ *)(v4 != 0 ? v4 + 16 : 0) )
  {
    v3 = (ZRefCounted *)(i != 0 ? (unsigned int)&i[-2].hEvent : 0);
    v4 = v3->_m_nRef;
    ZRefCountedAccessorBase::_Delete(v3);
  }
  v1->_m_pTail = 0;
  v1->_m_pHead = 0;
  v1->_m_uCount = 0;
}

//----- (0040BD07) --------------------------------------------------------
ZSocketThread *__thiscall ZSocketThread::`vector deleting destructor'(ZSocketThread *this, unsigned int a2)
{
  return ZSocketThread::`scalar deleting destructor'((ZSocketThread *)((char *)this - 12), a2);
}

//----- (0040BD0F) --------------------------------------------------------
ZSocketThread *__thiscall ZSocketThread::`scalar deleting destructor'(ZSocketThread *this, unsigned int __flags)
{
  ZSocketThread *v2; // esi@1

  v2 = this;
  ZSocketThread::~ZSocketThread(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0040BD2F) --------------------------------------------------------
void __thiscall ZSocketThread::BeginThread(ZSocketThread *this)
{
  ZSocketThread *v1; // esi@1
  void **v2; // edi@2
  HANDLE v3; // eax@2
  int v4; // [sp+8h] [bp-4h]@4

  v1 = this;
  if ( !this->_m_hThread )
  {
    this->m_pbTerminate = 0;
    v2 = ZArray<void *>::InsertBefore(&this->m_ahEvents, -1);
    v3 = WSACreateEvent();
    *v2 = v3;
    if ( !v3 || !ZThread::BeginThread((ZThread *)&v1->vfptr, 0, 0, 0, 0, 0) )
    {
      v4 = ((int (__cdecl *)())dword_4A474C)();
      _CxxThrowException(&v4, &_TI1_AVZException__);
    }
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0040BD87) --------------------------------------------------------
void **__thiscall ZArray<void *>::InsertBefore(ZArray<void *> *this, int nIndex)
{
  ZArray<void *> *v2; // ebx@1
  int v3; // esi@4
  unsigned int c; // [sp+Ch] [bp-4h]@2

  v2 = this;
  if ( this->a )
    c = *((_DWORD *)this->a - 1);
  else
    c = 0;
  v3 = nIndex;
  if ( nIndex == -1 )
    v3 = c;
  ZArray<void *>::_Realloc(this, c + 1, 2, (ZAllocHelper *)&nIndex + 3);
  memmove(&v2->a[v3 + 1], &v2->a[v3], 4 * (c + 0x3FFFFFFF * v3));
  return &v2->a[v3];
}

//----- (0040BDF7) --------------------------------------------------------
void **__thiscall ZArray<void *>::_Realloc(ZArray<void *> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<void *> *v4; // edi@1
  unsigned int v5; // ebx@2
  unsigned int v6; // esi@4
  void *v7; // esi@8
  int nModea; // [sp+1Ch] [bp+Ch]@7

  v4 = this;
  if ( this->a )
    v5 = *((_DWORD *)this->a - 1);
  else
    v5 = 0;
  v6 = u;
  if ( u > v5 )
  {
    if ( u > (unsigned int)ZArray<void *>::GetCapacity(this) )
    {
      v7 = (void *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 4 * u + 4) + 4);
      if ( v4->a )
      {
        if ( !(nMode & 1) )
          memcpy(v7, v4->a, 4 * v5);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v4->a - 1);
      }
      v4->a = (void **)v7;
      v6 = u;
    }
    else if ( !(nMode & 2) )
    {
      nModea = (int)&v4->a[v5];
    }
  }
  if ( v4->a )
    *((_DWORD *)v4->a - 1) = v6;
  return v4->a;
}

//----- (0040BE9D) --------------------------------------------------------
void **__thiscall ZArray<void *>::GetCapacity(ZArray<void *> *this)
{
  void **result; // eax@1
  int v2; // eax@2

  result = this->a;
  if ( this->a )
  {
    v2 = (int)*(result - 2);
    if ( v2 < 0 )
      v2 = ~v2;
    result = (void **)((unsigned int)(v2 - 4) >> 2);
  }
  return result;
}

//----- (0040BEB4) --------------------------------------------------------
void __thiscall ZSocketThread::~ZSocketThread(ZSocketThread *this)
{
  ZSocketThread *v1; // esi@1
  ZThread *v2; // edi@1
  volatile int *v3; // eax@1
  HANDLE *v4; // eax@3
  ZThread *v5; // ecx@6

  v1 = this;
  v2 = (ZThread *)&this->vfptr;
  this->vfptr = (ZRefCountedVtbl *)&ZSocketThread::`vftable'{for `ZRefCounted'};
  this->vfptr = (ZThreadVtbl *)&ZSocketThread::`vftable'{for `ZThread'};
  ZSocketThread::DoRequests(this);
  v3 = v1->m_pbTerminate;
  if ( v3 )
  {
    *v3 = 1;
    WSASetEvent(*v1->m_ahEvents.a);
    ZThread::JoinThread(v2, 0xFFFFFFFF);
  }
  v4 = v1->m_ahEvents.a;
  if ( v4 && *(v4 - 1) )
    WSACloseEvent(*v4);
  v1->m_lRequests.vfptr = (ZList<ZSocketThread::REQ>Vtbl *)&ZList<ZSocketThread::REQ>::`vftable';
  ZList<ZSocketThread::REQ>::RemoveAll(&v1->m_lRequests);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lockRequest.DebugInfo);
  ZArray<void *>::RemoveAll(&v1->m_ahEvents);
  v1->m_mSockets.vfptr = (ZMap<void *,ZSocket *,void *>Vtbl *)&ZMap<void *,ZSocket *,void *>::`vftable';
  ZMap<void *,ZSocket *,void *>::RemoveAll(&v1->m_mSockets);
  v5 = (ZThread *)(v1 != 0 ? (unsigned int)v2 : 0);
  v5->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  ZThread::CloseThread(v5);
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);
// 443590: using guessed type void *ZSocketThread::`vftable'{for `ZThread'};
// 44359C: using guessed type int (__thiscall *ZSocketThread::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 4435A4: using guessed type int (__thiscall *ZList<ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags);
// 4435AC: using guessed type int (__thiscall *ZMap<void *,ZSocket *,void *>::`vftable')(void *p, unsigned int __flags);

//----- (0040BFA6) --------------------------------------------------------
int __thiscall ZThread::JoinThread(ZThread *this, unsigned int dwTimeOutMillisec)
{
  ZThread *v2; // esi@1
  int result; // eax@2
  int v4; // esi@5

  v2 = this;
  if ( this->_m_hThread )
  {
    if ( this->_m_dwThreadId == dword_4A465C() )
    {
      result = 0;
    }
    else
    {
      v4 = dword_4A4694(v2->_m_hThread, dwTimeOutMillisec);
      if ( v4 )
        dword_4A4884(32);
      result = v4 == 0;
    }
  }
  else
  {
    result = 1;
  }
  return result;
}
// 4A465C: using guessed type int (*dword_4A465C)(void);
// 4A4694: using guessed type int (__stdcall *dword_4A4694)(_DWORD, _DWORD);
// 4A4884: using guessed type int (__stdcall *dword_4A4884)(_DWORD);

//----- (0040BFE9) --------------------------------------------------------
void __thiscall ZArray<void *>::RemoveAll(ZArray<void *> *this)
{
  ZArray<void *> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this->a - 1);
    v1->a = 0;
  }
}

//----- (0040C00B) --------------------------------------------------------
int __thiscall ZSocketThread::Run(ZSocketThread *this, void *__formal, ZThread::ZThreadResult *pResult)
{
  ZSocketThread *v3; // esi@1
  unsigned int v4; // eax@5
  unsigned int v5; // edi@6
  DWORD v6; // ecx@8
  DWORD v7; // eax@10
  unsigned int v8; // ecx@14
  unsigned int v9; // edx@14
  int v10; // edx@15
  const HANDLE *i; // edi@17
  int v13; // [sp+0h] [bp-38h]@1
  ZRef<ZSocketThread> v14; // [sp+Ch] [bp-2Ch]@3
  ZSocketThread *v15; // [sp+1Ch] [bp-1Ch]@1
  int v16; // [sp+20h] [bp-18h]@11
  int v17; // [sp+24h] [bp-14h]@1
  int *v18; // [sp+28h] [bp-10h]@1
  int v19; // [sp+34h] [bp-4h]@1
  ZThread::ZThreadResult *v20; // [sp+44h] [bp+Ch]@17

  v18 = &v13;
  v3 = this;
  v15 = this;
  InterlockedIncrement(&ZSocketBase::_s_init);
  v17 = 0;
  v3->m_lRequests._m_uCount = (unsigned int)&v17;
  ZThread::ZThreadResult::Succeeded(pResult);
  v19 = 0;
  while ( !v17 )
  {
    v14.p = (ZSocketThread *)((char *)v3 - 12);
    if ( v3 != (ZSocketThread *)12 )
      InterlockedIncrement((volatile LONG *)&v3[-1].m_lRequests._m_pTail);
    v4 = v3->m_mSockets._m_uCount;
    LOBYTE(v19) = 1;
    if ( v4 )
      v5 = *(_DWORD *)(v4 - 4);
    else
      v5 = 0;
    v6 = 64;
    if ( v5 < 0x40 )
      v6 = v5;
    v7 = WSAWaitForMultipleEvents(v6, (const HANDLE *)v3->m_mSockets._m_uCount, 0, 0xFFFFFFFF, 0);
    if ( v7 >= v5 )
    {
      v16 = WSAGetLastError();
      _CxxThrowException(&v16, &_TI1_AVZException__);
    }
    if ( !v7 )
    {
      WSAResetEvent(*(HANDLE *)v3->m_mSockets._m_uCount);
      ZSocketThread::DoRequests((ZSocketThread *)((char *)v3 - 12));
      v7 = 1;
    }
    v8 = v3->m_mSockets._m_uCount;
    v9 = v3->m_mSockets._m_uCount;
    if ( v9 )
      v10 = *(_DWORD *)(v9 - 4);
    else
      v10 = 0;
    v20 = (ZThread::ZThreadResult *)(v8 + 4 * v10);
    for ( i = (const HANDLE *)(v8 + 4 * v7);
          i < (const HANDLE *)v20
       && (WSAWaitForMultipleEvents(1u, i, 0, 0, 0) || ZSocketThread::DoEvent((ZSocketThread *)((char *)v3 - 12), *i));
          ++i )
    {
      ;
    }
    LOBYTE(v19) = 0;
    if ( v14.p )
    {
      ZRef<ZSocketThread>::_ReleaseRaw(&v14, 0);
      v14.p = 0;
    }
  }
  InterlockedDecrement(&ZSocketBase::_s_init);
  return 0;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040C1AF) --------------------------------------------------------
int __thiscall ZSocketThread::DoEvent(ZSocketThread *this, void *hEvent)
{
  ZSocketThread *v2; // edi@1
  ZSocket *v3; // ebx@1
  SOCKET v4; // eax@1
  ZISocketCallBack *v5; // esi@3
  int v7; // [sp+0h] [bp-58h]@1
  struct _WSANETWORKEVENTS NetworkEvents; // [sp+Ch] [bp-4Ch]@1
  ZSocketThread *v9; // [sp+3Ch] [bp-1Ch]@1
  ZSocket *pSocket; // [sp+40h] [bp-18h]@1
  int v11; // [sp+44h] [bp-14h]@2
  int *v12; // [sp+48h] [bp-10h]@1
  int v13; // [sp+54h] [bp-4h]@1

  v12 = &v7;
  v2 = this;
  v9 = this;
  v3 = *ZMap<void *,ZSocket *,void *>::GetAt(&this->m_mSockets, &hEvent, 0);
  v13 = 0;
  v4 = *(_DWORD *)(v3 != 0 ? (unsigned int)&v3->_m_hSocket : 0);
  pSocket = v3;
  if ( WSAEnumNetworkEvents(v4, hEvent, &NetworkEvents) == -1 )
  {
    v11 = WSAGetLastError();
    _CxxThrowException(&v11, &_TI1_AVZException__);
  }
  v5 = v3->_m_pCallBack;
  if ( !v5 )
    return v2->m_lRequests._m_uCount == 0;
  if ( !v2->m_lRequests._m_uCount )
  {
    if ( NetworkEvents.lNetworkEvents & 8 )
      v5->vfptr->OnSocketAccept(v5, v3, NetworkEvents.iErrorCode[3]);
    if ( !v2->m_lRequests._m_uCount )
    {
      if ( NetworkEvents.lNetworkEvents & 0x10 )
        v5->vfptr->OnSocketConnect(v5, v3, NetworkEvents.iErrorCode[4]);
      if ( !v2->m_lRequests._m_uCount )
      {
        if ( NetworkEvents.lNetworkEvents & 4 )
          v5->vfptr->OnSocketOOB(v5, v3, NetworkEvents.iErrorCode[2]);
        if ( !v2->m_lRequests._m_uCount )
        {
          if ( NetworkEvents.lNetworkEvents & 1 )
            v5->vfptr->OnSocketReceive(v5, v3, NetworkEvents.iErrorCode[0]);
          if ( !v2->m_lRequests._m_uCount )
          {
            if ( NetworkEvents.lNetworkEvents & 2 )
              v5->vfptr->OnSocketSend(v5, v3, NetworkEvents.iErrorCode[1]);
            if ( !v2->m_lRequests._m_uCount )
            {
              if ( NetworkEvents.lNetworkEvents & 0x20 )
                v5->vfptr->OnSocketClose(v5, v3, NetworkEvents.iErrorCode[5]);
              return v2->m_lRequests._m_uCount == 0;
            }
          }
        }
      }
    }
  }
  return 0;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040C2E8) --------------------------------------------------------
ZSocket **__thiscall ZMap<void *,ZSocket *,void *>::GetAt(ZMap<void *,ZSocket *,void *> *this, void *const *key, ZSocket **value)
{
  ZMap<void *,ZSocket *,void *>::_PAIR *v3; // edx@2
  ZSocket **result; // eax@5

  if ( this->_m_apTable && (v3 = this->_m_apTable[_lrotr((unsigned __int32)*key, 5) % this->_m_uTableSize]) != 0 )
  {
    while ( v3->key != *key )
    {
      v3 = v3->pNext;
      if ( !v3 )
        goto LABEL_5;
    }
    if ( value )
      *value = v3->value;
    result = &v3->value;
  }
  else
  {
LABEL_5:
    result = 0;
  }
  return result;
}

//----- (0040C338) --------------------------------------------------------
void __thiscall ZSocketThread::DoRequests(ZSocketThread *this)
{
  ZSocketThread *v1; // ebx@1
  ZSocketThread::REQ *v2; // ST08_4@3
  void *v3; // eax@5
  int v4; // eax@7
  ZSocket *pSocket; // [sp+Ch] [bp-1Ch]@3
  __int32 lNetworkEvents; // [sp+10h] [bp-18h]@3
  HANDLE hEvent; // [sp+14h] [bp-14h]@3

  v1 = this;
  while ( 1 )
  {
    EnterCriticalSection((LPCRITICAL_SECTION)&v1->m_lockRequest.DebugInfo);
    if ( !v1->m_lRequests._m_uCount )
      break;
    v2 = v1->m_lRequests._m_pHead;
    pSocket = v2->pSocket;
    lNetworkEvents = v2->lEvents;
    hEvent = v2->hEvent;
    ZList<ZSocketThread::REQ>::RemoveAt(&v1->m_lRequests, (__POSITION *)v2);
    LeaveCriticalSection((LPCRITICAL_SECTION)&v1->m_lockRequest.DebugInfo);
    if ( lNetworkEvents == -1 )
    {
      ZSocketThread::RawUnregisterSocket(v1, pSocket);
    }
    else
    {
      v3 = ZSocketThread::RawRegisterSocket(v1, pSocket);
      if ( !v3
        || WSAEventSelect(*(_DWORD *)(pSocket != 0 ? (unsigned int)&pSocket->_m_hSocket : 0), v3, lNetworkEvents) == -1 )
      {
        v4 = WSAGetLastError();
        ZSocketThread::ForceClose(v1, pSocket, v4);
      }
    }
    if ( hEvent )
      WSASetEvent(hEvent);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&v1->m_lockRequest.DebugInfo);
}

//----- (0040C405) --------------------------------------------------------
void __thiscall ZList<ZSocketThread::REQ>::RemoveAt(ZList<ZSocketThread::REQ> *this, __POSITION *pos)
{
  int v2; // edx@1
  int v3; // eax@2
  int v4; // eax@4
  int v5; // eax@5
  int v6; // eax@6
  int v7; // eax@7
  int v8; // edx@7
  int v9; // eax@7
  int v10; // edx@7

  v2 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8);
  if ( *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? v2 + 16 : 0 )
  {
    v5 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v5 + 16 : 0 )
    {
      v7 = v5 != 0 ? v5 + 16 : 0;
      v8 = v2 != 0 ? v2 + 16 : 0;
      *(_DWORD *)(v8 != 0 ? v8 - 16 + 4 : 4) = v7 != 0 ? v7 - 16 : 0;
      v9 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      v10 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v10 != 0 ? v10 - 16 + 8 : 8) = v9 != 0 ? v9 - 16 : 0;
    }
    else
    {
      this->_m_pTail = (ZSocketThread::REQ *)(v2 != 0 ? v2 + 16 : 0);
      v6 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      *(_DWORD *)(v6 != 0 ? v6 - 16 + 4 : 4) = 0;
    }
  }
  else
  {
    v3 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v3 + 16 : 0 )
    {
      this->_m_pHead = (ZSocketThread::REQ *)(v3 != 0 ? v3 + 16 : 0);
      v4 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v4 != 0 ? v4 - 16 + 8 : 8) = 0;
    }
    else
    {
      this->_m_pTail = 0;
      this->_m_pHead = 0;
    }
  }
  --this->_m_uCount;
  ZRefCountedAccessorBase::_Delete((ZRefCounted *)(pos != 0 ? (unsigned int)&pos[-16] : 0));
}

//----- (0040C517) --------------------------------------------------------
void __thiscall ZSocketThread::ForceClose(ZSocketThread *this, ZSocket *pSocket, int nErr)
{
  ZISocketCallBack *v3; // ecx@1
  ZISocketCallBackVtbl *v4; // edx@2
  int v5; // [sp-Ch] [bp-1Ch]@1
  ZSocketThread *v6; // [sp+0h] [bp-10h]@1
  int v7; // [sp+Ch] [bp-4h]@2

  v6 = this;
  v3 = pSocket->_m_pCallBack;
  v6 = (ZSocketThread *)&v5;
  if ( v3 )
  {
    v4 = v3->vfptr;
    v7 = 0;
    ((void (__stdcall *)(ZSocket *, int))v4->OnSocketClose)(pSocket, nErr);
    v7 = -1;
  }
  ZSocket::Close(pSocket);
}

//----- (0040C55C) --------------------------------------------------------
void *_L123941()
{
  return &_L92283;
}

//----- (0040C562) --------------------------------------------------------
void *__thiscall ZSocketThread::RawRegisterSocket(ZSocketThread *this, ZSocket *pSocket)
{
  ZSocketThread *v2; // esi@1
  void *result; // eax@3
  void **v4; // eax@4
  void *e; // [sp+4h] [bp-4h]@2

  v2 = this;
  if ( this->m_mSockets._m_uCount + 1 < 0x40 && (e = WSACreateEvent()) != 0 )
  {
    ZMap<void *,ZSocket *,void *>::Insert(&v2->m_mSockets, &e, &pSocket);
    v4 = ZArray<void *>::InsertBefore(&v2->m_ahEvents, -1);
    *v4 = e;
    result = e;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0040C5AA) --------------------------------------------------------
__POSITION *__thiscall ZMap<void *,ZSocket *,void *>::Insert(ZMap<void *,ZSocket *,void *> *this, void *const *key, ZSocket *const *value)
{
  ZMap<void *,ZSocket *,void *> *v3; // esi@1
  unsigned int v4; // eax@2
  __POSITION **v5; // edi@7
  __POSITION *result; // eax@7
  __POSITION *v7; // ecx@11

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<void *,ZSocket *,void *>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = (__POSITION **)&v3->_m_apTable[_lrotr((unsigned __int32)*key, 5) % v3->_m_uTableSize];
  result = *v5;
  if ( *v5 )
  {
    while ( *(void *const *)&result[8] != *key )
    {
      result = *(__POSITION **)&result[4];
      if ( !result )
        goto LABEL_10;
    }
    if ( value )
      *(ZSocket **)&result[12] = *value;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    result = (__POSITION *)ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance);
    if ( result )
    {
      v7 = *v5;
      *(_DWORD *)result = &ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable';
      *(_DWORD *)&result[4] = v7;
      *(void **)&result[8] = *key;
      *(_DWORD *)result = &ZMap<void *,ZSocket *,void *>::_PAIR::`vftable';
    }
    else
    {
      result = 0;
    }
    if ( value )
      *(ZSocket **)&result[12] = *value;
    *v5 = result;
  }
  return result;
}
// 4435B4: using guessed type int (__thiscall *ZMap<void *,ZSocket *,void *>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 4435BC: using guessed type int (__thiscall *ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0040C656) --------------------------------------------------------
ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *__thiscall ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`scalar deleting destructor'(ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>Vtbl *)&ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 4435BC: using guessed type int (__thiscall *ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0040C678) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0040C69E) --------------------------------------------------------
ZMap<void *,ZSocket *,void *>::_PAIR *__thiscall ZMap<void *,ZSocket *,void *>::_PAIR::`scalar deleting destructor'(ZMap<void *,ZSocket *,void *>::_PAIR *this, unsigned int __flags)
{
  ZMap<void *,ZSocket *,void *>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<void *,ZSocket *,void *>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (0040C6BF) --------------------------------------------------------
void __thiscall ZMap<void *,ZSocket *,void *>::_PAIR::~_PAIR(ZMap<void *,ZSocket *,void *>::_PAIR *this)
{
  this->vfptr = (ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>Vtbl *)&ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable';
}
// 4435BC: using guessed type int (__thiscall *ZRecyclable<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0040C6C6) --------------------------------------------------------
void __thiscall ZMap<void *,ZSocket *,void *>::ResizeHashTable(ZMap<void *,ZSocket *,void *> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<void *,ZSocket *,void *> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<void *,ZSocket *,void *>::_PAIR **v5; // edi@3
  ZMap<void *,ZSocket *,void *>::_PAIR **v6; // ebx@3
  ZMap<void *,ZSocket *,void *>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<void *,ZSocket *,void *>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<void *,ZSocket *,void *>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<void *,ZSocket *,void *>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<void *,ZSocket *,void *>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<void *,ZSocket *,void *>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                    &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                    4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr((unsigned __int32)v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<void *,ZSocket *,void *>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (0040C771) --------------------------------------------------------
void __thiscall ZMap<void *,ZSocket *,void *>::_CalcAutoGrow(ZMap<void *,ZSocket *,void *> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (0040C795) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (0040C7EA) --------------------------------------------------------
void **__thiscall ZSocketThread::RawUnregisterSocket(ZSocketThread *this, ZSocket *pSocket)
{
  ZSocketThread *v2; // esi@1
  ZMap<void *,ZSocket *,void *> *v3; // edi@1
  void **result; // eax@1
  void **v5; // eax@2
  ZArray<void *> *v6; // ecx@2
  int v7; // eax@4
  void **v8; // esi@5
  void *e; // [sp+8h] [bp-4h]@2

  v2 = this;
  v3 = &this->m_mSockets;
  result = (void **)ZMap<void *,ZSocket *,void *>::FindInverse(&this->m_mSockets, &pSocket);
  if ( result )
  {
    e = *result;
    ZMap<void *,ZSocket *,void *>::RemoveKey(v3, &e);
    v5 = v2->m_ahEvents.a;
    v6 = &v2->m_ahEvents;
    if ( v5 )
      v5 = (void **)*(v5 - 1);
    v7 = (int)v5 - 1;
    if ( v7 )
    {
      v8 = &v6->a[v7];
      while ( *v8 != e )
      {
        --v7;
        --v8;
        if ( !v7 )
          goto LABEL_10;
      }
      ZArray<void *>::RemoveAt(v6, (__POSITION *)&v6->a[v7]);
    }
LABEL_10:
    result = (void **)1;
  }
  return result;
}

//----- (0040C84E) --------------------------------------------------------
int __thiscall ZMap<void *,ZSocket *,void *>::RemoveKey(ZMap<void *,ZSocket *,void *> *this, void *const *key)
{
  ZMap<void *,ZSocket *,void *> *v2; // esi@1
  unsigned __int32 v3; // edx@2
  ZMap<void *,ZSocket *,void *>::_PAIR **v4; // eax@2
  ZMap<void *,ZSocket *,void *>::_PAIR *v5; // ecx@2
  ZMap<void *,ZSocket *,void *>::_PAIR **v6; // eax@2
  ZMap<void *,ZSocket *,void *>::_PAIR *i; // eax@5

  v2 = this;
  if ( !this->_m_apTable )
    return 0;
  v3 = _lrotr((unsigned __int32)*key, 5) % this->_m_uTableSize;
  v4 = v2->_m_apTable;
  v5 = v4[v3];
  v6 = &v4[v3];
  if ( !v5 )
    return 0;
  if ( v5->key != *key )
  {
    for ( i = v5->pNext; i; i = i->pNext )
    {
      if ( i->key == *key )
      {
        v5->pNext = i->pNext;
        v5 = i;
        goto found;
      }
      v5 = i;
    }
    return 0;
  }
  *v6 = v5->pNext;
found:
  if ( v5 )
    ((void (__stdcall *)(signed int))v5->vfptr->__vecDelDtor)(1);
  --v2->_m_uCount;
  return 1;
}

//----- (0040C8BC) --------------------------------------------------------
__POSITION *__thiscall ZMap<void *,ZSocket *,void *>::FindInverse(ZMap<void *,ZSocket *,void *> *this, ZSocket *const *value)
{
  ZMap<void *,ZSocket *,void *> *v2; // edi@1
  __POSITION *v3; // eax@1
  __POSITION *v4; // esi@3
  ZSocket *v; // [sp+8h] [bp-8h]@3
  __POSITION *pos; // [sp+Ch] [bp-4h]@1

  v2 = this;
  v3 = (__POSITION *)ZMap<void *,ZSocket *,void *>::GetHeadPosition(this);
  pos = v3;
  while ( v3 )
  {
    v4 = v3;
    ZMap<void *,ZSocket *,void *>::GetNext(v2, &pos, &v);
    if ( v == *value )
      return v4 + 8;
    v3 = pos;
  }
  return 0;
}

//----- (0040C8FE) --------------------------------------------------------
ZMap<void *,ZSocket *,void *>::_PAIR *__thiscall ZMap<void *,ZSocket *,void *>::GetHeadPosition(ZMap<void *,ZSocket *,void *> *this)
{
  ZMap<void *,ZSocket *,void *>::_PAIR **v1; // eax@1
  unsigned int v2; // ecx@2

  v1 = this->_m_apTable;
  if ( v1 )
  {
    v2 = (unsigned int)&v1[this->_m_uTableSize];
    while ( (unsigned int)v1 < v2 )
    {
      if ( *v1 )
        return *v1;
      ++v1;
    }
  }
  return 0;
}

//----- (0040C91F) --------------------------------------------------------
void __thiscall ZArray<void *>::RemoveAt(ZArray<void *> *this, __POSITION *pos)
{
  ZArray<void *> *v2; // esi@1

  v2 = this;
  memmove(pos, &pos[4], 4 * (((signed int)this->a + 4 * *((_DWORD *)this->a - 1) - (signed int)pos - 4) >> 2));
  --*((_DWORD *)v2->a - 1);
}

//----- (0040C953) --------------------------------------------------------
__POSITION *__thiscall ZMap<void *,ZSocket *,void *>::GetNext(ZMap<void *,ZSocket *,void *> *this, __POSITION **pos, ZSocket **value)
{
  __POSITION *v3; // ebx@1
  ZMap<void *,ZSocket *,void *> *v4; // edi@1
  __POSITION *v5; // ecx@1
  unsigned int v6; // esi@3
  unsigned __int32 v7; // edx@3
  ZMap<void *,ZSocket *,void *>::_PAIR **v8; // eax@3
  __POSITION **v9; // ecx@3
  unsigned int v10; // eax@3

  v3 = *pos;
  v4 = this;
  v5 = *(__POSITION **)&(*pos)[4];
  if ( v5 )
  {
    *pos = v5;
  }
  else
  {
    *pos = 0;
    v6 = v4->_m_uTableSize;
    v7 = _lrotr(*(_DWORD *)&v3[8], 5) % v6;
    v8 = v4->_m_apTable;
    v9 = (__POSITION **)&v8[v7 + 1];
    v10 = (unsigned int)&v8[v6];
    while ( (unsigned int)v9 < v10 )
    {
      if ( *v9 )
      {
        *pos = *v9;
        break;
      }
      ++v9;
    }
  }
  if ( value )
    *value = *(ZSocket **)&v3[12];
  return v3 + 8;
}

//----- (0040C9B6) --------------------------------------------------------
void __thiscall ZSocket::DetachThread(ZSocket *this)
{
  ZSocket *v1; // ebx@1
  HANDLE v2; // ST28_4@2
  ZSocketThread *v3; // eax@2
  ZSocketThread::REQ *v4; // eax@2
  void *v5; // esi@2
  ZRef<ZSocketThread> *v6; // ebx@2
  struct _RTL_CRITICAL_SECTION *lpCriticalSection; // [sp+14h] [bp-14h]@2
  HANDLE hEvents; // [sp+18h] [bp-10h]@2
  int v9; // [sp+24h] [bp-4h]@2

  v1 = this;
  if ( this->_m_pThread.p )
  {
    hEvents = WSACreateEvent();
    v2 = hEvents;
    lpCriticalSection = (struct _RTL_CRITICAL_SECTION *)&v1->_m_pThread.p->m_lockRequest.DebugInfo;
    EnterCriticalSection(lpCriticalSection);
    v3 = v1->_m_pThread.p;
    v9 = 0;
    v4 = ZList<ZSocketThread::REQ>::AddTail(&v3->m_lRequests);
    v4->pSocket = v1;
    v4->lEvents = -1;
    v4->hEvent = v2;
    v5 = *v1->_m_pThread.p->m_ahEvents.a;
    v6 = &v1->_m_pThread;
    if ( v6->p )
    {
      ZRef<ZSocketThread>::_ReleaseRaw(v6, 0);
      v6->p = 0;
    }
    LeaveCriticalSection(lpCriticalSection);
    WSASetEvent(v5);
    WSAWaitForMultipleEvents(1u, &hEvents, 0, 0xFFFFFFFF, 0);
    WSACloseEvent(hEvents);
  }
}

//----- (0040CA65) --------------------------------------------------------
BOOL __thiscall ZSocket::Connect(ZSocket *this, sockaddr_in *pAddr)
{
  return connect(*(_DWORD *)(this != 0 ? (unsigned int)&this->_m_hSocket : 0), (const struct sockaddr *)pAddr, 16) != -1
      || WSAGetLastError() == 10035;
}

//----- (0040CA9B) --------------------------------------------------------
int __thiscall ZSocket::Send(ZSocket *this, const void *pData, unsigned int uSize, int bOOB)
{
  int result; // eax@1
  int v5; // eax@2

  result = send(*(_DWORD *)(this != 0 ? (unsigned int)&this->_m_hSocket : 0), (const char *)pData, uSize, bOOB != 0);
  if ( result == -1 )
  {
    v5 = WSAGetLastError();
    if ( v5 != 10035 )
    {
      bOOB = v5;
      _CxxThrowException(&bOOB, &_TI1_AVZException__);
    }
    result = 0;
  }
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040CAEA) --------------------------------------------------------
int __thiscall ZSocket::Receive(ZSocket *this, void *pData, unsigned int uSize, int bOOB)
{
  int result; // eax@1
  int v5; // eax@2

  result = recv(*(_DWORD *)(this != 0 ? (unsigned int)&this->_m_hSocket : 0), (char *)pData, uSize, bOOB != 0);
  if ( result == -1 )
  {
    v5 = WSAGetLastError();
    if ( v5 != 10035 )
    {
      bOOB = v5;
      _CxxThrowException(&bOOB, &_TI1_AVZException__);
    }
    result = 0;
  }
  else if ( !result )
  {
    WSASetLastError(10057);
    bOOB = 10057;
    _CxxThrowException(&bOOB, &_TI1_AVZException__);
  }
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040CB5D) --------------------------------------------------------
int __thiscall ZSocket::Read(ZSocket *this, void *pData, unsigned int uSize)
{
  SOCKET *v3; // esi@1
  int result; // eax@2
  int v5; // eax@3
  SOCKET i; // [sp-10h] [bp-18h]@1
  char *v7; // [sp-Ch] [bp-14h]@1
  int v8; // [sp-8h] [bp-10h]@1

  v8 = uSize;
  v7 = (char *)pData;
  v3 = (SOCKET *)(this != 0 ? (unsigned int)&this->_m_hSocket : 0);
  for ( i = *v3; ; i = *v3 )
  {
    result = recv(i, v7, v8, 0);
    if ( result != -1 )
      break;
    v5 = WSAGetLastError();
    if ( v5 != 10035 )
    {
      uSize = v5;
      _CxxThrowException(&uSize, &_TI1_AVZException__);
    }
    dword_4A469C(10);
    v8 = uSize;
    v7 = (char *)pData;
  }
  if ( !result )
  {
    uSize = 10057;
    _CxxThrowException(&uSize, &_TI1_AVZException__);
  }
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A469C: using guessed type int (__stdcall *dword_4A469C)(_DWORD);

//----- (0040CBD7) --------------------------------------------------------
int __thiscall ZSocket::Write(ZSocket *this, const void *pData, unsigned int uSize)
{
  return ZSocket::Send(this, pData, uSize, 0);
}

//----- (0040CBE9) --------------------------------------------------------
int __thiscall ZSocket::ReadEOF(ZSocket *this, void *pData, unsigned int uSize)
{
  int v3; // edi@1
  unsigned int v4; // ebx@1
  SOCKET *v5; // esi@2
  int v6; // eax@3
  void *v7; // eax@4

  v3 = uSize;
  v4 = uSize;
  if ( !uSize )
    return v4;
  v5 = (SOCKET *)(this != 0 ? (unsigned int)&this->_m_hSocket : 0);
  while ( 1 )
  {
    v6 = recv(*v5, (char *)pData, v3, 0);
    if ( v6 == -1 )
      break;
    if ( !v6 )
      return v4 - v3;
    pData = (char *)pData + v6;
    v3 -= v6;
LABEL_8:
    if ( !v3 )
      return v4;
  }
  v7 = (void *)WSAGetLastError();
  if ( v7 == (void *)10035 )
  {
    dword_4A469C(10);
    goto LABEL_8;
  }
  if ( v7 != (void *)10057 )
  {
    pData = v7;
    _CxxThrowException(&pData, &_TI1_AVZException__);
  }
  return v4 - v3;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A469C: using guessed type int (__stdcall *dword_4A469C)(_DWORD);

//----- (0040CC62) --------------------------------------------------------
int __thiscall ZSocket::WriteEOF(ZSocket *this, const void *pData, unsigned int uSize)
{
  int v3; // edi@1
  unsigned int v4; // ebx@1
  SOCKET *v5; // esi@2
  int v6; // eax@3
  const void *v7; // eax@4

  v3 = uSize;
  v4 = uSize;
  if ( !uSize )
    return v4;
  v5 = (SOCKET *)(this != 0 ? (unsigned int)&this->_m_hSocket : 0);
  while ( 1 )
  {
    v6 = send(*v5, (const char *)pData, v3, 0);
    if ( v6 == -1 )
      break;
    if ( !v6 )
      return v4 - v3;
    pData = (char *)pData + v6;
    v3 -= v6;
LABEL_8:
    if ( !v3 )
      return v4;
  }
  v7 = (const void *)WSAGetLastError();
  if ( v7 == (const void *)10035 )
  {
    dword_4A469C(10);
    goto LABEL_8;
  }
  if ( v7 != (const void *)10057 )
  {
    pData = v7;
    _CxxThrowException(&pData, &_TI1_AVZException__);
  }
  return v4 - v3;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A469C: using guessed type int (__stdcall *dword_4A469C)(_DWORD);

//----- (0040CCDB) --------------------------------------------------------
void __thiscall ZSocketBuffer::Sub(ZSocketBuffer *this, unsigned int uFrom, unsigned int uLength, ZAllocHelper *_ALLOC)
{
  ZSocketBuffer *v4; // esi@1
  ZSocketBuffer *v5; // ecx@1

  v4 = this;
  v5 = (ZSocketBuffer *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x1Cu);
  if ( v5 )
    ZSocketBuffer::ZSocketBuffer(v5, uLength, &v4->buf[uFrom], v4);
}

//----- (0040CD22) --------------------------------------------------------
int __thiscall CRand32::Random(CRand32 *this)
{
  CRand32 *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // ebp@1
  unsigned int v3; // eax@1
  unsigned int v4; // ecx@1
  unsigned int v5; // edx@1
  unsigned int v6; // edi@1
  unsigned int v7; // ebx@1
  unsigned int v8; // edi@1
  unsigned int v9; // ebx@1
  unsigned int v10; // eax@1
  int v11; // esi@1

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v3 = v1->m_s1;
  v4 = v1->m_s2;
  v5 = v1->m_s3;
  v6 = v1->m_s1;
  v7 = v1->m_s1;
  v1->m_past_s1 = v1->m_s1;
  v8 = ((v3 & 0xFFFFFFFE) << 12) ^ ((v7 & 0x7FFC0 ^ (v6 >> 13)) >> 6);
  v1->m_past_s2 = v4;
  v9 = 16 * (v4 & 0xFFFFFFF8) ^ (((v4 >> 2) ^ v4 & 0x3F800000) >> 23);
  v1->m_past_s3 = v5;
  v10 = ((v5 & 0xFFFFFFF0) << 17) ^ (((v5 >> 3) ^ v5 & 0x1FFFFF00) >> 8);
  v1->m_s3 = v10;
  v1->m_s1 = v8;
  v1->m_s2 = v9;
  v11 = v8 ^ v9 ^ v10;
  LeaveCriticalSection(v2);
  return v11;
}

//----- (0040CDAC) --------------------------------------------------------
_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *__cdecl get_conf()
{
  return &g_pPropConf;
}

//----- (0040CDB2) --------------------------------------------------------
const unsigned __int16 *__cdecl get_string(Ztl_variant_t *v, const unsigned __int16 *sDefault)
{
  const unsigned __int16 *result; // eax@2

  if ( v->vt == 8 )
    result = v->bstrVal;
  else
    result = sDefault;
  return result;
}

//----- (0040CDC5) --------------------------------------------------------
int _E32_3()
{
  _E28_0();
  return _E31_3();
}

//----- (0040CDCF) --------------------------------------------------------
void _E28_0()
{
  InitializeCriticalSection(&CClientSocket::ms_lockClient);
}

//----- (0040CDDB) --------------------------------------------------------
int _E31_3()
{
  return atexit(_E29_2);
}

//----- (0040CDE7) --------------------------------------------------------
void __cdecl _E29_2()
{
  if ( !(_S30_0 & 1) )
  {
    _S30_0 |= 1u;
    DeleteCriticalSection(&CClientSocket::ms_lockClient);
  }
}

//----- (0040CE03) --------------------------------------------------------
int _E37_3()
{
  _E34_4();
  return _E36_4();
}

//----- (0040CE0D) --------------------------------------------------------
void _E34_4()
{
  InitializeCriticalSection(&CClientSocket::ms_lockGuardData);
}

//----- (0040CE19) --------------------------------------------------------
int _E36_4()
{
  return atexit(_E35_4);
}

//----- (0040CE25) --------------------------------------------------------
void __cdecl _E35_4()
{
  if ( !(_S30_0 & 2) )
  {
    _S30_0 |= 2u;
    DeleteCriticalSection(&CClientSocket::ms_lockGuardData);
  }
}

//----- (0040CE41) --------------------------------------------------------
int _E42_0()
{
  _E39_1();
  return _E41_0();
}

//----- (0040CE4B) --------------------------------------------------------
void _E39_1()
{
  CClientSocket::ms_mWhiteProcessName._m_apTable = 0;
  CClientSocket::ms_mWhiteProcessName._m_uCount = 0;
  CClientSocket::ms_mWhiteProcessName._m_uTableSize = 31;
  CClientSocket::ms_mWhiteProcessName.vfptr = (ZMap<char const *,int,ZXString<char> >Vtbl *)&ZMap<char const *,int,ZXString<char>>::`vftable';
  ZMap<char const *,int,ZXString<char>>::_CalcAutoGrow(&CClientSocket::ms_mWhiteProcessName, 0x64u);
}
// 4435CC: using guessed type int (__thiscall *ZMap<char const *,int,ZXString<char>>::`vftable')(void *p, unsigned int __flags);

//----- (0040CE7A) --------------------------------------------------------
int _E41_0()
{
  return atexit(_E40_0);
}

//----- (0040CE86) --------------------------------------------------------
void __cdecl _E40_0()
{
  if ( !(_S30_0 & 4) )
  {
    _S30_0 |= 4u;
    CClientSocket::ms_mWhiteProcessName.vfptr = (ZMap<char const *,int,ZXString<char> >Vtbl *)&ZMap<char const *,int,ZXString<char>>::`vftable';
    ZMap<char const *,int,ZXString<char>>::RemoveAll(&CClientSocket::ms_mWhiteProcessName);
  }
}
// 4435CC: using guessed type int (__thiscall *ZMap<char const *,int,ZXString<char>>::`vftable')(void *p, unsigned int __flags);

//----- (0040CEAB) --------------------------------------------------------
int _E47()
{
  _E44();
  return _E46();
}

//----- (0040CEB5) --------------------------------------------------------
void _E44()
{
  CClientSocket::ms_mClient._m_apTable = 0;
  CClientSocket::ms_mClient._m_uCount = 0;
  CClientSocket::ms_mClient._m_uTableSize = 31;
  CClientSocket::ms_mClient.vfptr = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>Vtbl *)&ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable';
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_CalcAutoGrow(&CClientSocket::ms_mClient, 0x64u);
}
// 4435D4: using guessed type int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (0040CEE4) --------------------------------------------------------
int _E46()
{
  return atexit(_E45);
}

//----- (0040CEF0) --------------------------------------------------------
void __cdecl _E45()
{
  if ( !(_S30_0 & 8) )
  {
    _S30_0 |= 8u;
    CClientSocket::ms_mClient.vfptr = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>Vtbl *)&ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable';
    ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveAll(&CClientSocket::ms_mClient);
  }
}
// 4435D4: using guessed type int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (0040CF15) --------------------------------------------------------
int _E52_1()
{
  _E49_1();
  return _E51_1();
}

//----- (0040CF1F) --------------------------------------------------------
void _E49_1()
{
  InitializeCriticalSection(&CClientSocket::ms_lockStat);
}

//----- (0040CF2B) --------------------------------------------------------
int _E51_1()
{
  return atexit(_E50_1);
}

//----- (0040CF37) --------------------------------------------------------
void __cdecl _E50_1()
{
  if ( !(_S30_0 & 0x10) )
  {
    _S30_0 |= 0x10u;
    DeleteCriticalSection(&CClientSocket::ms_lockStat);
  }
}

//----- (0040CF53) --------------------------------------------------------
void __thiscall CClientSocket::CClientSocket(CClientSocket *this)
{
  CClientSocket *v1; // esi@1
  int v2; // eax@1
  int v3; // eax@1
  CSecuritySession *v4; // eax@1
  CSecuritySession *v5; // eax@2

  v1 = this;
  ZSocketEx::ZSocketEx((ZSocketEx *)&this->vfptr);
  v1->vfptr = (CVerboseObjVtbl *)&CVerboseObj::`vftable';
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->m_lockSend.DebugInfo);
  CInPacket::CInPacket(&v1->m_packetRecv, 0);
  CInPacket::CInPacket(&v1->m_packetLoopback, 1);
  v1->m_nLoginState = 1;
  v1->m_nFailCount = 0;
  v1->m_nFailCountbyPinCode = 0;
  v1->m_bIsPinCodeChecked = 0;
  v1->m_sId._m_pStr = 0;
  v1->m_dwAccountId = 0;
  v1->m_nGradeCode = 0;
  v1->m_sNexonClubID._m_pStr = 0;
  v1->m_bAdminclient = 0;
  v1->m_sEventCharacterID._m_pStr = 0;
  v2 = (int)&v1->m_mCharIDName;
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)(v2 + 8) = 31;
  *(_DWORD *)(v2 + 12) = 0;
  *(_DWORD *)v2 = &ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable';
  *(_DWORD *)(v2 + 16) = 100;
  *(_DWORD *)(v2 + 20) = 24;
  v3 = (int)&v1->m_mNameWorldID;
  *(_DWORD *)(v3 + 4) = 0;
  *(_DWORD *)(v3 + 8) = 31;
  *(_DWORD *)(v3 + 12) = 0;
  *(_DWORD *)v3 = &ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable';
  *(_DWORD *)(v3 + 16) = 100;
  *(_DWORD *)(v3 + 20) = 24;
  v1->m_bIsVACDlgOn = 0;
  v1->m_nGameStartMode = 0;
  v1->m_bClosePosted = 0;
  v1->m_bUpdatePosted = 0;
  ZInetAddr::_Init(&v1->m_addr, 0, 0);
  v1->m_sAddr._m_pStr = 0;
  v1->m_uLocalSocketSN = 0;
  v1->m_posList = 0;
  v1->m_tAliveReqSent = 0;
  v1->m_tLastAliveAck = 0;
  v1->m_bFirstAliveAck = 1;
  v1->m_tIPCheckRequestSent = 0;
  v1->m_bPremium = 0;
  v1->m_bTempBlockedIP = 0;
  v1->m_bProcessed = 0;
  COutPacket::COutPacket(&v1->m_oPacket, 0x7FFFFFFF, 0);
  v1->m_pMxHelper.p = 0;
  v1->vfptr = (ZRefCountedVtbl *)&CClientSocket::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZOverlapped::ZICallBackVtbl *)&CClientSocket::`vftable'{for `ZOverlapped::ZICallBack'};
  v1->vfptr = (CVerboseObjVtbl *)&CClientSocket::`vftable';
  v1->m_tLastUpdateTime = timeGetTime();
  v4 = (CSecuritySession *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x6Cu);
  if ( v4 )
    CSecuritySession::CSecuritySession(v4, v1);
  else
    v5 = 0;
  v1->m_pSecuritySession = v5;
  CSecuritySession::Init(v5);
  ZRef<CMxHelperServerManager>::_Alloc(&v1->m_pMxHelper);
  COutPacket::Init(&v1->m_oPacket, 2, 1);
}
// 443420: using guessed type const char *(__thiscall *CVerboseObj::`vftable')(CVerboseObj *__hidden this);
// 4435DC: using guessed type const char *(__thiscall *CClientSocket::`vftable')(CClientSocket *__hidden this);
// 4435E4: using guessed type void (__thiscall *CClientSocket::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32);
// 4435F0: using guessed type int (__thiscall *CClientSocket::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443604: using guessed type int (__thiscall *ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable')(void *p, unsigned int __flags);
// 44360C: using guessed type int (__thiscall *ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (0040D130) --------------------------------------------------------
void __thiscall CSecuritySession::CSecuritySession(CSecuritySession *this, CClientSocket *pSocket)
{
  CSecuritySession *v2; // esi@1

  v2 = this;
  this->m_bForCheckGameGuardUpdate = 0;
  COutPacket::COutPacket(&this->m_oPacket, 0x7FFFFFFF, 0);
  v2->m_pOwner = pSocket;
  CCSAuth2::CCSAuth2(&v2->m_Auth);
}

//----- (0040D176) --------------------------------------------------------
_RTL_CRITICAL_SECTION_DEBUG *__thiscall CClientSocket::GetLogTail(CClientSocket *this)
{
  return this->m_lockSend.DebugInfo;
}

//----- (0040D17D) --------------------------------------------------------
CClientSocket *__thiscall CClientSocket::`vector deleting destructor'(CClientSocket *this, unsigned int __flags)
{
  CClientSocket *v2; // esi@1

  v2 = this;
  CClientSocket::~CClientSocket(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0040D19D) --------------------------------------------------------
void __thiscall CClientSocket::~CClientSocket(CClientSocket *this)
{
  CClientSocket *v1; // esi@1
  CSecuritySession *v2; // edi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&CClientSocket::`vftable'{for `ZRefCounted'};
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&CClientSocket::`vftable'{for `ZOverlapped::ZICallBack'};
  this->vfptr = (CVerboseObjVtbl *)&CClientSocket::`vftable';
  v2 = this->m_pSecuritySession;
  if ( v2 )
  {
    CSecuritySession::~CSecuritySession(v2);
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  }
  if ( v1->m_pMxHelper.p )
  {
    ZRef<CMxHelperServerManager>::_ReleaseRaw(&v1->m_pMxHelper, 0);
    v1->m_pMxHelper.p = 0;
  }
  ZArray<unsigned char>::RemoveAll(&v1->m_oPacket.m_aSendBuff);
  ZXString<char>::~ZXString<char>(&v1->m_sAddr);
  v1->m_mNameWorldID.vfptr = (ZMap<ZXString<char>,unsigned long,ZXString<char> >Vtbl *)&ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable';
  ZMap<ZXString<char>,unsigned long,ZXString<char>>::RemoveAll(&v1->m_mNameWorldID);
  v1->m_mCharIDName.vfptr = (ZMap<unsigned long,ZXString<char>,unsigned long>Vtbl *)&ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable';
  ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveAll(&v1->m_mCharIDName);
  ZXString<char>::~ZXString<char>(&v1->m_sEventCharacterID);
  ZXString<char>::~ZXString<char>(&v1->m_sNexonClubID);
  ZXString<char>::~ZXString<char>(&v1->m_sId);
  ZArray<unsigned char>::RemoveAll(&v1->m_packetLoopback.m_aRecvBuff);
  ZArray<unsigned char>::RemoveAll(&v1->m_packetRecv.m_aRecvBuff);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lockSend.DebugInfo);
  ZSocketEx::~ZSocketEx((ZSocketEx *)&v1->vfptr);
}
// 4435DC: using guessed type const char *(__thiscall *CClientSocket::`vftable')(CClientSocket *__hidden this);
// 4435E4: using guessed type void (__thiscall *CClientSocket::`vftable'{for `ZOverlapped::ZICallBack'})(ZSocketEx *this, void *, unsigned __int32, unsigned __int32 dwErr, unsigned __int32);
// 4435F0: using guessed type int (__thiscall *CClientSocket::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443604: using guessed type int (__thiscall *ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable')(void *p, unsigned int __flags);
// 44360C: using guessed type int (__thiscall *ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (0040D2C2) --------------------------------------------------------
void __thiscall CSecuritySession::~CSecuritySession(CSecuritySession *this)
{
  CSecuritySession *v1; // esi@1

  v1 = this;
  CCSAuth2::~CCSAuth2(&this->m_Auth);
  ZArray<unsigned char>::RemoveAll(&v1->m_oPacket.m_aSendBuff);
}

//----- (0040D2F8) --------------------------------------------------------
int __thiscall CClientSocket::IsAdmin(CClientSocket *this)
{
  return this->m_nGradeCode & 1;
}

//----- (0040D304) --------------------------------------------------------
unsigned int __thiscall CClientSocket::IsLimitedIP(CClientSocket *this)
{
  return ((unsigned int)this->m_nGradeCode >> 3) & 1;
}

//----- (0040D313) --------------------------------------------------------
unsigned int __thiscall CClientSocket::IsSkipCrcIP(CClientSocket *this)
{
  return (CIPChecker::GetFlag(TSingleton<CIPChecker>::ms_pInstance, this->m_addr.sin_addr.S_un.S_addr) >> 2) & 1;
}

//----- (0040D32C) --------------------------------------------------------
int __thiscall CClientSocket::PostClose(CClientSocket *this)
{
  CClientSocket *v1; // esi@1
  int result; // eax@2
  COutPacket *v3; // eax@3
  COutPacket v4; // [sp+4h] [bp-1Ch]@3
  int v5; // [sp+1Ch] [bp-4h]@3

  v1 = this;
  if ( InterlockedCompareExchange(&this->m_bClosePosted, 1, 0) )
  {
    result = 0;
  }
  else
  {
    COutPacket::COutPacket(&v4, 14, 1);
    v5 = 0;
    CClientSocket::SendPacket(v1, v3, 1);
    v5 = -1;
    ZArray<unsigned char>::RemoveAll(&v4.m_aSendBuff);
    result = 1;
  }
  return result;
}

//----- (0040D38B) --------------------------------------------------------
int __thiscall CClientSocket::PostUpdate(CClientSocket *this, int tCur, COutPacket *oPacket)
{
  CClientSocket *v3; // esi@1
  int result; // eax@3

  v3 = this;
  if ( tCur - this->m_tLastUpdateTime < 5000 || InterlockedCompareExchange(&this->m_bUpdatePosted, 1, 0) )
  {
    result = 0;
  }
  else
  {
    v3->m_tLastUpdateTime = tCur;
    CClientSocket::SendPacket(v3, oPacket, 0);
    result = 1;
  }
  return result;
}

//----- (0040D3D6) --------------------------------------------------------
void __thiscall CClientSocket::SendPacket(CClientSocket *this, COutPacket *oPacket, int bForce)
{
  int v3; // ebp@0
  CClientSocket *v4; // esi@1
  struct _RTL_CRITICAL_SECTION *v5; // edi@1
  bool v6; // zf@5
  ZRef<ZSocketBuffer> *v7; // edi@6
  ZSocketBuffer *v8; // ST10_4@8
  int v9; // [sp+0h] [bp-3Ch]@1
  ZList<ZRef<ZSocketBuffer> > l; // [sp+Ch] [bp-30h]@5
  CClientSocket *v11; // [sp+24h] [bp-18h]@1
  ZCriticalSectionEx<4000> *v12; // [sp+28h] [bp-14h]@1
  int *v13; // [sp+2Ch] [bp-10h]@1
  int v14; // [sp+38h] [bp-4h]@1

  v4 = this;
  v5 = (struct _RTL_CRITICAL_SECTION *)&this->m_lockSend.DebugInfo;
  v13 = &v9;
  v11 = this;
  v14 = 0;
  v12 = &this->m_lockSend;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo);
  LOBYTE(v14) = 1;
  if ( !v4->m_bClosePosted || bForce )
  {
    l._m_uCount = 0;
    l._m_pHead = 0;
    l._m_pTail = 0;
    l.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
    v6 = oPacket->m_bLoopback == 0;
    LOBYTE(v14) = 2;
    if ( v6 )
    {
      COutPacket::MakeBufferList(oPacket, v3, &l, 0xFFFEu, &v4->m_uSeqSnd, 1, v4->m_uSeqSnd);
      v4->m_uSeqSnd = CIGCipher::innoHash((char *)&v4->m_uSeqSnd, 4, 0);
      ZSocketEx::SendPacket((ZSocketEx *)&v4->vfptr, &l);
    }
    else
    {
      COutPacket::MakeBufferList(oPacket, v3, &l, 0, 0, 0, 0);
      v7 = l._m_pHead;
      while ( v7 )
      {
        v8 = v7->p;
        v7 = (ZRef<ZSocketBuffer> *)(v7[-2].p != 0 ? &v7[-2].p->buf : 0);
        ZSocketEx::LoopBackPacket((ZSocketEx *)&v4->vfptr, v8);
      }
    }
    LOBYTE(v14) = 1;
    l.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
    ZList<ZRef<ZSocketBuffer>>::RemoveAll(&l);
    LeaveCriticalSection((LPCRITICAL_SECTION)&v12->DebugInfo);
  }
  else
  {
    LeaveCriticalSection(v5);
  }
}
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);

//----- (0040D4CA) --------------------------------------------------------
void *__usercall _L125551@<eax>(int a1@<ebp>)
{
  CClientSocket *v1; // esi@1

  v1 = *(CClientSocket **)(a1 - 24);
  CVerboseObj::LogException((CVerboseObj *)&v1->vfptr, *(ZException **)(a1 - 28));
  CClientSocket::PostClose(v1);
  return &_L115553;
}

//----- (0040D4E8) --------------------------------------------------------
void __thiscall CClientSocket::ResetLoginState(CClientSocket *this, int nLoginState)
{
  CClientSocket *v2; // esi@1
  bool v3; // zf@3

  v2 = this;
  if ( this->m_dwAccountId )
  {
    EnterCriticalSection(&CClientSocket::ms_lockClient);
    ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveKey(&CClientSocket::ms_mClient, &v2->m_dwAccountId);
    LeaveCriticalSection(&CClientSocket::ms_lockClient);
  }
  ZXString<char>::Empty(&v2->m_sId);
  v2->m_nWorldId = -1;
  v2->m_nChannelId = -1;
  v2->m_dwAccountId = 0;
  v2->m_dwCharacterId = 0;
  v2->m_nRegStatID = 0;
  v2->m_nUseDay = 0;
  COutPacket::Init(&v2->m_oPacket, 2, 1);
  v3 = v2->m_nLoginState == nLoginState;
  v2->m_bProcessed = 0;
  v2->m_tIPCheckRequestSent = 0;
  v2->m_bTempBlockedIP = 0;
  v2->m_bPremium = 0;
  if ( v3 )
  {
    if ( ++v2->m_nFailCount > 5 )
      CClientSocket::PostClose(v2);
  }
  else
  {
    v2->m_nFailCount = 0;
  }
  v2->m_nLoginState = nLoginState;
  if ( nLoginState == 1 )
    v2->m_bIsPinCodeChecked = 0;
}

//----- (0040D5D9) --------------------------------------------------------
void __thiscall CClientSocket::SendDisconnectPacket(CClientSocket *this)
{
  CClientSocket *v1; // esi@1
  unsigned int v2; // ST04_4@1
  int v3; // esi@1
  signed int v4; // edi@2
  int i; // edx@2
  CCenter *v6; // eax@3
  CCenter *v7; // eax@6
  COutPacket oPacket; // [sp+4h] [bp-1Ch]@1
  int v9; // [sp+1Ch] [bp-4h]@1

  v1 = this;
  COutPacket::COutPacket(&oPacket, 4, 0);
  v2 = v1->m_uLocalSocketSN;
  v9 = 0;
  COutPacket::Encode4(&oPacket, v2);
  COutPacket::Encode4(&oPacket, v1->m_dwAccountId);
  v3 = v1->m_nWorldId;
  if ( v3 >= 0 )
  {
    v4 = 0;
    for ( i = 0; ; ++i )
    {
      v6 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
      if ( v6 )
        v6 = (CCenter *)v6[-1].m_mServerStatus._m_uAutoGrowLimit;
      if ( v4 >= (signed int)v6 )
        break;
      v7 = &TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i];
      if ( v7->m_nWorldId == v3 )
        goto LABEL_9;
      ++v4;
    }
    v7 = 0;
LABEL_9:
    if ( v7 )
      CCenter::SendPacket(v7, &oPacket);
  }
  v9 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (0040D673) --------------------------------------------------------
void __thiscall CClientSocket::SendRemoveUserMigrateTimeout(CClientSocket *this)
{
  int v1; // edi@1
  CClientSocket *v2; // esi@1
  signed int v3; // ebx@1
  CCenter *v4; // eax@2
  CCenter *v5; // eax@5
  int v6; // edx@5
  CCenter *v7; // eax@5
  COutPacket oPacket; // [sp+Ch] [bp-1Ch]@1
  int v9; // [sp+24h] [bp-4h]@1

  v1 = 0;
  v2 = this;
  COutPacket::COutPacket(&oPacket, 64, 0);
  v9 = 0;
  COutPacket::Encode4(&oPacket, 1u);
  COutPacket::Encode4(&oPacket, v2->m_uLocalSocketSN);
  COutPacket::Encode4(&oPacket, v2->m_dwAccountId);
  v3 = 0;
  while ( 1 )
  {
    v4 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
    if ( v4 )
      v4 = (CCenter *)v4[-1].m_mServerStatus._m_uAutoGrowLimit;
    if ( v3 >= (signed int)v4 )
      break;
    v5 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
    v6 = v5[v1].m_nWorldId;
    v7 = &v5[v1];
    if ( v6 == v2->m_nWorldId )
      goto LABEL_8;
    ++v3;
    ++v1;
  }
  v7 = 0;
LABEL_8:
  CCenter::SendPacket(v7, &oPacket);
  v9 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (0040D710) --------------------------------------------------------
void __thiscall CClientSocket::SendWorldInformation(CClientSocket *this)
{
  CLoginApp *v1; // eax@1
  CCenter *v2; // ecx@2
  int v3; // ecx@3
  CCenter *v4; // ecx@7
  int v5; // ecx@8
  CCenter *v6; // esi@11
  signed int v7; // edi@13
  char *v8; // eax@13
  char v9; // al@13
  char *v10; // ecx@13
  int v11; // edi@15
  bool v12; // zf@16
  ZXString<char> v13; // [sp-4h] [bp-64h]@13
  COutPacket v14; // [sp+Ch] [bp-54h]@21
  COutPacket oPacket; // [sp+1Ch] [bp-44h]@13
  ZXString<char> *v16; // [sp+2Ch] [bp-34h]@19
  CLoginApp *v17; // [sp+30h] [bp-30h]@1
  CClientSocket *v18; // [sp+34h] [bp-2Ch]@1
  char *sFormat; // [sp+38h] [bp-28h]@13
  unsigned int v20; // [sp+3Ch] [bp-24h]@1
  char n[4]; // [sp+40h] [bp-20h]@13
  int i; // [sp+44h] [bp-1Ch]@15
  int v23; // [sp+48h] [bp-18h]@15
  int v24; // [sp+4Ch] [bp-14h]@1
  ZXString<char> s; // [sp+50h] [bp-10h]@16
  int v26; // [sp+5Ch] [bp-4h]@13

  v1 = TSingleton<CServerApp>::ms_pInstance;
  v18 = this;
  v17 = TSingleton<CServerApp>::ms_pInstance;
  v24 = 0;
  v20 = 0;
  while ( 1 )
  {
    v2 = v1->m_aCenter.a;
    v3 = v2 ? v2[-1].m_mServerStatus._m_uAutoGrowLimit : 0;
    if ( v24 >= v3 )
      break;
    if ( (v20 & 0x80000000) != 0
      || ((v4 = v1->m_aCenter.a) != 0 ? (v5 = v4[-1].m_mServerStatus._m_uAutoGrowLimit) : (v5 = 0), v24 >= v5) )
    {
      v6 = 0;
    }
    else
    {
      v6 = &v1->m_aCenter.a[v20 / 0x7C];
    }
    v7 = v6->m_nAdultChannelNo;
    *(_DWORD *)n = v6->m_nChannelNo;
    COutPacket::COutPacket(&oPacket, 5, 0);
    v13._m_pStr = (char *)v6->m_nWorldId;
    v26 = 0;
    COutPacket::Encode1(&oPacket, (char)v13._m_pStr);
    v8 = CCenter::GetName(v6);
    sFormat = (char *)&v13;
    v13._m_pStr = 0;
    ZXString<char>::Assign(&v13, v8, -1);
    COutPacket::EncodeStr(&oPacket, v13);
    v9 = CCenter::GetWorldState(v6);
    COutPacket::Encode1(&oPacket, v9);
    v13._m_pStr = v10;
    sFormat = (char *)&v13;
    CCenter::GetWorldEventDesc(v6, &v13);
    COutPacket::EncodeStr(&oPacket, v13);
    COutPacket::Encode2(&oPacket, v6->m_nEventEXP_WSE);
    COutPacket::Encode2(&oPacket, v6->m_nEventDrop_WSE);
    COutPacket::Encode1(&oPacket, v6->m_nBlockCharCreation);
    COutPacket::Encode1(&oPacket, n[0]);
    sFormat = aSOver20d;
    if ( v7 <= 1 )
      sFormat = aSOver20;
    v11 = 0;
    v23 = 0;
    for ( i = 0; v11 < *(_DWORD *)n; ++v11 )
    {
      s._m_pStr = 0;
      v12 = v6->m_aAdultChannel.a[v11] == 0;
      LOBYTE(v26) = 1;
      if ( v12 )
      {
        v13._m_pStr = (char *)++v23;
        ZXString<char>::Format(&s, aSD_1, v6->m_sName._m_pStr, v23);
      }
      else
      {
        ZXString<char>::Format(&s, sFormat, v6->m_sName._m_pStr, ++i);
      }
      v16 = &v13;
      v13._m_pStr = 0;
      ZXString<char>::operator=(&v13, &s);
      COutPacket::EncodeStr(&oPacket, v13);
      COutPacket::Encode4(&oPacket, v6->m_aUserNo.a[v11]);
      COutPacket::Encode1(&oPacket, v6->m_nWorldId);
      COutPacket::Encode1(&oPacket, v11);
      COutPacket::Encode1(&oPacket, v6->m_aAdultChannel.a[v11]);
      LOBYTE(v26) = 0;
      ZXString<char>::~ZXString<char>(&s);
    }
    CClientSocket::SendPacket(v18, &oPacket, 0);
    v26 = -1;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
    ++v24;
    v20 += 124;
    v1 = v17;
  }
  COutPacket::COutPacket(&v14, 5, 0);
  v26 = 2;
  COutPacket::Encode1(&v14, -1);
  CClientSocket::SendPacket(v18, &v14, 0);
  v26 = -1;
  ZArray<unsigned char>::RemoveAll(&v14.m_aSendBuff);
}

//----- (0040D928) --------------------------------------------------------
void __thiscall COutPacket::Encode2(COutPacket *this, unsigned __int16 n)
{
  COutPacket *v2; // esi@1

  v2 = this;
  COutPacket::EnlargeBuffer(this, 2u);
  *(_WORD *)&v2->m_aSendBuff.a[v2->m_uOffset] = n;
  v2->m_uOffset += 2;
}

//----- (0040D949) --------------------------------------------------------
void __thiscall COutPacket::EncodeStr(COutPacket *this, ZXString<char> s)
{
  COutPacket *v2; // esi@1
  int v3; // eax@2
  char *v4; // ecx@4
  ZXString<char> v5; // [sp-8h] [bp-1Ch]@4
  char *v6; // [sp-4h] [bp-18h]@4
  ZXString<char> *v7; // [sp+4h] [bp-10h]@4
  int v8; // [sp+10h] [bp-4h]@1

  v2 = this;
  v8 = 0;
  if ( s._m_pStr )
    v3 = *((_DWORD *)s._m_pStr - 1);
  else
    v3 = 0;
  COutPacket::EnlargeBuffer(this, v3 + 2);
  v6 = &v2->m_aSendBuff.a[v2->m_uOffset];
  v5._m_pStr = v4;
  v7 = &v5;
  ZXString<char>::ZXString<char>(&v5, &s);
  v2->m_uOffset += CIOBufferManipulator::EncodeStr(v5, v6);
  v8 = -1;
  ZXString<char>::~ZXString<char>(&s);
}

//----- (0040D9AF) --------------------------------------------------------
char *__thiscall CCenter::GetName(CCenter *this)
{
  return this->m_sName._m_pStr;
}

//----- (0040D9B3) --------------------------------------------------------
int __thiscall CCenter::GetWorldState(CCenter *this)
{
  CCenter *v1; // esi@1
  int result; // eax@4
  _SYSTEMTIME stCur; // [sp+4h] [bp-10h]@2

  v1 = this;
  if ( this->m_nWorldState_WSE && (GetLocalTime(&stCur), stCur.wHour >= 0xDu) && stCur.wHour < 0x13u )
    result = v1->m_nWorldState_WSE;
  else
    result = v1->m_nWorldState;
  return result;
}

//----- (0040D9E5) --------------------------------------------------------
ZXString<char> *__thiscall CCenter::GetWorldEventDesc(CCenter *this, ZXString<char> *result)
{
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, &this->m_sWorldEventDesc);
  return result;
}

//----- (0040DA06) --------------------------------------------------------
void __cdecl CClientSocket::OnReceive(unsigned int dwErr, ZSocketBuffer *pBuff)
{
  CClientSocket *this; // ecx@0
  int v3; // ebp@0
  CClientSocket *v4; // esi@1
  int v5; // eax@10
  unsigned int v6; // eax@19
  unsigned int *v7; // edi@19
  int v8; // eax@20
  int v9; // eax@23
  char *v10; // [sp-Ch] [bp-48h]@19
  int v11; // [sp+0h] [bp-3Ch]@1
  int *v12; // [sp+Ch] [bp-30h]@6
  int v13; // [sp+10h] [bp-2Ch]@6
  ZRef<ZSocketBuffer> pBuffa; // [sp+14h] [bp-28h]@4
  int v15; // [sp+20h] [bp-1Ch]@17
  int v16; // [sp+24h] [bp-18h]@14
  CClientSocket *v17; // [sp+28h] [bp-14h]@1
  int *v18; // [sp+2Ch] [bp-10h]@1
  int v19; // [sp+38h] [bp-4h]@4

  v4 = this;
  v18 = &v11;
  v17 = this;
  if ( dwErr )
  {
    CVerboseObj::LogException((CVerboseObj *)&this->vfptr, (ZException *)&dwErr);
LABEL_26:
    CClientSocket::PostClose(v4);
    return;
  }
  if ( !pBuff || !this->m_posList )
    goto LABEL_26;
  pBuffa.p = pBuff;
  v19 = 0;
  InterlockedIncrement(&pBuff->_m_nRef);
  if ( pBuffa.p->_m_pPrev )
  {
    while ( pBuffa.p )
    {
      v12 = &v4->m_packetLoopback.m_bLoopback;
      v13 = 1;
      LOBYTE(v19) = 2;
      if ( CInPacket::AppendBuffer(&v4->m_packetLoopback, &pBuffa, 0, 0) == 2 )
      {
        CClientSocket::ProcessPacket(v4, &v4->m_packetLoopback);
        v4->m_packetLoopback.m_nState = 0;
        v4->m_packetLoopback.m_uLength = 0;
        v4->m_packetLoopback.m_uOffset = 0;
      }
      else
      {
        v13 = 0;
      }
    }
  }
  else
  {
    while ( pBuffa.p )
    {
      v12 = &v4->m_packetRecv.m_bLoopback;
      v13 = 1;
      LOBYTE(v19) = 3;
      v5 = CInPacket::AppendBuffer(&v4->m_packetRecv, &pBuffa, (int *)&dwErr, 1);
      if ( v5 > 0 && (signed int)dwErr <= 0 )
      {
        if ( (v4->m_packetRecv.m_uRawSeq ^ (v4->m_uSeqRcv >> 16)) != 1 )
        {
          CVerboseObj::LogError((CVerboseObj *)&v4->vfptr, aIncorrectPacke);
          v16 = -2147467259;
          _CxxThrowException(&v16, &_TI1_AVZException__);
        }
        if ( v4->m_packetRecv.m_uDataLen > 0x4000u )
        {
          CVerboseObj::LogError((CVerboseObj *)&v4->vfptr, aReceivedPacket);
          v15 = -2147467259;
          _CxxThrowException(&v15, &_TI1_AVZException__);
        }
      }
      if ( v5 == 2 )
      {
        v6 = v4->m_uSeqRcv;
        v7 = &v4->m_uSeqRcv;
        v4->m_uSeqRcvLast = v6;
        v10 = (char *)&v4->m_uSeqRcv;
        if ( !CInPacket::DecryptData(&v4->m_packetRecv, v3, v6) )
        {
          *v7 = CIGCipher::innoHash(v10, 4, 0);
          CVerboseObj::LogError((CVerboseObj *)&v4->vfptr, aDecryptdataFai);
          v8 = (int)v12;
          v12[1] = 0;
          *(_WORD *)(v8 + 12) = 0;
          *(_DWORD *)(v8 + 20) = 0;
          break;
        }
        *v7 = CIGCipher::innoHash(v10, 4, 0);
        CClientSocket::ProcessPacket(v4, &v4->m_packetRecv);
        v9 = (int)v12;
        v12[1] = 0;
        *(_WORD *)(v9 + 12) = 0;
        *(_DWORD *)(v9 + 20) = 0;
      }
      else
      {
        v13 = 0;
      }
    }
  }
  LOBYTE(v19) = 0;
  if ( pBuffa.p )
    ZRef<ZSocketBuffer>::_ReleaseRaw(&pBuffa, 0);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040DC54) --------------------------------------------------------
void __thiscall CClientSocket::ProcessPacket(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  int v3; // ebx@1
  int v4; // ebx@32
  int v5; // ebx@33
  int v6; // ebx@34
  int v7; // ebx@35
  int v8; // ebx@43
  int v9; // ebx@44
  int v10; // ebx@45
  int v11; // ebx@46

  v2 = this;
  v3 = CInPacket::Decode2(iPacket);
  v2->_m_nType = (unsigned __int16)v3;
  if ( iPacket->m_bLoopback )
  {
    if ( v3 > 9 )
    {
      v8 = v3 - 13;
      if ( v8 )
      {
        v9 = v8 - 1;
        if ( v9 )
        {
          v10 = v9 - 1;
          if ( v10 )
          {
            v11 = v10 - 1;
            if ( v11 )
            {
              if ( v11 == 1 )
$L115695:
                CClientSocket::OnSelectCharacter(v2, iPacket);
            }
            else
            {
              CClientSocket::OnCenterSelectCharacterByVACResult(v2, iPacket);
            }
          }
          else
          {
            CClientSocket::OnCenterViewAllCharResult(v2, iPacket);
          }
        }
        else
        {
          CClientSocket::OnClose(v2, iPacket);
        }
      }
      else
      {
        CClientSocket::OnUpdate(v2, iPacket);
      }
    }
    else if ( v3 == 9 )
    {
      CClientSocket::OnCenterCheckUserLimitResult(v2, iPacket);
    }
    else
    {
      v4 = v3 - 1;
      if ( v4 )
      {
        v5 = v4 - 1;
        if ( v5 )
        {
          v6 = v5 - 1;
          if ( v6 )
          {
            v7 = v6 - 4;
            if ( v7 )
            {
              if ( v7 == 1 )
                CClientSocket::OnCenterDeleteCharacterResult(v2, iPacket);
            }
            else
            {
              CClientSocket::OnCenterCreateNewCharacterResult(v2, iPacket);
            }
          }
          else
          {
            CClientSocket::OnCenterCheckDuplicatedIDResult(v2, iPacket);
          }
        }
        else
        {
          CClientSocket::OnCenterSelectCharacterResult(v2, iPacket);
        }
      }
      else
      {
        CClientSocket::OnCenterLoginResult(v2, iPacket);
      }
    }
  }
  else
  {
    if ( !CSecuritySession::PreProcessPacket(v2->m_pSecuritySession, v3, iPacket, v2->m_uSeqRcvLast) )
      return;
    if ( v3 > 174 )
    {
      if ( v3 == 175 )
        CClientSocket::OnCheckSPWOnCreateNewCharacter(v2, iPacket);
    }
    else if ( v3 == 174 )
    {
      CClientSocket::OnCheckSSN2OnCreateNewCharacter(v2, iPacket);
    }
    else
    {
      switch ( v3 )
      {
        case 27:
          CClientSocket::OnCheckPassword(v2, iPacket);
          break;
        case 2:
          CClientSocket::OnWorldInfoRequest(v2, iPacket);
          break;
        case 25:
          CClientSocket::OnSelectWorld(v2, iPacket);
          break;
        case 9:
          CClientSocket::OnCheckDuplicatedID(v2, iPacket);
          break;
        case 14:
          CClientSocket::OnCreateNewCharacter(v2, iPacket);
          break;
        case 15:
          CClientSocket::OnDeleteCharacter(v2, iPacket);
          break;
        case 26:
          CClientSocket::OnCheckGameGuardUpdated(v2, iPacket);
          break;
        case 28:
          CClientSocket::OnEnableSPW(v2, iPacket);
          break;
        case 29:
          CClientSocket::OnCheckSPW(v2, iPacket);
          break;
        case 24:
          CClientSocket::OnWorldRequest(v2, iPacket);
          break;
        case 21:
          CClientSocket::OnConfirmEULA(v2, iPacket);
          break;
        case 23:
          CClientSocket::OnSetGender(v2, iPacket);
          break;
        case 3:
          CClientSocket::OnCheckPinCode(v2, iPacket);
          break;
        case 5:
          CClientSocket::OnUpdatePinCode(v2, iPacket);
          break;
        case 19:
          CClientSocket::OnCheckUserLimit(v2, iPacket);
          break;
        case 4:
          CClientSocket::OnLogoutWorld(v2, iPacket);
          break;
        case 6:
          CClientSocket::OnViewAllChar(v2, iPacket);
          break;
        case 7:
          CClientSocket::OnSelectCharacterByVAC(v2, iPacket);
          break;
        case 8:
          CClientSocket::OnVACFlagSet(v2, iPacket);
          break;
        case 10:
          CClientSocket::OnAliveAck(v2, iPacket);
          break;
        case 16:
          CClientSocket::OnExceptionLog(v2, iPacket);
          break;
        case 22:
          goto $L115695;
        default:
          break;
      }
    }
  }
  v2->_m_nType = -1;
}

//----- (0040DF00) --------------------------------------------------------
void __thiscall CClientSocket::OnCheckPassword(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  CInPacket *v3; // edi@3
  ZXString<char> *v4; // eax@3
  ZXString<char> *v5; // eax@3
  ZXString<char> *v6; // eax@3
  int v7; // eax@6
  char *v8; // eax@9
  DWORD v9; // edi@18
  IUnknownVtbl *v10; // ecx@20
  int v11; // eax@20
  ZXString<char> *v12; // ecx@28
  _bstr_t::Data_t *v13; // ecx@32
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v14; // eax@32
  IWzResMan *v15; // eax@32
  Ztl_variant_t *v16; // eax@32
  int v17; // eax@33
  int v18; // eax@36
  int v19; // eax@38
  int v20; // eax@40
  char *v21; // ecx@40
  IWzProperty *v22; // eax@42
  Ztl_variant_t *v23; // eax@42
  unsigned int v24; // edi@42
  int v25; // eax@42
  IUnknownVtbl *v26; // ecx@60
  Ztl_bstr_t v27; // [sp-14h] [bp-98h]@32
  Ztl_variant_t *v28; // [sp-Ch] [bp-90h]@20
  char *v29; // [sp-8h] [bp-8Ch]@20
  char *v30; // [sp-4h] [bp-88h]@5
  Ztl_variant_t v31; // [sp+Ch] [bp-78h]@42
  Ztl_variant_t v32; // [sp+1Ch] [bp-68h]@32
  _variant_t v33; // [sp+2Ch] [bp-58h]@32
  COutPacket oPacket; // [sp+3Ch] [bp-48h]@11
  COutPacket v35; // [sp+4Ch] [bp-38h]@50
  int v36; // [sp+5Ch] [bp-28h]@5
  IUnknown *punk; // [sp+60h] [bp-24h]@16
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v38; // [sp+64h] [bp-20h]@32
  unsigned __int16 *pbsNexonClubID; // [sp+68h] [bp-1Ch]@16
  ZXString<char> s; // [sp+6Ch] [bp-18h]@5
  ZXString<char> v41; // [sp+70h] [bp-14h]@5
  ZXString<char> result; // [sp+74h] [bp-10h]@3
  int v43; // [sp+80h] [bp-4h]@3

  v2 = this;
  if ( this->m_nLoginState != 1 )
  {
    CClientSocket::PostClose(this);
    return;
  }
  v3 = iPacket;
  v4 = CInPacket::DecodeStr(iPacket, &result);
  v43 = 0;
  v5 = ZXString<char>::TrimRight(v4, 0);
  v6 = ZXString<char>::TrimLeft(v5, 0);
  ZXString<char>::operator=(&v2->m_sId, v6);
  v43 = -1;
  if ( result._m_pStr )
    ZXString<char>::_Release((ZXString<char>::_ZXStringData *)result._m_pStr - 1);
  CInPacket::DecodeStr(v3, &s);
  v36 = (int)&v30;
  v43 = 1;
  ZXString<char>::operator=((ZXString<char> *)&v30, &s);
  MD5_digest_string(&v41, 0);
  LOBYTE(v43) = 2;
  CInPacket::DecodeBuffer(v3, &v2->m_machineId, 0x10u);
  v2->m_dwGameRoomCode = CInPacket::Decode4(v3);
  v2->m_nGameStartMode = (unsigned __int8)CInPacket::Decode1(v3);
  v2->m_bAdminclient = (unsigned __int8)CInPacket::Decode1(v3);
  if ( !TSingleton<CLoginAcceptor>::ms_pInstance->m_bIsWebDead )
  {
    v7 = v2->m_nGameStartMode;
    if ( !v7 || v7 == 1 )
    {
      CClientSocket::PostClose(v2);
LABEL_12:
      LOBYTE(v43) = 1;
      if ( v41._m_pStr )
        ZXString<char>::_Release((ZXString<char>::_ZXStringData *)v41._m_pStr - 1);
      v43 = -1;
      if ( s._m_pStr )
        ZXString<char>::_Release((ZXString<char>::_ZXStringData *)s._m_pStr - 1);
      return;
    }
  }
  v8 = v2->m_sId._m_pStr;
  if ( !v8 || !*v8 )
  {
    COutPacket::COutPacket(&oPacket, 0, 0);
    LOBYTE(v43) = 3;
    COutPacket::Encode1(&oPacket, 6);
    CClientSocket::SendPacket(v2, &oPacket, 0);
    CClientSocket::PostClose(v2);
    LOBYTE(v43) = 2;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
    goto LABEL_12;
  }
  pbsNexonClubID = 0;
  punk = (IUnknown *)timeGetTime();
  result._m_pStr = v2->m_sId._m_pStr;
  if ( !g_pDB.m_pInterface )
    _com_issue_error(-2147467261);
  result._m_pStr = (char *)IWvsUnifiedDB::CheckPassword(
                             g_pDB.m_pInterface,
                             result._m_pStr,
                             v41._m_pStr,
                             0,
                             7,
                             30,
                             &v2->m_dwAccountId,
                             &v2->m_nGender,
                             &v2->m_nBirthDate,
                             &v2->m_nCountryID,
                             &v2->m_nGradeCode,
                             &pbsNexonClubID,
                             &v2->m_nRegStatID,
                             &v2->m_nUseDay,
                             &v2->m_nPurchaseExp,
                             &v2->m_nBlockReason,
                             &v2->m_dtUnblockDate,
                             &v2->m_nChatBlockReason,
                             &v2->m_dtChatUnblockDate,
                             &v2->m_nPrivateStatusID,
                             &v2->m_dtRegisterDate);
  v9 = timeGetTime() - (_DWORD)punk;
  if ( !g_pDB.m_pInterface )
    _com_issue_error(-2147467261);
  v10 = g_pDB.m_pInterface->vfptr;
  v30 = (char *)&v36;
  v29 = (char *)&iPacket + 3;
  v28 = (Ztl_variant_t *)v2->m_dwAccountId;
  punk = (IUnknown *)g_pDB.m_pInterface;
  v11 = ((int (__stdcall *)(IWvsUnifiedDB *, Ztl_variant_t *, char *, int *))v10[2].Release)(
          g_pDB.m_pInterface,
          v28,
          (char *)&iPacket + 3,
          &v36);
  if ( v11 < 0 )
    _com_issue_errorex(v11, punk, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
  if ( v36 == 2 )
    result._m_pStr = (char *)6;
  EnterCriticalSection(&CClientSocket::ms_lockStat);
  ++CClientSocket::ms_nCheckPassword;
  CClientSocket::ms_tCheckPassword_SP += v9;
  LeaveCriticalSection(&CClientSocket::ms_lockStat);
  if ( CClientSocket::IsAdmin(v2)
    && CClientSocket::IsLimitedIP(v2)
    && !(CIPChecker::GetFlag(TSingleton<CIPChecker>::ms_pInstance, v2->m_addr.sin_addr.S_un.S_addr) & 2) )
  {
    COutPacket::COutPacket(&oPacket, 0, 0);
    LOBYTE(v43) = 4;
    COutPacket::Encode1(&oPacket, 13);
    CClientSocket::SendPacket(v2, &oPacket, 0);
    CClientSocket::PostClose(v2);
    LOBYTE(v43) = 2;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
  }
  else
  {
    v12 = &v2->m_sNexonClubID;
    if ( pbsNexonClubID )
    {
      ZXString<char>::Assign(v12, (int)pbsNexonClubID, -1);
      if ( pbsNexonClubID )
        dword_4A4900(pbsNexonClubID - 2);
    }
    else
    {
      ZXString<char>::Empty(v12);
    }
    _variant_t::_variant_t(&v33, &vtMissing);
    LOBYTE(v43) = 5;
    _variant_t::_variant_t((_variant_t *)&oPacket, &vtMissing);
    v30 = 0;
    v27.m_Data = v13;
    punk = (IUnknown *)&v27;
    LOBYTE(v43) = 6;
    Ztl_bstr_t::Ztl_bstr_t(&v27, aStringTesteula);
    LOBYTE(v43) = 6;
    v14 = get_rm();
    v15 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v14);
    v16 = IWzResMan::GetObjectA(v15, &v32, v27, (Ztl_variant_t *)&oPacket, (Ztl_variant_t *)&v33);
    LOBYTE(v43) = 8;
    v36 = (int)Ztl_variant_t::GetUnknown(v16, 0, (char)v30);
    v38.m_pInterface = 0;
    if ( v36 )
    {
      v17 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v38,
              (int)&v36);
      if ( v17 < 0 && v17 != -2147467262 )
        _com_issue_error(v17);
    }
    LOBYTE(v43) = 12;
    v18 = ZComAPI::ZComVariantClear((tagVARIANT *)&v32.0);
    if ( v18 < 0 )
      _com_issue_error(v18);
    LOBYTE(v43) = 11;
    v19 = ZComAPI::ZComVariantClear((tagVARIANT *)&oPacket);
    if ( v19 < 0 )
      _com_issue_error(v19);
    LOBYTE(v43) = 10;
    v20 = ZComAPI::ZComVariantClear((tagVARIANT *)&v33.0);
    v21 = v30;
    if ( v20 < 0 )
      _com_issue_error(v20);
    v30 = 0;
    v29 = v21;
    punk = (IUnknown *)&v29;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v29, aNumber);
    v28 = &v31;
    LOBYTE(v43) = 10;
    v22 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v38);
    v23 = IWzProperty::Getitem(v22, v28, (Ztl_bstr_t)v29);
    LOBYTE(v43) = 14;
    v24 = get_int32(v23, (int)v30);
    LOBYTE(v43) = 10;
    v25 = ZComAPI::ZComVariantClear((tagVARIANT *)&v31.0);
    if ( v25 < 0 )
      _com_issue_error(v25);
    if ( BYTE3(iPacket) != v24 && !result._m_pStr )
      result._m_pStr = (char *)23;
    if ( v2->m_bIPBlockType == 2 && v2->m_dwAccountId > TSingleton<CIPFilter>::ms_pInstance->m_dwMaxUnlimitedAccountID )
      result._m_pStr = (char *)25;
    COutPacket::COutPacket(&v35, 0, 0);
    LOBYTE(v43) = 15;
    COutPacket::Encode1(&v35, (char)result._m_pStr);
    COutPacket::Encode1(&v35, v2->m_nRegStatID);
    COutPacket::Encode4(&v35, v2->m_nUseDay);
    if ( result._m_pStr == (char *)2 )
    {
      COutPacket::Encode1(&v35, v2->m_nBlockReason);
      COutPacket::EncodeBuffer(&v35, &v2->m_dtUnblockDate, 8u);
    }
    if ( !result._m_pStr )
    {
      COutPacket::Encode4(&v35, v2->m_dwAccountId);
      COutPacket::Encode1(&v35, v2->m_nGender);
      COutPacket::Encode1(&v35, v2->m_nGradeCode);
      COutPacket::Encode1(&v35, v2->m_nCountryID);
      punk = (IUnknown *)&v30;
      v30 = 0;
      ZXString<char>::operator=((ZXString<char> *)&v30, &v2->m_sNexonClubID);
      COutPacket::EncodeStr(&v35, (ZXString<char>)v30);
      COutPacket::Encode1(&v35, v2->m_nPurchaseExp);
      COutPacket::Encode1(&v35, v2->m_nChatBlockReason);
      COutPacket::EncodeBuffer(&v35, &v2->m_dtChatUnblockDate, 8u);
      COutPacket::EncodeBuffer(&v35, &v2->m_dtRegisterDate, 8u);
    }
    CClientSocket::SendPacket(v2, &v35, 0);
    if ( result._m_pStr )
    {
      if ( result._m_pStr == (char *)23 )
        v2->m_nLoginState = 2;
      else
        CClientSocket::ResetLoginState(v2, 1);
    }
    else
    {
      v2->m_nLoginState = (v2->m_nGender != 10) + 3;
    }
    LOBYTE(v43) = 10;
    ZArray<unsigned char>::RemoveAll(&v35.m_aSendBuff);
    LOBYTE(v43) = 2;
    if ( v38.m_pInterface )
    {
      v26 = v38.m_pInterface->vfptr;
      v30 = (char *)v38.m_pInterface;
      v26->Release((IUnknown *)v38.m_pInterface);
    }
  }
  LOBYTE(v43) = 1;
  ZXString<char>::~ZXString<char>(&v41);
  v43 = -1;
  ZXString<char>::~ZXString<char>(&s);
}
// 4A4318: using guessed type __int32 CClientSocket::ms_nCheckPassword;
// 4A431C: using guessed type __int32 CClientSocket::ms_tCheckPassword_SP;
// 4A4900: using guessed type int (__stdcall *dword_4A4900)(_DWORD);

//----- (0040E509) --------------------------------------------------------
void __thiscall CInPacket::DecodeBuffer(CInPacket *this, void *p, unsigned int uSize)
{
  CInPacket *v3; // esi@1
  int v4; // edx@1
  unsigned int v5; // ecx@1
  unsigned int v6; // edi@1

  v3 = this;
  v4 = this->m_uLength;
  v5 = this->m_uOffset;
  v6 = uSize;
  if ( v4 - v5 < uSize )
  {
    uSize = 38;
    _CxxThrowException(&uSize, &_TI1_AVZException__);
  }
  memcpy(p, &v3->m_aRecvBuff.a[v5], uSize);
  v3->m_uOffset += v6;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040E550) --------------------------------------------------------
void __thiscall CClientSocket::OnWorldInfoRequest(CClientSocket *this, CInPacket *iPacket)
{
  if ( this->m_nLoginState == 1 || this->m_bIsVACDlgOn )
    CClientSocket::SendWorldInformation(this);
  else
    CClientSocket::PostClose(this);
}

//----- (0040E571) --------------------------------------------------------
void __thiscall CClientSocket::OnSelectWorld(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  char v3; // al@1
  CInPacket *v4; // ecx@1
  int i; // edi@1
  CCenter *v6; // eax@2
  signed int v7; // eax@3
  CCenter *v8; // eax@6
  int v9; // edx@6
  int v10; // eax@6
  CCenter *v11; // edi@8
  int v12; // eax@12
  COutPacket oPacket; // [sp+Ch] [bp-1Ch]@10
  int v14; // [sp+24h] [bp-4h]@10

  v2 = this;
  v3 = CInPacket::Decode1(iPacket);
  v4 = iPacket;
  v2->m_nWorldId = v3;
  v2->m_nChannelId = (unsigned __int8)CInPacket::Decode1(v4);
  iPacket = 0;
  for ( i = 0; ; ++i )
  {
    v6 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
    v7 = v6 ? v6[-1].m_mServerStatus._m_uAutoGrowLimit : 0;
    if ( (signed int)iPacket >= v7 )
      break;
    v8 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
    v9 = v8[i].m_nWorldId;
    v10 = (int)&v8[i];
    if ( v9 == v2->m_nWorldId )
    {
      v11 = (CCenter *)v10;
      goto LABEL_10;
    }
    iPacket = (CInPacket *)((char *)iPacket + 1);
  }
  v11 = 0;
LABEL_10:
  COutPacket::COutPacket(&oPacket, 0x7FFFFFFF, 0);
  v14 = 0;
  if ( !v11 || !v11->m_pSocket )
    goto LABEL_22;
  v12 = v2->m_nChannelId;
  if ( v12 < 0 || v12 > v11->m_nChannelNo )
  {
    CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aInvalidChannel);
    iPacket = (CInPacket *)-2147467259;
    _CxxThrowException(&iPacket, &_TI1_AVZException__);
  }
  if ( CCenter::IsServerConnected(v11, v2->m_nChannelId) )
  {
    v2->m_nLoginState = 7;
    COutPacket::Init(&oPacket, 0, 0);
    COutPacket::Encode4(&oPacket, v2->m_uLocalSocketSN);
    COutPacket::Encode4(&oPacket, v2->m_addr.sin_addr.S_un.S_addr);
    COutPacket::Encode4(&oPacket, v2->m_dwAccountId);
    COutPacket::Encode1(&oPacket, v2->m_nChannelId);
    CCenter::SendPacket(v11, &oPacket);
    CSecuritySession::SendMemoryRegion(v2->m_pSecuritySession);
  }
  else
  {
LABEL_22:
    COutPacket::Init(&oPacket, 19, 0);
    COutPacket::Encode1(&oPacket, 8);
    CClientSocket::SendPacket(v2, &oPacket, 0);
  }
  v14 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040E6F2) --------------------------------------------------------
void __thiscall CClientSocket::OnSelectCharacter(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  CCenter *v3; // eax@6
  _DWORD *v4; // eax@7
  bool v5; // zf@14
  CSecuritySession *v6; // ecx@16
  int v7; // ecx@16
  int v8; // [sp-4h] [bp-38h]@15
  COutPacket oPacket; // [sp+Ch] [bp-28h]@14
  CCenter *i; // [sp+1Ch] [bp-18h]@5
  int *v11; // [sp+20h] [bp-14h]@5
  ZXString<char> value; // [sp+24h] [bp-10h]@3
  int v13; // [sp+30h] [bp-4h]@3

  v2 = this;
  if ( this->m_nLoginState == 8 )
  {
    this->m_dwCharacterId = CInPacket::Decode4(iPacket);
    value._m_pStr = 0;
    v13 = 0;
    if ( !ZMap<unsigned long,ZXString<char>,unsigned long>::GetAt(&v2->m_mCharIDName, &v2->m_dwCharacterId, &value) )
    {
      iPacket = (CInPacket *)-2147467259;
      _CxxThrowException(&iPacket, &_TI1_AVZException__);
    }
    v11 = 0;
    for ( i = 0; ; ++i )
    {
      v3 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
      v4 = (_DWORD *)(v3 ? v3[-1].m_mServerStatus._m_uAutoGrowLimit : 0);
      if ( (signed int)v11 >= (signed int)v4 )
        break;
      if ( *(int *)((char *)&TSingleton<CServerApp>::ms_pInstance->m_aCenter.a->m_nWorldId + (unsigned int)i) == v2->m_nWorldId )
      {
        i = (CCenter *)((char *)i + (unsigned int)TSingleton<CServerApp>::ms_pInstance->m_aCenter.a);
        goto LABEL_14;
      }
      v11 = (int *)((char *)v11 + 1);
    }
    i = 0;
LABEL_14:
    COutPacket::COutPacket(&oPacket, 0x7FFFFFFF, 0);
    v5 = i->m_pSocket == 0;
    LOBYTE(v13) = 1;
    if ( v5 )
    {
      v8 = 0;
      v2->m_nLoginState = 8;
      COutPacket::Init(&oPacket, 12, v8);
      COutPacket::Encode1(&oPacket, 8);
      COutPacket::Encode1(&oPacket, 0);
      CClientSocket::SendPacket(v2, &oPacket, 0);
    }
    else
    {
      v6 = v2->m_pSecuritySession;
      v8 = 0;
      v2->m_nLoginState = 9;
      CSecuritySession::SendGGAuthReqPacket(v6, v8);
      COutPacket::Init(&oPacket, 1, 0);
      COutPacket::Encode4(&oPacket, v2->m_uLocalSocketSN);
      COutPacket::Encode4(&oPacket, v2->m_dwAccountId);
      COutPacket::Encode4(&oPacket, v2->m_dwCharacterId);
      COutPacket::Encode1(&oPacket, v2->m_nGradeCode);
      COutPacket::Encode1(&oPacket, v2->m_nCountryID);
      COutPacket::Encode4(&oPacket, v2->m_nBirthDate);
      v11 = &v8;
      v8 = 0;
      ZXString<char>::operator=((ZXString<char> *)&v8, &v2->m_sNexonClubID);
      COutPacket::EncodeStr(&oPacket, (ZXString<char>)v8);
      COutPacket::Encode1(&oPacket, v2->m_nPurchaseExp);
      COutPacket::Encode1(&oPacket, v2->m_nPrivateStatusID);
      COutPacket::EncodeBuffer(&oPacket, &v2->m_addr, 0x10u);
      COutPacket::EncodeBuffer(&oPacket, &v2->m_machineId, 0x10u);
      v11 = &v8;
      v8 = 0;
      ZXString<char>::operator=((ZXString<char> *)&v8, &v2->m_sId);
      COutPacket::EncodeStr(&oPacket, (ZXString<char>)v8);
      v11 = &v8;
      v8 = 0;
      ZXString<char>::operator=((ZXString<char> *)&v8, &value);
      COutPacket::EncodeStr(&oPacket, (ZXString<char>)v8);
      COutPacket::Encode4(&oPacket, v2->m_dwGameRoomCode);
      v8 = v7;
      v11 = &v8;
      CInPacket::DecodeStr(iPacket, (ZXString<char> *)&v8);
      COutPacket::EncodeStr(&oPacket, (ZXString<char>)v8);
      CCenter::SendPacket(i, &oPacket);
    }
    LOBYTE(v13) = 0;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
    v13 = -1;
    ZXString<char>::~ZXString<char>(&value);
  }
  else
  {
    CClientSocket::PostClose(this);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040E94F) --------------------------------------------------------
void __thiscall CClientSocket::OnSelectCharacterByVAC(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  unsigned int v3; // eax@4
  CInPacket *v4; // ecx@4
  CCenter *v5; // eax@7
  _DWORD *v6; // eax@8
  bool v7; // zf@17
  CSecuritySession *v8; // ecx@19
  int v9; // ecx@19
  int v10; // [sp-4h] [bp-40h]@19
  COutPacket oPacket; // [sp+Ch] [bp-30h]@17
  unsigned int v12; // [sp+1Ch] [bp-20h]@15
  ZXString<char> v13; // [sp+20h] [bp-1Ch]@15
  CCenter *i; // [sp+24h] [bp-18h]@6
  int *v15; // [sp+28h] [bp-14h]@6
  ZXString<char> value; // [sp+2Ch] [bp-10h]@4
  int v17; // [sp+38h] [bp-4h]@4

  v2 = this;
  if ( this->m_nLoginState == 10 )
  {
    v3 = CInPacket::Decode4(iPacket);
    v4 = iPacket;
    v2->m_dwCharacterId = v3;
    v2->m_nWorldId = CInPacket::Decode4(v4);
    value._m_pStr = 0;
    v17 = 0;
    if ( !ZMap<unsigned long,ZXString<char>,unsigned long>::GetAt(&v2->m_mCharIDName, &v2->m_dwCharacterId, &value) )
    {
      iPacket = (CInPacket *)-2147467259;
      _CxxThrowException(&iPacket, &_TI1_AVZException__);
    }
    v15 = 0;
    for ( i = 0; ; ++i )
    {
      v5 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
      v6 = (_DWORD *)(v5 ? v5[-1].m_mServerStatus._m_uAutoGrowLimit : 0);
      if ( (signed int)v15 >= (signed int)v6 )
        break;
      if ( *(int *)((char *)&TSingleton<CServerApp>::ms_pInstance->m_aCenter.a->m_nWorldId + (unsigned int)i) == v2->m_nWorldId )
      {
        i = (CCenter *)((char *)i + (unsigned int)TSingleton<CServerApp>::ms_pInstance->m_aCenter.a);
        goto LABEL_15;
      }
      v15 = (int *)((char *)v15 + 1);
    }
    i = 0;
LABEL_15:
    v13._m_pStr = 0;
    LOBYTE(v17) = 1;
    if ( !ZMap<ZXString<char>,unsigned long,ZXString<char>>::GetAt(&v2->m_mNameWorldID, &value, &v12)
      || v12 != v2->m_nWorldId )
    {
      CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aUserTriedToLog);
      iPacket = (CInPacket *)-2147467259;
      _CxxThrowException(&iPacket, &_TI1_AVZException__);
    }
    COutPacket::COutPacket(&oPacket, 0x7FFFFFFF, 0);
    v7 = i->m_pSocket == 0;
    LOBYTE(v17) = 2;
    if ( v7 )
    {
      COutPacket::Init(&oPacket, 4, 0);
      COutPacket::Encode1(&oPacket, 8);
      COutPacket::Encode1(&oPacket, 0);
      CClientSocket::SendPacket(v2, &oPacket, 0);
    }
    else
    {
      v8 = v2->m_pSecuritySession;
      v10 = 0;
      v2->m_nLoginState = 9;
      CSecuritySession::SendGGAuthReqPacket(v8, v10);
      COutPacket::Init(&oPacket, 15, 0);
      COutPacket::Encode4(&oPacket, v2->m_uLocalSocketSN);
      COutPacket::Encode4(&oPacket, v2->m_dwAccountId);
      COutPacket::Encode4(&oPacket, v2->m_dwCharacterId);
      COutPacket::Encode1(&oPacket, v2->m_nGradeCode);
      COutPacket::Encode1(&oPacket, v2->m_nCountryID);
      COutPacket::Encode4(&oPacket, v2->m_nBirthDate);
      v15 = &v10;
      v10 = 0;
      ZXString<char>::operator=((ZXString<char> *)&v10, &v2->m_sNexonClubID);
      COutPacket::EncodeStr(&oPacket, (ZXString<char>)v10);
      COutPacket::Encode1(&oPacket, v2->m_nPurchaseExp);
      COutPacket::Encode1(&oPacket, v2->m_nPrivateStatusID);
      COutPacket::EncodeBuffer(&oPacket, &v2->m_addr, 0x10u);
      COutPacket::EncodeBuffer(&oPacket, &v2->m_machineId, 0x10u);
      v15 = &v10;
      v10 = 0;
      ZXString<char>::operator=((ZXString<char> *)&v10, &v2->m_sId);
      COutPacket::EncodeStr(&oPacket, (ZXString<char>)v10);
      v15 = &v10;
      v10 = 0;
      ZXString<char>::operator=((ZXString<char> *)&v10, &value);
      COutPacket::EncodeStr(&oPacket, (ZXString<char>)v10);
      COutPacket::Encode4(&oPacket, v2->m_dwGameRoomCode);
      COutPacket::Encode4(&oPacket, v2->m_addr.sin_addr.S_un.S_addr);
      v10 = v9;
      v15 = &v10;
      CInPacket::DecodeStr(iPacket, (ZXString<char> *)&v10);
      COutPacket::EncodeStr(&oPacket, (ZXString<char>)v10);
      CCenter::SendPacket(i, &oPacket);
    }
    LOBYTE(v17) = 1;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
    LOBYTE(v17) = 0;
    ZXString<char>::~ZXString<char>(&v13);
    v17 = -1;
    ZXString<char>::~ZXString<char>(&value);
  }
  else
  {
    CClientSocket::PostClose(this);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040EC25) --------------------------------------------------------
void __thiscall CClientSocket::OnVACFlagSet(CClientSocket *this, CInPacket *iPacket)
{
  this->m_bIsVACDlgOn = (unsigned __int8)CInPacket::Decode1(iPacket);
}

//----- (0040EC3E) --------------------------------------------------------
void __thiscall CClientSocket::OnCheckDuplicatedID(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  int i; // edi@3
  CCenter *v4; // eax@4
  signed int v5; // eax@5
  CCenter *v6; // edi@10
  unsigned int v7; // [sp-4h] [bp-30h]@14
  COutPacket oPacket; // [sp+Ch] [bp-20h]@14
  ZXString<char> result; // [sp+1Ch] [bp-10h]@3
  int v10; // [sp+28h] [bp-4h]@3
  CInPacket *v11; // [sp+34h] [bp+8h]@3

  v2 = this;
  if ( this->m_nLoginState == 8 )
  {
    CInPacket::DecodeStr(iPacket, &result);
    v10 = 0;
    v11 = 0;
    for ( i = 0; ; ++i )
    {
      v4 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
      v5 = v4 ? v4[-1].m_mServerStatus._m_uAutoGrowLimit : 0;
      if ( (signed int)v11 >= v5 )
        break;
      if ( TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i].m_nWorldId == v2->m_nWorldId )
      {
        v6 = &TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i];
        goto LABEL_12;
      }
      v11 = (CInPacket *)((char *)v11 + 1);
    }
    v6 = 0;
LABEL_12:
    if ( v6 )
    {
      if ( v6->m_pSocket )
      {
        COutPacket::COutPacket(&oPacket, 5, 0);
        v7 = v2->m_uLocalSocketSN;
        LOBYTE(v10) = 1;
        COutPacket::Encode4(&oPacket, v7);
        v7 = 0;
        ZXString<char>::operator=((ZXString<char> *)&v7, &result);
        COutPacket::EncodeStr(&oPacket, (ZXString<char>)v7);
        COutPacket::Encode4(&oPacket, v2->m_dwAccountId);
        CCenter::SendPacket(v6, &oPacket);
        LOBYTE(v10) = 0;
        ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
      }
    }
    v10 = -1;
    ZXString<char>::~ZXString<char>(&result);
  }
  else
  {
    CClientSocket::PostClose(this);
  }
}

//----- (0040ED30) --------------------------------------------------------
void __thiscall CClientSocket::OnCreateNewCharacter(CClientSocket *this, CInPacket *iPacket)
{
  bool v2; // zf@1
  int v3; // ebx@3
  int v4; // edi@3
  int v5; // edi@3
  int v6; // edi@3
  char v7; // al@3
  CLoginApp *v8; // esi@3
  int v9; // edi@3
  int v10; // eax@3
  int v11; // edi@9
  CClientSocket *v12; // esi@25
  signed int v13; // ebx@26
  int i; // edi@26
  CCenter *v15; // eax@27
  CCenter *v16; // edi@34
  ZArray<unsigned char> *v17; // ecx@39
  unsigned int v18; // [sp-4h] [bp-CCh]@29
  int p; // [sp+Ch] [bp-BCh]@3
  char v20; // [sp+10h] [bp-B8h]@3
  int v21; // [sp+20h] [bp-A8h]@3
  int v22; // [sp+24h] [bp-A4h]@3
  int v23; // [sp+28h] [bp-A0h]@3
  int v24; // [sp+38h] [bp-90h]@3
  unsigned int v25; // [sp+84h] [bp-44h]@3
  int v26; // [sp+88h] [bp-40h]@3
  char n[4]; // [sp+8Ch] [bp-3Ch]@3
  int nItemId; // [sp+90h] [bp-38h]@3
  int v29; // [sp+94h] [bp-34h]@3
  int v30; // [sp+98h] [bp-30h]@3
  int v31; // [sp+9Ch] [bp-2Ch]@3
  int v32; // [sp+A0h] [bp-28h]@3
  COutPacket oPacket; // [sp+A4h] [bp-24h]@39
  ZXString<char> result; // [sp+B4h] [bp-14h]@3
  CClientSocket *v35; // [sp+B8h] [bp-10h]@1
  int v36; // [sp+C4h] [bp-4h]@3
  CInPacket *v37; // [sp+D0h] [bp+8h]@3

  v2 = this->m_nLoginState == 8;
  v35 = this;
  if ( !v2 )
  {
    CClientSocket::PostClose(this);
    return;
  }
  CInPacket::DecodeStr(iPacket, &result);
  v36 = 0;
  memset(&v20, 0, 0x74u);
  nItemId = CInPacket::Decode4(iPacket);
  v26 = CInPacket::Decode4(iPacket);
  v3 = CInPacket::Decode4(iPacket);
  v25 = CInPacket::Decode4(iPacket);
  p = v3 + 10 * (v26 / 10);
  v21 = CInPacket::Decode4(iPacket);
  v22 = CInPacket::Decode4(iPacket);
  v23 = CInPacket::Decode4(iPacket);
  v24 = CInPacket::Decode4(iPacket);
  n[0] = CInPacket::Decode1(iPacket);
  v29 = (unsigned __int8)CInPacket::Decode1(iPacket);
  v4 = (unsigned __int8)v29;
  v30 = (unsigned __int8)CInPacket::Decode1(iPacket);
  v5 = (unsigned __int8)v30 + v4;
  v31 = (unsigned __int8)CInPacket::Decode1(iPacket);
  v6 = (unsigned __int8)v31 + v5;
  v7 = CInPacket::Decode1(iPacket);
  v8 = TSingleton<CServerApp>::ms_pInstance;
  v32 = (unsigned __int8)v7;
  v9 = (unsigned __int8)v7 + v6;
  v37 = (CInPacket *)1;
  v10 = CClientSocket::IsAdmin(v35);
  if ( !CLoginApp::CheckCharName(v8, &result, v10 == 0) )
  {
LABEL_24:
    v37 = 0;
LABEL_25:
    v12 = v35;
    goto LABEL_26;
  }
  if ( v29 >= 4 && v30 >= 4 && v31 >= 4 && v32 >= 4 && v9 <= 25 )
  {
    v11 = (unsigned __int8)n[0];
    if ( !CLoginApp::CheckCharEquip(v8, (unsigned __int8)n[0], 0, nItemId) )
      v37 = 0;
    if ( !CLoginApp::CheckCharEquip(v8, v11, 1, v26) )
      v37 = 0;
    if ( !CLoginApp::CheckCharEquip(v8, v11, 2, v3) )
      v37 = 0;
    if ( !CLoginApp::CheckCharEquip(v8, v11, 3, v25) )
      v37 = 0;
    if ( !CLoginApp::CheckCharEquip(v8, v11, 4, v21) )
      v37 = 0;
    if ( !CLoginApp::CheckCharEquip(v8, v11, 5, v22) )
      v37 = 0;
    if ( !CLoginApp::CheckCharEquip(v8, v11, 6, v23) )
      v37 = 0;
    if ( CLoginApp::CheckCharEquip(v8, v11, 7, v24) )
      goto LABEL_25;
    goto LABEL_24;
  }
  v18 = v32;
  v12 = v35;
  CVerboseObj::LogError(
    (CVerboseObj *)&v35->vfptr,
    aNewCharacterHa,
    v35->m_dwAccountId,
    result._m_pStr,
    v29,
    v30,
    v31,
    v32);
  v37 = 0;
LABEL_26:
  v13 = 0;
  for ( i = 0; ; ++i )
  {
    v15 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
    if ( v15 )
      v15 = (CCenter *)v15[-1].m_mServerStatus._m_uAutoGrowLimit;
    if ( v13 >= (signed int)v15 )
      break;
    if ( TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i].m_nWorldId == v12->m_nWorldId )
    {
      v16 = &TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i];
      goto LABEL_36;
    }
    ++v13;
  }
  v16 = 0;
LABEL_36:
  if ( v37 && v16 && v16->m_pSocket )
  {
    COutPacket::COutPacket(&oPacket, 10, 0);
    v18 = v12->m_uLocalSocketSN;
    LOBYTE(v36) = 1;
    COutPacket::Encode4(&oPacket, v18);
    COutPacket::Encode4(&oPacket, v12->m_dwAccountId);
    v18 = 0;
    ZXString<char>::operator=((ZXString<char> *)&v18, &result);
    COutPacket::EncodeStr(&oPacket, (ZXString<char>)v18);
    COutPacket::Encode1(&oPacket, n[0]);
    COutPacket::Encode4(&oPacket, nItemId);
    COutPacket::Encode4(&oPacket, v25);
    COutPacket::EncodeBuffer(&oPacket, &p, 0x78u);
    COutPacket::EncodeBuffer(&oPacket, &v29, 0x10u);
    CCenter::SendPacket(v16, &oPacket);
    LOBYTE(v36) = 0;
    v17 = &oPacket.m_aSendBuff;
  }
  else
  {
    COutPacket::COutPacket(&oPacket, 7, 0);
    LOBYTE(v36) = 2;
    COutPacket::Encode1(&oPacket, 9);
    CClientSocket::SendPacket(v12, &oPacket, 0);
    LOBYTE(v36) = 0;
    v17 = &oPacket.m_aSendBuff;
  }
  ZArray<unsigned char>::RemoveAll(v17);
  v36 = -1;
  ZXString<char>::~ZXString<char>(&result);
}

//----- (0040F0B7) --------------------------------------------------------
void __thiscall CClientSocket::OnDeleteCharacter(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  unsigned int v3; // edi@3
  unsigned int v4; // eax@3
  bool v5; // zf@3
  char *v6; // ecx@4
  int i; // edi@5
  CCenter *v8; // eax@6
  CCenter *v9; // edi@11
  unsigned int v10; // ST04_4@15
  COutPacket oPacket; // [sp+8h] [bp-30h]@4
  COutPacket v12; // [sp+18h] [bp-20h]@15
  unsigned int n; // [sp+28h] [bp-10h]@3
  int v14; // [sp+34h] [bp-4h]@4
  CInPacket *v15; // [sp+40h] [bp+8h]@5

  v2 = this;
  if ( this->m_nLoginState != 8 )
  {
    CClientSocket::PostClose(this);
    return;
  }
  v3 = CInPacket::Decode4(iPacket);
  v4 = CInPacket::Decode4(iPacket);
  v5 = v2->m_nBirthDate == v3;
  n = v4;
  if ( !v5 )
  {
    COutPacket::COutPacket(&oPacket, 8, 0);
    v14 = 0;
    COutPacket::Encode4(&oPacket, n);
    COutPacket::Encode1(&oPacket, 18);
    CClientSocket::SendPacket(v2, &oPacket, 0);
    v14 = -1;
    v6 = (char *)&oPacket.m_aSendBuff.a;
LABEL_16:
    ZArray<unsigned char>::RemoveAll((ZArray<unsigned char> *)v6);
    return;
  }
  v15 = 0;
  for ( i = 0; ; ++i )
  {
    v8 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
    if ( v8 )
      v8 = (CCenter *)v8[-1].m_mServerStatus._m_uAutoGrowLimit;
    if ( (signed int)v15 >= (signed int)v8 )
      break;
    if ( TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i].m_nWorldId == v2->m_nWorldId )
    {
      v9 = &TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i];
      goto LABEL_13;
    }
    v15 = (CInPacket *)((char *)v15 + 1);
  }
  v9 = 0;
LABEL_13:
  if ( v9 && v9->m_pSocket )
  {
    COutPacket::COutPacket(&v12, 11, 0);
    v10 = v2->m_uLocalSocketSN;
    v14 = 1;
    COutPacket::Encode4(&v12, v10);
    COutPacket::Encode4(&v12, v2->m_dwAccountId);
    COutPacket::Encode4(&v12, n);
    CCenter::SendPacket(v9, &v12);
    v14 = -1;
    v6 = (char *)&v12.m_aSendBuff.a;
    goto LABEL_16;
  }
}

//----- (0040F1E6) --------------------------------------------------------
void __thiscall CClientSocket::OnCheckGameGuardUpdated(CClientSocket *this, CInPacket *iPacket)
{
  CSecuritySession::SendGGAuthReqPacket(this->m_pSecuritySession, 1);
}

//----- (0040F1F6) --------------------------------------------------------
void __thiscall CClientSocket::OnCheckUserLimit(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // ebx@1
  int v3; // edx@1
  int i; // esi@1
  CCenter *v5; // eax@2
  signed int v6; // eax@3
  CCenter *v7; // esi@8
  COutPacket oPacket; // [sp+Ch] [bp-1Ch]@10
  int v9; // [sp+24h] [bp-4h]@10
  CInPacket *v10; // [sp+30h] [bp+8h]@1

  v2 = this;
  v3 = CInPacket::Decode2(iPacket);
  v10 = 0;
  for ( i = 0; ; ++i )
  {
    v5 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
    v6 = v5 ? v5[-1].m_mServerStatus._m_uAutoGrowLimit : 0;
    if ( (signed int)v10 >= v6 )
      break;
    if ( TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i].m_nWorldId == v3 )
    {
      v7 = &TSingleton<CServerApp>::ms_pInstance->m_aCenter.a[i];
      goto LABEL_10;
    }
    v10 = (CInPacket *)((char *)v10 + 1);
  }
  v7 = 0;
LABEL_10:
  COutPacket::COutPacket(&oPacket, 0x7FFFFFFF, 0);
  v9 = 0;
  if ( v7 && v7->m_pSocket )
  {
    COutPacket::Init(&oPacket, 13, 0);
    COutPacket::Encode4(&oPacket, v2->m_uLocalSocketSN);
    CCenter::SendPacket(v7, &oPacket);
  }
  else
  {
    COutPacket::Init(&oPacket, 18, 0);
    COutPacket::Encode1(&oPacket, 2);
    CClientSocket::SendPacket(v2, &oPacket, 0);
  }
  v9 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (0040F2CB) --------------------------------------------------------
void __thiscall CClientSocket::OnAliveAck(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  DWORD v3; // eax@1
  int v4; // ecx@1

  v2 = this;
  v3 = timeGetTime();
  v4 = v2->m_tAliveReqSent;
  if ( v4 && (signed int)(v3 - v4) <= 60000 * (v2->m_bFirstAliveAck != 0 ? 8 : 3) )
  {
    if ( !v3 )
      v3 = 1;
    v2->m_tAliveReqSent = 0;
    v2->m_bFirstAliveAck = 0;
    v2->m_tLastAliveAck = v3;
  }
  else
  {
    CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aAliveCheckFail);
    CClientSocket::PostClose(v2);
  }
}

//----- (0040F339) --------------------------------------------------------
void __thiscall CClientSocket::OnCenterLoginResult(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  char v3; // al@3
  int v4; // edi@3
  char *v5; // ecx@8
  int v6; // edi@9
  char v7; // al@10
  unsigned int v8; // eax@12
  GW_CharacterStat v9; // [sp+Ch] [bp-184h]@10
  AvatarLook v10; // [sp+5Ah] [bp-136h]@10
  COutPacket oPacket; // [sp+15Ch] [bp-34h]@4
  COutPacket v12; // [sp+16Ch] [bp-24h]@9
  int v13; // [sp+17Ch] [bp-14h]@9
  ZXString<char> value; // [sp+180h] [bp-10h]@10
  int v15; // [sp+18Ch] [bp-4h]@4

  v2 = this;
  if ( this->m_nLoginState == 7 )
  {
    v3 = CInPacket::Decode1(iPacket);
    v4 = v3;
    if ( v3 )
    {
      COutPacket::COutPacket(&oPacket, 19, 0);
      v15 = 0;
      COutPacket::Encode1(&oPacket, v4);
      CClientSocket::SendPacket(v2, &oPacket, 0);
      if ( v4 == 7 )
      {
        CClientSocket::ResetLoginState(v2, 1);
      }
      else if ( v4 == 10 )
      {
        CClientSocket::ResetLoginState(v2, TSingleton<CLoginAcceptor>::ms_pInstance->m_bIsWebDead != 0 ? 6 : 1);
      }
      v15 = -1;
      v5 = (char *)&oPacket.m_aSendBuff.a;
    }
    else
    {
      v6 = (unsigned __int8)CInPacket::Decode1(iPacket);
      COutPacket::COutPacket(&v12, 19, 0);
      v15 = 1;
      COutPacket::Encode1(&v12, 0);
      COutPacket::Encode1(&v12, v6);
      ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveAll(&v2->m_mCharIDName);
      v13 = 0;
      if ( v6 <= 0 )
        goto LABEL_23;
      do
      {
        AvatarLook::AvatarLook(&v10);
        GW_CharacterStat::Decode(&v9, iPacket, 0);
        AvatarLook::Decode(&v10, iPacket);
        GW_CharacterStat::Encode(&v9, &v12);
        AvatarLook::Encode(&v10, &v12);
        v7 = CInPacket::Decode1(iPacket);
        value._m_pStr = (char *)(unsigned __int8)v7;
        COutPacket::Encode1(&v12, v7);
        if ( value._m_pStr )
        {
          value._m_pStr = (char *)4;
          do
          {
            v8 = CInPacket::Decode4(iPacket);
            COutPacket::Encode4(&v12, v8);
            --value._m_pStr;
          }
          while ( value._m_pStr );
        }
        value._m_pStr = 0;
        ZXString<char>::Assign(&value, v9.sCharacterName, -1);
        LOBYTE(v15) = 2;
        ZMap<unsigned long,ZXString<char>,unsigned long>::Insert(&v2->m_mCharIDName, &v9.dwCharacterID, &value);
        LOBYTE(v15) = 1;
        ZXString<char>::~ZXString<char>(&value);
        if ( !CClientSocket::IsAdmin(v2) && v9.nJob / 100 == 5 )
          break;
        ++v13;
      }
      while ( v13 < v6 );
      if ( v13 >= v6 )
      {
LABEL_23:
        CClientSocket::SendPacket(v2, &v12, 0);
        v2->m_nLoginState = 8;
      }
      else
      {
        CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aAdminJobFoundI, v2->m_sId._m_pStr);
        CClientSocket::PostClose(v2);
      }
      v15 = -1;
      v5 = (char *)&v12.m_aSendBuff.a;
    }
    ZArray<unsigned char>::RemoveAll((ZArray<unsigned char> *)v5);
  }
  else
  {
    CClientSocket::PostClose(this);
  }
}

//----- (0040F54C) --------------------------------------------------------
void __thiscall AvatarLook::AvatarLook(AvatarLook *this)
{
  this->nGender = 0;
  this->nSkin = 0;
  this->nFace = 0;
  this->nWeaponStickerID = 0;
  this->nPetID = 0;
  memset(this->anHairEquip, 0, 0x78u);
}

//----- (0040F575) --------------------------------------------------------
void __thiscall CClientSocket::OnCenterSelectCharacterResult(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  CSecuritySession *v3; // edi@3
  CSecuritySession *v4; // esi@7
  CInPacket *v5; // edi@9
  int v6; // eax@9
  char *v7; // ecx@15
  unsigned int v8; // eax@16
  unsigned __int16 v9; // ax@16
  char v10; // al@16
  unsigned int v11; // eax@16
  COutPacket oPacket; // [sp+Ch] [bp-30h]@15
  COutPacket v13; // [sp+1Ch] [bp-20h]@16
  int v14; // [sp+2Ch] [bp-10h]@9
  int v15; // [sp+38h] [bp-4h]@15

  v2 = this;
  if ( this->m_nLoginState != 9 )
  {
    CClientSocket::PostClose(this);
    return;
  }
  v3 = this->m_pSecuritySession;
  if ( v3->m_nGGAuthReqPacketRecv != 2 )
  {
    if ( !this->m_bAdminclient )
    {
      CInPacket::CopyTo(iPacket, &v3->m_oPacket);
      v3->m_bCenterResultPacketCame = 1;
      return;
    }
    if ( !(CIPChecker::GetFlag(TSingleton<CIPChecker>::ms_pInstance, this->m_addr.sin_addr.S_un.S_addr) & 1) )
    {
      CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aAdminclientWit);
      v4 = v2->m_pSecuritySession;
      CInPacket::CopyTo(iPacket, &v4->m_oPacket);
      v4->m_bCenterResultPacketCame = 1;
      iPacket = (CInPacket *)-2147467259;
      _CxxThrowException(&iPacket, &_TI1_AVZException__);
    }
  }
  v5 = iPacket;
  v14 = CInPacket::Decode1(iPacket) != 0;
  LOBYTE(iPacket) = CInPacket::Decode1(v5);
  v6 = CInPacket::Decode1(v5) != 0;
  if ( v14 )
  {
    COutPacket::COutPacket(&v13, 12, 0);
    v15 = 1;
    COutPacket::Encode1(&v13, 0);
    COutPacket::Encode1(&v13, (char)iPacket);
    v8 = CInPacket::Decode4(v5);
    COutPacket::Encode4(&v13, v8);
    v9 = CInPacket::Decode2(v5);
    COutPacket::Encode2(&v13, v9);
    COutPacket::Encode4(&v13, v2->m_dwCharacterId);
    v10 = CInPacket::Decode1(v5);
    COutPacket::Encode1(&v13, v10);
    v11 = CInPacket::Decode4(v5);
    COutPacket::Encode4(&v13, v11);
    CClientSocket::SendPacket(v2, &v13, 0);
    v15 = -1;
    v2->m_nLoginState = 12;
    v7 = (char *)&v13.m_aSendBuff.a;
  }
  else
  {
    if ( (_BYTE)iPacket == 11 || (_BYTE)iPacket == 13 || v6 && !(_BYTE)iPacket )
      LOBYTE(iPacket) = 1;
    COutPacket::COutPacket(&oPacket, 12, 0);
    v15 = 0;
    COutPacket::Encode1(&oPacket, (_BYTE)iPacket != 0 ? 12 : 9);
    COutPacket::Encode1(&oPacket, (char)iPacket);
    CClientSocket::SendPacket(v2, &oPacket, 0);
    CClientSocket::SendDisconnectPacket(v2);
    v15 = -1;
    v2->m_nLoginState = 13;
    v7 = (char *)&oPacket.m_aSendBuff.a;
  }
  ZArray<unsigned char>::RemoveAll((ZArray<unsigned char> *)v7);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040F766) --------------------------------------------------------
void __thiscall CClientSocket::OnCenterSelectCharacterByVACResult(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  CInPacket *v3; // ebx@3
  char *v4; // ecx@4
  unsigned int v5; // eax@5
  unsigned __int16 v6; // ax@5
  char v7; // al@5
  unsigned int v8; // eax@5
  COutPacket oPacket; // [sp+Ch] [bp-30h]@4
  COutPacket v10; // [sp+1Ch] [bp-20h]@5
  char n[4]; // [sp+2Ch] [bp-10h]@3
  int v12; // [sp+38h] [bp-4h]@4
  CInPacket *v13; // [sp+44h] [bp+8h]@3

  v2 = this;
  if ( this->m_nLoginState == 11 )
  {
    v3 = iPacket;
    v13 = (CInPacket *)(CInPacket::Decode1(iPacket) != 0);
    *(_DWORD *)n = CInPacket::Decode4(v3);
    if ( v13 )
    {
      COutPacket::COutPacket(&v10, 4, 0);
      v12 = 1;
      COutPacket::Encode1(&v10, 0);
      COutPacket::Encode1(&v10, 0);
      v5 = CInPacket::Decode4(v3);
      COutPacket::Encode4(&v10, v5);
      v6 = CInPacket::Decode2(v3);
      COutPacket::Encode2(&v10, v6);
      COutPacket::Encode4(&v10, v2->m_dwCharacterId);
      v7 = CInPacket::Decode1(v3);
      COutPacket::Encode1(&v10, v7);
      v8 = CInPacket::Decode4(v3);
      COutPacket::Encode4(&v10, v8);
      CClientSocket::SendPacket(v2, &v10, 0);
      v12 = -1;
      v2->m_nLoginState = 12;
      v4 = (char *)&v10.m_aSendBuff.a;
    }
    else
    {
      COutPacket::COutPacket(&oPacket, 4, 0);
      v12 = 0;
      COutPacket::Encode1(&oPacket, 9);
      COutPacket::Encode1(&oPacket, n[0]);
      CClientSocket::SendPacket(v2, &oPacket, 0);
      v12 = -1;
      v4 = (char *)&oPacket.m_aSendBuff.a;
    }
    ZArray<unsigned char>::RemoveAll((ZArray<unsigned char> *)v4);
  }
  else
  {
    CClientSocket::PostClose(this);
  }
}

//----- (0040F88C) --------------------------------------------------------
void __thiscall CClientSocket::OnCenterViewAllCharResult(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  char v3; // al@1
  int v4; // ebx@1
  char *v5; // ecx@5
  int v6; // ebx@6
  char v7; // al@7
  unsigned int v8; // eax@9
  GW_CharacterStat v9; // [sp+Ch] [bp-18Ch]@7
  AvatarLook v10; // [sp+5Ah] [bp-13Eh]@7
  COutPacket oPacket; // [sp+15Ch] [bp-3Ch]@2
  unsigned int v12; // [sp+16Ch] [bp-2Ch]@12
  COutPacket v13; // [sp+170h] [bp-28h]@6
  char n[4]; // [sp+180h] [bp-18h]@6
  int v15; // [sp+184h] [bp-14h]@6
  ZXString<char> value; // [sp+188h] [bp-10h]@7
  int v17; // [sp+194h] [bp-4h]@2

  v2 = this;
  v3 = CInPacket::Decode1(iPacket);
  v4 = v3;
  if ( v3 )
  {
    COutPacket::COutPacket(&oPacket, 2, 0);
    v17 = 0;
    COutPacket::Encode1(&oPacket, v4);
    if ( v4 == 3 || v4 == 6 )
      COutPacket::Encode1(&oPacket, 0);
    CClientSocket::SendPacket(v2, &oPacket, 0);
    v17 = -1;
    v5 = (char *)&oPacket.m_aSendBuff.a;
  }
  else
  {
    *(_DWORD *)n = CInPacket::Decode4(iPacket);
    v6 = (unsigned __int8)CInPacket::Decode1(iPacket);
    COutPacket::COutPacket(&v13, 2, 0);
    v17 = 1;
    COutPacket::Encode1(&v13, 0);
    COutPacket::Encode1(&v13, n[0]);
    COutPacket::Encode1(&v13, v6);
    v15 = 0;
    if ( v6 <= 0 )
      goto LABEL_24;
    do
    {
      AvatarLook::AvatarLook(&v10);
      GW_CharacterStat::Decode(&v9, iPacket, 0);
      AvatarLook::Decode(&v10, iPacket);
      GW_CharacterStat::Encode(&v9, &v13);
      AvatarLook::Encode(&v10, &v13);
      v7 = CInPacket::Decode1(iPacket);
      value._m_pStr = (char *)(unsigned __int8)v7;
      COutPacket::Encode1(&v13, v7);
      if ( value._m_pStr )
      {
        value._m_pStr = (char *)4;
        do
        {
          v8 = CInPacket::Decode4(iPacket);
          COutPacket::Encode4(&v13, v8);
          --value._m_pStr;
        }
        while ( value._m_pStr );
      }
      value._m_pStr = 0;
      ZXString<char>::Assign(&value, v9.sCharacterName, -1);
      LOBYTE(v17) = 2;
      ZMap<unsigned long,ZXString<char>,unsigned long>::Insert(&v2->m_mCharIDName, &v9.dwCharacterID, &value);
      LOBYTE(v17) = 1;
      if ( value._m_pStr )
        ZXString<char>::_Release((ZXString<char>::_ZXStringData *)value._m_pStr - 1);
      v12 = *(_DWORD *)n;
      value._m_pStr = 0;
      ZXString<char>::Assign(&value, v9.sCharacterName, -1);
      LOBYTE(v17) = 3;
      ZMap<ZXString<char>,unsigned long,ZXString<char>>::Insert(&v2->m_mNameWorldID, &value, &v12);
      LOBYTE(v17) = 1;
      if ( value._m_pStr )
        ZXString<char>::_Release((ZXString<char>::_ZXStringData *)value._m_pStr - 1);
      if ( !CClientSocket::IsAdmin(v2) && v9.nJob / 100 == 5 )
        break;
      ++v15;
    }
    while ( v15 < v6 );
    if ( v15 >= v6 )
    {
LABEL_24:
      CClientSocket::SendPacket(v2, &v13, 0);
    }
    else
    {
      CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aAdminJobFoundI, v2->m_sId._m_pStr);
      CClientSocket::PostClose(v2);
    }
    v17 = -1;
    v5 = (char *)&v13.m_aSendBuff.a;
  }
  ZArray<unsigned char>::RemoveAll((ZArray<unsigned char> *)v5);
}

//----- (0040FAC7) --------------------------------------------------------
void __thiscall CClientSocket::OnCenterCheckDuplicatedIDResult(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // edi@1
  char v3; // si@1
  ZXString<char> v4; // [sp-4h] [bp-30h]@1
  COutPacket oPacket; // [sp+Ch] [bp-20h]@1
  ZXString<char> result; // [sp+1Ch] [bp-10h]@1
  int v7; // [sp+28h] [bp-4h]@1

  v2 = this;
  CInPacket::DecodeStr(iPacket, &result);
  v7 = 0;
  v3 = CInPacket::Decode1(iPacket);
  COutPacket::COutPacket(&oPacket, 6, 0);
  LOBYTE(v7) = 1;
  v4._m_pStr = 0;
  ZXString<char>::operator=(&v4, &result);
  COutPacket::EncodeStr(&oPacket, v4);
  COutPacket::Encode1(&oPacket, v3);
  CClientSocket::SendPacket(v2, &oPacket, 0);
  LOBYTE(v7) = 0;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
  v7 = -1;
  ZXString<char>::~ZXString<char>(&result);
}

//----- (0040FB5A) --------------------------------------------------------
void __thiscall CClientSocket::OnCenterCreateNewCharacterResult(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // edi@1
  int v3; // esi@1
  char *v4; // eax@2
  char **v5; // esi@2
  char *v6; // edx@4
  char *v7; // eax@6
  GW_CharacterStat v8; // [sp+Ch] [bp-170h]@2
  AvatarLook v9; // [sp+5Ah] [bp-122h]@2
  COutPacket oPacket; // [sp+15Ch] [bp-20h]@1
  ZXString<char> value; // [sp+16Ch] [bp-10h]@2
  int v12; // [sp+178h] [bp-4h]@1

  v2 = this;
  v3 = CInPacket::Decode1(iPacket);
  COutPacket::COutPacket(&oPacket, 7, 0);
  v12 = 0;
  COutPacket::Encode1(&oPacket, v3);
  if ( !v3 )
  {
    AvatarLook::AvatarLook(&v9);
    GW_CharacterStat::Decode(&v8, iPacket, 0);
    AvatarLook::Decode(&v9, iPacket);
    GW_CharacterStat::Encode(&v8, &oPacket);
    AvatarLook::Encode(&v9, &oPacket);
    value._m_pStr = 0;
    ZXString<char>::Assign(&value, v8.sCharacterName, -1);
    LOBYTE(v12) = 1;
    ZMap<unsigned long,ZXString<char>,unsigned long>::Insert(&v2->m_mCharIDName, &v8.dwCharacterID, &value);
    v4 = v2->m_sEventCharacterID._m_pStr;
    v5 = &v2->m_sEventCharacterID._m_pStr;
    if ( v4 && *v4 )
    {
      v6 = value._m_pStr;
      if ( !value._m_pStr )
        v6 = ZXString<char>::_s_sEmpty._m_pStr;
      v7 = *v5;
      if ( !*v5 )
        v7 = ZXString<char>::_s_sEmpty._m_pStr;
      if ( !_strcmpi(v7, v6) )
        ZXString<char>::Empty(&v2->m_sEventCharacterID);
    }
    LOBYTE(v12) = 0;
    ZXString<char>::~ZXString<char>(&value);
  }
  CClientSocket::SendPacket(v2, &oPacket, 0);
  v12 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (0040FC82) --------------------------------------------------------
void __thiscall CClientSocket::OnCenterDeleteCharacterResult(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // ebx@1
  int v3; // esi@1
  COutPacket oPacket; // [sp+8h] [bp-20h]@1
  unsigned int n; // [sp+18h] [bp-10h]@1
  int v6; // [sp+24h] [bp-4h]@1

  v2 = this;
  n = CInPacket::Decode4(iPacket);
  v3 = CInPacket::Decode1(iPacket);
  COutPacket::COutPacket(&oPacket, 8, 0);
  v6 = 0;
  COutPacket::Encode4(&oPacket, n);
  COutPacket::Encode1(&oPacket, v3);
  CClientSocket::SendPacket(v2, &oPacket, 0);
  if ( !v3 )
    ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveKey(&v2->m_mCharIDName, &n);
  v6 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (0040FD09) --------------------------------------------------------
void __thiscall CClientSocket::SetCenterSelectCharacterResultPacket(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // edi@1
  int v3; // ebx@1
  unsigned int v4; // eax@2

  v2 = this;
  CInPacket::CopyTo(iPacket, &this->m_oPacket);
  v3 = CInPacket::Decode1(iPacket) != 0;
  CInPacket::Decode1(iPacket);
  CInPacket::Decode1(iPacket);
  if ( v3 )
  {
    CInPacket::Decode4(iPacket);
    CInPacket::Decode2(iPacket);
    LOBYTE(v4) = CInPacket::Decode1(iPacket);
    v2->m_bPremium = (v4 >> 1) & 1;
    CInPacket::Decode4(iPacket);
  }
}

//----- (0040FD6E) --------------------------------------------------------
void __thiscall CClientSocket::OnCenterCheckUserLimitResult(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // edi@1
  char v3; // al@1
  char v4; // al@1
  COutPacket oPacket; // [sp+4h] [bp-1Ch]@1
  int v6; // [sp+1Ch] [bp-4h]@1

  v2 = this;
  COutPacket::COutPacket(&oPacket, 18, 0);
  v6 = 0;
  v3 = CInPacket::Decode1(iPacket);
  COutPacket::Encode1(&oPacket, v3);
  v4 = CInPacket::Decode1(iPacket);
  COutPacket::Encode1(&oPacket, v4);
  CClientSocket::SendPacket(v2, &oPacket, 0);
  v6 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (0040FDD8) --------------------------------------------------------
void __thiscall CClientSocket::OnCheckPinCode(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  CInPacket *v3; // edi@3
  char v4; // al@3
  int v5; // ebx@5
  CInPacket *v6; // eax@5
  IWvsUnifiedDB *v7; // edi@10
  int v8; // eax@10
  signed int v9; // edi@12
  CInPacket *v10; // ST0C_4@18
  bool v11; // zf@21
  COutPacket oPacket; // [sp+Ch] [bp-28h]@28
  int v13; // [sp+1Ch] [bp-18h]@3
  char n[4]; // [sp+20h] [bp-14h]@10
  ZXString<char> result; // [sp+24h] [bp-10h]@8
  int v16; // [sp+30h] [bp-4h]@8

  v2 = this;
  if ( this->m_nLoginState != 4 )
  {
    CClientSocket::PostClose(this);
    return;
  }
  v3 = iPacket;
  v4 = CInPacket::Decode1(iPacket);
  v13 = (unsigned __int8)v4;
  if ( !v4 )
  {
    CClientSocket::ResetLoginState(v2, 1);
    return;
  }
  v5 = (unsigned __int8)CInPacket::Decode1(v3);
  iPacket = (CInPacket *)CInPacket::Decode4(v3);
  v6 = (CInPacket *)v2->m_dwAccountId;
  if ( iPacket != v6 )
  {
    CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aInvalidAccount, v6, iPacket);
    iPacket = (CInPacket *)-2147467259;
    _CxxThrowException(&iPacket, &_TI1_AVZException__);
  }
  CInPacket::DecodeStr(v3, &result);
  v16 = 0;
  if ( !g_pDB.m_pInterface )
    _com_issue_error(-2147467261);
  v7 = g_pDB.m_pInterface;
  v8 = ((int (__stdcall *)(IWvsUnifiedDB *, CInPacket *, char *, char *))g_pDB.m_pInterface->vfptr[3].AddRef)(
         g_pDB.m_pInterface,
         iPacket,
         result._m_pStr,
         n);
  if ( v8 < 0 )
    _com_issue_errorex(v8, (IUnknown *)&v7->vfptr, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
  v9 = *(_DWORD *)n;
  if ( v5 )
  {
    if ( *(_DWORD *)n && *(_DWORD *)n != 2 )
      goto $L134310;
    v9 = 4;
  }
  if ( v9 == 2 )
  {
    if ( ++v2->m_nFailCountbyPinCode > 4 )
    {
      v10 = iPacket;
      v2->m_nFailCountbyPinCode = 0;
      CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aPincodeCheckFa, v10);
      *(_DWORD *)n = -2147467259;
      _CxxThrowException(n, &_TI1_AVZException__);
    }
    goto LABEL_28;
  }
$L134310:
  if ( v9 )
  {
LABEL_23:
    if ( v9 == 1 )
      v2->m_nLoginState = 5;
    if ( v9 == 3 || v9 == 7 )
      CClientSocket::ResetLoginState(v2, 1);
    goto LABEL_28;
  }
  v11 = v13 == 2;
  v2->m_bIsPinCodeChecked = 1;
  if ( v11 )
  {
    v9 = 1;
    goto LABEL_23;
  }
LABEL_28:
  COutPacket::COutPacket(&oPacket, 13, 0);
  LOBYTE(v16) = 1;
  COutPacket::Encode1(&oPacket, v9);
  CClientSocket::SendPacket(v2, &oPacket, 0);
  LOBYTE(v16) = 0;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
  v16 = -1;
  ZXString<char>::~ZXString<char>(&result);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0040FF96) --------------------------------------------------------
void __thiscall CClientSocket::OnUpdatePinCode(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // edi@1
  IWvsUnifiedDB *v3; // esi@7
  int v4; // eax@7
  COutPacket oPacket; // [sp+4h] [bp-20h]@9
  ZXString<char> result; // [sp+14h] [bp-10h]@5
  int v7; // [sp+20h] [bp-4h]@5

  v2 = this;
  if ( this->m_nLoginState == 5 )
  {
    if ( CInPacket::Decode1(iPacket) )
    {
      CInPacket::DecodeStr(iPacket, &result);
      v7 = 0;
      if ( !g_pDB.m_pInterface )
        _com_issue_error(-2147467261);
      v3 = g_pDB.m_pInterface;
      v4 = ((int (__stdcall *)(IWvsUnifiedDB *, unsigned int, char *, CInPacket **))g_pDB.m_pInterface->vfptr[3].Release)(
             g_pDB.m_pInterface,
             v2->m_dwAccountId,
             result._m_pStr,
             &iPacket);
      if ( v4 < 0 )
        _com_issue_errorex(v4, (IUnknown *)&v3->vfptr, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
      COutPacket::COutPacket(&oPacket, 17, 0);
      LOBYTE(v7) = 1;
      COutPacket::Encode1(&oPacket, (char)iPacket);
      CClientSocket::SendPacket(v2, &oPacket, 0);
      CClientSocket::ResetLoginState(v2, 1);
      LOBYTE(v7) = 0;
      ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
      v7 = -1;
      ZXString<char>::~ZXString<char>(&result);
    }
    else
    {
      CClientSocket::ResetLoginState(v2, 1);
    }
  }
  else
  {
    CClientSocket::PostClose(this);
  }
}

//----- (00410079) --------------------------------------------------------
void __thiscall CClientSocket::OnSetGender(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // edi@1
  IWvsUnifiedDB *v3; // esi@7
  int v4; // eax@7
  COutPacket oPacket; // [sp+4h] [bp-20h]@5
  int v6; // [sp+14h] [bp-10h]@7
  int v7; // [sp+20h] [bp-4h]@5

  v2 = this;
  if ( this->m_nLoginState == 3 )
  {
    if ( CInPacket::Decode1(iPacket) )
    {
      LOBYTE(iPacket) = CInPacket::Decode1(iPacket);
      COutPacket::COutPacket(&oPacket, 14, 0);
      v7 = 0;
      if ( !g_pDB.m_pInterface )
        _com_issue_error(-2147467261);
      v3 = g_pDB.m_pInterface;
      v4 = ((int (__stdcall *)(IWvsUnifiedDB *, unsigned int, CInPacket *, int *))g_pDB.m_pInterface->vfptr[2].AddRef)(
             g_pDB.m_pInterface,
             v2->m_dwAccountId,
             iPacket,
             &v6);
      if ( v4 < 0 )
        _com_issue_errorex(v4, (IUnknown *)&v3->vfptr, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
      COutPacket::Encode1(&oPacket, (char)iPacket);
      if ( v6 )
      {
        COutPacket::Encode1(&oPacket, 0);
      }
      else
      {
        v2->m_nGender = (char)iPacket;
        COutPacket::Encode1(&oPacket, 1);
      }
      CClientSocket::SendPacket(v2, &oPacket, 0);
      v7 = -1;
      v2->m_nLoginState = 4;
      ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
    }
    else
    {
      CClientSocket::ResetLoginState(v2, 1);
    }
  }
  else
  {
    CClientSocket::PostClose(this);
  }
}

//----- (00410168) --------------------------------------------------------
void __thiscall CClientSocket::OnConfirmEULA(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  bool v3; // zf@1
  _bstr_t::Data_t *v4; // ecx@5
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v5; // eax@5
  IWzResMan *v6; // eax@5
  Ztl_variant_t *v7; // eax@5
  int v8; // eax@6
  int v9; // eax@9
  int v10; // eax@11
  int v11; // eax@13
  CInPacket *v12; // ecx@13
  IWzProperty *v13; // eax@15
  Ztl_variant_t *v14; // eax@15
  unsigned int v15; // ebx@15
  int v16; // eax@15
  unsigned int v17; // eax@19
  IWvsUnifiedDB *v18; // esi@19
  IUnknownVtbl *v19; // ecx@19
  int v20; // eax@19
  int v21; // ecx@22
  Ztl_bstr_t v22; // [sp-14h] [bp-88h]@5
  Ztl_variant_t *v23; // [sp-10h] [bp-84h]@5
  Ztl_variant_t *v24; // [sp-Ch] [bp-80h]@5
  Ztl_bstr_t v25; // [sp-8h] [bp-7Ch]@5
  CInPacket *v26; // [sp-4h] [bp-78h]@5
  Ztl_variant_t v27; // [sp+Ch] [bp-68h]@15
  Ztl_variant_t result; // [sp+1Ch] [bp-58h]@5
  _variant_t v29; // [sp+2Ch] [bp-48h]@5
  _variant_t v30; // [sp+3Ch] [bp-38h]@5
  COutPacket oPacket; // [sp+4Ch] [bp-28h]@17
  Ztl_bstr_t *v32; // [sp+5Ch] [bp-18h]@5
  int v33; // [sp+60h] [bp-14h]@5
  CClientSocket *v34; // [sp+64h] [bp-10h]@1
  int v35; // [sp+70h] [bp-4h]@5

  v2 = this;
  v3 = this->m_nLoginState == 2;
  v34 = this;
  if ( v3 )
  {
    if ( CInPacket::Decode1(iPacket) )
    {
      _variant_t::_variant_t(&v29, &vtMissing);
      v35 = 0;
      _variant_t::_variant_t(&v30, &vtMissing);
      v26 = 0;
      v25.m_Data = 0;
      v24 = (Ztl_variant_t *)&v29;
      v23 = (Ztl_variant_t *)&v30;
      v22.m_Data = v4;
      v32 = &v22;
      LOBYTE(v35) = 1;
      Ztl_bstr_t::Ztl_bstr_t(&v22, aStringTesteula);
      LOBYTE(v35) = 1;
      v5 = get_rm();
      v6 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v5);
      v7 = IWzResMan::GetObjectA(v6, &result, v22, v23, v24);
      LOBYTE(v35) = 3;
      v33 = (int)Ztl_variant_t::GetUnknown(v7, (char)v25.m_Data, (char)v26);
      iPacket = 0;
      if ( v33 )
      {
        v8 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
               (_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)&iPacket,
               (int)&v33);
        if ( v8 < 0 && v8 != -2147467262 )
          _com_issue_error(v8);
      }
      LOBYTE(v35) = 7;
      v9 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
      if ( v9 < 0 )
        _com_issue_error(v9);
      LOBYTE(v35) = 6;
      v10 = ZComAPI::ZComVariantClear((tagVARIANT *)&v30.0);
      if ( v10 < 0 )
        _com_issue_error(v10);
      LOBYTE(v35) = 5;
      v11 = ZComAPI::ZComVariantClear((tagVARIANT *)&v29.0);
      v12 = v26;
      if ( v11 < 0 )
        _com_issue_error(v11);
      v26 = 0;
      v25.m_Data = (_bstr_t::Data_t *)v12;
      v32 = &v25;
      Ztl_bstr_t::Ztl_bstr_t(&v25, aNumber);
      v24 = &v27;
      LOBYTE(v35) = 5;
      v13 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)&iPacket);
      v14 = IWzProperty::Getitem(v13, v24, v25);
      LOBYTE(v35) = 9;
      v15 = get_int32(v14, (int)v26);
      LOBYTE(v35) = 5;
      v16 = ZComAPI::ZComVariantClear((tagVARIANT *)&v27.0);
      if ( v16 < 0 )
        _com_issue_error(v16);
      COutPacket::COutPacket(&oPacket, 15, 0);
      LOBYTE(v35) = 10;
      if ( !g_pDB.m_pInterface )
        _com_issue_error(-2147467261);
      v17 = v34->m_dwAccountId;
      v18 = g_pDB.m_pInterface;
      v19 = g_pDB.m_pInterface->vfptr;
      v26 = (CInPacket *)&v32;
      v25.m_Data = (_bstr_t::Data_t *)v15;
      v24 = (Ztl_variant_t *)v17;
      v23 = (Ztl_variant_t *)g_pDB.m_pInterface;
      v20 = ((int (__stdcall *)(IWvsUnifiedDB *, unsigned int, unsigned int, int *))v19[3].QueryInterface)(
              g_pDB.m_pInterface,
              v17,
              v15,
              (int *)&v32);
      if ( v20 < 0 )
        _com_issue_errorex(v20, (IUnknown *)&v18->vfptr, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
      COutPacket::Encode1(&oPacket, v32 == 0);
      CClientSocket::SendPacket(v34, &oPacket, 0);
      CClientSocket::ResetLoginState(v34, 1);
      LOBYTE(v35) = 5;
      ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
      v35 = -1;
      if ( iPacket )
      {
        v21 = iPacket->m_bLoopback;
        v26 = iPacket;
        (*(void (__stdcall **)(CInPacket *))(v21 + 8))(iPacket);
      }
    }
    else
    {
      CClientSocket::ResetLoginState(v2, 1);
    }
  }
  else
  {
    CClientSocket::PostClose(this);
  }
}

//----- (00410367) --------------------------------------------------------
void __thiscall CClientSocket::OnLogoutWorld(CClientSocket *this, CInPacket *iPacket)
{
  this->m_bIsPinCodeChecked = 0;
  this->m_nLoginState = 1;
  CClientSocket::SendDisconnectPacket(this);
}

//----- (00410380) --------------------------------------------------------
void __thiscall CClientSocket::OnViewAllChar(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  ZArray<unsigned char> *v3; // ecx@2
  IWvsUnifiedDB *v4; // ebx@9
  int v5; // eax@9
  CCenter *v6; // eax@14
  unsigned int v7; // eax@15
  CCenter *v8; // eax@18
  int v9; // eax@19
  signed int v10; // ecx@22
  _DWORD *v11; // eax@23
  CCenter *v12; // eax@30
  int v13; // eax@31
  CCenter *v14; // eax@36
  int v15; // eax@37
  CCenter *v16; // ebx@40
  unsigned int v17; // ST10_4@44
  char *v18; // ecx@44
  COutPacket v19; // [sp+Ch] [bp-6Ch]@45
  COutPacket v20; // [sp+1Ch] [bp-5Ch]@44
  COutPacket oPacket; // [sp+2Ch] [bp-4Ch]@2
  COutPacket v22; // [sp+3Ch] [bp-3Ch]@29
  int v23; // [sp+4Ch] [bp-2Ch]@7
  _DWORD *v24; // [sp+50h] [bp-28h]@7
  CLoginApp *v25; // [sp+54h] [bp-24h]@14
  unsigned int n; // [sp+58h] [bp-20h]@14
  unsigned int v27; // [sp+5Ch] [bp-1Ch]@9
  ZArray<int> v28; // [sp+60h] [bp-18h]@14
  int i; // [sp+64h] [bp-14h]@17
  char v30; // [sp+6Bh] [bp-Dh]@17
  int v31; // [sp+74h] [bp-4h]@2

  v2 = this;
  if ( this->m_bIsVACDlgOn )
  {
    CVerboseObj::LogError((CVerboseObj *)&this->vfptr, aVacRequestDoub);
    COutPacket::COutPacket(&oPacket, 2, 0);
    v31 = 0;
    COutPacket::Encode1(&oPacket, 7);
    COutPacket::Encode1(&oPacket, 0);
    CClientSocket::SendPacket(v2, &oPacket, 0);
    v31 = -1;
    v3 = &oPacket.m_aSendBuff;
LABEL_13:
    ZArray<unsigned char>::RemoveAll(v3);
    return;
  }
  if ( !g_pDB.m_pInterface )
    _com_issue_error(-2147467261);
  if ( IWvsUnifiedDB::CheckUserConnected(g_pDB.m_pInterface, this->m_dwAccountId) )
  {
    COutPacket::COutPacket(&oPacket, 2, 0);
    v31 = 1;
    COutPacket::Encode1(&oPacket, 2);
    CClientSocket::SendPacket(v2, &oPacket, 0);
    CClientSocket::ResetLoginState(v2, 1);
    v31 = -1;
    v3 = &oPacket.m_aSendBuff;
    goto LABEL_13;
  }
  v24 = 0;
  v23 = 0;
  if ( !g_pDB.m_pInterface )
    _com_issue_error(-2147467261);
  v4 = g_pDB.m_pInterface;
  v5 = ((int (__stdcall *)(IWvsUnifiedDB *, unsigned int, _DWORD **, int *, unsigned int *))g_pDB.m_pInterface->vfptr[11].AddRef)(
         g_pDB.m_pInterface,
         v2->m_dwAccountId,
         &v24,
         &v23,
         &v27);
  if ( v5 < 0 )
    _com_issue_errorex(v5, (IUnknown *)&v4->vfptr, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
  if ( !v27 )
  {
    COutPacket::COutPacket(&oPacket, 2, 0);
    v31 = 2;
    COutPacket::Encode1(&oPacket, 4);
    CClientSocket::SendPacket(v2, &oPacket, 0);
    v31 = -1;
    v3 = &oPacket.m_aSendBuff;
    goto LABEL_13;
  }
  ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveAll(&v2->m_mCharIDName);
  ZMap<ZXString<char>,unsigned long,ZXString<char>>::RemoveAll(&v2->m_mNameWorldID);
  n = 0;
  v25 = TSingleton<CServerApp>::ms_pInstance;
  v28.a = 0;
  v6 = TSingleton<CServerApp>::ms_pInstance->m_aCenter.a;
  v31 = 3;
  if ( v6 )
    v7 = v6[-1].m_mServerStatus._m_uAutoGrowLimit;
  else
    v7 = 0;
  ZArray<int>::_Alloc(&v28, v7, (ZAllocHelper *)&v30);
  for ( i = 0; ; ++i )
  {
    v8 = v25->m_aCenter.a;
    v9 = v8 ? v8[-1].m_mServerStatus._m_uAutoGrowLimit : 0;
    if ( i >= v9 )
      break;
    v28.a[i] = 0;
    v10 = 0;
    if ( (signed int)v27 > 0 )
    {
      v11 = v24;
      while ( *v11 != i )
      {
        ++v10;
        ++v11;
        if ( v10 >= (signed int)v27 )
          goto LABEL_28;
      }
      ++n;
      v28.a[i] = 1;
    }
LABEL_28:
    ;
  }
  COutPacket::COutPacket(&v22, 2, 0);
  LOBYTE(v31) = 4;
  COutPacket::Encode1(&v22, 1);
  COutPacket::Encode4(&v22, n);
  COutPacket::Encode4(&v22, v27);
  CClientSocket::SendPacket(v2, &v22, 0);
  i = 0;
  for ( n = 0; ; n += 124 )
  {
    v12 = v25->m_aCenter.a;
    v13 = v12 ? v12[-1].m_mServerStatus._m_uAutoGrowLimit : 0;
    if ( i >= v13 )
      break;
    if ( v28.a[i] )
    {
      if ( i < 0
        || ((v14 = v25->m_aCenter.a) != 0 ? (v15 = v14[-1].m_mServerStatus._m_uAutoGrowLimit) : (v15 = 0), i >= v15) )
      {
        v16 = 0;
      }
      else
      {
        v16 = (CCenter *)((char *)v25->m_aCenter.a + n);
      }
      if ( v16 && v16->m_pSocket )
      {
        COutPacket::COutPacket(&v20, 17, 0);
        v17 = v2->m_uLocalSocketSN;
        LOBYTE(v31) = 6;
        COutPacket::Encode4(&v20, v17);
        COutPacket::Encode4(&v20, v2->m_dwAccountId);
        CCenter::SendPacket(v16, &v20);
        LOBYTE(v31) = 4;
        v18 = (char *)&v20.m_aSendBuff.a;
      }
      else
      {
        COutPacket::COutPacket(&v19, 2, 0);
        LOBYTE(v31) = 5;
        COutPacket::Encode1(&v19, 5);
        CClientSocket::SendPacket(v2, &v19, 0);
        LOBYTE(v31) = 4;
        v18 = (char *)&v19.m_aSendBuff.a;
      }
      ZArray<unsigned char>::RemoveAll((ZArray<unsigned char> *)v18);
    }
    ++i;
  }
  v2->m_nLoginState = 10;
  LOBYTE(v31) = 3;
  ZArray<unsigned char>::RemoveAll(&v22.m_aSendBuff);
  v31 = -1;
  ZArray<int>::RemoveAll(&v28);
}

//----- (004106A6) --------------------------------------------------------
void __thiscall CClientSocket::OnUpdate(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  int v3; // edi@1
  int v4; // eax@3
  int v5; // eax@6
  COutPacket *v6; // eax@8
  COutPacket v7; // [sp+8h] [bp-1Ch]@8
  int v8; // [sp+20h] [bp-4h]@8

  v2 = this;
  v3 = timeGetTime();
  if ( !v3 )
    v3 = 1;
  CSecuritySession::Update(v2->m_pSecuritySession, v3);
  v4 = v2->m_tAliveReqSent;
  if ( v4 )
  {
    if ( v3 - v4 > 60000 * (v2->m_bFirstAliveAck != 0 ? 8 : 3) )
    {
      CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aAliveCheckFa_1);
      CClientSocket::PostClose(v2);
    }
  }
  else
  {
    v5 = v2->m_tLastAliveAck;
    if ( !v5 || v3 - v5 > 7000 )
    {
      v2->m_tAliveReqSent = v3;
      COutPacket::COutPacket(&v7, 9, 0);
      v8 = 0;
      CClientSocket::SendPacket(v2, v6, 0);
      v8 = -1;
      ZArray<unsigned char>::RemoveAll(&v7.m_aSendBuff);
    }
  }
  v2->m_bUpdatePosted = 0;
}

//----- (00410770) --------------------------------------------------------
void __thiscall CClientSocket::OnClose(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1
  bool v3; // zf@3
  unsigned int *v4; // edi@3
  signed int v5; // ecx@5
  unsigned int v6; // ecx@7
  ZRef<CClientSocket> v7; // [sp+8h] [bp-18h]@1
  struct _RTL_CRITICAL_SECTION *v8; // [sp+10h] [bp-10h]@4
  int v9; // [sp+1Ch] [bp-4h]@3

  v2 = this;
  v7.p = this;
  if ( this )
    InterlockedIncrement(&this->_m_nRef);
  v3 = v2->m_dwAccountId == 0;
  v4 = &v2->m_dwAccountId;
  v9 = 0;
  if ( !v3 )
  {
    v8 = &CClientSocket::ms_lockClient;
    EnterCriticalSection(&CClientSocket::ms_lockClient);
    ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveKey(&CClientSocket::ms_mClient, &v2->m_dwAccountId);
    LOBYTE(v9) = 0;
    LeaveCriticalSection(&CClientSocket::ms_lockClient);
  }
  v5 = v2->m_nLoginState;
  if ( v5 < 7 || v5 >= 12 )
    v6 = 0;
  else
    v6 = *v4;
  v2->m_nLoginState = 13;
  *v4 = v6;
  CVerboseObj::LogReport((CVerboseObj *)&v2->vfptr, aClientSocketDi);
  CLoginAcceptor::RemoveSocket(TSingleton<CLoginAcceptor>::ms_pInstance, v2);
  v3 = v2->m_bIsVACDlgOn == 0;
  v2->m_posList = 0;
  if ( v3 && *v4 )
    CClientSocket::SendDisconnectPacket(v2);
  v9 = -1;
  if ( v7.p )
    ZRef<CClientSocket>::_ReleaseRaw(&v7, 0);
}

//----- (00410850) --------------------------------------------------------
void __thiscall CClientSocket::OnExceptionLog(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // ebx@1
  unsigned __int16 v3; // ax@1
  int v4; // esi@1
  unsigned int v5; // ST18_4@1
  char *v6; // eax@1
  ZXString<char> v7; // [sp+Ch] [bp-10h]@1
  int v8; // [sp+18h] [bp-4h]@1

  v2 = this;
  v3 = CInPacket::Decode2(iPacket);
  v4 = v3;
  v7._m_pStr = 0;
  v5 = v3;
  v8 = 0;
  v6 = ZXString<char>::GetBuffer(&v7, v3, 0);
  CInPacket::DecodeBuffer(iPacket, v6, v5);
  ZXString<char>::ReleaseBuffer(&v7, v4);
  CLog::OutputLog(TSingleton<CLog>::ms_pInstance, 1u, 0, 0, aSS, v2->m_sAddr._m_pStr, v7._m_pStr);
  v8 = -1;
  ZXString<char>::~ZXString<char>(&v7);
}

//----- (004108D0) --------------------------------------------------------
void __cdecl CClientSocket::RefreshProcessList()
{
  char *key; // [sp+8h] [bp-24h]@6
  int v1; // [sp+Ch] [bp-20h]@1
  int v2; // [sp+10h] [bp-1Ch]@4
  int v3; // [sp+14h] [bp-18h]@5
  ZXString<char> v4; // [sp+18h] [bp-14h]@6
  LPVOID pv; // [sp+1Ch] [bp-10h]@3
  int v6; // [sp+28h] [bp-4h]@4

  v1 = 0;
  if ( !g_pDB.m_pInterface )
    _com_issue_error(-2147467261);
  if ( g_pDB.m_pInterface->vfptr[17].QueryInterface((IUnknown *)g_pDB.m_pInterface, (_GUID *)&pv, (void **)&v1) >= 0 )
  {
    EnterCriticalSection(&CClientSocket::ms_lockGuardData);
    v6 = 0;
    ZMap<char const *,int,ZXString<char>>::RemoveAll(&CClientSocket::ms_mWhiteProcessName);
    v2 = 0;
    if ( v1 > 0 )
    {
      v3 = 0;
      do
      {
        v4._m_pStr = 0;
        ZXString<char>::Assign(&v4, (const char *)pv + v3, -1);
        LOBYTE(v6) = 1;
        ZXString<char>::MakeUpper(&v4);
        key = v4._m_pStr;
        ZMap<char const *,int,ZXString<char>>::Insert(
          &CClientSocket::ms_mWhiteProcessName,
          (const char *const *)&key,
          0);
        LOBYTE(v6) = 0;
        ZXString<char>::~ZXString<char>(&v4);
        ++v2;
        v3 += 33;
      }
      while ( v2 < v1 );
    }
    LeaveCriticalSection(&CClientSocket::ms_lockGuardData);
  }
  if ( pv )
    CoTaskMemFree(pv);
}

//----- (004109B1) --------------------------------------------------------
void __thiscall CClientSocket::OnWorldRequest(CClientSocket *this, CInPacket *iPacket)
{
  CClientSocket *v2; // esi@1

  v2 = this;
  if ( this->m_bIsPinCodeChecked
    || this->m_bAdminclient
    && CClientSocket::IsSkipCrcIP(this)
    && CIPChecker::GetFlag(TSingleton<CIPChecker>::ms_pInstance, v2->m_addr.sin_addr.S_un.S_addr) & 2 )
  {
    CClientSocket::SendWorldInformation(v2);
    v2->m_nLoginState = 6;
  }
  else
  {
    CVerboseObj::LogError((CVerboseObj *)&v2->vfptr, aUserTriedToSel);
    CClientSocket::PostClose(v2);
  }
}

//----- (00410A16) --------------------------------------------------------
BOOL __cdecl CSecuritySessionHelper::IsSkipCrcIP(CClientSocket *pSocket)
{
  return CClientSocket::IsSkipCrcIP(pSocket) && pSocket->m_nPrivateStatusID & 4;
}

//----- (00410A38) --------------------------------------------------------
void __cdecl CSecuritySessionHelper::SendPacket(CClientSocket *pSocket, COutPacket *oPacket)
{
  CClientSocket::SendPacket(pSocket, oPacket, 0);
}

//----- (00410A48) --------------------------------------------------------
int __cdecl CSecuritySessionHelper::IsAdminClient(CClientSocket *pSocket)
{
  return pSocket->m_bAdminclient;
}

//----- (00410A53) --------------------------------------------------------
void __cdecl CSecuritySessionHelper::CloseSocket(CClientSocket *pSocket)
{
  CClientSocket::PostClose(pSocket);
}

//----- (00410A5C) --------------------------------------------------------
ZXString<char> *__cdecl CSecuritySessionHelper::GetLogInfo(ZXString<char> *result, CClientSocket *__$ReturnUdt)
{
  char *v2; // eax@1

  v2 = __$ReturnUdt->m_sAddr._m_pStr;
  result->_m_pStr = 0;
  ZXString<char>::Assign(result, v2, -1);
  return result;
}

//----- (00410A83) --------------------------------------------------------
IWzResMan *__thiscall _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *this)
{
  if ( !this->m_pInterface )
    _com_issue_error(-2147467261);
  return this->m_pInterface;
}

//----- (00410A99) --------------------------------------------------------
void __thiscall ZXString<char>::ZXString<char>(ZXString<char> *this, ZXString<char> *s)
{
  this->_m_pStr = 0;
  ZXString<char>::operator=(this, s);
}

//----- (00410AAE) --------------------------------------------------------
void __thiscall ZXString<char>::MakeUpper(ZXString<char> *this)
{
  ZXString<char> *v1; // esi@1
  char *v2; // eax@3
  int v3; // eax@4

  v1 = this;
  if ( this->_m_pStr && *this->_m_pStr )
  {
    v2 = ZXString<char>::GetBuffer(this, 0, 1);
    _strupr(v2);
    if ( v1->_m_pStr )
      v3 = *((_DWORD *)v1->_m_pStr - 1);
    else
      v3 = 0;
    ZXString<char>::ReleaseBuffer(v1, v3);
  }
}

//----- (00410AE3) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::~ZMap<unsigned long,ZXString<char>,unsigned long>(ZMap<unsigned long,ZXString<char>,unsigned long> *this)
{
  this->vfptr = (ZMap<unsigned long,ZXString<char>,unsigned long>Vtbl *)&ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable';
  ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveAll(this);
}
// 44360C: using guessed type int (__thiscall *ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (00410AEE) --------------------------------------------------------
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::~ZMap<ZXString<char>,unsigned long,ZXString<char>>(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this)
{
  this->vfptr = (ZMap<ZXString<char>,unsigned long,ZXString<char> >Vtbl *)&ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable';
  ZMap<ZXString<char>,unsigned long,ZXString<char>>::RemoveAll(this);
}
// 443604: using guessed type int (__thiscall *ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable')(void *p, unsigned int __flags);

//----- (00410AF9) --------------------------------------------------------
void __thiscall ZRef<CMxHelperServerManager>::~ZRef<CMxHelperServerManager>(ZRef<CMxHelperServerManager> *this)
{
  ZRef<CMxHelperServerManager> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<CMxHelperServerManager>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (00410B0F) --------------------------------------------------------
void __thiscall _variant_t::_variant_t(_variant_t *this, _variant_t *varSrc)
{
  _variant_t *v2; // esi@1
  int v3; // eax@1

  v2 = this;
  VariantInit((VARIANTARG *)&this->0);
  v3 = ZComAPI::ZComVariantCopy((tagVARIANT *)&v2->0, (tagVARIANT *)&varSrc->0);
  if ( v3 < 0 )
    _com_issue_error(v3);
}

//----- (00410B35) --------------------------------------------------------
ZMap<unsigned long,ZXString<char>,unsigned long> *__thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::`scalar deleting destructor'(ZMap<unsigned long,ZXString<char>,unsigned long> *this, unsigned int __flags)
{
  ZMap<unsigned long,ZXString<char>,unsigned long> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZMap<unsigned long,ZXString<char>,unsigned long>Vtbl *)&ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable';
  ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 44360C: using guessed type int (__thiscall *ZMap<unsigned long,ZXString<char>,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (00410B5B) --------------------------------------------------------
ZMap<ZXString<char>,unsigned long,ZXString<char> > *__thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::`scalar deleting destructor'(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, unsigned int __flags)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZMap<ZXString<char>,unsigned long,ZXString<char> >Vtbl *)&ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable';
  ZMap<ZXString<char>,unsigned long,ZXString<char>>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 443604: using guessed type int (__thiscall *ZMap<ZXString<char>,unsigned long,ZXString<char>>::`vftable')(void *p, unsigned int __flags);

//----- (00410B81) --------------------------------------------------------
ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *__thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vector deleting destructor'(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, unsigned int __flags)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>Vtbl *)&ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable';
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 4435D4: using guessed type int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (00410BA7) --------------------------------------------------------
ZMap<char const *,int,ZXString<char> > *__thiscall ZMap<char const *,int,ZXString<char>>::`vector deleting destructor'(ZMap<char const *,int,ZXString<char> > *this, unsigned int __flags)
{
  ZMap<char const *,int,ZXString<char> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZMap<char const *,int,ZXString<char> >Vtbl *)&ZMap<char const *,int,ZXString<char>>::`vftable';
  ZMap<char const *,int,ZXString<char>>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 4435CC: using guessed type int (__thiscall *ZMap<char const *,int,ZXString<char>>::`vftable')(void *p, unsigned int __flags);

//----- (00410BCD) --------------------------------------------------------
void __thiscall ZRef<CMxHelperServerManager>::_Alloc(ZRef<CMxHelperServerManager> *this)
{
  ZRef<CMxHelperServerManager> *v1; // esi@1
  CMxHelperServerManager *v2; // eax@3

  v1 = this;
  if ( this->p )
  {
    ZRef<CMxHelperServerManager>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
  ZRefCounted_Alloc();
  v2->_m_nRef = 1;
  v1->p = v2;
}

//----- (00410BF5) --------------------------------------------------------
void __thiscall ZRef<CMxHelperServerManager>::_ReleaseRaw(ZRef<CMxHelperServerManager> *this, ZRefCounted *__formal)
{
  ZRef<CMxHelperServerManager> *v2; // esi@1

  v2 = this;
  if ( !InterlockedDecrement(&this->p->_m_nRef) )
  {
    InterlockedIncrement(&v2->p->_m_nRef);
    ZRefCountedAccessorBase::_Delete((ZRefCounted *)&v2->p->vfptr);
  }
}

//----- (00410C23) --------------------------------------------------------
ZXString<char> *__thiscall ZXString<char>::TrimRight(ZXString<char> *this, const char *sWhiteSpaceSet)
{
  ZXString<char> *v2; // edi@1
  char *v3; // eax@3
  char *v4; // ebx@6
  int v5; // eax@7
  unsigned int v6; // esi@9
  int v7; // eax@13
  ZXString<char> *result; // eax@15

  v2 = this;
  if ( !sWhiteSpaceSet )
    sWhiteSpaceSet = asc_454C8C;
  v3 = this->_m_pStr;
  if ( this->_m_pStr && *v3 && strchr(sWhiteSpaceSet, v3[*((_DWORD *)v3 - 1) - 1]) )
  {
    v4 = ZXString<char>::GetBuffer(v2, 0, 1);
    if ( v2->_m_pStr )
      v5 = *((_DWORD *)v2->_m_pStr - 1);
    else
      v5 = 0;
    v6 = (unsigned int)&v4[v5 - 2];
    if ( v6 < (unsigned int)v4 )
      goto LABEL_19;
    do
    {
      if ( !strchr(sWhiteSpaceSet, *(_BYTE *)v6) )
        break;
      --v6;
    }
    while ( v6 >= (unsigned int)v4 );
    if ( v6 >= (unsigned int)v4 )
    {
      *(_BYTE *)(v6 + 1) = 0;
      ZXString<char>::ReleaseBuffer(v2, v6 + 1 - (_DWORD)v4);
    }
    else
    {
LABEL_19:
      v7 = (int)(v2->_m_pStr - 12);
      *(_DWORD *)v7 = 1;
      *v2->_m_pStr = 0;
      *(_DWORD *)(v7 + 8) = 0;
      ZXString<char>::Empty(v2);
    }
    result = v2;
  }
  else
  {
    result = v2;
  }
  return result;
}

//----- (00410CD8) --------------------------------------------------------
ZXString<char> *__thiscall ZXString<char>::TrimLeft(ZXString<char> *this, const char *sWhiteSpaceSet)
{
  ZXString<char> *v2; // edi@1
  char v3; // al@4
  char *v4; // ebp@6
  const void *i; // esi@6
  ZXString<char> v6; // eax@10
  int v7; // eax@11
  int v8; // eax@13
  int v9; // eax@15
  int v10; // ebx@15
  ZXString<char> *result; // eax@16

  v2 = this;
  if ( !sWhiteSpaceSet )
    sWhiteSpaceSet = asc_454C8C;
  if ( this->_m_pStr && (v3 = *this->_m_pStr) != 0 && strchr(sWhiteSpaceSet, v3) )
  {
    v4 = ZXString<char>::GetBuffer(v2, 0, 1);
    for ( i = v4 + 1; *(_BYTE *)i && strchr(sWhiteSpaceSet, *(_BYTE *)i); i = (char *)i + 1 )
      ;
    v6._m_pStr = v2->_m_pStr;
    if ( *(_BYTE *)i )
    {
      if ( v6._m_pStr )
        v8 = *((_DWORD *)v6._m_pStr - 1);
      else
        v8 = 0;
      v9 = v8 - (_DWORD)i;
      v10 = (int)&v4[v9];
      memmove(v4, i, (size_t)&v4[v9]);
      ZXString<char>::ReleaseBuffer(v2, v10);
    }
    else
    {
      v7 = (int)(v6._m_pStr - 12);
      *(_DWORD *)v7 = 1;
      *v2->_m_pStr = 0;
      *(_DWORD *)(v7 + 8) = 0;
      ZXString<char>::Empty(v2);
    }
    result = v2;
  }
  else
  {
    result = v2;
  }
  return result;
}

//----- (00410D90) --------------------------------------------------------
void __cdecl ZXString<char>::_Release(ZXString<char>::_ZXStringData *pData)
{
  if ( InterlockedDecrement(&pData->nRef) <= 0 )
    ZAllocEx<ZAllocStrSelector<char>>::Free(&ZAllocEx<ZAllocStrSelector<char>>::_s_alloc, pData);
}

//----- (00410DAD) --------------------------------------------------------
ZXString<char> *__thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::GetAt(ZMap<unsigned long,ZXString<char>,unsigned long> *this, const unsigned int *key, ZXString<char> *value)
{
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v3; // esi@2
  ZXString<char> *result; // eax@5

  if ( this->_m_apTable && (v3 = this->_m_apTable[_lrotr(*key, 5) % this->_m_uTableSize]) != 0 )
  {
    while ( v3->key != *key )
    {
      v3 = v3->pNext;
      if ( !v3 )
        goto LABEL_5;
    }
    if ( value )
      ZXString<char>::operator=(value, &v3->value);
    result = &v3->value;
  }
  else
  {
LABEL_5:
    result = 0;
  }
  return result;
}

//----- (00410E01) --------------------------------------------------------
__POSITION *__thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::Insert(ZMap<unsigned long,ZXString<char>,unsigned long> *this, const unsigned int *key, ZXString<char> *value)
{
  ZMap<unsigned long,ZXString<char>,unsigned long> *v3; // esi@1
  unsigned int v4; // eax@2
  unsigned __int32 v5; // edx@7
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **v6; // eax@7
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v7; // edi@7
  void **v8; // ebx@7
  void **v9; // eax@10
  void **v10; // esi@11
  __POSITION *result; // eax@14

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<unsigned long,ZXString<char>,unsigned long>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = _lrotr(*key, 5) % v3->_m_uTableSize;
  v6 = v3->_m_apTable;
  v7 = v6[v5];
  v8 = (void **)&v6[v5];
  if ( v7 )
  {
    while ( v7->key != *key )
    {
      v7 = v7->pNext;
      if ( !v7 )
        goto LABEL_10;
    }
    if ( value )
      ZXString<char>::operator=(&v7->value, value);
    result = (__POSITION *)v7;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    v9 = ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance);
    if ( v9 )
    {
      v9[1] = *v8;
      *v9 = &ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable';
      v9[2] = (void *)*key;
      v9[3] = 0;
      *v9 = &ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::`vftable';
      v10 = v9;
    }
    else
    {
      v10 = 0;
    }
    if ( value )
      ZXString<char>::operator=((ZXString<char> *)v10 + 3, value);
    *v8 = v10;
    result = (__POSITION *)v10;
  }
  return result;
}
// 443614: using guessed type int (__thiscall *ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 44361C: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00410EC9) --------------------------------------------------------
ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 44361C: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00410EEB) --------------------------------------------------------
int __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveKey(ZMap<unsigned long,ZXString<char>,unsigned long> *this, const unsigned int *key)
{
  ZMap<unsigned long,ZXString<char>,unsigned long> *v2; // esi@1
  unsigned __int32 v3; // edx@2
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **v4; // eax@2
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v5; // ecx@2
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **v6; // eax@2
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *i; // eax@5

  v2 = this;
  if ( !this->_m_apTable )
    return 0;
  v3 = _lrotr(*key, 5) % this->_m_uTableSize;
  v4 = v2->_m_apTable;
  v5 = v4[v3];
  v6 = &v4[v3];
  if ( !v5 )
    return 0;
  if ( v5->key != *key )
  {
    for ( i = v5->pNext; i; i = i->pNext )
    {
      if ( i->key == *key )
      {
        v5->pNext = i->pNext;
        v5 = i;
        goto found_0;
      }
      v5 = i;
    }
    return 0;
  }
  *v6 = v5->pNext;
found_0:
  if ( v5 )
    ((void (__stdcall *)(signed int))v5->vfptr->__vecDelDtor)(1);
  --v2->_m_uCount;
  return 1;
}

//----- (00410F59) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::RemoveAll(ZMap<unsigned long,ZXString<char>,unsigned long> *this)
{
  ZMap<unsigned long,ZXString<char>,unsigned long> *v1; // edi@1
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v4; // ecx@3
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (00410FAA) --------------------------------------------------------
unsigned int *__thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::GetAt(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, ZXString<char> *key, unsigned int *value)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *i; // esi@2

  if ( this->_m_apTable )
  {
    for ( i = this->_m_apTable[HashKey(key->_m_pStr) % this->_m_uTableSize]; i; i = i->pNext )
    {
      if ( ZXString<char>::operator==(&i->key, key) )
      {
        if ( value )
          *value = i->value;
        return &i->value;
      }
    }
  }
  return 0;
}

//----- (00410FFA) --------------------------------------------------------
unsigned int __cdecl HashKey(const char *s)
{
  unsigned int result; // eax@1
  const char *v2; // edx@1
  char i; // cl@2

  result = 0;
  v2 = s;
  if ( s )
  {
    for ( i = *s; i; i = *v2 )
    {
      ++v2;
      result = 32 * result + i + 1;
    }
  }
  return result;
}

//----- (0041101C) --------------------------------------------------------
ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *__thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::Insert(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, ZXString<char> *key, const unsigned int *value)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char> > *v3; // esi@1
  unsigned int v4; // eax@2
  unsigned int v5; // eax@7
  char *v6; // edx@7
  char i; // cl@8
  int v8; // edx@11
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR **v9; // eax@11
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *v10; // edi@11
  void ***v11; // ebx@11
  void **v13; // esi@18
  void **v14; // eax@19

  v3 = this;
  if ( !this->_m_apTable )
  {
    v4 = this->_m_uTableSize;
    goto LABEL_5;
  }
  if ( this->_m_uCount > this->_m_uAutoGrowLimit )
  {
    v4 = 2 * this->_m_uTableSize + 1;
LABEL_5:
    if ( v4 )
      ZMap<ZXString<char>,unsigned long,ZXString<char>>::ResizeHashTable(this, v4, 0);
  }
  v5 = 0;
  v6 = key->_m_pStr;
  if ( key->_m_pStr )
  {
    for ( i = *key->_m_pStr; i; i = *v6 )
    {
      ++v6;
      v5 = 32 * v5 + i + 1;
    }
  }
  v8 = v5 % v3->_m_uTableSize;
  v9 = v3->_m_apTable;
  v10 = v9[v8];
  v11 = (void ***)&v9[v8];
  while ( v10 )
  {
    if ( ZXString<char>::operator==(&v10->key, key) )
    {
      if ( value )
        v10->value = *value;
      return v10;
    }
    v10 = v10->pNext;
  }
  ++v3->_m_uCount;
  v13 = ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance);
  if ( v13 )
  {
    v14 = *v11;
    *v13 = &ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable';
    v13[1] = v14;
    v13[2] = 0;
    ZXString<char>::operator=((ZXString<char> *)v13 + 2, key);
    *v13 = &ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::`vftable';
  }
  else
  {
    v13 = 0;
  }
  if ( value )
    v13[3] = (void *)*value;
  *v11 = v13;
  return (ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *)v13;
}
// 443624: using guessed type int (__thiscall *ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 44362C: using guessed type int (__thiscall *ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041110F) --------------------------------------------------------
void __thiscall ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::~ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this)
{
  this->vfptr = (ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR>Vtbl *)&ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable';
}
// 44362C: using guessed type int (__thiscall *ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00411116) --------------------------------------------------------
ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *__thiscall ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR>Vtbl *)&ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 44362C: using guessed type int (__thiscall *ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00411138) --------------------------------------------------------
void __cdecl ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::raw_delete(
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance,
    p);
}

//----- (00411148) --------------------------------------------------------
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::RemoveAll(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char> > *v1; // edi@1
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *v4; // ecx@3
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (00411199) --------------------------------------------------------
int __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveKey(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, const unsigned int *key)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *v2; // esi@1
  unsigned __int32 v3; // edx@2
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **v4; // eax@2
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v5; // ecx@2
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **v6; // eax@2
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *i; // eax@5

  v2 = this;
  if ( !this->_m_apTable )
    return 0;
  v3 = _lrotr(*key, 5) % this->_m_uTableSize;
  v4 = v2->_m_apTable;
  v5 = v4[v3];
  v6 = &v4[v3];
  if ( !v5 )
    return 0;
  if ( v5->key != *key )
  {
    for ( i = v5->pNext; i; i = i->pNext )
    {
      if ( i->key == *key )
      {
        v5->pNext = i->pNext;
        v5 = i;
        goto found_1;
      }
      v5 = i;
    }
    return 0;
  }
  *v6 = v5->pNext;
found_1:
  if ( v5 )
    ((void (__stdcall *)(signed int))v5->vfptr->__vecDelDtor)(1);
  --v2->_m_uCount;
  return 1;
}

//----- (00411207) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveAll(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *v1; // edi@1
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v4; // ecx@3
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (00411258) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_CalcAutoGrow(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (0041127C) --------------------------------------------------------
ZMap<char const *,int,ZXString<char> >::_PAIR *__thiscall ZMap<char const *,int,ZXString<char>>::Insert(ZMap<char const *,int,ZXString<char> > *this, const char *const *key, const int *value)
{
  ZMap<char const *,int,ZXString<char> > *v3; // esi@1
  unsigned int v4; // eax@2
  const char *v5; // ecx@7
  unsigned int v6; // eax@7
  int v7; // edx@10
  ZMap<char const *,int,ZXString<char> >::_PAIR **v8; // eax@10
  ZMap<char const *,int,ZXString<char> >::_PAIR *v9; // ebx@10
  void ***v10; // edi@10
  const char *v11; // eax@12
  char *v12; // ecx@14
  void **v14; // esi@21
  const char *v15; // ST00_4@22
  void **v16; // eax@22
  char v17; // [sp+10h] [bp-14h]@1
  ZXString<char> s; // [sp+14h] [bp-10h]@22
  int v19; // [sp+20h] [bp-4h]@21

  v3 = this;
  v17 = 0;
  if ( !this->_m_apTable )
  {
    v4 = this->_m_uTableSize;
    goto LABEL_5;
  }
  if ( this->_m_uCount > this->_m_uAutoGrowLimit )
  {
    v4 = 2 * this->_m_uTableSize + 1;
LABEL_5:
    if ( v4 )
      ZMap<char const *,int,ZXString<char>>::ResizeHashTable(this, v4, 0);
  }
  v5 = *key;
  v6 = 0;
  if ( *key )
  {
    while ( *v5 )
      v6 = 32 * v6 + *v5++ + 1;
  }
  v7 = v6 % v3->_m_uTableSize;
  v8 = v3->_m_apTable;
  v9 = v8[v7];
  v10 = (void ***)&v8[v7];
  while ( v9 )
  {
    v11 = *key;
    if ( !*key )
      v11 = ZXString<char>::_s_sEmpty._m_pStr;
    v12 = v9->key._m_pStr;
    if ( !v12 )
      v12 = ZXString<char>::_s_sEmpty._m_pStr;
    if ( !strcmp(v12, v11) )
    {
      if ( value )
        v9->value = *value;
      return v9;
    }
    v9 = v9->pNext;
  }
  ++v3->_m_uCount;
  v14 = ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance);
  v19 = 0;
  if ( v14 )
  {
    v15 = *key;
    s._m_pStr = 0;
    ZXString<char>::Assign(&s, v15, -1);
    v17 = 1;
    v16 = *v10;
    *v14 = &ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable';
    v14[1] = v16;
    v19 = 2;
    v14[2] = 0;
    ZXString<char>::operator=((ZXString<char> *)v14 + 2, &s);
    *v14 = &ZMap<char const *,int,ZXString<char>>::_PAIR::`vftable';
  }
  else
  {
    v14 = 0;
  }
  v19 = -1;
  if ( v17 & 1 )
    ZXString<char>::~ZXString<char>(&s);
  if ( value )
    v14[3] = (void *)*value;
  *v10 = v14;
  return (ZMap<char const *,int,ZXString<char> >::_PAIR *)v14;
}
// 443634: using guessed type int (__thiscall *ZMap<char const *,int,ZXString<char>>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 44363C: using guessed type int (__thiscall *ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004113BB) --------------------------------------------------------
void __thiscall ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::~ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this)
{
  this->vfptr = (ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR>Vtbl *)&ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable';
}
// 44363C: using guessed type int (__thiscall *ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004113C2) --------------------------------------------------------
ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *__thiscall ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR>Vtbl *)&ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 44363C: using guessed type int (__thiscall *ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004113E4) --------------------------------------------------------
void __cdecl ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::raw_delete(
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance,
    p);
}

//----- (004113F4) --------------------------------------------------------
void __thiscall ZMap<char const *,int,ZXString<char>>::RemoveAll(ZMap<char const *,int,ZXString<char> > *this)
{
  ZMap<char const *,int,ZXString<char> > *v1; // edi@1
  ZMap<char const *,int,ZXString<char> >::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<char const *,int,ZXString<char> >::_PAIR *v4; // ecx@3
  ZMap<char const *,int,ZXString<char> >::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (00411445) --------------------------------------------------------
void __thiscall ZMap<char const *,int,ZXString<char>>::_CalcAutoGrow(ZMap<char const *,int,ZXString<char> > *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (00411469) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0041148F) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (004114B5) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (004114DB) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  CMxHelperServerManager *v0; // ecx@1

  v0 = (CMxHelperServerManager *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x14u);
  if ( v0 )
    CMxHelperServerManager::CMxHelperServerManager(v0);
}

//----- (00411511) --------------------------------------------------------
void _E80()
{
  _E67();
  _E68();
  _E69();
  _E70();
  _E71();
  _E72();
  _E73();
  _E74();
  _E75();
  _E76();
  _E77();
  _E78();
  _E79();
}

//----- (00411552) --------------------------------------------------------
void _E67()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0041158D) --------------------------------------------------------
void _E68()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (004115C8) --------------------------------------------------------
void _E69()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::s_pInstance = v3;
}

//----- (00411603) --------------------------------------------------------
void _E70()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::s_pInstance = v3;
}

//----- (0041163E) --------------------------------------------------------
void _E71()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::s_pInstance = v3;
}

//----- (00411679) --------------------------------------------------------
void _E72()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::s_pInstance = v3;
}

//----- (004116B4) --------------------------------------------------------
void _E73()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::s_pInstance = v3;
}

//----- (004116EF) --------------------------------------------------------
void _E74()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0041172A) --------------------------------------------------------
void _E75()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (00411765) --------------------------------------------------------
void _E76()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (004117A0) --------------------------------------------------------
void _E77()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (004117DB) --------------------------------------------------------
void _E78()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00411816) --------------------------------------------------------
void _E79()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance = v3;
}

//----- (00411851) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443644: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00411884) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 44364C: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004118B7) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443654: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004118EA) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 44365C: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041191D) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443664: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00411950) --------------------------------------------------------
ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::`scalar deleting destructor'(ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *this, unsigned int __flags)
{
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (00411971) --------------------------------------------------------
ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *__thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::`scalar deleting destructor'(ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *this, unsigned int __flags)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (00411992) --------------------------------------------------------
ZMap<char const *,int,ZXString<char> >::_PAIR *__thiscall ZMap<char const *,int,ZXString<char>>::_PAIR::`scalar deleting destructor'(ZMap<char const *,int,ZXString<char> >::_PAIR *this, unsigned int __flags)
{
  ZMap<char const *,int,ZXString<char> >::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<char const *,int,ZXString<char>>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (004119B3) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004119D3) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004119F3) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00411A13) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00411A33) --------------------------------------------------------
ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *__thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vector deleting destructor'(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00411A53) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR::~_PAIR(ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *this)
{
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v1; // esi@1

  v1 = this;
  ZXString<char>::~ZXString<char>(&this->value);
  v1->vfptr = (ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable';
}
// 44361C: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00411A83) --------------------------------------------------------
void __thiscall ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::~ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this)
{
  this->vfptr = (ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable';
}
// 44361C: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00411A8A) --------------------------------------------------------
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR::~_PAIR(ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *this)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *v1; // esi@1

  v1 = this;
  ZXString<char>::~ZXString<char>(&this->key);
  v1->vfptr = (ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR>Vtbl *)&ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable';
}
// 44362C: using guessed type int (__thiscall *ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00411ABA) --------------------------------------------------------
void __thiscall ZMap<char const *,int,ZXString<char>>::_PAIR::~_PAIR(ZMap<char const *,int,ZXString<char> >::_PAIR *this)
{
  ZMap<char const *,int,ZXString<char> >::_PAIR *v1; // esi@1

  v1 = this;
  ZXString<char>::~ZXString<char>(&this->key);
  v1->vfptr = (ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR>Vtbl *)&ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable';
}
// 44363C: using guessed type int (__thiscall *ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00411AEA) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00411AFF) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00411B14) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00411B29) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::~ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00411B3E) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::~ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00411B53) --------------------------------------------------------
Ztl_variant_t *__thiscall IWzResMan::GetObjectA(IWzResMan *this, Ztl_variant_t *result, Ztl_bstr_t __$ReturnUdt, Ztl_variant_t *sUOL, Ztl_variant_t *vParam)
{
  IWzResMan *v5; // ebx@1
  unsigned __int16 *v6; // eax@2
  int v7; // eax@4
  VARIANTARG *v9; // [sp-4h] [bp-30h]@4
  VARIANTARG pvarg; // [sp+Ch] [bp-20h]@1
  int v11; // [sp+1Ch] [bp-10h]@1
  int v12; // [sp+28h] [bp-4h]@1

  v11 = 0;
  v5 = this;
  v12 = 0;
  VariantInit(&pvarg);
  if ( __$ReturnUdt.m_Data )
    v6 = __$ReturnUdt.m_Data->m_wstr;
  else
    v6 = 0;
  v9 = &pvarg;
  v7 = ((int (__stdcall *)(IWzResMan *, unsigned __int16 *, _DWORD, unsigned int, unsigned int, unsigned int, _DWORD, unsigned int, unsigned int, unsigned int, VARIANTARG *))v5->vfptr[2].AddRef)(
         v5,
         v6,
         *(_DWORD *)&sUOL->vt,
         sUOL->decVal.Hi32,
         sUOL->decVal.Lo32,
         sUOL->decVal.Mid32,
         *(_DWORD *)&vParam->vt,
         vParam->decVal.Hi32,
         vParam->decVal.Lo32,
         vParam->decVal.Mid32,
         &pvarg);
  if ( v7 < 0 )
    _com_issue_errorex(v7, (IUnknown *)&v5->vfptr, &_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf);
  _variant_t::_variant_t((_variant_t *)&result->0, &pvarg, 0);
  if ( __$ReturnUdt.m_Data )
    _bstr_t::Data_t::Release(__$ReturnUdt.m_Data);
  return result;
}

//----- (00411BE5) --------------------------------------------------------
_FILETIME *__thiscall IWvsUnifiedDB::CheckPassword(IWvsUnifiedDB *this, char *sId, char *sPasswd, int nRegionID, int nTemporaryDue, int nWaitingDue, unsigned int *pdwAccountID, char *pnGender, int *pnBirthDate, char *pnCountryId, char *pnGradeCode, unsigned __int16 **pbsNexonClubID, char *pnRegStatID, int *pnUseDay, char *pnPurchaseExp, int *pnBlockReason, _FILETIME *pdtUnblockDate, int *pnChatBlockReason, _FILETIME *pdtChatUnblockDate, char *pnPrivateStatusID, _FILETIME *pdtRegisterDate)
{
  IWvsUnifiedDB *v21; // esi@1
  int v22; // eax@1

  v21 = this;
  v22 = ((int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))this->vfptr[9].Release)(
          this,
          sId,
          sPasswd,
          nRegionID,
          nTemporaryDue,
          nWaitingDue,
          pdwAccountID,
          pnGender,
          pnBirthDate,
          pnCountryId,
          pnGradeCode,
          pbsNexonClubID,
          pnRegStatID,
          pnUseDay,
          pnPurchaseExp,
          pnBlockReason,
          pdtUnblockDate,
          pnChatBlockReason,
          pdtChatUnblockDate,
          pnPrivateStatusID,
          pdtRegisterDate,
          &pdtRegisterDate);
  if ( v22 < 0 )
    _com_issue_errorex(v22, (IUnknown *)&v21->vfptr, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
  return pdtRegisterDate;
}

//----- (00411C49) --------------------------------------------------------
unsigned int __thiscall IWvsUnifiedDB::CheckUserConnected(IWvsUnifiedDB *this, unsigned int dwAccountID)
{
  IWvsUnifiedDB *v2; // esi@1
  int v3; // eax@1

  v2 = this;
  v3 = this->vfptr[11].QueryInterface((IUnknown *)this, (_GUID *)dwAccountID, (void **)&dwAccountID);
  if ( v3 < 0 )
    _com_issue_errorex(v3, (IUnknown *)&v2->vfptr, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
  return dwAccountID;
}

//----- (00411C77) --------------------------------------------------------
int __thiscall ZXString<char>::operator==(ZXString<char> *this, ZXString<char> *s)
{
  char *v2; // eax@1
  char *v3; // ecx@1
  int result; // eax@2
  int v5; // esi@4
  int v6; // edx@7

  v2 = this->_m_pStr;
  v3 = s->_m_pStr;
  if ( v2 == s->_m_pStr )
  {
    result = 1;
  }
  else
  {
    if ( v2 )
      v5 = *((_DWORD *)v2 - 1);
    else
      v5 = 0;
    if ( v3 )
      v6 = *((_DWORD *)v3 - 1);
    else
      v6 = 0;
    if ( v5 == v6 && v2 && v3 )
      result = memcmp(v2, v3, *((_DWORD *)v2 - 1)) == 0;
    else
      result = 0;
  }
  return result;
}

//----- (00411CC5) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::ResizeHashTable(ZMap<unsigned long,ZXString<char>,unsigned long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<unsigned long,ZXString<char>,unsigned long> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **v5; // edi@3
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **v6; // ebx@3
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<unsigned long,ZXString<char>,unsigned long>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                                       &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                                       4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (00411D70) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZXString<char>,unsigned long>::_CalcAutoGrow(ZMap<unsigned long,ZXString<char>,unsigned long> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (00411D94) --------------------------------------------------------
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::ResizeHashTable(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char> > *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR **v5; // edi@3
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR **v6; // ebx@3
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *v7; // esi@5
  unsigned int v8; // eax@6
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<ZXString<char>,unsigned long,ZXString<char>>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                                         &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                                         4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = HashKey(v7->key._m_pStr);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (00411E3B) --------------------------------------------------------
void __thiscall ZMap<ZXString<char>,unsigned long,ZXString<char>>::_CalcAutoGrow(ZMap<ZXString<char>,unsigned long,ZXString<char> > *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (00411E5F) --------------------------------------------------------
void __thiscall ZMap<char const *,int,ZXString<char>>::ResizeHashTable(ZMap<char const *,int,ZXString<char> > *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<char const *,int,ZXString<char> > *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<char const *,int,ZXString<char> >::_PAIR **v5; // edi@3
  ZMap<char const *,int,ZXString<char> >::_PAIR **v6; // ebx@3
  ZMap<char const *,int,ZXString<char> >::_PAIR *v7; // esi@5
  unsigned int v8; // eax@6
  ZMap<char const *,int,ZXString<char> >::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<char const *,int,ZXString<char> >::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<char const *,int,ZXString<char> >::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<char const *,int,ZXString<char>>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<char const *,int,ZXString<char> >::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                             &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                             4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = HashKey(v7->key._m_pStr);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<char const *,int,ZXString<char> >::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (00411F06) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (00411F5B) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (00411FB0) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (00412005) --------------------------------------------------------
void _E109()
{
  if ( !(___B_1____s_sEmpty___ZXString_D___D__9_51 & 1) )
  {
    ___B_1____s_sEmpty___ZXString_D___D__9_51 |= 1u;
    ZXString<char>::_s_sEmpty._m_pStr = 0;
  }
  _E96();
  _E97();
  _E98();
  _E99();
  _E100();
  _E101();
  _E102();
  _E103();
  _E104();
  _E105();
  _E106();
  _E107();
}
// 4A6550: using guessed type char ___B_1____s_sEmpty___ZXString_D___D__9_51;

//----- (00412058) --------------------------------------------------------
int _E96()
{
  return atexit(ZXString<char>::_s_sEmpty`template static data member destructor helper');
}

//----- (00412064) --------------------------------------------------------
void _E97()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0041209F) --------------------------------------------------------
void _E98()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004120DA) --------------------------------------------------------
void _E99()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00412115) --------------------------------------------------------
void _E100()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00412150) --------------------------------------------------------
void _E101()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0041218B) --------------------------------------------------------
void _E102()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004121C6) --------------------------------------------------------
void _E103()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance = v3;
}

//----- (00412201) --------------------------------------------------------
void _E104()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance = v3;
}

//----- (0041223C) --------------------------------------------------------
void _E105()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance = v3;
}

//----- (00412277) --------------------------------------------------------
void _E106()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (004122B2) --------------------------------------------------------
void _E107()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00412308) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 44366C: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable')(void *p, unsigned int __flags);

//----- (0041233B) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 443674: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable')(void *p, unsigned int __flags);

//----- (0041236E) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 44367C: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable')(void *p, unsigned int __flags);

//----- (004123A1) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004123C1) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004123E1) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`scalar deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00412401) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00412416) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (0041242B) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00412440) --------------------------------------------------------
_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *__cdecl get_rm()
{
  return &g_rm;
}

//----- (00412446) --------------------------------------------------------
unsigned int __cdecl CCrc32::GetCrc32(const char *pData, unsigned int dwSize, unsigned int dwInit, int bUseAddr)
{
  const char *v4; // ecx@1
  unsigned int result; // eax@3
  unsigned int v6; // edi@3
  unsigned int v7; // esi@4
  unsigned int v8; // eax@5
  unsigned int v9; // edx@5
  int v10; // ecx@5
  unsigned int v11; // eax@5
  unsigned int v12; // edx@5
  unsigned int v13; // eax@5
  unsigned int v14; // edx@5
  unsigned int v15; // eax@5
  unsigned __int32 *v16; // edx@5
  int v17; // ebx@5
  unsigned int v18; // edx@5
  unsigned __int32 *v19; // eax@5
  unsigned int v20; // edx@5
  unsigned int v21; // edx@5
  unsigned int v22; // eax@5
  unsigned __int32 *v23; // edx@5
  int v24; // ebx@5
  unsigned int v25; // eax@5

  v4 = pData;
  if ( bUseAddr )
    dwInit ^= (unsigned int)pData;
  result = dwInit;
  v6 = dwSize;
  if ( dwSize >= 0x10 )
  {
    v7 = dwSize >> 4;
    do
    {
      v8 = (result << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*v4 ^ (result >> 24)];
      v9 = (v8 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[v4[1] ^ (v8 >> 24)];
      v10 = (int)(v4 + 1);
      v11 = (v9 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10++ + 1) ^ (v9 >> 24)];
      v12 = (v11 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10++ + 1) ^ (v11 >> 24)];
      v13 = (v12 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10++ + 1) ^ (v12 >> 24)];
      v14 = (v13 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10++ + 1) ^ (v13 >> 24)];
      v15 = (v14 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10++ + 1) ^ (v14 >> 24)];
      v16 = (&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10++ + 1) ^ (v15 >> 24)];
      v17 = *(_BYTE *)(v10 + 1);
      v18 = (v15 << 8) ^ (unsigned int)v16;
      ++v10;
      v19 = (&CCrc32::ms_adwCrc32Table)[v17 ^ (v18 >> 24)];
      v20 = (((v18 << 8) ^ (unsigned int)v19) << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10 + 1) ^ (((v18 << 8) ^ (unsigned int)v19) >> 24)];
      v10 += 2;
      v21 = (((v20 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)v10 ^ (v20 >> 24)]) << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10 + 1) ^ (((v20 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)v10 ^ (v20 >> 24)]) >> 24)];
      v22 = (v21 << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(++v10 + 1) ^ (v21 >> 24)];
      v23 = (&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(++v10 + 1) ^ (v22 >> 24)];
      v24 = *(_BYTE *)(++v10 + 1);
      ++v10;
      v25 = (((v22 << 8) ^ (unsigned int)v23) << 8) ^ (unsigned int)(&CCrc32::ms_adwCrc32Table)[v24 ^ (((v22 << 8) ^ (unsigned int)v23) >> 24)];
      result = (unsigned int)(&CCrc32::ms_adwCrc32Table)[*(_BYTE *)(v10 + 1) ^ (v25 >> 24)] ^ (v25 << 8);
      v4 = (const char *)(v10 + 2);
      v6 -= 16;
      --v7;
    }
    while ( v7 );
  }
  if ( v6 >= 1 )
  {
    do
    {
      result = (unsigned int)(&CCrc32::ms_adwCrc32Table)[*v4++ ^ (result >> 24)] ^ (result << 8);
      --v6;
    }
    while ( v6 );
  }
  return result;
}
// 4550E8: using guessed type unsigned __int32 *CCrc32::ms_adwCrc32Table;

//----- (0041261A) --------------------------------------------------------
void _E14_0()
{
  _E12_1();
  _E13_1();
}

//----- (00412624) --------------------------------------------------------
void _E12_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0041265F) --------------------------------------------------------
void _E13_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (0041269A) --------------------------------------------------------
void _E31_4()
{
  _E24_0();
  _E25_0();
  _E26_0();
  _E27_0();
  _E28_1();
  _E29_3();
  _E30_3();
}

//----- (004126BD) --------------------------------------------------------
void _E24_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004126F8) --------------------------------------------------------
void _E25_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00412733) --------------------------------------------------------
void _E26_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0041276E) --------------------------------------------------------
void _E27_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (004127A9) --------------------------------------------------------
void _E28_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004127E4) --------------------------------------------------------
void _E29_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0041281F) --------------------------------------------------------
void _E30_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0041285A) --------------------------------------------------------
void __thiscall GW_CharacterStat::Encode(GW_CharacterStat *this, COutPacket *oPacket)
{
  GW_CharacterStat *v2; // esi@1

  v2 = this;
  COutPacket::Encode4(oPacket, this->dwCharacterID);
  COutPacket::EncodeBuffer(oPacket, v2->sCharacterName, 0xDu);
  COutPacket::Encode1(oPacket, v2->nGender);
  COutPacket::Encode1(oPacket, v2->nSkin);
  COutPacket::Encode4(oPacket, v2->nFace);
  COutPacket::Encode4(oPacket, v2->nHair);
  COutPacket::EncodeBuffer(oPacket, &v2->liPetLockerSN, 8u);
  COutPacket::Encode1(oPacket, v2->nLevel);
  COutPacket::Encode2(oPacket, v2->nJob);
  COutPacket::Encode2(oPacket, v2->nSTR);
  COutPacket::Encode2(oPacket, v2->nDEX);
  COutPacket::Encode2(oPacket, v2->nINT);
  COutPacket::Encode2(oPacket, v2->nLUK);
  COutPacket::Encode2(oPacket, v2->nHP);
  COutPacket::Encode2(oPacket, v2->nMHP);
  COutPacket::Encode2(oPacket, v2->nMP);
  COutPacket::Encode2(oPacket, v2->nMMP);
  COutPacket::Encode2(oPacket, v2->nAP);
  COutPacket::Encode2(oPacket, v2->nSP);
  COutPacket::Encode4(oPacket, v2->nEXP);
  COutPacket::Encode2(oPacket, v2->nPOP);
  COutPacket::Encode4(oPacket, v2->dwPosMap);
  COutPacket::Encode1(oPacket, v2->nPortal);
}

//----- (0041298E) --------------------------------------------------------
void __thiscall GW_CharacterStat::EncodeMoney(GW_CharacterStat *this, COutPacket *oPacket)
{
  COutPacket::Encode4(oPacket, this->nMoney);
}

//----- (0041299D) --------------------------------------------------------
void __thiscall GW_CharacterStat::Decode(GW_CharacterStat *this, CInPacket *iPacket, int bBackwardUpdate)
{
  GW_CharacterStat *v3; // esi@1
  char *v4; // eax@4
  char sTemp[13]; // [sp+Ch] [bp-10h]@4

  v3 = this;
  if ( bBackwardUpdate )
    CInPacket::Decode4(iPacket);
  else
    this->dwCharacterID = CInPacket::Decode4(iPacket);
  v4 = sTemp;
  if ( !bBackwardUpdate )
    v4 = v3->sCharacterName;
  CInPacket::DecodeBuffer(iPacket, v4, 0xDu);
  if ( bBackwardUpdate )
    CInPacket::Decode1(iPacket);
  else
    v3->nGender = CInPacket::Decode1(iPacket);
  if ( bBackwardUpdate )
    CInPacket::Decode1(iPacket);
  else
    v3->nSkin = CInPacket::Decode1(iPacket);
  if ( bBackwardUpdate )
    CInPacket::Decode4(iPacket);
  else
    v3->nFace = CInPacket::Decode4(iPacket);
  if ( bBackwardUpdate )
    CInPacket::Decode4(iPacket);
  else
    v3->nHair = CInPacket::Decode4(iPacket);
  CInPacket::DecodeBuffer(iPacket, &v3->liPetLockerSN, 8u);
  v3->nLevel = CInPacket::Decode1(iPacket);
  v3->nJob = CInPacket::Decode2(iPacket);
  v3->nSTR = CInPacket::Decode2(iPacket);
  v3->nDEX = CInPacket::Decode2(iPacket);
  v3->nINT = CInPacket::Decode2(iPacket);
  v3->nLUK = CInPacket::Decode2(iPacket);
  v3->nHP = CInPacket::Decode2(iPacket);
  v3->nMHP = CInPacket::Decode2(iPacket);
  v3->nMP = CInPacket::Decode2(iPacket);
  v3->nMMP = CInPacket::Decode2(iPacket);
  v3->nAP = CInPacket::Decode2(iPacket);
  v3->nSP = CInPacket::Decode2(iPacket);
  v3->nEXP = CInPacket::Decode4(iPacket);
  v3->nPOP = CInPacket::Decode2(iPacket);
  v3->dwPosMap = CInPacket::Decode4(iPacket);
  v3->nPortal = CInPacket::Decode1(iPacket);
}

//----- (00412AEA) --------------------------------------------------------
void __thiscall GW_CharacterStat::DecodeMoney(GW_CharacterStat *this, CInPacket *iPacket)
{
  this->nMoney = CInPacket::Decode4(iPacket);
}

//----- (00412AFD) --------------------------------------------------------
void __thiscall GW_CharacterStat::EncodeChangeStat(GW_CharacterStat *this, unsigned int flag, COutPacket *oPacket)
{
  unsigned int v3; // ebx@1
  GW_CharacterStat *v4; // esi@1

  v3 = flag;
  v4 = this;
  COutPacket::Encode4(oPacket, flag);
  if ( flag & 1 )
    COutPacket::Encode1(oPacket, v4->nSkin);
  if ( flag & 2 )
    COutPacket::Encode4(oPacket, v4->nFace);
  if ( flag & 4 )
    COutPacket::Encode4(oPacket, v4->nHair);
  if ( flag & 8 )
    COutPacket::EncodeBuffer(oPacket, &v4->liPetLockerSN, 8u);
  if ( flag & 0x10 )
    COutPacket::Encode1(oPacket, v4->nLevel);
  if ( flag & 0x20 )
    COutPacket::Encode2(oPacket, v4->nJob);
  if ( flag & 0x40 )
    COutPacket::Encode2(oPacket, v4->nSTR);
  if ( flag & 0x80 )
    COutPacket::Encode2(oPacket, v4->nDEX);
  if ( BYTE1(v3) & 1 )
    COutPacket::Encode2(oPacket, v4->nINT);
  if ( BYTE1(v3) & 2 )
    COutPacket::Encode2(oPacket, v4->nLUK);
  if ( BYTE1(v3) & 4 )
    COutPacket::Encode2(oPacket, v4->nHP);
  if ( BYTE1(v3) & 8 )
    COutPacket::Encode2(oPacket, v4->nMHP);
  if ( BYTE1(v3) & 0x10 )
    COutPacket::Encode2(oPacket, v4->nMP);
  if ( BYTE1(v3) & 0x20 )
    COutPacket::Encode2(oPacket, v4->nMMP);
  if ( BYTE1(v3) & 0x40 )
    COutPacket::Encode2(oPacket, v4->nAP);
  if ( BYTE1(v3) & 0x80 )
    COutPacket::Encode2(oPacket, v4->nSP);
  if ( v3 & 0x10000 )
    COutPacket::Encode4(oPacket, v4->nEXP);
  if ( v3 & 0x20000 )
    COutPacket::Encode2(oPacket, v4->nPOP);
  if ( v3 & 0x40000 )
    COutPacket::Encode4(oPacket, v4->nMoney);
}

//----- (00412C77) --------------------------------------------------------
unsigned int __thiscall GW_CharacterStat::DecodeChangeStat(GW_CharacterStat *this, CInPacket *iPacket)
{
  GW_CharacterStat *v2; // esi@1
  unsigned int v3; // ebx@1

  v2 = this;
  v3 = CInPacket::Decode4(iPacket);
  if ( v3 & 1 )
    v2->nSkin = CInPacket::Decode1(iPacket);
  if ( v3 & 2 )
    v2->nFace = CInPacket::Decode4(iPacket);
  if ( v3 & 4 )
    v2->nHair = CInPacket::Decode4(iPacket);
  if ( v3 & 8 )
    CInPacket::DecodeBuffer(iPacket, &v2->liPetLockerSN, 8u);
  if ( v3 & 0x10 )
    v2->nLevel = CInPacket::Decode1(iPacket);
  if ( v3 & 0x20 )
    v2->nJob = CInPacket::Decode2(iPacket);
  if ( v3 & 0x40 )
    v2->nSTR = CInPacket::Decode2(iPacket);
  if ( v3 & 0x80 )
    v2->nDEX = CInPacket::Decode2(iPacket);
  if ( BYTE1(v3) & 1 )
    v2->nINT = CInPacket::Decode2(iPacket);
  if ( BYTE1(v3) & 2 )
    v2->nLUK = CInPacket::Decode2(iPacket);
  if ( BYTE1(v3) & 4 )
    v2->nHP = CInPacket::Decode2(iPacket);
  if ( BYTE1(v3) & 8 )
    v2->nMHP = CInPacket::Decode2(iPacket);
  if ( BYTE1(v3) & 0x10 )
    v2->nMP = CInPacket::Decode2(iPacket);
  if ( BYTE1(v3) & 0x20 )
    v2->nMMP = CInPacket::Decode2(iPacket);
  if ( BYTE1(v3) & 0x40 )
    v2->nAP = CInPacket::Decode2(iPacket);
  if ( BYTE1(v3) & 0x80 )
    v2->nSP = CInPacket::Decode2(iPacket);
  if ( v3 & 0x10000 )
    v2->nEXP = CInPacket::Decode4(iPacket);
  if ( v3 & 0x20000 )
    v2->nPOP = CInPacket::Decode2(iPacket);
  if ( v3 & 0x40000 )
    v2->nMoney = CInPacket::Decode4(iPacket);
  return v3;
}

//----- (00412DC6) --------------------------------------------------------
void __thiscall GW_ItemSlotBase::Encode(GW_ItemSlotBase *this, COutPacket *oPacket)
{
  GW_ItemSlotBase *v2; // esi@1
  char v3; // al@1

  v2 = this;
  v3 = ((int (*)(void))this->vfptr[2].__vecDelDtor)();
  COutPacket::Encode1(oPacket, v3);
  v2->vfptr[13].__vecDelDtor((ZRefCounted *)v2, (unsigned int)oPacket);
}

//----- (00412DE7) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__cdecl GW_ItemSlotBase::Decode(ZRef<GW_ItemSlotBase> *result, CInPacket *__$ReturnUdt)
{
  char v2; // al@1
  ZRefCountedVtbl *v3; // eax@1
  GW_ItemSlotBase *v4; // eax@1
  bool v5; // zf@1
  ZRef<GW_ItemSlotBase> resulta; // [sp+8h] [bp-18h]@1
  int v8; // [sp+10h] [bp-10h]@1
  int v9; // [sp+1Ch] [bp-4h]@1

  v8 = 0;
  v2 = CInPacket::Decode1(__$ReturnUdt);
  GW_ItemSlotBase::CreateItem(&resulta, (unsigned __int8)v2);
  v3 = resulta.p->vfptr;
  v9 = 1;
  ((void (__stdcall *)(CInPacket *))v3[12].__vecDelDtor)(__$ReturnUdt);
  v4 = resulta.p;
  v5 = resulta.p == 0;
  result->p = resulta.p;
  if ( !v5 )
  {
    InterlockedIncrement(&v4->_m_nRef);
    v4 = resulta.p;
  }
  v8 = 1;
  LOBYTE(v9) = 0;
  if ( v4 )
    ZRef<GW_ItemSlotBase>::_ReleaseRaw(&resulta, 0);
  return result;
}

//----- (00412E61) --------------------------------------------------------
int __thiscall GW_ItemSlotBase::IsSameItem(GW_ItemSlotBase *this, GW_ItemSlotBase *pSrc)
{
  GW_ItemSlotEquip *v2; // edi@1
  int result; // eax@7

  v2 = (GW_ItemSlotEquip *)this;
  if ( this->nItemID != pSrc->nItemID
    || this->liCashItemSN.LowPart != pSrc->liCashItemSN.LowPart
    || this->liCashItemSN.HighPart != pSrc->liCashItemSN.HighPart
    || this->dateExpire.dwHighDateTime != pSrc->dateExpire.dwHighDateTime
    || this->dateExpire.dwLowDateTime != pSrc->dateExpire.dwLowDateTime )
  {
    result = 0;
  }
  else if ( ((int (__thiscall *)(GW_ItemSlotBase *))pSrc->vfptr[2].__vecDelDtor)(pSrc) == 1 )
  {
    result = GW_ItemSlotEquip::IsSameEquipItem(v2, (GW_ItemSlotEquip *)pSrc);
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (00412EB3) --------------------------------------------------------
BOOL __thiscall GW_ItemSlotEquip::IsSameEquipItem(GW_ItemSlotEquip *this, GW_ItemSlotEquip *pSrc)
{
  return this->nRUC == pSrc->nRUC
      && this->nCUC == pSrc->nCUC
      && this->niSTR == pSrc->niSTR
      && this->niDEX == pSrc->niDEX
      && this->niINT == pSrc->niINT
      && this->niLUK == pSrc->niLUK
      && this->niMaxHP == pSrc->niMaxHP
      && this->niMaxMP == pSrc->niMaxMP
      && this->niPAD == pSrc->niPAD
      && this->niMAD == pSrc->niMAD
      && this->niPDD == pSrc->niPDD
      && this->niMDD == pSrc->niMDD
      && this->niACC == pSrc->niACC
      && this->niEVA == pSrc->niEVA
      && this->niCraft == pSrc->niCraft
      && this->niSpeed == pSrc->niSpeed
      && this->niJump == pSrc->niJump
      && this->nAttribute == pSrc->nAttribute;
}

//----- (00412F85) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__cdecl GW_ItemSlotBase::CreateItem(ZRef<GW_ItemSlotBase> *result, int __$ReturnUdt)
{
  ZRef<GW_ItemSlotBase> *v2; // eax@4
  GW_ItemSlotBase *v3; // eax@5
  GW_ItemSlotBase *v4; // esi@5
  GW_ItemSlotBase *v5; // eax@7
  GW_ItemSlotBase *v6; // eax@9
  GW_ItemSlotBase *v7; // eax@10

  if ( __$ReturnUdt == 1 )
  {
    v7 = (GW_ItemSlotBase *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x57u);
    v4 = v7;
    if ( v7 )
    {
      GW_ItemSlotBase::GW_ItemSlotBase(v7);
      v4->vfptr = (ZRefCountedVtbl *)&GW_ItemSlotEquip::`vftable';
      goto LABEL_9;
    }
    goto LABEL_12;
  }
  if ( __$ReturnUdt == 2 )
  {
    v5 = (GW_ItemSlotBase *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x39u);
    v4 = v5;
    if ( v5 )
    {
      GW_ItemSlotBase::GW_ItemSlotBase(v5);
      v4->vfptr = (ZRefCountedVtbl *)&GW_ItemSlotBundle::`vftable';
      goto LABEL_9;
    }
LABEL_12:
    v6 = 0;
    goto LABEL_13;
  }
  if ( __$ReturnUdt != 3 )
  {
    v2 = result;
    result->p = 0;
    return v2;
  }
  v3 = (GW_ItemSlotBase *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x3Du);
  v4 = v3;
  if ( !v3 )
    goto LABEL_12;
  GW_ItemSlotBase::GW_ItemSlotBase(v3);
  v4->vfptr = (ZRefCountedVtbl *)&GW_ItemSlotPet::`vftable';
LABEL_9:
  v6 = v4;
LABEL_13:
  result->p = v6;
  if ( v6 )
    InterlockedIncrement(&v6->_m_nRef);
  return result;
}
// 44368C: using guessed type int (__thiscall *GW_ItemSlotEquip::`vftable')(void *p, unsigned int __flags);
// 4436C8: using guessed type int (__thiscall *GW_ItemSlotBundle::`vftable')(void *p, unsigned int __flags);
// 443704: using guessed type int (__thiscall *GW_ItemSlotPet::`vftable')(void *p, unsigned int __flags);

//----- (00413052) --------------------------------------------------------
void __thiscall GW_ItemSlotBase::GW_ItemSlotBase(GW_ItemSlotBase *this)
{
  GW_ItemSlotBase *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->liCashItemSN.LowPart = 0;
  v1->vfptr = (ZRefCountedVtbl *)&GW_ItemSlotBase::`vftable';
  v1->nItemID = 0;
  v1->liCashItemSN.HighPart = 0;
  memset(&v1->dateExpire, 0, 8u);
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443748: using guessed type int (__thiscall *GW_ItemSlotBase::`vftable')(void *p, unsigned int __flags);

//----- (0041308A) --------------------------------------------------------
GW_ItemSlotBase *__thiscall GW_ItemSlotBase::`vector deleting destructor'(GW_ItemSlotBase *this, unsigned int __flags)
{
  GW_ItemSlotBase *v2; // esi@1

  v2 = this;
  GW_ItemSlotBase::~GW_ItemSlotBase(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004130AA) --------------------------------------------------------
void __thiscall GW_ItemSlotBase::~GW_ItemSlotBase(GW_ItemSlotBase *this)
{
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);

//----- (004130B1) --------------------------------------------------------
int __thiscall GW_ItemSlotEquip::IsProtectedItem(GW_ItemSlotEquip *this)
{
  return this->nAttribute & 1;
}

//----- (004130BA) --------------------------------------------------------
int GW_ItemSlotEquip::GetType()
{
  return 1;
}

//----- (004130BE) --------------------------------------------------------
int GW_ItemSlotEquip::GetDataSize()
{
  return 75;
}

//----- (004130C2) --------------------------------------------------------
int GW_ItemSlotEquip::GetItemNumber()
{
  return 1;
}

//----- (004130C9) --------------------------------------------------------
ZXString<char> *__thiscall GW_ItemSlotEquip::GetItemTitle(GW_ItemSlotEquip *this, ZXString<char> *result)
{
  result->_m_pStr = 0;
  ZXString<char>::Assign(result, this->sTitle, -1);
  return result;
}

//----- (004130EC) --------------------------------------------------------
void __thiscall GW_ItemSlotEquip::SetItemTitle(GW_ItemSlotEquip *this, ZXString<char> sName)
{
  lstrcpyA(this->sTitle, sName._m_pStr);
  ZXString<char>::~ZXString<char>(&sName);
}

//----- (00413106) --------------------------------------------------------
void __thiscall GW_ItemSlotEquip::SetProtected(GW_ItemSlotEquip *this)
{
  LOBYTE(this->nAttribute) |= 1u;
}

//----- (0041310B) --------------------------------------------------------
void __thiscall GW_ItemSlotEquip::SetItemAttribute(GW_ItemSlotEquip *this, __int16 nNewAttribute)
{
  this->nAttribute = nNewAttribute;
}

//----- (00413117) --------------------------------------------------------
int __thiscall GW_ItemSlotBundle::IsProtectedItem(GW_ItemSlotBundle *this)
{
  return this->nAttribute & 1;
}

//----- (00413120) --------------------------------------------------------
int GW_ItemSlotBundle::GetType()
{
  return 2;
}

//----- (00413124) --------------------------------------------------------
int GW_ItemSlotBundle::GetDataSize()
{
  return 45;
}

//----- (00413128) --------------------------------------------------------
int __thiscall GW_ItemSlotBundle::GetItemNumber(GW_ItemSlotBundle *this)
{
  return this->nNumber;
}

//----- (0041312D) --------------------------------------------------------
void __thiscall GW_ItemSlotBundle::SetItemNumber(GW_ItemSlotBundle *this, __int16 nNumber)
{
  this->nNumber = nNumber;
}

//----- (00413139) --------------------------------------------------------
ZXString<char> *__thiscall GW_ItemSlotBundle::GetItemTitle(GW_ItemSlotBundle *this, ZXString<char> *result)
{
  result->_m_pStr = 0;
  ZXString<char>::Assign(result, this->sTitle, -1);
  return result;
}

//----- (0041315C) --------------------------------------------------------
void __thiscall GW_ItemSlotBundle::SetItemTitle(GW_ItemSlotBundle *this, ZXString<char> sName)
{
  lstrcpyA(this->sTitle, sName._m_pStr);
  ZXString<char>::~ZXString<char>(&sName);
}

//----- (00413176) --------------------------------------------------------
void __thiscall GW_ItemSlotBundle::SetProtected(GW_ItemSlotBundle *this)
{
  LOBYTE(this->nAttribute) |= 1u;
}

//----- (0041317B) --------------------------------------------------------
void __thiscall GW_ItemSlotBundle::SetItemAttribute(GW_ItemSlotBundle *this, __int16 nNewAttribute)
{
  this->nAttribute = nNewAttribute;
}

//----- (00413187) --------------------------------------------------------
int GW_ItemSlotPet::IsProtectedItem()
{
  return 0;
}

//----- (0041318A) --------------------------------------------------------
int GW_ItemSlotPet::GetType()
{
  return 3;
}

//----- (0041318E) --------------------------------------------------------
int GW_ItemSlotPet::GetDataSize()
{
  return 49;
}

//----- (00413192) --------------------------------------------------------
int GW_ItemSlotPet::GetItemNumber()
{
  return 1;
}

//----- (00413199) --------------------------------------------------------
ZXString<char> *__stdcall GW_ItemSlotPet::GetItemTitle(ZXString<char> *result)
{
  result->_m_pStr = 0;
  ZXString<char>::Assign(result, &sLog, -1);
  return result;
}

//----- (004131BD) --------------------------------------------------------
void __stdcall GW_ItemSlotPet::SetItemTitle(ZXString<char> sName)
{
  ZXString<char>::~ZXString<char>(&sName);
}

//----- (004131CD) --------------------------------------------------------
_LARGE_INTEGER *__stdcall GW_ItemSlotPet::GetSN(_LARGE_INTEGER *__$ReturnUdt)
{
  _LARGE_INTEGER *result; // eax@1

  result = __$ReturnUdt;
  __$ReturnUdt->LowPart = 0;
  __$ReturnUdt->HighPart = 0;
  return result;
}

//----- (004131DE) --------------------------------------------------------
GW_ItemSlotEquip *__thiscall GW_ItemSlotEquip::`scalar deleting destructor'(GW_ItemSlotEquip *this, unsigned int __flags)
{
  GW_ItemSlotEquip *v2; // esi@1

  v2 = this;
  GW_ItemSlotEquip::~GW_ItemSlotEquip(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004131FE) --------------------------------------------------------
GW_ItemSlotBundle *__thiscall GW_ItemSlotBundle::`vector deleting destructor'(GW_ItemSlotBundle *this, unsigned int __flags)
{
  GW_ItemSlotBundle *v2; // esi@1

  v2 = this;
  GW_ItemSlotBundle::~GW_ItemSlotBundle(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0041321E) --------------------------------------------------------
GW_ItemSlotPet *__thiscall GW_ItemSlotPet::`vector deleting destructor'(GW_ItemSlotPet *this, unsigned int __flags)
{
  GW_ItemSlotPet *v2; // esi@1

  v2 = this;
  GW_ItemSlotPet::~GW_ItemSlotPet(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0041323E) --------------------------------------------------------
void __thiscall GW_ItemSlotEquip::~GW_ItemSlotEquip(GW_ItemSlotEquip *this)
{
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);

//----- (00413245) --------------------------------------------------------
void __thiscall GW_ItemSlotBundle::~GW_ItemSlotBundle(GW_ItemSlotBundle *this)
{
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);

//----- (0041324C) --------------------------------------------------------
void __thiscall GW_ItemSlotPet::~GW_ItemSlotPet(GW_ItemSlotPet *this)
{
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);

//----- (00413253) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__thiscall GW_ItemSlotBase::MakeClone(GW_ItemSlotBase *this, ZRef<GW_ItemSlotBase> *result)
{
  GW_ItemSlotBase *v2; // esi@1
  int v3; // eax@1
  ZRefCountedVtbl *v4; // eax@1
  GW_ItemSlotBase *v5; // edi@1
  size_t v6; // eax@1
  GW_ItemSlotBase *v7; // eax@1
  bool v8; // zf@1
  ZRef<GW_ItemSlotBase> resulta; // [sp+Ch] [bp-18h]@1
  int v11; // [sp+14h] [bp-10h]@1
  int v12; // [sp+20h] [bp-4h]@1

  v11 = 0;
  v2 = this;
  v3 = ((int (*)(void))this->vfptr[2].__vecDelDtor)();
  GW_ItemSlotBase::CreateItem(&resulta, v3);
  v4 = v2->vfptr;
  v5 = resulta.p;
  v12 = 1;
  v6 = ((int (__thiscall *)(GW_ItemSlotBase *))v4[3].__vecDelDtor)(v2);
  memcpy(&v5->nItemID, &v2->nItemID, v6);
  v7 = resulta.p;
  v8 = resulta.p == 0;
  result->p = resulta.p;
  if ( !v8 )
  {
    InterlockedIncrement(&v7->_m_nRef);
    v7 = resulta.p;
  }
  v11 = 1;
  LOBYTE(v12) = 0;
  if ( v7 )
    ZRef<GW_ItemSlotBase>::_ReleaseRaw(&resulta, 0);
  return result;
}

//----- (004132DD) --------------------------------------------------------
ZXString<char> *__thiscall GW_ItemSlotBase::DumpString(GW_ItemSlotBase *this, ZXString<char> *result)
{
  __int64 v2; // ST0C_8@1
  ZXString<char> *v3; // eax@1
  ZXString<char> v5; // [sp+Ch] [bp-10h]@1
  int v6; // [sp+18h] [bp-4h]@1

  v5._m_pStr = 0;
  v2 = this->liCashItemSN.QuadPart;
  v6 = 1;
  v3 = ZXString<char>::Format(&v5, aDI64d, this->nItemID, v2);
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, v3);
  LOBYTE(v6) = 0;
  ZXString<char>::~ZXString<char>(&v5);
  return result;
}

//----- (00413342) --------------------------------------------------------
void __thiscall GW_ItemSlotBase::RawEncode(GW_ItemSlotBase *this, COutPacket *oPacket)
{
  GW_ItemSlotBase *v2; // edi@1
  int v3; // ebx@1

  v2 = this;
  COutPacket::Encode4(oPacket, this->nItemID);
  v3 = v2->liCashItemSN.QuadPart != 0;
  COutPacket::Encode1(oPacket, v3);
  if ( v3 )
    COutPacket::EncodeBuffer(oPacket, &v2->liCashItemSN, 8u);
  COutPacket::EncodeBuffer(oPacket, &v2->dateExpire, 8u);
}

//----- (00413394) --------------------------------------------------------
void __thiscall GW_ItemSlotBase::RawDecode(GW_ItemSlotBase *this, CInPacket *iPacket)
{
  GW_ItemSlotBase *v2; // esi@1

  v2 = this;
  this->nItemID = CInPacket::Decode4(iPacket);
  if ( CInPacket::Decode1(iPacket) )
  {
    CInPacket::DecodeBuffer(iPacket, &v2->liCashItemSN, 8u);
  }
  else
  {
    v2->liCashItemSN.LowPart = 0;
    v2->liCashItemSN.HighPart = 0;
  }
  CInPacket::DecodeBuffer(iPacket, &v2->dateExpire, 8u);
}

//----- (004133DA) --------------------------------------------------------
void __thiscall GW_ItemSlotEquip::BackwardUpdateCashItem(GW_ItemSlotEquip *this, GW_ItemSlotBase *pSrc)
{
  GW_ItemSlotEquip *v2; // esi@1

  v2 = this;
  this->nRUC = (char)pSrc[1].vfptr;
  this->nCUC = BYTE1(pSrc[1].vfptr);
  this->niSTR = HIWORD(pSrc[1].vfptr);
  this->niDEX = pSrc[1]._m_nRef;
  this->niINT = HIWORD(pSrc[1]._m_pNext);
  this->niLUK = (__int16)pSrc[1]._m_pPrev;
  this->niMaxHP = HIWORD(pSrc[1]._m_pPrev);
  this->niMaxMP = pSrc[1].nItemID;
  this->niPAD = HIWORD(pSrc[1].nItemID);
  this->niMAD = pSrc[1].liCashItemSN.QuadPart;
  this->niPDD = HIWORD(pSrc[1].liCashItemSN.u.LowPart);
  this->niMDD = WORD2(pSrc[1].liCashItemSN.QuadPart);
  this->niACC = WORD3(pSrc[1].liCashItemSN.QuadPart);
  this->niEVA = pSrc[1].dateExpire.dwLowDateTime;
  this->niCraft = HIWORD(pSrc[1].dateExpire.dwLowDateTime);
  this->niSpeed = pSrc[1].dateExpire.dwHighDateTime;
  this->niJump = HIWORD(pSrc[1].dateExpire.dwHighDateTime);
  lstrcpyA(this->sTitle, (LPCSTR)&pSrc[2]._m_pPrev + 2);
  v2->nAttribute = (__int16)pSrc[2].vfptr;
}

//----- (00413481) --------------------------------------------------------
ZXString<char> *__thiscall GW_ItemSlotEquip::DumpString(GW_ItemSlotEquip *this, ZXString<char> *result)
{
  GW_ItemSlotEquip *v2; // esi@1
  int v3; // ST50_4@1
  int v4; // ST48_4@1
  int v5; // ST44_4@1
  int v6; // ST40_4@1
  int v7; // ST3C_4@1
  int v8; // ST38_4@1
  int v9; // ST34_4@1
  int v10; // ST30_4@1
  int v11; // ST2C_4@1
  int v12; // ST28_4@1
  int v13; // ST24_4@1
  int v14; // ST20_4@1
  int v15; // ST1C_4@1
  int v16; // ST18_4@1
  int v17; // ST14_4@1
  int v18; // ST10_4@1
  int v19; // ST0C_4@1
  int v20; // ST08_4@1
  char *v21; // eax@1
  int v22; // ecx@2
  ZXString<char> *v23; // eax@4
  ZXString<char> resulta; // [sp+Ch] [bp-18h]@1
  ZXString<char> v26; // [sp+10h] [bp-14h]@1
  ZXString<char> v27; // [sp+14h] [bp-10h]@1
  int v28; // [sp+20h] [bp-4h]@1

  v2 = this;
  GW_ItemSlotBase::DumpString((GW_ItemSlotBase *)&this->vfptr, &resulta);
  v27._m_pStr = 0;
  v28 = 1;
  ZXString<char>::Assign(&v27, v2->sTitle, -1);
  v26._m_pStr = 0;
  v3 = v2->nAttribute;
  v4 = v2->niJump;
  v5 = v2->niCraft;
  v6 = v2->niSpeed;
  v7 = v2->niEVA;
  v8 = v2->niACC;
  v9 = v2->niMDD;
  v10 = v2->niPDD;
  v11 = v2->niMAD;
  v12 = v2->niPAD;
  v13 = v2->niMaxMP;
  v14 = v2->niMaxHP;
  v15 = v2->niLUK;
  v16 = v2->niINT;
  v17 = v2->niDEX;
  v18 = v2->niSTR;
  v19 = v2->nCUC;
  v20 = v2->nRUC;
  LOBYTE(v28) = 3;
  v21 = ZXString<char>::Format(
          &v26,
          aDDDDDDDDDDDDDD,
          v20,
          v19,
          v18,
          v17,
          v16,
          v15,
          v14,
          v13,
          v12,
          v11,
          v10,
          v9,
          v8,
          v7,
          v6,
          v5,
          v4,
          v27._m_pStr,
          v3)->_m_pStr;
  if ( v21 )
    v22 = *((_DWORD *)v21 - 1);
  else
    v22 = 0;
  v23 = ZXString<char>::_Cat(&resulta, v21, v22);
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, v23);
  LOBYTE(v28) = 2;
  ZXString<char>::~ZXString<char>(&v26);
  LOBYTE(v28) = 1;
  ZXString<char>::~ZXString<char>(&v27);
  LOBYTE(v28) = 0;
  ZXString<char>::~ZXString<char>(&resulta);
  return result;
}

//----- (0041358A) --------------------------------------------------------
void __thiscall GW_ItemSlotEquip::RawEncode(GW_ItemSlotEquip *this, COutPacket *oPacket)
{
  GW_ItemSlotEquip *v2; // esi@1
  char *v3; // ecx@1
  ZXString<char> v4; // [sp-4h] [bp-Ch]@1

  v2 = this;
  GW_ItemSlotBase::RawEncode((GW_ItemSlotBase *)&this->vfptr, oPacket);
  COutPacket::Encode1(oPacket, v2->nRUC);
  COutPacket::Encode1(oPacket, v2->nCUC);
  COutPacket::Encode2(oPacket, v2->niSTR);
  COutPacket::Encode2(oPacket, v2->niDEX);
  COutPacket::Encode2(oPacket, v2->niINT);
  COutPacket::Encode2(oPacket, v2->niLUK);
  COutPacket::Encode2(oPacket, v2->niMaxHP);
  COutPacket::Encode2(oPacket, v2->niMaxMP);
  COutPacket::Encode2(oPacket, v2->niPAD);
  COutPacket::Encode2(oPacket, v2->niMAD);
  COutPacket::Encode2(oPacket, v2->niPDD);
  COutPacket::Encode2(oPacket, v2->niMDD);
  COutPacket::Encode2(oPacket, v2->niACC);
  COutPacket::Encode2(oPacket, v2->niEVA);
  COutPacket::Encode2(oPacket, v2->niCraft);
  COutPacket::Encode2(oPacket, v2->niSpeed);
  COutPacket::Encode2(oPacket, v2->niJump);
  v4._m_pStr = v3;
  ZXString<char>::ZXString<char>(&v4, v2->sTitle, -1);
  COutPacket::EncodeStr(oPacket, v4);
  COutPacket::Encode2(oPacket, v2->nAttribute);
  if ( !v2->liCashItemSN.QuadPart )
    COutPacket::EncodeBuffer(oPacket, &v2->liSN, 8u);
}

//----- (004136C7) --------------------------------------------------------
void __thiscall GW_ItemSlotEquip::RawDecode(GW_ItemSlotEquip *this, CInPacket *iPacket)
{
  CInPacket *v2; // edi@1
  GW_ItemSlotEquip *v3; // esi@1
  ZXString<char> *v4; // eax@1

  v2 = iPacket;
  v3 = this;
  GW_ItemSlotBase::RawDecode((GW_ItemSlotBase *)&this->vfptr, iPacket);
  v3->nRUC = CInPacket::Decode1(v2);
  v3->nCUC = CInPacket::Decode1(v2);
  v3->niSTR = CInPacket::Decode2(v2);
  v3->niDEX = CInPacket::Decode2(v2);
  v3->niINT = CInPacket::Decode2(v2);
  v3->niLUK = CInPacket::Decode2(v2);
  v3->niMaxHP = CInPacket::Decode2(v2);
  v3->niMaxMP = CInPacket::Decode2(v2);
  v3->niPAD = CInPacket::Decode2(v2);
  v3->niMAD = CInPacket::Decode2(v2);
  v3->niPDD = CInPacket::Decode2(v2);
  v3->niMDD = CInPacket::Decode2(v2);
  v3->niACC = CInPacket::Decode2(v2);
  v3->niEVA = CInPacket::Decode2(v2);
  v3->niCraft = CInPacket::Decode2(v2);
  v3->niSpeed = CInPacket::Decode2(v2);
  v3->niJump = CInPacket::Decode2(v2);
  v4 = CInPacket::DecodeStr(v2, (ZXString<char> *)&iPacket);
  lstrcpyA(v3->sTitle, v4->_m_pStr);
  if ( iPacket )
    ZXString<char>::_Release((ZXString<char>::_ZXStringData *)&iPacket[-1].m_uLength);
  v3->nAttribute = CInPacket::Decode2(v2);
  if ( v3->liCashItemSN.QuadPart )
  {
    v3->liSN.LowPart = 0;
    v3->liSN.HighPart = 0;
  }
  else
  {
    CInPacket::DecodeBuffer(v2, &v3->liSN, 8u);
  }
}

//----- (004137EB) --------------------------------------------------------
ZXString<char> *__thiscall GW_ItemSlotBundle::DumpString(GW_ItemSlotBundle *this, ZXString<char> *result)
{
  GW_ItemSlotBundle *v2; // esi@1
  int v3; // ST10_4@1
  int v4; // ST08_4@1
  char *v5; // eax@1
  int v6; // ecx@2
  ZXString<char> *v7; // eax@4
  ZXString<char> resulta; // [sp+Ch] [bp-18h]@1
  ZXString<char> v10; // [sp+10h] [bp-14h]@1
  ZXString<char> v11; // [sp+14h] [bp-10h]@1
  int v12; // [sp+20h] [bp-4h]@1

  v2 = this;
  GW_ItemSlotBase::DumpString((GW_ItemSlotBase *)&this->vfptr, &resulta);
  v11._m_pStr = 0;
  v12 = 1;
  ZXString<char>::Assign(&v11, v2->sTitle, -1);
  v10._m_pStr = 0;
  v3 = v2->nAttribute;
  v4 = v2->nNumber;
  LOBYTE(v12) = 3;
  v5 = ZXString<char>::Format(&v10, aDSD, v4, v11._m_pStr, v3)->_m_pStr;
  if ( v5 )
    v6 = *((_DWORD *)v5 - 1);
  else
    v6 = 0;
  v7 = ZXString<char>::_Cat(&resulta, v5, v6);
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, v7);
  LOBYTE(v12) = 2;
  ZXString<char>::~ZXString<char>(&v10);
  LOBYTE(v12) = 1;
  ZXString<char>::~ZXString<char>(&v11);
  LOBYTE(v12) = 0;
  ZXString<char>::~ZXString<char>(&resulta);
  return result;
}

//----- (004138A4) --------------------------------------------------------
void __thiscall GW_ItemSlotBundle::RawEncode(GW_ItemSlotBundle *this, COutPacket *oPacket)
{
  GW_ItemSlotBundle *v2; // esi@1
  ZXString<char> v3; // [sp-4h] [bp-Ch]@1

  v2 = this;
  GW_ItemSlotBase::RawEncode((GW_ItemSlotBase *)&this->vfptr, oPacket);
  COutPacket::Encode2(oPacket, v2->nNumber);
  v3._m_pStr = 0;
  ZXString<char>::Assign(&v3, v2->sTitle, -1);
  COutPacket::EncodeStr(oPacket, v3);
  COutPacket::Encode2(oPacket, v2->nAttribute);
  if ( v2->nItemID / 10000 == 207 )
    COutPacket::EncodeBuffer(oPacket, &v2->liSN, 8u);
}

//----- (00413910) --------------------------------------------------------
void __thiscall GW_ItemSlotBundle::RawDecode(GW_ItemSlotBundle *this, CInPacket *iPacket)
{
  CInPacket *v2; // edi@1
  GW_ItemSlotBundle *v3; // esi@1
  ZXString<char> *v4; // eax@1

  v2 = iPacket;
  v3 = this;
  GW_ItemSlotBase::RawDecode((GW_ItemSlotBase *)&this->vfptr, iPacket);
  v3->nNumber = CInPacket::Decode2(v2);
  v4 = CInPacket::DecodeStr(v2, (ZXString<char> *)&iPacket);
  lstrcpyA(v3->sTitle, v4->_m_pStr);
  ZXString<char>::~ZXString<char>((ZXString<char> *)&iPacket);
  v3->nAttribute = CInPacket::Decode2(v2);
  if ( v3->nItemID / 10000 == 207 )
  {
    CInPacket::DecodeBuffer(v2, &v3->liSN, 8u);
  }
  else
  {
    v3->liSN.LowPart = 0;
    v3->liSN.HighPart = 0;
  }
}

//----- (00413984) --------------------------------------------------------
void __thiscall GW_ItemSlotPet::BackwardUpdateCashItem(GW_ItemSlotPet *this, GW_ItemSlotBase *pSrc)
{
  this->nLevel = BYTE1(pSrc[1].nItemID);
  this->nTameness = HIWORD(pSrc[1].nItemID);
  this->nRepleteness = pSrc[1].liCashItemSN.QuadPart;
  this->nPetAttribute = *(_WORD *)((char *)&pSrc[1].liCashItemSN.LowPart + 1);
}

//----- (004139A7) --------------------------------------------------------
ZXString<char> *__thiscall GW_ItemSlotPet::DumpString(GW_ItemSlotPet *this, ZXString<char> *result)
{
  GW_ItemSlotPet *v2; // esi@1
  int v3; // ST24_4@1
  int v4; // ST20_4@1
  unsigned int v5; // ST1C_4@1
  int v6; // eax@1
  unsigned int v7; // ST18_4@1
  int v8; // ST10_4@1
  int v9; // ST0C_4@1
  char *v10; // eax@1
  int v11; // ecx@2
  ZXString<char> *v12; // eax@4
  ZXString<char> resulta; // [sp+Ch] [bp-14h]@1
  ZXString<char> v15; // [sp+10h] [bp-10h]@1
  int v16; // [sp+1Ch] [bp-4h]@1

  v2 = this;
  GW_ItemSlotBase::DumpString((GW_ItemSlotBase *)&this->vfptr, &resulta);
  v15._m_pStr = 0;
  v16 = 1;
  v3 = v2->usPetSkill;
  v4 = v2->nPetAttribute;
  v5 = v2->dateDead.dwHighDateTime;
  v6 = v2->nRepleteness;
  v7 = v2->dateDead.dwLowDateTime;
  v2 = (GW_ItemSlotPet *)((char *)v2 + 32);
  v8 = HIWORD(v2->nItemID);
  v9 = BYTE1(v2->nItemID);
  LOBYTE(v16) = 2;
  v10 = ZXString<char>::Format(&v15, aSDDDI64dDD, v2, v9, v8, v6, v7, v5, v4, v3)->_m_pStr;
  if ( v10 )
    v11 = *((_DWORD *)v10 - 1);
  else
    v11 = 0;
  v12 = ZXString<char>::_Cat(&resulta, v10, v11);
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, v12);
  LOBYTE(v16) = 1;
  ZXString<char>::~ZXString<char>(&v15);
  LOBYTE(v16) = 0;
  ZXString<char>::~ZXString<char>(&resulta);
  return result;
}

//----- (00413A58) --------------------------------------------------------
void __thiscall GW_ItemSlotPet::RawEncode(GW_ItemSlotPet *this, COutPacket *oPacket)
{
  GW_ItemSlotPet *v2; // esi@1

  v2 = this;
  GW_ItemSlotBase::RawEncode((GW_ItemSlotBase *)&this->vfptr, oPacket);
  COutPacket::EncodeBuffer(oPacket, v2->sPetName, 0xDu);
  COutPacket::Encode1(oPacket, v2->nLevel);
  COutPacket::Encode2(oPacket, v2->nTameness);
  COutPacket::Encode1(oPacket, v2->nRepleteness);
  COutPacket::EncodeBuffer(oPacket, &v2->dateDead, 8u);
  COutPacket::Encode2(oPacket, v2->nPetAttribute);
  COutPacket::Encode2(oPacket, v2->usPetSkill);
}

//----- (00413AC9) --------------------------------------------------------
void __thiscall GW_ItemSlotPet::RawDecode(GW_ItemSlotPet *this, CInPacket *iPacket)
{
  GW_ItemSlotPet *v2; // esi@1

  v2 = this;
  GW_ItemSlotBase::RawDecode((GW_ItemSlotBase *)&this->vfptr, iPacket);
  CInPacket::DecodeBuffer(iPacket, v2->sPetName, 0xDu);
  v2->nLevel = CInPacket::Decode1(iPacket);
  v2->nTameness = CInPacket::Decode2(iPacket);
  v2->nRepleteness = CInPacket::Decode1(iPacket);
  CInPacket::DecodeBuffer(iPacket, &v2->dateDead, 8u);
  v2->nPetAttribute = CInPacket::Decode2(iPacket);
  v2->usPetSkill = CInPacket::Decode2(iPacket);
}

//----- (00413B2B) --------------------------------------------------------
void __thiscall GW_MiniGameRecord::InitializeData(GW_MiniGameRecord *this, int nGameType)
{
  this->nGameID = nGameType;
  this->nWin = 0;
  this->nDraw = 0;
  this->nLose = 0;
  this->nScore = 2000;
}

//----- (00413B46) --------------------------------------------------------
void __thiscall GW_MiniGameRecord::Encode(GW_MiniGameRecord *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x14u);
}

//----- (00413B55) --------------------------------------------------------
void __thiscall GW_MiniGameRecord::Decode(GW_MiniGameRecord *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x14u);
}

//----- (00413B64) --------------------------------------------------------
void __thiscall PARCEL::Encode(PARCEL *this, COutPacket *oPacket)
{
  PARCEL *v2; // esi@1
  GW_ItemSlotBase **v3; // esi@1

  v2 = this;
  COutPacket::EncodeBuffer(oPacket, this, 0x86u);
  v3 = &v2->pItem.p;
  COutPacket::Encode1(oPacket, *v3 != 0);
  if ( *v3 )
    GW_ItemSlotBase::Encode(*v3, oPacket);
}

//----- (00413B9E) --------------------------------------------------------
void __thiscall PARCEL::Decode(PARCEL *this, CInPacket *iPacket)
{
  PARCEL *v2; // esi@1
  ZRef<GW_ItemSlotBase> *v3; // eax@2
  ZRef<GW_ItemSlotBase> result; // [sp+4h] [bp-14h]@2
  int v5; // [sp+14h] [bp-4h]@2

  v2 = this;
  CInPacket::DecodeBuffer(iPacket, this, 0x86u);
  if ( CInPacket::Decode1(iPacket) )
  {
    v3 = GW_ItemSlotBase::Decode(&result, iPacket);
    v5 = 0;
    ZRef<GW_ItemSlotBase>::operator=(&v2->pItem, v3);
    v5 = -1;
    if ( result.p )
      ZRef<GW_ItemSlotBase>::_ReleaseRaw(&result, 0);
  }
}

//----- (00413C0B) --------------------------------------------------------
void __thiscall PARTYMEMBER::Encode(PARTYMEMBER *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0xB2u);
}

//----- (00413C1D) --------------------------------------------------------
void __thiscall PARTYMEMBER::Decode(PARTYMEMBER *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0xB2u);
}

//----- (00413C2F) --------------------------------------------------------
void __thiscall PARTYDATA::Encode(PARTYDATA *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x12Au);
}

//----- (00413C41) --------------------------------------------------------
void __thiscall PARTYDATA::Decode(PARTYDATA *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x12Au);
}

//----- (00413C53) --------------------------------------------------------
void __thiscall FUNCKEY_MAPPED::Encode(FUNCKEY_MAPPED *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 5u);
}

//----- (00413C62) --------------------------------------------------------
void __thiscall FUNCKEY_MAPPED::Decode(FUNCKEY_MAPPED *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 5u);
}

//----- (00413C71) --------------------------------------------------------
void __thiscall GW_Friend::Encode(GW_Friend *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x16u);
}

//----- (00413C80) --------------------------------------------------------
void __thiscall GW_Friend::Decode(GW_Friend *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x16u);
}

//----- (00413C8F) --------------------------------------------------------
void __thiscall GUILDMEMBER::Encode(GUILDMEMBER *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x21u);
}

//----- (00413C9E) --------------------------------------------------------
void __thiscall GUILDMEMBER::Decode(GUILDMEMBER *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x21u);
}

//----- (00413CAD) --------------------------------------------------------
void __thiscall GUILDDATA::Encode(GUILDDATA *this, COutPacket *oPacket)
{
  GUILDDATA *v2; // esi@1
  int v3; // ebx@1
  ZXString<char> *v4; // eax@2
  unsigned int *v5; // eax@3
  int v6; // ebx@4
  int v7; // [sp-4h] [bp-10h]@1

  v2 = this;
  COutPacket::Encode4(oPacket, this->nGuildID);
  v3 = 0;
  v7 = 0;
  ZXString<char>::operator=((ZXString<char> *)&v7, &v2->sGuildName);
  COutPacket::EncodeStr(oPacket, (ZXString<char>)v7);
  do
  {
    v4 = ZArray<ZXString<char>>::operator[](&v2->asGradeName, v3);
    v7 = 0;
    ZXString<char>::operator=((ZXString<char> *)&v7, v4);
    COutPacket::EncodeStr(oPacket, (ZXString<char>)v7);
    ++v3;
  }
  while ( v3 < 5 );
  v5 = v2->adwCharacterID.a;
  if ( v5 )
    v6 = *(v5 - 1);
  else
    v6 = 0;
  COutPacket::Encode1(oPacket, v6);
  if ( v6 > 0 )
  {
    v7 = 4 * v6;
    COutPacket::EncodeBuffer(oPacket, v2->adwCharacterID.a, 4 * v6);
    v7 = 33 * v6;
    COutPacket::EncodeBuffer(oPacket, v2->aMemberData.a, 33 * v6);
  }
  COutPacket::Encode4(oPacket, v2->nMaxMemberNum);
  COutPacket::Encode2(oPacket, v2->nMarkBg);
  COutPacket::Encode1(oPacket, v2->nMarkBgColor);
  COutPacket::Encode2(oPacket, v2->nMark);
  COutPacket::Encode1(oPacket, v2->nMarkColor);
  v7 = 0;
  ZXString<char>::operator=((ZXString<char> *)&v7, &v2->sNotice);
  COutPacket::EncodeStr(oPacket, (ZXString<char>)v7);
  COutPacket::Encode4(oPacket, v2->nPoint);
}

//----- (00413DA2) --------------------------------------------------------
void __thiscall GUILDDATA::Decode(GUILDDATA *this, CInPacket *iPacket)
{
  CInPacket *v2; // ebx@1
  GUILDDATA *v3; // esi@1
  ZXString<char> *v4; // eax@1
  ZXString<char> *v5; // ST04_4@4
  ZXString<char> *v6; // eax@4
  signed int v7; // edi@7
  ZXString<char> *v8; // eax@9
  ZXString<char> v9; // [sp+8h] [bp-14h]@9
  ZXString<char> v10; // [sp+Ch] [bp-10h]@4
  int v11; // [sp+18h] [bp-4h]@1

  v2 = iPacket;
  v3 = this;
  this->nGuildID = CInPacket::Decode4(iPacket);
  v4 = CInPacket::DecodeStr(v2, (ZXString<char> *)&iPacket);
  ZXString<char>::operator=(&v3->sGuildName, v4);
  v11 = -1;
  if ( iPacket )
    ZXString<char>::_Release((ZXString<char>::_ZXStringData *)&iPacket[-1].m_uLength);
  iPacket = (CInPacket *)5;
  do
  {
    v5 = CInPacket::DecodeStr(v2, &v10);
    v11 = 1;
    v6 = ZArray<ZXString<char>>::InsertBefore(&v3->asGradeName, -1);
    ZXString<char>::operator=(v6, v5);
    v11 = -1;
    if ( v10._m_pStr )
      ZXString<char>::_Release((ZXString<char>::_ZXStringData *)v10._m_pStr - 1);
    iPacket = (CInPacket *)((char *)iPacket - 1);
  }
  while ( iPacket );
  v7 = (unsigned __int8)CInPacket::Decode1(v2);
  ZArray<unsigned long>::_Alloc(&v3->adwCharacterID, v7, (ZAllocHelper *)&iPacket + 3);
  ZArray<GUILDMEMBER>::_Alloc(&v3->aMemberData, v7, (ZAllocHelper *)&iPacket + 3);
  if ( v7 > 0 )
  {
    CInPacket::DecodeBuffer(v2, v3->adwCharacterID.a, 4 * v7);
    CInPacket::DecodeBuffer(v2, v3->aMemberData.a, 33 * v7);
  }
  v3->nMaxMemberNum = CInPacket::Decode4(v2);
  v3->nMarkBg = CInPacket::Decode2(v2);
  v3->nMarkBgColor = CInPacket::Decode1(v2);
  v3->nMark = CInPacket::Decode2(v2);
  v3->nMarkColor = CInPacket::Decode1(v2);
  v8 = CInPacket::DecodeStr(v2, &v9);
  v11 = 2;
  ZXString<char>::operator=(&v3->sNotice, v8);
  v11 = -1;
  if ( v9._m_pStr )
    ZXString<char>::_Release((ZXString<char>::_ZXStringData *)v9._m_pStr - 1);
  v3->nPoint = CInPacket::Decode4(v2);
}

//----- (00413EF8) --------------------------------------------------------
void __thiscall GW_CoupleRecord::Encode(GW_CoupleRecord *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x21u);
}

//----- (00413F07) --------------------------------------------------------
void __thiscall GW_CoupleRecord::Decode(GW_CoupleRecord *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x21u);
}

//----- (00413F16) --------------------------------------------------------
void __thiscall GW_FriendRecord::Encode(GW_FriendRecord *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x25u);
}

//----- (00413F25) --------------------------------------------------------
void __thiscall GW_FriendRecord::Decode(GW_FriendRecord *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x25u);
}

//----- (00413F34) --------------------------------------------------------
void __thiscall GW_MarriageRecord::Encode(GW_MarriageRecord *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x30u);
}

//----- (00413F43) --------------------------------------------------------
void __thiscall GW_MarriageRecord::Decode(GW_MarriageRecord *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x30u);
}

//----- (00413F52) --------------------------------------------------------
void __thiscall GW_WeddingReservation::Encode(GW_WeddingReservation *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x28u);
}

//----- (00413F61) --------------------------------------------------------
void __thiscall GW_WeddingReservation::Decode(GW_WeddingReservation *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x28u);
}

//----- (00413F70) --------------------------------------------------------
void __thiscall GW_WeddingWishList::Encode(GW_WeddingWishList *this, COutPacket *oPacket)
{
  COutPacket::EncodeBuffer(oPacket, this, 0x19u);
}

//----- (00413F7F) --------------------------------------------------------
void __thiscall GW_WeddingWishList::Decode(GW_WeddingWishList *this, CInPacket *iPacket)
{
  CInPacket::DecodeBuffer(iPacket, this, 0x19u);
}

//----- (00413F8E) --------------------------------------------------------
void __thiscall GW_Memo::Encode(GW_Memo *this, COutPacket *oPacket)
{
  GW_Memo *v2; // esi@1
  ZXString<char> v3; // [sp-4h] [bp-Ch]@1

  v2 = this;
  COutPacket::Encode4(oPacket, this->dwSN);
  v3._m_pStr = 0;
  ZXString<char>::Assign(&v3, v2->sSender, -1);
  COutPacket::EncodeStr(oPacket, v3);
  v3._m_pStr = 0;
  ZXString<char>::Assign(&v3, v2->sContent, -1);
  COutPacket::EncodeStr(oPacket, v3);
  COutPacket::EncodeBuffer(oPacket, &v2->dateSent, 8u);
  COutPacket::Encode1(oPacket, v2->nFlag);
}

//----- (00413FF7) --------------------------------------------------------
void __thiscall GW_Memo::Decode(GW_Memo *this, CInPacket *iPacket)
{
  CInPacket *v2; // ebx@1
  GW_Memo *v3; // esi@1
  ZXString<char> *v4; // eax@1
  ZXString<char> *v5; // eax@1

  v2 = iPacket;
  v3 = this;
  this->dwSN = CInPacket::Decode4(iPacket);
  v4 = CInPacket::DecodeStr(v2, (ZXString<char> *)&iPacket);
  lstrcpyA(v3->sSender, v4->_m_pStr);
  ZXString<char>::~ZXString<char>((ZXString<char> *)&iPacket);
  v5 = CInPacket::DecodeStr(v2, (ZXString<char> *)&iPacket);
  lstrcpyA(v3->sContent, v5->_m_pStr);
  ZXString<char>::~ZXString<char>((ZXString<char> *)&iPacket);
  CInPacket::DecodeBuffer(v2, &v3->dateSent, 8u);
  v3->nFlag = (unsigned __int8)CInPacket::Decode1(v2);
}

//----- (00414068) --------------------------------------------------------
void __thiscall CharacterData::Encode(CharacterData *this, COutPacket *oPacket, unsigned __int16 usFlag)
{
  CharacterData *v3; // esi@1
  ZRef<GW_ItemSlotBase> **v4; // edi@6
  signed int v5; // ebx@6
  ZRef<GW_ItemSlotBase> *v6; // eax@7
  GW_ItemSlotBase **v7; // edi@11
  GW_ItemSlotBase *v8; // ebx@12
  GW_ItemSlotBase **v9; // edi@15
  GW_ItemSlotBase *v10; // ebx@16
  ZRef<GW_ItemSlotBase> *v11; // eax@19
  int v12; // ebx@21
  signed int i; // edi@21
  char *v14; // eax@32
  ZRef<GW_ItemSlotBase> **v15; // edi@40
  ZRef<GW_ItemSlotBase> *v16; // eax@40
  signed int v17; // ebx@42
  __POSITION **v18; // eax@49
  unsigned int v19; // ecx@50
  __POSITION *v20; // eax@54
  COutPacket *v21; // ebx@62
  __POSITION **v22; // eax@62
  unsigned int v23; // ecx@63
  __POSITION *v24; // eax@67
  unsigned int *v25; // eax@70
  __POSITION **v26; // eax@74
  unsigned int v27; // ecx@75
  __POSITION *v28; // eax@79
  unsigned __int16 *v29; // eax@82
  __POSITION **v30; // eax@85
  unsigned int v31; // ecx@86
  __POSITION *v32; // eax@90
  unsigned __int16 *v33; // eax@93
  __POSITION **v34; // eax@95
  unsigned int v35; // ecx@96
  __POSITION *v36; // eax@100
  int v37; // edi@107
  GW_CoupleRecord *v38; // ecx@109
  int v39; // eax@109
  int v40; // edi@110
  GW_FriendRecord *v41; // ecx@112
  int v42; // eax@112
  int v43; // edi@113
  GW_MarriageRecord *v44; // ecx@115
  int v45; // eax@115
  unsigned int *v46; // edi@117
  signed int v47; // ebx@117
  unsigned int *v48; // esi@119
  signed int v49; // edi@119
  ZXString<char> v50; // [sp-4h] [bp-3Ch]@33
  ZRef<GW_MiniGameRecord> v51; // [sp+Ch] [bp-2Ch]@103
  _FILETIME p; // [sp+14h] [bp-24h]@59
  int value; // [sp+1Ch] [bp-1Ch]@57
  __POSITION *v54; // [sp+20h] [bp-18h]@26
  __POSITION *pos; // [sp+24h] [bp-14h]@42
  ZXString<char> s; // [sp+28h] [bp-10h]@11
  int v57; // [sp+34h] [bp-4h]@74

  v3 = this;
  COutPacket::Encode2(oPacket, usFlag);
  if ( usFlag & 1 )
  {
    GW_CharacterStat::Encode(&v3->characterStat, oPacket);
    COutPacket::Encode1(oPacket, v3->nFriendMax);
  }
  if ( usFlag & 2 )
    GW_CharacterStat::EncodeMoney(&v3->characterStat, oPacket);
  if ( usFlag & 0x80 )
  {
    v4 = &v3->aaItemSlot[1].a;
    v5 = 5;
    do
    {
      v6 = *v4;
      if ( *v4 )
        v6 = (ZRef<GW_ItemSlotBase> *)v6[-1].p;
      COutPacket::Encode1(oPacket, (_BYTE)v6 - 1);
      ++v4;
      --v5;
    }
    while ( v5 );
  }
  if ( usFlag & 4 )
  {
    s._m_pStr = (char *)1;
    v7 = &v3->aEquipped[1].p;
    do
    {
      v8 = *v7;
      if ( *v7 )
      {
        COutPacket::Encode1(oPacket, (char)s._m_pStr);
        GW_ItemSlotBase::Encode(v8, oPacket);
      }
      ++s._m_pStr;
      v7 += 2;
    }
    while ( (signed int)s._m_pStr <= 29 );
    COutPacket::Encode1(oPacket, 0);
    s._m_pStr = (char *)1;
    v9 = &v3->aEquipped2[1].p;
    do
    {
      v10 = *v9;
      if ( *v9 )
      {
        COutPacket::Encode1(oPacket, (char)s._m_pStr);
        GW_ItemSlotBase::Encode(v10, oPacket);
      }
      ++s._m_pStr;
      v9 += 2;
    }
    while ( (signed int)s._m_pStr <= 29 );
    COutPacket::Encode1(oPacket, 0);
    v11 = v3->aaItemSlot[1].a;
    if ( v11 )
      v11 = (ZRef<GW_ItemSlotBase> *)v11[-1].p;
    v12 = (int)&v11[-1].p + 3;
    for ( i = 1; i <= v12; ++i )
    {
      if ( v3->aaItemSlot[1].a[i].p )
      {
        COutPacket::Encode1(oPacket, i);
        GW_ItemSlotBase::Encode(v3->aaItemSlot[1].a[i].p, oPacket);
      }
    }
    COutPacket::Encode1(oPacket, 0);
  }
  s._m_pStr = (char *)2;
  v54 = (__POSITION *)usFlag;
  do
  {
    switch ( s._m_pStr )
    {
      case 1u:
        v50._m_pStr = (char *)4;
        break;
      case 2u:
        v50._m_pStr = (char *)8;
        break;
      case 3u:
        v50._m_pStr = (char *)16;
        break;
      case 4u:
        v50._m_pStr = (char *)32;
        break;
      default:
        if ( s._m_pStr != (char *)5 )
        {
          v14 = 0;
          goto LABEL_39;
        }
        v50._m_pStr = (char *)64;
        break;
    }
    v14 = v50._m_pStr;
LABEL_39:
    if ( (unsigned int)v14 & (unsigned int)v54 )
    {
      v15 = &v3->aaItemSlot[(unsigned int)s._m_pStr].a;
      v16 = *v15;
      if ( *v15 )
        v16 = (ZRef<GW_ItemSlotBase> *)v16[-1].p;
      v17 = 1;
      pos = (__POSITION *)&v16[-1].p + 3;
      if ( (signed int)&v16[-1].p + 3 >= 1 )
      {
        do
        {
          if ( (*v15)[v17].p )
          {
            COutPacket::Encode1(oPacket, v17);
            GW_ItemSlotBase::Encode((*v15)[v17].p, oPacket);
          }
          ++v17;
        }
        while ( v17 <= (signed int)pos );
      }
      COutPacket::Encode1(oPacket, 0);
    }
    ++s._m_pStr;
  }
  while ( (signed int)s._m_pStr <= 5 );
  if ( HIBYTE(usFlag) & 1 )
  {
    COutPacket::Encode2(oPacket, v3->mSkillRecord._m_uCount);
    v18 = (__POSITION **)v3->mSkillRecord._m_apTable;
    if ( v18 )
    {
      v19 = (unsigned int)&v18[v3->mSkillRecord._m_uTableSize];
      while ( (unsigned int)v18 < v19 )
      {
        if ( *v18 )
        {
          v20 = *v18;
          goto LABEL_56;
        }
        ++v18;
      }
    }
    v20 = 0;
LABEL_56:
    pos = v20;
    while ( pos )
    {
      s._m_pStr = *(char **)ZMap<long,long,long>::GetNext(&v3->mSkillRecord, &pos, &value);
      COutPacket::Encode4(oPacket, (unsigned int)s._m_pStr);
      COutPacket::Encode4(oPacket, value);
      if ( (signed int)s._m_pStr / 10000 % 100 && (signed int)s._m_pStr / 10000 % 10 == 2 )
      {
        ZMap<long,long,long>::GetAt(&v3->mSkillMasterLev, (const int *)&s, (int *)&p.dwHighDateTime);
        COutPacket::Encode4(oPacket, p.dwHighDateTime);
      }
    }
  }
  if ( HIBYTE(usFlag) & 0x80 )
  {
    v21 = oPacket;
    COutPacket::Encode2(oPacket, v3->mSkillCooltime._m_uCount);
    v22 = (__POSITION **)v3->mSkillCooltime._m_apTable;
    if ( v22 )
    {
      v23 = (unsigned int)&v22[v3->mSkillCooltime._m_uTableSize];
      while ( (unsigned int)v22 < v23 )
      {
        if ( *v22 )
        {
          v24 = *v22;
          goto LABEL_69;
        }
        ++v22;
      }
    }
    v24 = 0;
LABEL_69:
    pos = v24;
    while ( pos )
    {
      v25 = (unsigned int *)ZMap<long,unsigned short,long>::GetNext(
                              &v3->mSkillCooltime,
                              &pos,
                              (unsigned __int16 *)&p.dwHighDateTime);
      COutPacket::Encode4(oPacket, *v25);
      COutPacket::Encode2(oPacket, p.dwHighDateTime);
    }
  }
  else
  {
    v21 = oPacket;
  }
  if ( HIBYTE(usFlag) & 2 )
  {
    s._m_pStr = 0;
    v50._m_pStr = (char *)v3->mQuestRecord._m_uCount;
    v57 = 0;
    COutPacket::Encode2(v21, (unsigned __int16)v50._m_pStr);
    v26 = (__POSITION **)v3->mQuestRecord._m_apTable;
    if ( v26 )
    {
      v27 = (unsigned int)&v26[v3->mQuestRecord._m_uTableSize];
      while ( (unsigned int)v26 < v27 )
      {
        if ( *v26 )
        {
          v28 = *v26;
          goto LABEL_81;
        }
        ++v26;
      }
    }
    v28 = 0;
LABEL_81:
    pos = v28;
    while ( pos )
    {
      v29 = (unsigned __int16 *)ZMap<unsigned short,ZXString<char>,unsigned short>::GetNext(&v3->mQuestRecord, &pos, &s);
      COutPacket::Encode2(v21, *v29);
      v50._m_pStr = 0;
      p.dwHighDateTime = (unsigned int)&v50;
      ZXString<char>::operator=(&v50, &s);
      COutPacket::EncodeStr(v21, v50);
    }
    v57 = -1;
    ZXString<char>::~ZXString<char>(&s);
  }
  if ( HIBYTE(usFlag) & 0x40 )
  {
    COutPacket::Encode2(v21, v3->mQuestComplete._m_uCount);
    v30 = (__POSITION **)v3->mQuestComplete._m_apTable;
    if ( v30 )
    {
      v31 = (unsigned int)&v30[v3->mQuestComplete._m_uTableSize];
      while ( (unsigned int)v30 < v31 )
      {
        if ( *v30 )
        {
          v32 = *v30;
          goto LABEL_92;
        }
        ++v30;
      }
    }
    v32 = 0;
LABEL_92:
    pos = v32;
    while ( pos )
    {
      v33 = (unsigned __int16 *)ZMap<unsigned short,_FILETIME,unsigned short>::GetNext(&v3->mQuestComplete, &pos, &p);
      COutPacket::Encode2(v21, *v33);
      COutPacket::EncodeBuffer(v21, &p, 8u);
    }
  }
  if ( HIBYTE(usFlag) & 4 )
  {
    COutPacket::Encode2(v21, v3->mMiniGameRecord._m_uCount);
    v34 = (__POSITION **)v3->mMiniGameRecord._m_apTable;
    if ( v34 )
    {
      v35 = (unsigned int)&v34[v3->mMiniGameRecord._m_uTableSize];
      while ( (unsigned int)v34 < v35 )
      {
        if ( *v34 )
        {
          v36 = *v34;
          goto LABEL_102;
        }
        ++v34;
      }
    }
    v36 = 0;
LABEL_102:
    v54 = v36;
    while ( v54 )
    {
      v51.p = 0;
      v57 = 1;
      v50._m_pStr = *(char **)ZMap<long,ZRef<GW_MiniGameRecord>,long>::GetNext(&v3->mMiniGameRecord, &v54, &v51);
      COutPacket::Encode4(v21, (unsigned int)v50._m_pStr);
      COutPacket::Encode4(v21, v51.p->nWin);
      COutPacket::Encode4(v21, v51.p->nDraw);
      COutPacket::Encode4(v21, v51.p->nLose);
      COutPacket::Encode4(v21, v51.p->nScore);
      v57 = -1;
      if ( v51.p )
      {
        ZRef<GW_MiniGameRecord>::_ReleaseRaw(&v51, 0);
        v51.p = 0;
      }
    }
  }
  if ( HIBYTE(usFlag) & 8 )
  {
    COutPacket::Encode2(v21, v3->lCoupleRecord._m_uCount);
    v37 = (int)v3->lCoupleRecord._m_pHead;
    while ( v37 )
    {
      v38 = (GW_CoupleRecord *)v37;
      v39 = *(_DWORD *)(v37 != 0 ? v37 - 16 + 4 : 4);
      v37 = v39 != 0 ? v39 + 16 : 0;
      GW_CoupleRecord::Encode(v38, v21);
    }
    COutPacket::Encode2(v21, v3->lFriendRecord._m_uCount);
    v40 = (int)v3->lFriendRecord._m_pHead;
    while ( v40 )
    {
      v41 = (GW_FriendRecord *)v40;
      v42 = *(_DWORD *)(v40 != 0 ? v40 - 16 + 4 : 4);
      v40 = v42 != 0 ? v42 + 16 : 0;
      GW_FriendRecord::Encode(v41, v21);
    }
    COutPacket::Encode2(v21, v3->lMarriageRecord._m_uCount);
    v43 = (int)v3->lMarriageRecord._m_pHead;
    while ( v43 )
    {
      v44 = (GW_MarriageRecord *)v43;
      v45 = *(_DWORD *)(v43 != 0 ? v43 - 16 + 4 : 4);
      v43 = v45 != 0 ? v45 + 16 : 0;
      GW_MarriageRecord::Encode(v44, v21);
    }
  }
  if ( HIBYTE(usFlag) & 0x10 )
  {
    v46 = v3->adwMapTransfer;
    v47 = 5;
    do
    {
      COutPacket::Encode4(oPacket, *v46);
      ++v46;
      --v47;
    }
    while ( v47 );
    v48 = v3->adwMapTransferEx;
    v49 = 10;
    do
    {
      COutPacket::Encode4(oPacket, *v48);
      ++v48;
      --v49;
    }
    while ( v49 );
  }
}

//----- (00414639) --------------------------------------------------------
int __thiscall CharacterData::Decode(CharacterData *this, CInPacket *iPacket, int bBackwardUpdate)
{
  CInPacket *v3; // esi@1
  CharacterData *v4; // ebx@1
  int v5; // eax@1
  signed int v6; // edi@7
  int v7; // esi@7
  int v8; // eax@8
  int v9; // ecx@9
  CashItemEntry *v10; // eax@10
  int v11; // eax@11
  int v12; // ecx@12
  CashItemEntry *v13; // eax@13
  __POSITION *v14; // eax@21
  ZArray<ZRef<GW_ItemSlotBase> > *v15; // esi@29
  ZArray<ZRef<GW_ItemSlotBase> > v16; // eax@29
  int v17; // ebx@31
  int i; // edi@31
  GW_ItemSlotBase *v19; // eax@32
  ZRef<GW_ItemSlotBase> *v20; // eax@34
  unsigned int v21; // ecx@34
  CashItemEntry *v22; // eax@34
  ZArray<ZRef<GW_ItemSlotBase> > *v23; // ebx@38
  signed int v24; // edi@38
  GW_ItemSlotBase *v25; // eax@39
  int v26; // esi@41
  char v27; // al@42
  GW_ItemSlotBase *v28; // eax@44
  __POSITION *v29; // eax@53
  ZRef<GW_ItemSlotBase> *v30; // esi@62
  char *v31; // esi@67
  signed int v32; // edi@67
  CInPacket *v33; // ebx@71
  signed int j; // esi@71
  unsigned int v35; // ecx@76
  CashItemEntry *v36; // eax@77
  char *v37; // esi@82
  signed int v38; // edi@82
  signed int k; // esi@86
  unsigned int v40; // ecx@91
  CashItemEntry *v41; // eax@92
  ZRef<GW_ItemSlotBase> *v42; // eax@97
  GW_ItemSlotBase *v43; // eax@98
  signed int v44; // esi@101
  unsigned int v45; // ecx@105
  CashItemEntry *v46; // eax@106
  __POSITION *v47; // eax@119
  char *v48; // edi@127
  int v49; // eax@127
  char v50; // al@130
  signed int v51; // esi@130
  unsigned int v52; // ecx@134
  CashItemEntry *v53; // eax@135
  int v54; // eax@143
  ZMap<long,long,long> *v55; // esi@144
  int v56; // edi@144
  ZMap<long,unsigned short,long> *v57; // esi@151
  int v58; // eax@151
  int v59; // edi@152
  CInPacket *v60; // eax@153
  int v61; // esi@155
  unsigned __int16 v62; // di@156
  int v63; // esi@158
  ZMap<unsigned short,_FILETIME,unsigned short> *v64; // edi@158
  CInPacket *v65; // eax@159
  CInPacket *v66; // eax@161
  ZMap<long,ZRef<GW_MiniGameRecord>,long> *v67; // edi@162
  GW_MiniGameRecord *v68; // esi@163
  GW_MiniGameRecord *v69; // esi@163
  GW_MiniGameRecord *v70; // esi@163
  GW_MiniGameRecord *v71; // esi@163
  GW_MiniGameRecord *v72; // esi@163
  int v73; // eax@167
  ZList<GW_CoupleRecord> *v74; // esi@168
  int v75; // edi@168
  GW_CoupleRecord *v76; // eax@169
  int v77; // eax@170
  ZList<GW_FriendRecord> *v78; // esi@171
  int v79; // edi@171
  GW_FriendRecord *v80; // eax@172
  int v81; // eax@173
  ZList<GW_MarriageRecord> *v82; // esi@174
  int v83; // edi@174
  GW_MarriageRecord *v84; // eax@175
  char *v85; // esi@178
  signed int v86; // edi@178
  char *v87; // esi@180
  signed int v88; // edi@180
  int v89; // ebx@184
  int v90; // eax@185
  signed int v91; // ecx@186
  char *l; // esi@189
  int v93; // ecx@191
  int v94; // ecx@194
  int v95; // edi@194
  int v96; // ecx@194
  int v97; // ecx@198
  int v98; // edi@201
  int v99; // ecx@203
  int v100; // ecx@206
  int v101; // esi@206
  int v102; // ecx@206
  int v103; // ecx@210
  int v104; // ecx@213
  ZArray<CashItemEntry> *v105; // ecx@213
  int v106; // esi@214
  ZArray<CashItemEntry> *v107; // edi@214
  int v108; // eax@216
  __POSITION *v109; // eax@217
  int v110; // edi@218
  int v111; // esi@219
  signed int v112; // eax@220
  int v113; // esi@223
  CashItemEntry *v114; // ebx@223
  int v115; // eax@223
  ZArray<ZRef<GW_ItemSlotBase> > *v116; // ebx@224
  int v117; // eax@225
  signed int v118; // ecx@226
  int v119; // esi@229
  ZArray<ZRef<GW_ItemSlotBase> > v120; // eax@229
  int v121; // ecx@231
  signed int v122; // eax@232
  ZRef<GW_ItemSlotBase> *v123; // ecx@234
  signed int v124; // eax@235
  int v125; // edi@241
  ZRef<GW_ItemSlotBase> *v126; // ecx@242
  unsigned int v128; // [sp-Ch] [bp-84h]@10
  unsigned int v129; // [sp-8h] [bp-80h]@10
  __POSITION *v130; // [sp-4h] [bp-7Ch]@10
  ZArray<CashItemEntry> v131; // [sp+Ch] [bp-6Ch]@5
  ZArray<CashItemEntry> v132; // [sp+10h] [bp-68h]@10
  ZArray<CashItemEntry> v133; // [sp+24h] [bp-54h]@5
  ZArray<CashItemEntry> v134; // [sp+28h] [bp-50h]@77
  ZRef<GW_ItemSlotBase> p; // [sp+3Ch] [bp-3Ch]@131
  ZRef<GW_MiniGameRecord> value; // [sp+44h] [bp-34h]@10
  int key; // [sp+4Ch] [bp-2Ch]@15
  ZRef<GW_ItemSlotBase> result; // [sp+50h] [bp-28h]@41
  int v139; // [sp+58h] [bp-20h]@1
  CharacterData *v140; // [sp+5Ch] [bp-1Ch]@1
  ZRef<GW_ItemSlotBase> r; // [sp+60h] [bp-18h]@15
  char v142; // [sp+6Bh] [bp-Dh]@47
  int v143; // [sp+74h] [bp-4h]@5

  v3 = iPacket;
  v4 = this;
  v140 = this;
  LOWORD(v5) = CInPacket::Decode2(iPacket);
  v139 = v5;
  if ( v5 & 1 )
  {
    GW_CharacterStat::Decode(&v4->characterStat, v3, bBackwardUpdate);
    v4->nFriendMax = (unsigned __int8)CInPacket::Decode1(v3);
  }
  if ( v139 & 2 )
    GW_CharacterStat::DecodeMoney(&v4->characterStat, v3);
  `eh vector constructor iterator'(
    &v131,
    4u,
    6,
    (int)ZArray<CashItemEntry>::ZArray<CashItemEntry>,
    (void (__thiscall *)(void *))ZArray<CashItemEntry>::~ZArray<CashItemEntry>);
  v143 = 0;
  `eh vector constructor iterator'(
    &v133,
    4u,
    6,
    (int)ZArray<CashItemEntry>::ZArray<CashItemEntry>,
    (void (__thiscall *)(void *))ZArray<CashItemEntry>::~ZArray<CashItemEntry>);
  LOBYTE(v143) = 1;
  if ( bBackwardUpdate )
  {
    if ( v139 & 4 )
    {
      v6 = -1;
      v7 = (int)&v4->aEquipped[1].p;
      do
      {
        v8 = *(_DWORD *)v7;
        if ( *(_DWORD *)v7 )
        {
          v9 = *(_DWORD *)(v8 + 20) | *(_DWORD *)(v8 + 16);
          if ( *(_QWORD *)(v8 + 16) )
          {
            v130 = (__POSITION *)v6;
            v129 = v9;
            v128 = v9;
            value.p = (GW_MiniGameRecord *)&v128;
            ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>(
              (ZRef<GW_ItemSlotBase> *)&v128,
              (ZRef<GW_ItemSlotBase> *)(v7 - 4));
            LOBYTE(v143) = 1;
            v10 = ZArray<CashItemEntry>::InsertBefore(&v132, -1);
            CashItemEntry::Set(v10, *(ZRef<GW_ItemSlotBase> *)&v128, (int)v130);
          }
        }
        v11 = *(_DWORD *)(v7 + 240);
        if ( v11 )
        {
          v12 = *(_DWORD *)(v11 + 20) | *(_DWORD *)(v11 + 16);
          if ( *(_QWORD *)(v11 + 16) )
          {
            v130 = (__POSITION *)(v6 - 100);
            v129 = v12;
            v128 = v12;
            value.p = (GW_MiniGameRecord *)&v128;
            ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>(
              (ZRef<GW_ItemSlotBase> *)&v128,
              (ZRef<GW_ItemSlotBase> *)(v7 + 236));
            LOBYTE(v143) = 1;
            v13 = ZArray<CashItemEntry>::InsertBefore(&v132, -1);
            CashItemEntry::Set(v13, *(ZRef<GW_ItemSlotBase> *)&v128, (int)v130);
          }
        }
        --v6;
        v7 += 8;
      }
      while ( v6 >= -29 );
    }
    r.p = (GW_ItemSlotBase *)1;
    key = (unsigned __int16)v139;
    while ( 1 )
    {
      if ( r.p == (GW_ItemSlotBase *)1 )
      {
        v130 = (__POSITION *)4;
        goto LABEL_27;
      }
      if ( r.p == (GW_ItemSlotBase *)2 )
      {
        v130 = (__POSITION *)8;
        goto LABEL_27;
      }
      if ( r.p == (GW_ItemSlotBase *)3 )
      {
        v130 = (__POSITION *)16;
        goto LABEL_27;
      }
      if ( r.p == (GW_ItemSlotBase *)4 )
        break;
      if ( r.p == (GW_ItemSlotBase *)5 )
      {
        v130 = (__POSITION *)64;
LABEL_27:
        v14 = v130;
        goto LABEL_28;
      }
      v14 = 0;
LABEL_28:
      if ( (unsigned int)v14 & key )
      {
        v15 = &v140->aaItemSlot[(unsigned int)r.p];
        v16.a = v15->a;
        if ( v15->a )
          v16.a = (ZRef<GW_ItemSlotBase> *)v16.a[-1].p;
        v17 = (int)&v16.a[-1].p + 3;
        for ( i = 1; i <= v17; ++i )
        {
          v19 = v15->a[i].p;
          if ( v19 && v19->liCashItemSN.QuadPart )
          {
            v130 = (__POSITION *)i;
            v20 = ZArray<ZRef<GW_ItemSlotBase>>::operator[](v15, i);
            v129 = v21;
            v128 = v21;
            value.p = (GW_MiniGameRecord *)&v128;
            ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)&v128, v20);
            LOBYTE(v143) = 1;
            v22 = ZArray<CashItemEntry>::InsertBefore(&v131 + (unsigned int)r.p, -1);
            CashItemEntry::Set(v22, *(ZRef<GW_ItemSlotBase> *)&v128, (int)v130);
          }
        }
      }
      if ( (signed int)++r.p > 5 )
        goto LABEL_37;
    }
    v130 = (__POSITION *)32;
    goto LABEL_27;
  }
LABEL_37:
  value.p = (GW_MiniGameRecord *)(v139 & 0x80);
  r.p = (GW_ItemSlotBase *)1;
  key = (unsigned __int16)v139;
  do
  {
    v23 = &v140->aaItemSlot[(unsigned int)r.p];
    v24 = 0;
    if ( v23->a )
      v25 = v23->a[-1].p;
    else
      v25 = 0;
    v26 = (int)&v25[-1].dateExpire.dwHighDateTime + 3;
    result.p = (GW_ItemSlotBase *)((char *)v25 - 1);
    if ( LOWORD(value.p) )
    {
      v27 = CInPacket::Decode1(iPacket);
      v26 = (unsigned __int8)v27;
      result.p = (GW_ItemSlotBase *)(unsigned __int8)v27;
    }
    if ( v23->a )
      v28 = v23->a[-1].p;
    else
      v28 = 0;
    if ( (GW_ItemSlotBase *)v26 != (GW_ItemSlotBase *)((char *)&v28[-1].dateExpire.dwHighDateTime + 3) )
      ZArray<ZRef<GW_ItemSlotBase>>::_Realloc(v23, v26 + 1, 0, (ZAllocHelper *)&v142);
    if ( r.p == (GW_ItemSlotBase *)1 )
    {
      v130 = (__POSITION *)4;
      goto LABEL_59;
    }
    if ( r.p == (GW_ItemSlotBase *)2 )
    {
      v130 = (__POSITION *)8;
      goto LABEL_59;
    }
    if ( r.p == (GW_ItemSlotBase *)3 )
    {
      v130 = (__POSITION *)16;
      goto LABEL_59;
    }
    if ( r.p == (GW_ItemSlotBase *)4 )
    {
      v130 = (__POSITION *)32;
      goto LABEL_59;
    }
    if ( r.p == (GW_ItemSlotBase *)5 )
    {
      v130 = (__POSITION *)64;
LABEL_59:
      v29 = v130;
      goto LABEL_60;
    }
    v29 = 0;
LABEL_60:
    if ( (unsigned int)v29 & key && v26 >= 0 )
    {
      do
      {
        v30 = &v23->a[v24];
        if ( v30->p )
        {
          ZRef<GW_ItemSlotBase>::_ReleaseRaw(v30, 0);
          v30->p = 0;
        }
        ++v24;
      }
      while ( v24 <= (signed int)result.p );
    }
    ++r.p;
  }
  while ( (signed int)r.p <= 5 );
  if ( v139 & 4 )
  {
    v31 = (char *)&v140->aEquipped[0].p;
    v32 = 30;
    do
    {
      if ( *(_DWORD *)v31 )
      {
        ZRef<GW_ItemSlotBase>::_ReleaseRaw((ZRef<GW_ItemSlotBase> *)(v31 - 4), 0);
        *(_DWORD *)v31 = 0;
      }
      v31 += 8;
      --v32;
    }
    while ( v32 );
    v33 = iPacket;
    for ( j = (unsigned __int8)CInPacket::Decode1(iPacket); j; j = (unsigned __int8)CInPacket::Decode1(v33) )
    {
      GW_ItemSlotBase::Decode(&result, v33);
      LOBYTE(v143) = 5;
      if ( j >= 1 && j <= 29 )
      {
        if ( bBackwardUpdate
          && (v35 = result.p->liCashItemSN.HighPart | result.p->liCashItemSN.LowPart, result.p->liCashItemSN.QuadPart) )
        {
          v130 = (__POSITION *)-j;
          v129 = v35;
          v128 = v35;
          value.p = (GW_MiniGameRecord *)&v128;
          ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)&v128, &result);
          LOBYTE(v143) = 5;
          v36 = ZArray<CashItemEntry>::InsertBefore(&v134, -1);
          CashItemEntry::Set(v36, *(ZRef<GW_ItemSlotBase> *)&v128, (int)v130);
        }
        else
        {
          ZRef<GW_ItemSlotBase>::operator=(&v140->aEquipped[j], &result);
        }
      }
      LOBYTE(v143) = 1;
      if ( result.p )
      {
        ZRef<GW_ItemSlotBase>::_ReleaseRaw(&result, 0);
        result.p = 0;
      }
    }
    v37 = (char *)&v140->aEquipped2[0].p;
    v38 = 30;
    do
    {
      if ( *(_DWORD *)v37 )
      {
        ZRef<GW_ItemSlotBase>::_ReleaseRaw((ZRef<GW_ItemSlotBase> *)(v37 - 4), 0);
        *(_DWORD *)v37 = 0;
      }
      v37 += 8;
      --v38;
    }
    while ( v38 );
    for ( k = (unsigned __int8)CInPacket::Decode1(v33); k; k = (unsigned __int8)CInPacket::Decode1(v33) )
    {
      GW_ItemSlotBase::Decode(&result, v33);
      LOBYTE(v143) = 7;
      if ( k >= 1 && k <= 29 )
      {
        if ( bBackwardUpdate
          && (v40 = result.p->liCashItemSN.HighPart | result.p->liCashItemSN.LowPart, result.p->liCashItemSN.QuadPart) )
        {
          v130 = (__POSITION *)(-100 - k);
          v129 = v40;
          v128 = v40;
          value.p = (GW_MiniGameRecord *)&v128;
          ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)&v128, &result);
          LOBYTE(v143) = 7;
          v41 = ZArray<CashItemEntry>::InsertBefore(&v134, -1);
          CashItemEntry::Set(v41, *(ZRef<GW_ItemSlotBase> *)&v128, (int)v130);
        }
        else
        {
          ZRef<GW_ItemSlotBase>::operator=(&v140->aEquipped2[k], &result);
        }
      }
      LOBYTE(v143) = 1;
      if ( result.p )
      {
        ZRef<GW_ItemSlotBase>::_ReleaseRaw(&result, 0);
        result.p = 0;
      }
    }
    v42 = v140->aaItemSlot[1].a;
    if ( v42 )
      v43 = v42[-1].p;
    else
      v43 = 0;
    result.p = (GW_ItemSlotBase *)((char *)v43 - 1);
    while ( 1 )
    {
      v44 = (unsigned __int8)CInPacket::Decode1(v33);
      if ( !v44 )
        break;
      GW_ItemSlotBase::Decode(&r, v33);
      LOBYTE(v143) = 9;
      if ( v44 < 1 || v44 > (signed int)result.p )
      {
        LOBYTE(v143) = 1;
      }
      else
      {
        if ( bBackwardUpdate
          && (v45 = r.p->liCashItemSN.HighPart | r.p->liCashItemSN.LowPart, r.p->liCashItemSN.QuadPart) )
        {
          v130 = (__POSITION *)v44;
          v129 = v45;
          v128 = v45;
          value.p = (GW_MiniGameRecord *)&v128;
          ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)&v128, &r);
          LOBYTE(v143) = 9;
          v46 = ZArray<CashItemEntry>::InsertBefore(&v134, -1);
          CashItemEntry::Set(v46, *(ZRef<GW_ItemSlotBase> *)&v128, (int)v130);
        }
        else
        {
          v130 = (__POSITION *)&r;
          ZRef<GW_ItemSlotBase>::operator=(&v140->aaItemSlot[1].a[v44], &r);
        }
        LOBYTE(v143) = 1;
      }
      if ( r.p )
      {
        ZRef<GW_ItemSlotBase>::_ReleaseRaw(&r, 0);
        r.p = 0;
      }
    }
  }
  else
  {
    v33 = iPacket;
  }
  r.p = (GW_ItemSlotBase *)2;
  while ( 2 )
  {
    switch ( r.p )
    {
      case 1u:
        v130 = (__POSITION *)4;
        break;
      case 2u:
        v130 = (__POSITION *)8;
        break;
      case 3u:
        v130 = (__POSITION *)16;
        break;
      case 4u:
        v130 = (__POSITION *)32;
        break;
      default:
        if ( r.p != (GW_ItemSlotBase *)5 )
        {
          v47 = 0;
          goto LABEL_126;
        }
        v130 = (__POSITION *)64;
        break;
    }
    v47 = v130;
LABEL_126:
    if ( (unsigned int)v47 & key )
    {
      v48 = (char *)&v140->aaItemSlot[(unsigned int)r.p];
      v49 = *(_DWORD *)v48;
      if ( *(_DWORD *)v48 )
        v49 = *(_DWORD *)(v49 - 4);
      result.p = (GW_ItemSlotBase *)(v49 - 1);
      while ( 1 )
      {
        v50 = CInPacket::Decode1(v33);
        v51 = (unsigned __int8)v50;
        if ( !v50 )
          break;
        GW_ItemSlotBase::Decode(&p, v33);
        LOBYTE(v143) = 11;
        if ( v51 < 1 || v51 > (signed int)result.p )
        {
          LOBYTE(v143) = 1;
          if ( p.p )
          {
            ZRef<GW_ItemSlotBase>::_ReleaseRaw(&p, 0);
            p.p = 0;
          }
        }
        else
        {
          if ( bBackwardUpdate
            && (v52 = p.p->liCashItemSN.HighPart | p.p->liCashItemSN.LowPart, p.p->liCashItemSN.QuadPart) )
          {
            v130 = (__POSITION *)v51;
            v129 = v52;
            v128 = v52;
            value.p = (GW_MiniGameRecord *)&v128;
            ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)&v128, &p);
            LOBYTE(v143) = 11;
            v53 = ZArray<CashItemEntry>::InsertBefore(&v133 + (unsigned int)r.p, -1);
            CashItemEntry::Set(v53, *(ZRef<GW_ItemSlotBase> *)&v128, (int)v130);
          }
          else
          {
            v130 = (__POSITION *)&p;
            ZRef<GW_ItemSlotBase>::operator=((ZRef<GW_ItemSlotBase> *)(*(_DWORD *)v48 + 8 * v51), &p);
          }
          LOBYTE(v143) = 1;
          if ( p.p )
          {
            ZRef<GW_ItemSlotBase>::_ReleaseRaw(&p, 0);
            p.p = 0;
          }
        }
      }
    }
    if ( (signed int)++r.p <= 5 )
      continue;
    break;
  }
  if ( BYTE1(v139) & 1 )
  {
    v54 = CInPacket::Decode2(v33);
    if ( (signed int)(unsigned __int16)v54 > 0 )
    {
      v55 = &v140->mSkillRecord;
      v56 = v54;
      do
      {
        key = CInPacket::Decode4(v33);
        value.p = (GW_MiniGameRecord *)CInPacket::Decode4(v33);
        ZMap<long,long,long>::Insert(v55, &key, (const int *)&value.p);
        if ( key / 10000 % 100 )
        {
          v33 = iPacket;
          if ( key / 10000 % 10 == 2 )
          {
            result.p = (GW_ItemSlotBase *)CInPacket::Decode4(iPacket);
            ZMap<long,long,long>::Insert(&v140->mSkillMasterLev, &key, (const int *)&result.p);
          }
        }
        else
        {
          v33 = iPacket;
        }
        --v56;
      }
      while ( v56 );
    }
  }
  if ( BYTE1(v139) & 0x80 )
  {
    v57 = &v140->mSkillCooltime;
    ZMap<long,unsigned short,long>::RemoveAll(&v140->mSkillCooltime);
    v58 = CInPacket::Decode2(v33);
    if ( (signed int)(unsigned __int16)v58 > 0 )
    {
      v59 = v58;
      do
      {
        value.p = (GW_MiniGameRecord *)CInPacket::Decode4(v33);
        LOWORD(v60) = CInPacket::Decode2(v33);
        iPacket = v60;
        ZMap<long,unsigned short,long>::Insert(v57, (const int *)&value.p, (const unsigned __int16 *)&iPacket);
        --v59;
      }
      while ( v59 );
    }
  }
  if ( BYTE1(v139) & 2 )
  {
    v61 = CInPacket::Decode2(v33);
    CharacterData::RemoveAllQuest(v140);
    if ( (signed int)(unsigned __int16)v61 > 0 )
    {
      do
      {
        v62 = CInPacket::Decode2(v33);
        CInPacket::DecodeStr(v33, (ZXString<char> *)&iPacket);
        LOBYTE(v143) = 13;
        CharacterData::SetQuest(v140, v62, (ZXString<char> *)&iPacket);
        LOBYTE(v143) = 1;
        ZXString<char>::~ZXString<char>((ZXString<char> *)&iPacket);
        --v61;
      }
      while ( v61 );
    }
  }
  if ( BYTE1(v139) & 0x40 )
  {
    v63 = CInPacket::Decode2(v33);
    v64 = &v140->mQuestComplete;
    ZMap<unsigned short,_FILETIME,unsigned short>::RemoveAll(&v140->mQuestComplete);
    if ( (signed int)(unsigned __int16)v63 > 0 )
    {
      do
      {
        LOWORD(v65) = CInPacket::Decode2(v33);
        iPacket = v65;
        CInPacket::DecodeBuffer(v33, &p, 8u);
        ZMap<unsigned short,_FILETIME,unsigned short>::Insert(v64, (const unsigned __int16 *)&iPacket, (_FILETIME *)&p);
        --v63;
      }
      while ( v63 );
    }
  }
  if ( BYTE1(v139) & 4 )
  {
    v66 = (CInPacket *)CInPacket::Decode2(v33);
    if ( (signed int)(unsigned __int16)v66 > 0 )
    {
      v67 = &v140->mMiniGameRecord;
      iPacket = v66;
      do
      {
        value.p = 0;
        LOBYTE(v143) = 14;
        ZRef<GW_MiniGameRecord>::_Alloc(&value);
        v68 = value.p;
        v68->nGameID = CInPacket::Decode4(v33);
        v69 = value.p;
        v69->nWin = CInPacket::Decode4(v33);
        v70 = value.p;
        v70->nDraw = CInPacket::Decode4(v33);
        v71 = value.p;
        v71->nLose = CInPacket::Decode4(v33);
        v72 = value.p;
        v72->nScore = CInPacket::Decode4(v33);
        ZMap<long,ZRef<GW_MiniGameRecord>,long>::Insert(v67, &value.p->nGameID, &value);
        LOBYTE(v143) = 1;
        if ( value.p )
        {
          ZRef<GW_MiniGameRecord>::_ReleaseRaw(&value, 0);
          value.p = 0;
        }
        iPacket = (CInPacket *)((char *)iPacket - 1);
      }
      while ( iPacket );
    }
  }
  if ( BYTE1(v139) & 8 )
  {
    value.p = 0;
    LOBYTE(v143) = 15;
    v73 = CInPacket::Decode2(v33);
    if ( (signed int)(unsigned __int16)v73 > 0 )
    {
      v74 = &v140->lCoupleRecord;
      v75 = v73;
      do
      {
        v76 = ZList<GW_CoupleRecord>::AddTail(v74);
        GW_CoupleRecord::Decode(v76, v33);
        --v75;
      }
      while ( v75 );
    }
    v77 = CInPacket::Decode2(v33);
    if ( (signed int)(unsigned __int16)v77 > 0 )
    {
      v78 = &v140->lFriendRecord;
      v79 = v77;
      do
      {
        v80 = ZList<GW_FriendRecord>::AddTail(v78);
        GW_FriendRecord::Decode(v80, v33);
        --v79;
      }
      while ( v79 );
    }
    v81 = CInPacket::Decode2(v33);
    if ( (signed int)(unsigned __int16)v81 > 0 )
    {
      v82 = &v140->lMarriageRecord;
      v83 = v81;
      do
      {
        v84 = ZList<GW_MarriageRecord>::AddTail(v82);
        GW_MarriageRecord::Decode(v84, v33);
        --v83;
      }
      while ( v83 );
    }
    LOBYTE(v143) = 1;
    ZXString<char>::~ZXString<char>((ZXString<char> *)&value.p);
  }
  if ( BYTE1(v139) & 0x10 )
  {
    v85 = (char *)v140->adwMapTransfer;
    v86 = 5;
    do
    {
      *(_DWORD *)v85 = CInPacket::Decode4(v33);
      v85 += 4;
      --v86;
    }
    while ( v86 );
    v87 = (char *)v140->adwMapTransferEx;
    v88 = 10;
    do
    {
      *(_DWORD *)v87 = CInPacket::Decode4(v33);
      v87 += 4;
      --v88;
    }
    while ( v88 );
  }
  if ( bBackwardUpdate )
  {
    r.p = (GW_ItemSlotBase *)1;
    do
    {
      v89 = 0;
      iPacket = 0;
      result.p = (GW_ItemSlotBase *)12;
      while ( 1 )
      {
        v90 = *((_DWORD *)&v133.a + (unsigned int)r.p);
        v91 = v90 ? *(_DWORD *)(v90 - 4) : 0;
        if ( (signed int)iPacket >= v91 )
          break;
        bBackwardUpdate = (int)&iPacket->m_bLoopback + 1;
        for ( l = (char *)&result.p->4 + v90; ; l += 12 )
        {
          v93 = v90 ? *(_DWORD *)(v90 - 4) : 0;
          if ( bBackwardUpdate >= v93 )
            break;
          v94 = *(_DWORD *)(v90 + v89 + 4);
          v95 = *(_DWORD *)(v94 + 16);
          v96 = v94 + 16;
          if ( v95 == *(_DWORD *)(*(_DWORD *)l + 16) && *(_DWORD *)(v96 + 4) == *(_DWORD *)(*(_DWORD *)l + 20) )
            break;
          ++bBackwardUpdate;
        }
        if ( v90 )
          v97 = *(_DWORD *)(v90 - 4);
        else
          v97 = 0;
        if ( bBackwardUpdate < v97 )
          goto LABEL_250;
        v98 = *((_DWORD *)&v131.a + (unsigned int)r.p);
        bBackwardUpdate = 0;
        for ( key = v98 + 4; ; key += 12 )
        {
          v99 = v98 ? *(_DWORD *)(v98 - 4) : 0;
          if ( bBackwardUpdate >= v99 )
            break;
          v100 = *(_DWORD *)(v90 + v89 + 4);
          v101 = *(_DWORD *)(v100 + 16);
          v102 = v100 + 16;
          if ( v101 == *(_DWORD *)(*(_DWORD *)key + 16) && *(_DWORD *)(v102 + 4) == *(_DWORD *)(*(_DWORD *)key + 20) )
            break;
          ++bBackwardUpdate;
        }
        v103 = v98 ? *(_DWORD *)(v98 - 4) : 0;
        if ( bBackwardUpdate < v103 )
        {
          v106 = bBackwardUpdate;
          (*(void (__stdcall **)(_DWORD))(**(_DWORD **)(v98 + 12 * bBackwardUpdate + 4) + 40))(*(_DWORD *)(v90 + v89 + 4));
          v107 = &v131 + (unsigned int)r.p;
          ZRef<GW_ItemSlotBase>::operator=(
            (ZRef<GW_ItemSlotBase> *)(*((_DWORD *)&v133.a + (unsigned int)r.p) + v89),
            &v107->a[v106].pItem);
          v105 = v107;
          v130 = (__POSITION *)&v107->a[v106];
        }
        else
        {
LABEL_250:
          iPacket = (CInPacket *)((char *)iPacket - 1);
          result.p = (GW_ItemSlotBase *)((char *)result.p - 12);
          v104 = v89;
          v89 -= 12;
          v130 = (__POSITION *)(v104 + v90);
          v105 = &v133 + (unsigned int)r.p;
        }
        ZArray<CashItemEntry>::RemoveAt(v105, v130);
        iPacket = (CInPacket *)((char *)iPacket + 1);
        result.p = (GW_ItemSlotBase *)((char *)result.p + 12);
        v89 += 12;
      }
      v108 = *((_DWORD *)&v131.a + (unsigned int)r.p);
      if ( v108 )
      {
        v109 = *(__POSITION **)(v108 - 4);
        if ( v109 )
        {
          v130 = v109;
          v129 = v140->characterStat.dwCharacterID;
          LogError(aLackOfCashItem, v129, v109);
          v110 = 0;
          iPacket = 0;
          while ( 1 )
          {
            v111 = *((_DWORD *)&v131.a + (unsigned int)r.p);
            v112 = v111 ? *(_DWORD *)(v111 - 4) : 0;
            if ( (signed int)iPacket >= v112 )
              break;
            v113 = v110 + v111;
            v114 = ZArray<CashItemEntry>::InsertBefore(&v133 + (unsigned int)r.p, -1);
            ZRef<GW_ItemSlotBase>::operator=(&v114->pItem, (ZRef<GW_ItemSlotBase> *)v113);
            v115 = *(_DWORD *)(v113 + 8);
            iPacket = (CInPacket *)((char *)iPacket + 1);
            v114->nPOS = v115;
            v110 += 12;
          }
        }
      }
      iPacket = 0;
      bBackwardUpdate = 0;
      v116 = &v140->aaItemSlot[(unsigned int)r.p];
      while ( 1 )
      {
        v117 = *((_DWORD *)&v133.a + (unsigned int)r.p);
        v118 = v117 ? *(_DWORD *)(v117 - 4) : 0;
        if ( (signed int)iPacket >= v118 )
          break;
        v119 = v117 + bBackwardUpdate;
        v120.a = v116->a;
        if ( v116->a )
          v120.a = (ZRef<GW_ItemSlotBase> *)v120.a[-1].p;
        v121 = (int)&v120.a[-1].p + 3;
        if ( r.p != (GW_ItemSlotBase *)1 || (v122 = *(_DWORD *)(v119 + 8), v122 > -101) || v122 < -129 )
        {
          v124 = *(_DWORD *)(v119 + 8);
          if ( v124 < 1 || v124 > v121 )
            goto LABEL_241;
          v123 = &v116->a[v124];
        }
        else
        {
          v123 = (ZRef<GW_ItemSlotBase> *)((char *)v140 + -8 * v122 - 482);
        }
        if ( v123 && !v123->p )
        {
          ZRef<GW_ItemSlotBase>::operator=(v123, (ZRef<GW_ItemSlotBase> *)v119);
          goto LABEL_245;
        }
LABEL_241:
        v125 = CharacterData::FindEmptySlotPosition(v140, (int)r.p);
        v130 = (__POSITION *)v119;
        if ( v125 <= 0 )
          v126 = ZArray<ZRef<GW_ItemSlotBase>>::InsertBefore(v116, -1);
        else
          v126 = &v116->a[v125];
        ZRef<GW_ItemSlotBase>::operator=(v126, (ZRef<GW_ItemSlotBase> *)v130);
        v130 = (__POSITION *)v125;
        v129 = *(_DWORD *)(v119 + 8);
        v128 = v140->characterStat.dwCharacterID;
        LogError(aCashItemPositi, v128, v129, v125);
LABEL_245:
        iPacket = (CInPacket *)((char *)iPacket + 1);
        bBackwardUpdate += 12;
      }
      ++r.p;
    }
    while ( (signed int)r.p <= 5 );
  }
  LOBYTE(v143) = 0;
  `eh vector destructor iterator'(
    &v133,
    4u,
    6,
    (void (__thiscall *)(void *))ZArray<CashItemEntry>::~ZArray<CashItemEntry>);
  v143 = -1;
  return `eh vector destructor iterator'(
           &v131,
           4u,
           6,
           (void (__thiscall *)(void *))ZArray<CashItemEntry>::~ZArray<CashItemEntry>);
}

//----- (00415213) --------------------------------------------------------
int __thiscall CharacterData::FindEmptySlotPosition(CharacterData *this, int nTI)
{
  char *v2; // ecx@3
  int v3; // eax@3
  int v4; // edx@5
  int result; // eax@5
  _DWORD *v6; // ecx@6

  if ( nTI < 1 || nTI > 5 )
    goto LABEL_9;
  v2 = (char *)&this->aaItemSlot[nTI];
  v3 = *(_DWORD *)v2;
  if ( *(_DWORD *)v2 )
    v3 = *(_DWORD *)(v3 - 4);
  v4 = v3 - 1;
  result = 1;
  if ( v4 < 1 )
  {
LABEL_9:
    result = 0;
  }
  else
  {
    v6 = (_DWORD *)(*(_DWORD *)v2 + 12);
    while ( *v6 )
    {
      ++result;
      v6 += 2;
      if ( result > v4 )
        goto LABEL_9;
    }
  }
  return result;
}

//----- (00415252) --------------------------------------------------------
void __thiscall CashItemEntry::Set(CashItemEntry *this, ZRef<GW_ItemSlotBase> pItem, int nPOS)
{
  CashItemEntry *v3; // esi@1
  bool v4; // zf@1

  v3 = this;
  ZRef<GW_ItemSlotBase>::operator=(&this->pItem, &pItem);
  v4 = pItem.p == 0;
  v3->nPOS = nPOS;
  if ( !v4 )
    ZRef<GW_ItemSlotBase>::_ReleaseRaw(&pItem, 0);
}

//----- (00415295) --------------------------------------------------------
__POSITION *__thiscall CharacterData::SetQuest(CharacterData *this, unsigned __int16 usQRKey, ZXString<char> *sQRValue)
{
  return ZMap<unsigned short,ZXString<char>,unsigned short>::Insert(&this->mQuestRecord, &usQRKey, sQRValue) + 12;
}

//----- (004152AF) --------------------------------------------------------
int __thiscall CharacterData::RemoveQuest(CharacterData *this, unsigned __int16 usQRKey)
{
  return ZMap<unsigned short,ZXString<char>,unsigned short>::RemoveKey(&this->mQuestRecord, &usQRKey);
}

//----- (004152C2) --------------------------------------------------------
void __thiscall CharacterData::RemoveAllQuest(CharacterData *this)
{
  ZMap<unsigned short,ZXString<char>,unsigned short>::RemoveAll(&this->mQuestRecord);
}

//----- (004152CD) --------------------------------------------------------
ZXString<char> *__thiscall CharacterData::SELECTEDMOB::Encode(CharacterData::SELECTEDMOB *this, ZXString<char> *result)
{
  bool v2; // zf@1
  int v3; // ST10_4@1
  ZXString<char> s; // [sp+10h] [bp-10h]@1
  int v6; // [sp+1Ch] [bp-4h]@1

  s._m_pStr = 0;
  v2 = this->bAbs == 0;
  v3 = this->dwBonusEXP;
  v6 = 1;
  ZXString<char>::Format(&s, aDDD, this->dwMobID, !v2, v3);
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, &s);
  LOBYTE(v6) = 0;
  ZXString<char>::~ZXString<char>(&s);
  return result;
}

//----- (0041533A) --------------------------------------------------------
char __thiscall CharacterData::SELECTEDMOB::Decode(CharacterData::SELECTEDMOB *this, ZXString<char> *sQRValue)
{
  int v2; // ebx@1
  int *v3; // edi@1
  char *v4; // esi@2
  char *v5; // eax@3
  int v6; // esi@4
  ZXString<char> *v7; // eax@8
  CharacterData::SELECTEDMOB *v8; // eax@9
  int aTemp[3]; // [sp+Ch] [bp-18h]@1
  CharacterData::SELECTEDMOB *v11; // [sp+18h] [bp-Ch]@1
  ZXString<char> result; // [sp+1Ch] [bp-8h]@8
  int i; // [sp+20h] [bp-4h]@1

  v2 = 0;
  aTemp[0] = 0;
  aTemp[1] = 0;
  aTemp[2] = 0;
  v11 = this;
  i = 0;
  v3 = aTemp;
  while ( 1 )
  {
    v4 = sQRValue->_m_pStr;
    if ( sQRValue->_m_pStr && (v5 = strchr(&v4[v2], 47)) != 0 )
      v6 = v5 - v4;
    else
      v6 = -1;
    if ( i < 2 && v6 < 0 )
      break;
    v7 = ZXString<char>::Substring(sQRValue, &result, v2, v6);
    *v3 = atoi(v7->_m_pStr);
    ZXString<char>::~ZXString<char>(&result);
    ++i;
    ++v3;
    v2 = v6 + 1;
    if ( i >= 3 )
    {
      v8 = v11;
      v11->dwMobID = aTemp[0];
      v8->bAbs = aTemp[1];
      v8->dwBonusEXP = aTemp[2];
      return 1;
    }
  }
  return 0;
}

//----- (004153D5) --------------------------------------------------------
CharacterData::SELECTEDMOB *__thiscall CharacterData::_GetQuestValue(CharacterData *this, CharacterData::SELECTEDMOB *result, unsigned __int16 __$ReturnUdt)
{
  ZXString<char> *v3; // eax@1
  ZXString<char> value; // [sp+8h] [bp-10h]@1
  int v6; // [sp+14h] [bp-4h]@1

  value._m_pStr = 0;
  v6 = 0;
  v3 = ZMap<unsigned short,ZXString<char>,unsigned short>::GetAt(&this->mQuestRecord, &__$ReturnUdt, &value);
  result->dwMobID = 0;
  result->bAbs = 0;
  result->dwBonusEXP = 0;
  if ( v3 )
    CharacterData::SELECTEDMOB::Decode(result, &value);
  v6 = -1;
  ZXString<char>::~ZXString<char>(&value);
  return result;
}

//----- (0041543B) --------------------------------------------------------
int __thiscall CharacterData::GetItemCount(CharacterData *this, int nTI, int nItemID)
{
  CharacterData *v3; // edi@1
  ZRef<GW_ItemSlotBase> *v4; // eax@1
  signed int v5; // ebx@3
  GW_ItemSlotBase *v6; // esi@4
  ZRef<GW_ItemSlotBase> result; // [sp+8h] [bp-10h]@4
  int nSlotCount; // [sp+10h] [bp-8h]@3
  int nCount; // [sp+14h] [bp-4h]@1

  nCount = 0;
  v3 = this;
  v4 = this->aaItemSlot[nTI].a;
  if ( v4 )
    v4 = (ZRef<GW_ItemSlotBase> *)v4[-1].p;
  v5 = 1;
  for ( nSlotCount = (int)&v4[-1].p + 3; v5 <= nSlotCount; ++v5 )
  {
    v6 = CharacterData::GetItem(v3, &result, nTI, v5)->p;
    if ( result.p )
    {
      ZRef<GW_ItemSlotBase>::_ReleaseRaw(&result, 0);
      result.p = 0;
    }
    if ( v6 && v6->nItemID == nItemID )
      ++nCount;
  }
  return nCount;
}

//----- (004154AD) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__thiscall CharacterData::GetItem(CharacterData *this, ZRef<GW_ItemSlotBase> *result, int __$ReturnUdt, int nTI)
{
  ZRef<GW_ItemSlotBase> *v4; // edx@7
  GW_ItemSlotBase *v5; // ecx@12
  ZRef<GW_ItemSlotBase> *v6; // esi@15
  GW_ItemSlotBase *v7; // eax@17
  ZRef<GW_ItemSlotBase> *v8; // eax@20
  char *v9; // eax@22
  int v10; // ecx@22

  if ( __$ReturnUdt >= 1 && __$ReturnUdt <= 5 )
  {
    if ( __$ReturnUdt == 1 )
    {
      if ( nTI && (nTI >= -29 || nTI < -100) )
      {
        v4 = this->aaItemSlot[1].a;
        if ( v4 )
          v4 = (ZRef<GW_ItemSlotBase> *)v4[-1].p;
        if ( nTI <= (signed int)&v4[-1].p + 3 && nTI >= -129 )
        {
          if ( nTI < -100 )
          {
            v5 = *(GW_ItemSlotBase **)((char *)this + -8 * nTI - 478);
            goto LABEL_15;
          }
          if ( nTI < 0 )
          {
            v5 = this->aEquipped[-nTI].p;
LABEL_15:
            v6 = result;
            result->p = v5;
            if ( v5 )
              InterlockedIncrement(&v5->_m_nRef);
            return v6;
          }
          v7 = this->aaItemSlot[1].a[nTI].p;
LABEL_18:
          v6 = result;
          result->p = v7;
          if ( v7 )
            InterlockedIncrement(&v7->_m_nRef);
          return v6;
        }
      }
    }
    else if ( nTI > 0 )
    {
      v9 = (char *)&this->aaItemSlot[__$ReturnUdt];
      v10 = *(_DWORD *)v9;
      if ( *(_DWORD *)v9 )
        v10 = *(_DWORD *)(v10 - 4);
      if ( nTI <= v10 - 1 )
      {
        v7 = *(GW_ItemSlotBase **)(*(_DWORD *)v9 + 8 * nTI + 4);
        goto LABEL_18;
      }
    }
  }
  v8 = result;
  result->p = 0;
  return v8;
}

//----- (00415586) --------------------------------------------------------
void __thiscall AvatarLook::Load(AvatarLook *this, GW_CharacterStat *cs, const int *anEquipped, const int *anEquipped2)
{
  const int *v4; // eax@1
  char *v5; // edx@1
  signed int v6; // edi@1
  int v7; // esi@3
  int i; // [sp+14h] [bp+8h]@1

  this->nGender = cs->nGender;
  this->nSkin = cs->nSkin;
  this->nFace = cs->nFace;
  this->anHairEquip[0] = cs->nHair;
  i = 1;
  v4 = anEquipped + 1;
  v5 = (char *)&this->anUnseenEquip[1];
  v6 = (char *)anEquipped2 - (char *)anEquipped;
  do
  {
    if ( i != 11 && (v7 = *(const int *)((char *)v4 + v6)) != 0 )
      *((_DWORD *)v5 - 30) = v7;
    else
      v7 = *v4;
    *((_DWORD *)v5 - 30) = v7;
    if ( *v4 && *(const int *)((char *)v4 + v6) && i != 11 )
      *(_DWORD *)v5 = *v4;
    else
      *(_DWORD *)v5 = 0;
    ++i;
    ++v4;
    v5 += 4;
  }
  while ( i <= 29 );
  this->nWeaponStickerID = anEquipped2[11];
}

//----- (0041560D) --------------------------------------------------------
void __thiscall AvatarLook::Load(AvatarLook *this, GW_CharacterStat *cs, ZRef<GW_ItemSlotBase> *apEquipped, ZRef<GW_ItemSlotBase> *apEquipped2)
{
  char *v4; // eax@1
  char *v5; // edx@1
  signed int v6; // edi@1
  int v7; // esi@3
  GW_ItemSlotBase *v8; // eax@13
  int v9; // eax@14
  int i; // [sp+14h] [bp+8h]@1

  this->nGender = cs->nGender;
  this->nSkin = cs->nSkin;
  this->nFace = cs->nFace;
  this->anHairEquip[0] = cs->nHair;
  i = 1;
  v4 = (char *)&apEquipped[1].p;
  v5 = (char *)&this->anHairEquip[1];
  v6 = (char *)apEquipped2 - (char *)apEquipped;
  do
  {
    if ( i != 11 && (v7 = *(_DWORD *)&v4[v6]) != 0 || (v7 = *(_DWORD *)v4) != 0 )
      *(_DWORD *)v5 = *(_DWORD *)(v7 + 12);
    else
      *(_DWORD *)v5 = 0;
    if ( *(_DWORD *)v4 && *(_DWORD *)&v4[v6] && i != 11 )
      *((_DWORD *)v5 + 30) = *(_DWORD *)(*(_DWORD *)v4 + 12);
    else
      *((_DWORD *)v5 + 30) = 0;
    ++i;
    v4 += 8;
    v5 += 4;
  }
  while ( i <= 29 );
  v8 = apEquipped2[11].p;
  if ( v8 )
    v9 = v8->nItemID;
  else
    v9 = 0;
  this->nWeaponStickerID = v9;
}

//----- (004156A6) --------------------------------------------------------
void __thiscall AvatarLook::Encode(AvatarLook *this, COutPacket *oPacket)
{
  AvatarLook *v2; // esi@1
  COutPacket *v3; // edi@1
  unsigned int *v4; // ebx@1
  unsigned int *v5; // ebx@6
  int i; // [sp+14h] [bp+8h]@1
  int ia; // [sp+14h] [bp+8h]@6

  v2 = this;
  v3 = oPacket;
  COutPacket::Encode1(oPacket, this->nGender);
  COutPacket::Encode1(oPacket, v2->nSkin);
  COutPacket::Encode4(oPacket, v2->nFace);
  COutPacket::Encode1(oPacket, 0);
  COutPacket::Encode4(oPacket, v2->anHairEquip[0]);
  i = 1;
  v4 = (unsigned int *)&v2->anHairEquip[1];
  do
  {
    if ( *v4 && i )
    {
      COutPacket::Encode1(v3, i);
      COutPacket::Encode4(v3, *v4);
    }
    ++i;
    ++v4;
  }
  while ( i <= 29 );
  COutPacket::Encode1(v3, -1);
  ia = 1;
  v5 = (unsigned int *)&v2->anUnseenEquip[1];
  do
  {
    if ( *v5 && ia )
    {
      COutPacket::Encode1(v3, ia);
      COutPacket::Encode4(v3, *v5);
    }
    ++ia;
    ++v5;
  }
  while ( ia <= 29 );
  COutPacket::Encode1(v3, -1);
  COutPacket::Encode4(v3, v2->nWeaponStickerID);
  COutPacket::Encode4(v3, v2->nPetID);
}

//----- (00415788) --------------------------------------------------------
void __thiscall AvatarLook::Decode(AvatarLook *this, CInPacket *iPacket)
{
  AvatarLook *v2; // esi@1
  int v3; // ebx@2
  CInPacket *v4; // ecx@2
  int v5; // eax@3
  int v6; // ebp@3
  int v7; // eax@5
  int v8; // ebx@7
  int v9; // eax@8
  int v10; // ebp@8
  int v11; // eax@10

  v2 = this;
  this->nGender = CInPacket::Decode1(iPacket);
  v2->nSkin = (unsigned __int8)CInPacket::Decode1(iPacket);
  v2->nFace = CInPacket::Decode4(iPacket);
  memset(v2->anHairEquip, 0, 0x78u);
  memset(v2->anUnseenEquip, 0, 0x78u);
  CInPacket::Decode1(iPacket);
  v2->anHairEquip[0] = CInPacket::Decode4(iPacket);
  while ( 1 )
  {
    LOBYTE(v3) = CInPacket::Decode1(iPacket);
    v4 = iPacket;
    if ( (_BYTE)v3 == -1 )
      break;
    v5 = CInPacket::Decode4(iPacket);
    v6 = v5;
    if ( (unsigned __int8)v3 <= 0x1Du && (_BYTE)v3 )
    {
      v3 = (unsigned __int8)v3;
      LOBYTE(v7) = is_correct_bodypart(v5, (unsigned __int8)v3, 2);
      if ( v7 )
        v2->anHairEquip[v3] = v6;
    }
  }
  while ( 1 )
  {
    LOBYTE(v8) = CInPacket::Decode1(v4);
    if ( (_BYTE)v8 == -1 )
      break;
    v9 = CInPacket::Decode4(iPacket);
    v10 = v9;
    if ( (unsigned __int8)v8 <= 0x1Du )
    {
      if ( (_BYTE)v8 )
      {
        v8 = (unsigned __int8)v8;
        LOBYTE(v11) = is_correct_bodypart(v9, (unsigned __int8)v8, 2);
        if ( v11 )
          v2->anUnseenEquip[v8] = v10;
      }
    }
    v4 = iPacket;
  }
  v2->nWeaponStickerID = CInPacket::Decode4(iPacket);
  v2->nPetID = CInPacket::Decode4(iPacket);
}

//----- (00415873) --------------------------------------------------------
void __thiscall SCRIPTINFO::Encode(SCRIPTINFO *this, COutPacket *oPacket)
{
  SCRIPTINFO *v2; // esi@1
  ZXString<char> v3; // [sp-4h] [bp-Ch]@1
  ZXString<char> *v4; // [sp+4h] [bp-4h]@1

  v2 = this;
  v3._m_pStr = 0;
  v4 = &v3;
  ZXString<char>::operator=(&v3, &this->sScript);
  COutPacket::EncodeStr(oPacket, v3);
  COutPacket::Encode4(oPacket, v2->tStartDate);
  COutPacket::Encode4(oPacket, v2->tEndDate);
}

//----- (004158AC) --------------------------------------------------------
void __thiscall SCRIPTINFO::Decode(SCRIPTINFO *this, CInPacket *iPacket)
{
  SCRIPTINFO *v2; // esi@1
  ZXString<char> *v3; // eax@1
  ZXString<char> result; // [sp+4h] [bp-10h]@1
  int v5; // [sp+10h] [bp-4h]@1

  v2 = this;
  v3 = CInPacket::DecodeStr(iPacket, &result);
  v5 = 0;
  ZXString<char>::operator=(&v2->sScript, v3);
  v5 = -1;
  ZXString<char>::~ZXString<char>(&result);
  v2->tStartDate = CInPacket::Decode4(iPacket);
  v2->tEndDate = CInPacket::Decode4(iPacket);
}

//----- (00415903) --------------------------------------------------------
void __thiscall MODSCRIPT::Encode(MODSCRIPT *this, COutPacket *oPacket)
{
  MODSCRIPT *v2; // esi@1

  v2 = this;
  COutPacket::Encode4(oPacket, this->dwTemplateID);
  SCRIPTINFO::Encode(&v2->sInfo, oPacket);
}

//----- (00415921) --------------------------------------------------------
void __thiscall MODSCRIPT::Decode(MODSCRIPT *this, CInPacket *iPacket)
{
  MODSCRIPT *v2; // esi@1

  v2 = this;
  this->dwTemplateID = CInPacket::Decode4(iPacket);
  SCRIPTINFO::Decode(&v2->sInfo, iPacket);
}

//----- (0041593F) --------------------------------------------------------
void __thiscall ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(ZRef<GW_ItemSlotBase> *this)
{
  ZRef<GW_ItemSlotBase> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<GW_ItemSlotBase>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (00415955) --------------------------------------------------------
void __thiscall ZRef<GW_ItemSlotBase>::ZRef<GW_ItemSlotBase>(ZRef<GW_ItemSlotBase> *this, ZRef<GW_ItemSlotBase> *r)
{
  GW_ItemSlotBase *v2; // eax@1

  v2 = r->p;
  this->p = v2;
  if ( v2 )
    InterlockedIncrement(&v2->_m_nRef);
}

//----- (00415976) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__thiscall ZRef<GW_ItemSlotBase>::operator=(ZRef<GW_ItemSlotBase> *this, ZRef<GW_ItemSlotBase> *r)
{
  GW_ItemSlotBase *v2; // eax@1
  ZRef<GW_ItemSlotBase> *v3; // esi@1

  v2 = r->p;
  v3 = this;
  if ( v2 )
    InterlockedIncrement(&v2->_m_nRef);
  if ( v3->p )
  {
    ZRef<GW_ItemSlotBase>::_ReleaseRaw(v3, 0);
    v3->p = 0;
  }
  v3->p = r->p;
  return v3;
}

//----- (004159AF) --------------------------------------------------------
void __thiscall ZRef<GW_MiniGameRecord>::~ZRef<GW_MiniGameRecord>(ZRef<GW_MiniGameRecord> *this)
{
  ZRef<GW_MiniGameRecord> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<GW_MiniGameRecord>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (004159C5) --------------------------------------------------------
void __thiscall ZArray<CashItemEntry>::ZArray<CashItemEntry>(ZArray<CashItemEntry> *this)
{
  this->a = 0;
}

//----- (004159D0) --------------------------------------------------------
void __thiscall ZRef<GW_MiniGameRecord>::_Alloc(ZRef<GW_MiniGameRecord> *this)
{
  ZRef<GW_MiniGameRecord> *v1; // esi@1
  int v2; // eax@3

  v1 = this;
  if ( this->p )
  {
    ZRef<GW_MiniGameRecord>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
  ZRefCounted_Alloc();
  *(_DWORD *)(v2 + 4) = 1;
  v1->p = (GW_MiniGameRecord *)(v2 != 0 ? v2 + 16 : 0);
}

//----- (00415A03) --------------------------------------------------------
void __thiscall ZRef<GW_ItemSlotBase>::_ReleaseRaw(ZRef<GW_ItemSlotBase> *this, ZRefCounted *__formal)
{
  ZRef<GW_ItemSlotBase> *v2; // esi@1

  v2 = this;
  if ( !InterlockedDecrement(&this->p->_m_nRef) )
  {
    InterlockedIncrement(&v2->p->_m_nRef);
    ZRefCountedAccessorBase::_Delete((ZRefCounted *)&v2->p->vfptr);
  }
}

//----- (00415A31) --------------------------------------------------------
void __thiscall ZRef<GW_MiniGameRecord>::_ReleaseRaw(ZRef<GW_MiniGameRecord> *this, void *__formal)
{
  ZRefCounted *v2; // esi@1

  v2 = (ZRefCounted *)(this->p != 0 ? &this->p[-1].nWin : 0);
  if ( !InterlockedDecrement(&v2->_m_nRef) )
  {
    InterlockedIncrement(&v2->_m_nRef);
    ZRefCountedAccessorBase::_Delete(v2);
  }
}

//----- (00415A60) --------------------------------------------------------
ZXString<char> *__thiscall ZXString<char>::Substring(ZXString<char> *this, ZXString<char> *result, int __$ReturnUdt, int nFrom)
{
  int v4; // edi@1
  const char *v5; // ST08_4@2
  ZXString<char> *v6; // eax@2
  int v7; // edi@3
  char *v8; // ST08_4@3
  char *v9; // eax@3

  v4 = nFrom;
  if ( nFrom == -1 )
  {
    v5 = &this->_m_pStr[__$ReturnUdt];
    result->_m_pStr = 0;
    ZXString<char>::Assign(result, v5, v4);
    v6 = result;
  }
  else
  {
    nFrom = 0;
    v7 = v4 - __$ReturnUdt;
    v8 = &this->_m_pStr[__$ReturnUdt];
    v9 = ZXString<char>::GetBuffer((ZXString<char> *)&nFrom, v7, 0);
    memcpy(v9, v8, v7);
    ZXString<char>::ReleaseBuffer((ZXString<char> *)&nFrom, v7);
    result->_m_pStr = 0;
    ZXString<char>::operator=(result, (ZXString<char> *)&nFrom);
    ZXString<char>::~ZXString<char>((ZXString<char> *)&nFrom);
    v6 = result;
  }
  return v6;
}

//----- (00415AF2) --------------------------------------------------------
ZXString<char> *__thiscall ZXString<char>::_Cat(ZXString<char> *this, const char *s, int len)
{
  ZXString<char> *v3; // esi@1
  char *v4; // eax@2
  char *v5; // eax@4
  int v7; // edi@6
  int v8; // eax@6
  int v9; // edi@6
  char *v10; // eax@9
  int v11; // ecx@10

  v3 = this;
  if ( !len )
    return v3;
  v4 = this->_m_pStr;
  if ( !this->_m_pStr || !*v4 )
  {
    v5 = ZXString<char>::GetBuffer(this, len, 0);
    memcpy(v5, s, len);
    ZXString<char>::ReleaseBuffer(v3, len);
    return v3;
  }
  v7 = *((_DWORD *)v4 - 1);
  v8 = *((_DWORD *)v4 - 2);
  v9 = len + v7;
  while ( v8 < v9 )
    v8 *= 2;
  v10 = ZXString<char>::GetBuffer(this, v8, 1);
  if ( v3->_m_pStr )
    v11 = *((_DWORD *)v3->_m_pStr - 1);
  else
    v11 = 0;
  memcpy(&v10[v11], s, len);
  ZXString<char>::ReleaseBuffer(v3, v9);
  return v3;
}

//----- (00415B75) --------------------------------------------------------
ZXString<char> *__thiscall ZXString<char>::ZXString<char>(ZXString<char> *this, char *s, int n)
{
  ZXString<char> *v3; // esi@1

  v3 = this;
  this->_m_pStr = 0;
  ZXString<char>::Assign(this, s, n);
  return v3;
}

//----- (00415B8E) --------------------------------------------------------
ZXString<char> *__thiscall ZArray<ZXString<char>>::InsertBefore(ZArray<ZXString<char> > *this, int nIndex)
{
  ZArray<ZXString<char> > *v2; // edi@1
  int v3; // esi@4
  ZXString<char> *v4; // eax@6
  int v5; // edi@6
  int v6; // ebx@6
  unsigned int v7; // esi@6
  unsigned int v8; // edi@6
  ZXString<char> *v9; // ST08_4@8
  ZArray<ZXString<char> > *v11; // [sp+Ch] [bp-8h]@1
  char *c; // [sp+10h] [bp-4h]@2

  v2 = this;
  v11 = this;
  if ( this->a )
    c = this->a[-1]._m_pStr;
  else
    c = 0;
  v3 = nIndex;
  if ( nIndex == -1 )
    v3 = (int)c;
  ZArray<ZXString<char>>::_Realloc(this, (unsigned int)(c + 1), 2, (ZAllocHelper *)&nIndex + 3);
  v4 = v2->a;
  v5 = 4 * v3 + 4;
  v6 = v3;
  memmove((char *)v4 + v5, &v4[v3], 4 * (_DWORD)&c[0x3FFFFFFF * v3]);
  v7 = (unsigned int)v11->a + v5;
  v8 = (unsigned int)&v11->a[v6];
  while ( v8 < v7 )
  {
    v9 = (ZXString<char> *)v8;
    v8 += 4;
    construct(v9);
  }
  return &v11->a[v6];
}

//----- (00415C1E) --------------------------------------------------------
unsigned int *__thiscall ZArray<unsigned long>::_Alloc(ZArray<unsigned long> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<unsigned long> *v3; // esi@1
  unsigned int *result; // eax@2
  int v5; // eax@3

  v3 = this;
  ZArray<unsigned long>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 4 * u + 4) + 4;
    v3->a = (unsigned int *)v5;
    *(_DWORD *)(v5 - 4) = u;
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00415C5A) --------------------------------------------------------
void __thiscall ZArray<unsigned long>::RemoveAll(ZArray<unsigned long> *this)
{
  ZArray<unsigned long> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, this->a - 1);
    v1->a = 0;
  }
}

//----- (00415C7C) --------------------------------------------------------
GUILDMEMBER *__thiscall ZArray<GUILDMEMBER>::_Alloc(ZArray<GUILDMEMBER> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<GUILDMEMBER> *v3; // esi@1
  GUILDMEMBER *result; // eax@2
  int v5; // eax@3

  v3 = this;
  ZArray<GUILDMEMBER>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 33 * u + 4) + 4;
    v3->a = (GUILDMEMBER *)v5;
    *(_DWORD *)(v5 - 4) = u;
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00415CB9) --------------------------------------------------------
void __thiscall ZArray<GUILDMEMBER>::RemoveAll(ZArray<GUILDMEMBER> *this)
{
  ZArray<GUILDMEMBER> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &this->a[-1].nContribution);
    v1->a = 0;
  }
}

//----- (00415CDB) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__thiscall ZArray<ZRef<GW_ItemSlotBase>>::InsertBefore(ZArray<ZRef<GW_ItemSlotBase> > *this, int nIndex)
{
  ZArray<ZRef<GW_ItemSlotBase> > *v2; // edi@1
  int v3; // esi@4
  ZRef<GW_ItemSlotBase> *v4; // eax@6
  int v5; // edi@6
  int v6; // ebx@6
  unsigned int v7; // esi@6
  unsigned int v8; // edi@6
  ZRef<GW_ItemSlotBase> *v9; // ST08_4@8
  ZArray<ZRef<GW_ItemSlotBase> > *v11; // [sp+Ch] [bp-8h]@1
  GW_ItemSlotBase *c; // [sp+10h] [bp-4h]@2

  v2 = this;
  v11 = this;
  if ( this->a )
    c = this->a[-1].p;
  else
    c = 0;
  v3 = nIndex;
  if ( nIndex == -1 )
    v3 = (int)c;
  ZArray<ZRef<GW_ItemSlotBase>>::_Realloc(this, (unsigned int)&c->vfptr + 1, 2, (ZAllocHelper *)&nIndex + 3);
  v4 = v2->a;
  v5 = 8 * v3 + 8;
  v6 = v3;
  memmove((char *)v4 + v5, &v4[v3], 8 * ((_DWORD)c + 0x1FFFFFFF * v3));
  v7 = (unsigned int)v11->a + v5;
  v8 = (unsigned int)&v11->a[v6];
  while ( v8 < v7 )
  {
    v9 = (ZRef<GW_ItemSlotBase> *)v8;
    v8 += 8;
    construct(v9);
  }
  return &v11->a[v6];
}

//----- (00415D6B) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__thiscall ZArray<ZRef<GW_ItemSlotBase>>::_Realloc(ZArray<ZRef<GW_ItemSlotBase> > *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<ZRef<GW_ItemSlotBase> > *v4; // ebx@1
  ZRef<GW_ItemSlotBase> *v5; // eax@1
  unsigned int v6; // edi@2
  unsigned int v7; // esi@4
  int v8; // ecx@5
  ZRef<GW_ItemSlotBase> *v9; // edi@5
  unsigned int v10; // esi@10
  ZRef<GW_ItemSlotBase> *v11; // ST08_4@11
  char *v12; // esi@13
  unsigned int v13; // ebx@14
  ZRef<GW_ItemSlotBase> *v14; // ST08_4@15
  ZArray<ZRef<GW_ItemSlotBase> > *v16; // [sp+Ch] [bp-4h]@1
  unsigned int ua; // [sp+18h] [bp+8h]@5
  unsigned int nModea; // [sp+1Ch] [bp+Ch]@10

  v4 = this;
  v5 = this->a;
  v16 = this;
  if ( this->a )
    v6 = (unsigned int)v5[-1].p;
  else
    v6 = 0;
  v7 = u;
  if ( u > v6 )
  {
    if ( u > (unsigned int)ZArray<ZRef<GW_ItemSlotBase>>::GetCapacity(this) )
    {
      v12 = (char *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 8 * u + 4) + 4);
      if ( !(nMode & 2) )
      {
        v13 = (unsigned int)&v12[8 * v6];
        while ( v13 < (unsigned int)&v12[8 * u] )
        {
          v14 = (ZRef<GW_ItemSlotBase> *)v13;
          v13 += 8;
          construct(v14);
        }
        v4 = v16;
      }
      if ( v4->a )
      {
        if ( !(nMode & 1) )
          memcpy(v12, v4->a, 8 * v6);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v4->a[-1].p);
      }
      v4->a = (ZRef<GW_ItemSlotBase> *)v12;
    }
    else
    {
      if ( nMode & 2 )
        goto LABEL_24;
      v10 = (unsigned int)&v4->a[v6];
      nModea = (unsigned int)&v4->a[u];
      while ( v10 < nModea )
      {
        v11 = (ZRef<GW_ItemSlotBase> *)v10;
        v10 += 8;
        construct(v11);
      }
    }
    v7 = u;
  }
  else
  {
    v8 = (int)&v5[v6];
    v9 = &v5[u];
    for ( ua = v8; (unsigned int)v9 < ua; ++v9 )
      ZRef<GW_ItemSlotBase>::_Release(v9);
  }
LABEL_24:
  if ( v4->a )
    v4->a[-1].p = (GW_ItemSlotBase *)v7;
  return v4->a;
}

//----- (00415E65) --------------------------------------------------------
void __thiscall ZRef<GW_ItemSlotBase>::_Release(ZRef<GW_ItemSlotBase> *this)
{
  ZRef<GW_ItemSlotBase> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<GW_ItemSlotBase>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (00415E7B) --------------------------------------------------------
int *__thiscall ZMap<long,long,long>::GetAt(ZMap<long,long,long> *this, const int *key, int *value)
{
  ZMap<long,long,long>::_PAIR *v3; // edx@2
  int *result; // eax@5

  if ( this->_m_apTable && (v3 = this->_m_apTable[_lrotr(*key, 5) % this->_m_uTableSize]) != 0 )
  {
    while ( v3->key != *key )
    {
      v3 = v3->pNext;
      if ( !v3 )
        goto LABEL_5;
    }
    if ( value )
      *value = v3->value;
    result = &v3->value;
  }
  else
  {
LABEL_5:
    result = 0;
  }
  return result;
}

//----- (00415ECB) --------------------------------------------------------
__POSITION *__thiscall ZMap<long,long,long>::Insert(ZMap<long,long,long> *this, const int *key, const int *value)
{
  ZMap<long,long,long> *v3; // esi@1
  unsigned int v4; // eax@2
  __POSITION **v5; // edi@7
  __POSITION *result; // eax@7
  __POSITION *v7; // ecx@11

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<long,long,long>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = (__POSITION **)&v3->_m_apTable[_lrotr(*key, 5) % v3->_m_uTableSize];
  result = *v5;
  if ( *v5 )
  {
    while ( *(_DWORD *)&result[8] != *key )
    {
      result = *(__POSITION **)&result[4];
      if ( !result )
        goto LABEL_10;
    }
    if ( value )
      *(_DWORD *)&result[12] = *value;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    result = (__POSITION *)ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::s_pInstance);
    if ( result )
    {
      v7 = *v5;
      *(_DWORD *)result = &ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable';
      *(_DWORD *)&result[4] = v7;
      *(_DWORD *)&result[8] = *key;
      *(_DWORD *)result = &ZMap<long,long,long>::_PAIR::`vftable';
    }
    else
    {
      result = 0;
    }
    if ( value )
      *(_DWORD *)&result[12] = *value;
    *v5 = result;
  }
  return result;
}
// 443784: using guessed type int (__thiscall *ZMap<long,long,long>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 44378C: using guessed type int (__thiscall *ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00415F77) --------------------------------------------------------
ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *__thiscall ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 44378C: using guessed type int (__thiscall *ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00415F99) --------------------------------------------------------
__POSITION *__thiscall ZMap<long,long,long>::GetNext(ZMap<long,long,long> *this, __POSITION **pos, int *value)
{
  __POSITION *v3; // ebx@1
  ZMap<long,long,long> *v4; // edi@1
  __POSITION *v5; // ecx@1
  unsigned int v6; // esi@3
  unsigned __int32 v7; // edx@3
  ZMap<long,long,long>::_PAIR **v8; // eax@3
  __POSITION **v9; // ecx@3
  unsigned int v10; // eax@3

  v3 = *pos;
  v4 = this;
  v5 = *(__POSITION **)&(*pos)[4];
  if ( v5 )
  {
    *pos = v5;
  }
  else
  {
    *pos = 0;
    v6 = v4->_m_uTableSize;
    v7 = _lrotr(*(_DWORD *)&v3[8], 5) % v6;
    v8 = v4->_m_apTable;
    v9 = (__POSITION **)&v8[v7 + 1];
    v10 = (unsigned int)&v8[v6];
    while ( (unsigned int)v9 < v10 )
    {
      if ( *v9 )
      {
        *pos = *v9;
        break;
      }
      ++v9;
    }
  }
  if ( value )
    *value = *(_DWORD *)&v3[12];
  return v3 + 8;
}

//----- (00415FFC) --------------------------------------------------------
__POSITION *__thiscall ZMap<long,unsigned short,long>::Insert(ZMap<long,unsigned short,long> *this, const int *key, const unsigned __int16 *value)
{
  ZMap<long,unsigned short,long> *v3; // esi@1
  unsigned int v4; // eax@2
  __POSITION **v5; // edi@7
  __POSITION *result; // eax@7
  __POSITION *v7; // ecx@11

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<long,unsigned short,long>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = (__POSITION **)&v3->_m_apTable[_lrotr(*key, 5) % v3->_m_uTableSize];
  result = *v5;
  if ( *v5 )
  {
    while ( *(_DWORD *)&result[8] != *key )
    {
      result = *(__POSITION **)&result[4];
      if ( !result )
        goto LABEL_10;
    }
    if ( value )
      *(_WORD *)&result[12] = *value;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    result = (__POSITION *)ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::s_pInstance);
    if ( result )
    {
      v7 = *v5;
      *(_DWORD *)result = &ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable';
      *(_DWORD *)&result[4] = v7;
      *(_DWORD *)&result[8] = *key;
      *(_DWORD *)result = &ZMap<long,unsigned short,long>::_PAIR::`vftable';
    }
    else
    {
      result = 0;
    }
    if ( value )
      *(_WORD *)&result[12] = *value;
    *v5 = result;
  }
  return result;
}
// 443794: using guessed type int (__thiscall *ZMap<long,unsigned short,long>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 44379C: using guessed type int (__thiscall *ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004160AC) --------------------------------------------------------
ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *__thiscall ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 44379C: using guessed type int (__thiscall *ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004160CE) --------------------------------------------------------
void __thiscall ZMap<long,unsigned short,long>::RemoveAll(ZMap<long,unsigned short,long> *this)
{
  ZMap<long,unsigned short,long> *v1; // edi@1
  ZMap<long,unsigned short,long>::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<long,unsigned short,long>::_PAIR *v4; // ecx@3
  ZMap<long,unsigned short,long>::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (0041611F) --------------------------------------------------------
__POSITION *__thiscall ZMap<long,unsigned short,long>::GetNext(ZMap<long,unsigned short,long> *this, __POSITION **pos, unsigned __int16 *value)
{
  __POSITION *v3; // ebx@1
  ZMap<long,unsigned short,long> *v4; // edi@1
  __POSITION *v5; // ecx@1
  unsigned int v6; // esi@3
  unsigned __int32 v7; // edx@3
  ZMap<long,unsigned short,long>::_PAIR **v8; // eax@3
  __POSITION **v9; // ecx@3
  unsigned int v10; // eax@3

  v3 = *pos;
  v4 = this;
  v5 = *(__POSITION **)&(*pos)[4];
  if ( v5 )
  {
    *pos = v5;
  }
  else
  {
    *pos = 0;
    v6 = v4->_m_uTableSize;
    v7 = _lrotr(*(_DWORD *)&v3[8], 5) % v6;
    v8 = v4->_m_apTable;
    v9 = (__POSITION **)&v8[v7 + 1];
    v10 = (unsigned int)&v8[v6];
    while ( (unsigned int)v9 < v10 )
    {
      if ( *v9 )
      {
        *pos = *v9;
        break;
      }
      ++v9;
    }
  }
  if ( value )
    *value = *(_WORD *)&v3[12];
  return v3 + 8;
}

//----- (00416184) --------------------------------------------------------
__POSITION *__thiscall ZMap<unsigned short,_FILETIME,unsigned short>::Insert(ZMap<unsigned short,_FILETIME,unsigned short> *this, const unsigned __int16 *key, _FILETIME *value)
{
  ZMap<unsigned short,_FILETIME,unsigned short> *v3; // esi@1
  unsigned int v4; // eax@2
  __POSITION **v5; // edi@7
  __POSITION *result; // eax@7
  __POSITION *v7; // ecx@11

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<unsigned short,_FILETIME,unsigned short>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = (__POSITION **)&v3->_m_apTable[_lrotr(*key, 5) % v3->_m_uTableSize];
  result = *v5;
  if ( *v5 )
  {
    while ( *(_WORD *)&result[8] != *key )
    {
      result = *(__POSITION **)&result[4];
      if ( !result )
        goto LABEL_10;
    }
    if ( value )
      *(_FILETIME *)&result[12] = *value;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    result = (__POSITION *)ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::s_pInstance);
    if ( result )
    {
      v7 = *v5;
      *(_DWORD *)result = &ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable';
      *(_DWORD *)&result[4] = v7;
      *(_WORD *)&result[8] = *key;
      *(_DWORD *)result = &ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::`vftable';
    }
    else
    {
      result = 0;
    }
    if ( value )
      *(_FILETIME *)&result[12] = *value;
    *v5 = result;
  }
  return result;
}
// 4437A4: using guessed type int (__thiscall *ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 4437AC: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416241) --------------------------------------------------------
ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`scalar deleting destructor'(ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 4437AC: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416263) --------------------------------------------------------
void __thiscall ZMap<unsigned short,_FILETIME,unsigned short>::RemoveAll(ZMap<unsigned short,_FILETIME,unsigned short> *this)
{
  ZMap<unsigned short,_FILETIME,unsigned short> *v1; // edi@1
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *v4; // ecx@3
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (004162B4) --------------------------------------------------------
__POSITION *__thiscall ZMap<unsigned short,_FILETIME,unsigned short>::GetNext(ZMap<unsigned short,_FILETIME,unsigned short> *this, __POSITION **pos, _FILETIME *value)
{
  __POSITION *v3; // ebx@1
  ZMap<unsigned short,_FILETIME,unsigned short> *v4; // edi@1
  __POSITION *v5; // ecx@1
  unsigned int v6; // esi@3
  unsigned __int32 v7; // edx@3
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR **v8; // eax@3
  __POSITION **v9; // ecx@3
  unsigned int v10; // eax@3

  v3 = *pos;
  v4 = this;
  v5 = *(__POSITION **)&(*pos)[4];
  if ( v5 )
  {
    *pos = v5;
  }
  else
  {
    *pos = 0;
    v6 = v4->_m_uTableSize;
    v7 = _lrotr(*(_WORD *)&v3[8], 5) % v6;
    v8 = v4->_m_apTable;
    v9 = (__POSITION **)&v8[v7 + 1];
    v10 = (unsigned int)&v8[v6];
    while ( (unsigned int)v9 < v10 )
    {
      if ( *v9 )
      {
        *pos = *v9;
        break;
      }
      ++v9;
    }
  }
  if ( value )
  {
    value->dwLowDateTime = *(_DWORD *)&v3[12];
    value->dwHighDateTime = *(_DWORD *)&v3[16];
  }
  return v3 + 8;
}

//----- (0041631E) --------------------------------------------------------
ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *__thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::Insert(ZMap<long,ZRef<GW_MiniGameRecord>,long> *this, const int *key, ZRef<GW_MiniGameRecord> *value)
{
  ZMap<long,ZRef<GW_MiniGameRecord>,long> *v3; // esi@1
  unsigned int v4; // eax@2
  unsigned __int32 v5; // edx@7
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **v6; // eax@7
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *v7; // edi@7
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **v8; // ebx@7
  _DWORD **v9; // eax@10
  _DWORD **v10; // esi@11
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *result; // eax@14

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<long,ZRef<GW_MiniGameRecord>,long>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = _lrotr(*key, 5) % v3->_m_uTableSize;
  v6 = v3->_m_apTable;
  v7 = v6[v5];
  v8 = &v6[v5];
  if ( v7 )
  {
    while ( v7->key != *key )
    {
      v7 = v7->pNext;
      if ( !v7 )
        goto LABEL_10;
    }
    if ( value )
      ZRef<GW_MiniGameRecord>::operator=(&v7->value, value);
    result = v7;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    v9 = ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::s_pInstance);
    if ( v9 )
    {
      v9[1] = *v8;
      *v9 = &ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable';
      v9[2] = (_DWORD *)*key;
      v9[4] = 0;
      *v9 = &ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::`vftable';
      v10 = v9;
    }
    else
    {
      v10 = 0;
    }
    if ( value )
      ZRef<GW_MiniGameRecord>::operator=((ZRef<GW_MiniGameRecord> *)(v10 + 3), value);
    *v8 = (ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *)v10;
    result = (ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *)v10;
  }
  return result;
}
// 4437B4: using guessed type int (__thiscall *ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 4437BC: using guessed type int (__thiscall *ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (004163E6) --------------------------------------------------------
ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *__thiscall ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 4437BC: using guessed type int (__thiscall *ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416408) --------------------------------------------------------
__POSITION *__thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::GetNext(ZMap<long,ZRef<GW_MiniGameRecord>,long> *this, __POSITION **pos, ZRef<GW_MiniGameRecord> *value)
{
  __POSITION *v3; // ebx@1
  ZMap<long,ZRef<GW_MiniGameRecord>,long> *v4; // edi@1
  __POSITION *v5; // ecx@1
  unsigned int v6; // esi@3
  unsigned __int32 v7; // edx@3
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **v8; // eax@3
  __POSITION **v9; // ecx@3
  unsigned int v10; // eax@3

  v3 = *pos;
  v4 = this;
  v5 = *(__POSITION **)&(*pos)[4];
  if ( v5 )
  {
    *pos = v5;
  }
  else
  {
    *pos = 0;
    v6 = v4->_m_uTableSize;
    v7 = _lrotr(*(_DWORD *)&v3[8], 5) % v6;
    v8 = v4->_m_apTable;
    v9 = (__POSITION **)&v8[v7 + 1];
    v10 = (unsigned int)&v8[v6];
    while ( (unsigned int)v9 < v10 )
    {
      if ( *v9 )
      {
        *pos = *v9;
        break;
      }
      ++v9;
    }
  }
  if ( value )
    ZRef<GW_MiniGameRecord>::operator=(value, (ZRef<GW_MiniGameRecord> *)&v3[12]);
  return v3 + 8;
}

//----- (0041646F) --------------------------------------------------------
GW_CoupleRecord *__thiscall ZList<GW_CoupleRecord>::AddTail(ZList<GW_CoupleRecord> *this)
{
  ZList<GW_CoupleRecord> *v1; // esi@1
  GW_CoupleRecord *result; // eax@1
  GW_CoupleRecord *v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<GW_CoupleRecord>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)&result[-1].liSN : 0;
    *(_DWORD *)(v3 != 0 ? (__int64 *)((char *)&v3[-1].liSN.QuadPart + 4) : 4) = v4;
    result = (GW_CoupleRecord *)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (004164AD) --------------------------------------------------------
GW_FriendRecord *__thiscall ZList<GW_FriendRecord>::AddTail(ZList<GW_FriendRecord> *this)
{
  ZList<GW_FriendRecord> *v1; // esi@1
  GW_FriendRecord *result; // eax@1
  GW_FriendRecord *v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<GW_FriendRecord>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)&result[-1].liSN.HighPart : 0;
    (v3 != 0 ? &v3[-1].liPairSN : 4)->LowPart = v4;
    result = (GW_FriendRecord *)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (004164EB) --------------------------------------------------------
GW_MarriageRecord *__thiscall ZList<GW_MarriageRecord>::AddTail(ZList<GW_MarriageRecord> *this)
{
  ZList<GW_MarriageRecord> *v1; // esi@1
  GW_MarriageRecord *result; // eax@1
  GW_MarriageRecord *v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<GW_MarriageRecord>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)&result[-1].sGroomName[10] : 0;
    *(_DWORD *)(v3 != 0 ? &v3[-1].sBrideName[1] : 4) = v4;
    result = (GW_MarriageRecord *)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (00416529) --------------------------------------------------------
ZXString<char> *__thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::GetAt(ZMap<unsigned short,ZXString<char>,unsigned short> *this, const unsigned __int16 *key, ZXString<char> *value)
{
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v3; // esi@2
  ZXString<char> *result; // eax@5

  if ( this->_m_apTable && (v3 = this->_m_apTable[_lrotr(*key, 5) % this->_m_uTableSize]) != 0 )
  {
    while ( v3->key != *key )
    {
      v3 = v3->pNext;
      if ( !v3 )
        goto LABEL_5;
    }
    if ( value )
      ZXString<char>::operator=(value, &v3->value);
    result = &v3->value;
  }
  else
  {
LABEL_5:
    result = 0;
  }
  return result;
}

//----- (00416580) --------------------------------------------------------
__POSITION *__thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::Insert(ZMap<unsigned short,ZXString<char>,unsigned short> *this, const unsigned __int16 *key, ZXString<char> *value)
{
  ZMap<unsigned short,ZXString<char>,unsigned short> *v3; // esi@1
  unsigned int v4; // eax@2
  unsigned __int32 v5; // edx@7
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **v6; // eax@7
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v7; // edi@7
  void **v8; // ebx@7
  void **v9; // eax@10
  void **v10; // esi@11
  __POSITION *result; // eax@14

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<unsigned short,ZXString<char>,unsigned short>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = _lrotr(*key, 5) % v3->_m_uTableSize;
  v6 = v3->_m_apTable;
  v7 = v6[v5];
  v8 = (void **)&v6[v5];
  if ( v7 )
  {
    while ( v7->key != *key )
    {
      v7 = v7->pNext;
      if ( !v7 )
        goto LABEL_10;
    }
    if ( value )
      ZXString<char>::operator=(&v7->value, value);
    result = (__POSITION *)v7;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    v9 = ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::s_pInstance);
    if ( v9 )
    {
      v9[1] = *v8;
      *v9 = &ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable';
      *((_WORD *)v9 + 4) = *key;
      v9[3] = 0;
      *v9 = &ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::`vftable';
      v10 = v9;
    }
    else
    {
      v10 = 0;
    }
    if ( value )
      ZXString<char>::operator=((ZXString<char> *)v10 + 3, value);
    *v8 = v10;
    result = (__POSITION *)v10;
  }
  return result;
}
// 4437C4: using guessed type int (__thiscall *ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 4437CC: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041664D) --------------------------------------------------------
ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 4437CC: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041666F) --------------------------------------------------------
int __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::RemoveKey(ZMap<unsigned short,ZXString<char>,unsigned short> *this, const unsigned __int16 *key)
{
  ZMap<unsigned short,ZXString<char>,unsigned short> *v2; // esi@1
  unsigned __int32 v3; // edx@2
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **v4; // eax@2
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v5; // ecx@2
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **v6; // eax@2
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *i; // eax@5

  v2 = this;
  if ( !this->_m_apTable )
    return 0;
  v3 = _lrotr(*key, 5) % this->_m_uTableSize;
  v4 = v2->_m_apTable;
  v5 = v4[v3];
  v6 = &v4[v3];
  if ( !v5 )
    return 0;
  if ( v5->key != *key )
  {
    for ( i = v5->pNext; i; i = i->pNext )
    {
      if ( i->key == *key )
      {
        v5->pNext = i->pNext;
        v5 = i;
        goto found_2;
      }
      v5 = i;
    }
    return 0;
  }
  *v6 = v5->pNext;
found_2:
  if ( v5 )
    ((void (__stdcall *)(signed int))v5->vfptr->__vecDelDtor)(1);
  --v2->_m_uCount;
  return 1;
}

//----- (004166E1) --------------------------------------------------------
void __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::RemoveAll(ZMap<unsigned short,ZXString<char>,unsigned short> *this)
{
  ZMap<unsigned short,ZXString<char>,unsigned short> *v1; // edi@1
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v4; // ecx@3
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (00416732) --------------------------------------------------------
__POSITION *__thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::GetNext(ZMap<unsigned short,ZXString<char>,unsigned short> *this, __POSITION **pos, ZXString<char> *value)
{
  __POSITION *v3; // ebx@1
  ZMap<unsigned short,ZXString<char>,unsigned short> *v4; // edi@1
  __POSITION *v5; // ecx@1
  unsigned int v6; // esi@3
  unsigned __int32 v7; // edx@3
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **v8; // eax@3
  __POSITION **v9; // ecx@3
  unsigned int v10; // eax@3

  v3 = *pos;
  v4 = this;
  v5 = *(__POSITION **)&(*pos)[4];
  if ( v5 )
  {
    *pos = v5;
  }
  else
  {
    *pos = 0;
    v6 = v4->_m_uTableSize;
    v7 = _lrotr(*(_WORD *)&v3[8], 5) % v6;
    v8 = v4->_m_apTable;
    v9 = (__POSITION **)&v8[v7 + 1];
    v10 = (unsigned int)&v8[v6];
    while ( (unsigned int)v9 < v10 )
    {
      if ( *v9 )
      {
        *pos = *v9;
        break;
      }
      ++v9;
    }
  }
  if ( value )
    ZXString<char>::operator=(value, (ZXString<char> *)&v3[12]);
  return v3 + 8;
}

//----- (0041679A) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__thiscall ZArray<ZRef<GW_ItemSlotBase>>::operator[](ZArray<ZRef<GW_ItemSlotBase> > *this, int i)
{
  return &this->a[i];
}

//----- (004167A6) --------------------------------------------------------
ZXString<char> *__thiscall ZArray<ZXString<char>>::operator[](ZArray<ZXString<char> > *this, int i)
{
  return &this->a[i];
}

//----- (004167B2) --------------------------------------------------------
void __thiscall ZArray<CashItemEntry>::RemoveAll(ZArray<CashItemEntry> *this)
{
  ZArray<CashItemEntry> *v1; // ebx@1
  CashItemEntry *v2; // edi@2
  CashItemEntry *i; // esi@2

  v1 = this;
  if ( this->a )
  {
    v2 = &this->a[this->a[-1].nPOS];
    for ( i = this->a; i < v2; ++i )
      CashItemEntry::~CashItemEntry(i);
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v1->a[-1].nPOS);
    v1->a = 0;
  }
}

//----- (004167EF) --------------------------------------------------------
CashItemEntry *__thiscall ZArray<CashItemEntry>::InsertBefore(ZArray<CashItemEntry> *this, int nIndex)
{
  int v2; // ebx@2
  int v3; // edi@4
  int v4; // esi@6
  size_t v5; // ST08_4@6
  int v6; // edi@6
  unsigned int v7; // ebx@6
  unsigned int v8; // edi@6
  CashItemEntry *v9; // ST08_4@8
  ZArray<CashItemEntry> *v11; // [sp+Ch] [bp-4h]@1

  v11 = this;
  if ( this->a )
    v2 = this->a[-1].nPOS;
  else
    v2 = 0;
  v3 = nIndex;
  if ( nIndex == -1 )
    v3 = v2;
  ZArray<CashItemEntry>::_Realloc(this, v2 + 1, 2, (ZAllocHelper *)&nIndex + 3);
  v4 = v3;
  v5 = 12 * v2 - 12 * v3;
  v6 = 4 * (3 * v3 + 3);
  memmove((char *)v11->a + v6, &v11->a[v4], v5);
  v7 = (unsigned int)v11->a + v6;
  v8 = (unsigned int)&v11->a[v4];
  while ( v8 < v7 )
  {
    v9 = (CashItemEntry *)v8;
    v8 += 12;
    construct(v9);
  }
  return &v11->a[v4];
}

//----- (00416874) --------------------------------------------------------
void __thiscall ZArray<CashItemEntry>::RemoveAt(ZArray<CashItemEntry> *this, __POSITION *pos)
{
  __POSITION *v2; // edi@1
  __POSITION *v3; // ebx@1
  ZArray<CashItemEntry> *i; // esi@1

  v2 = pos;
  v3 = pos + 12;
  for ( i = this; pos < v3; pos += 12 )
    CashItemEntry::~CashItemEntry((CashItemEntry *)pos);
  memmove(v2, v3, 12 * (((signed int)&i->a[-1] + 12 * i->a[-1].nPOS - (signed int)v2) / 12));
  --i->a[-1].nPOS;
}

//----- (004168CE) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (004168F4) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0041691A) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (00416940) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (00416966) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0041698C) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<GW_MiniGameRecord> *v0; // ecx@1

  v0 = (ZRefCountedDummy<GW_MiniGameRecord> *)ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<GW_MiniGameRecord>::ZRefCountedDummy<GW_MiniGameRecord>(v0);
}

//----- (004169C1) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::s_pInstance,
    p);
}

//----- (004169D1) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (004169F7) --------------------------------------------------------
void _E26_1()
{
  _E18_1();
  _E19_1();
  _E20_0();
  _E21();
  _E22();
  _E23_0();
  _E24_1();
  _E25_1();
}

//----- (00416A1F) --------------------------------------------------------
void _E18_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00416A5A) --------------------------------------------------------
void _E19_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00416A95) --------------------------------------------------------
void _E20_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::s_pInstance = v3;
}

//----- (00416AD0) --------------------------------------------------------
void _E21()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::s_pInstance = v3;
}

//----- (00416B0B) --------------------------------------------------------
void _E22()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::s_pInstance = v3;
}

//----- (00416B46) --------------------------------------------------------
void _E23_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::s_pInstance = v3;
}

//----- (00416B81) --------------------------------------------------------
void _E24_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::s_pInstance = v3;
}

//----- (00416BBC) --------------------------------------------------------
void _E25_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::s_pInstance = v3;
}

//----- (00416BF7) --------------------------------------------------------
void __thiscall ZRefCountedDummy<GW_MiniGameRecord>::ZRefCountedDummy<GW_MiniGameRecord>(ZRefCountedDummy<GW_MiniGameRecord> *this)
{
  ZRefCountedDummy<GW_MiniGameRecord> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>Vtbl *)&ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<GW_MiniGameRecord>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>Vtbl *)&ZRefCountedDummy<GW_MiniGameRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4437D4: using guessed type void *ZRefCountedDummy<GW_MiniGameRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>'};
// 4437DC: using guessed type int (__thiscall *ZRefCountedDummy<GW_MiniGameRecord>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 4437E4: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00416C25) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *__thiscall ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>Vtbl *)&ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::s_pInstance,
      this);
  return v2;
}
// 4437E4: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00416C47) --------------------------------------------------------
ZRefCountedDummy<GW_MiniGameRecord> *__thiscall ZRefCountedDummy<GW_MiniGameRecord>::`scalar deleting destructor'(ZRefCountedDummy<GW_MiniGameRecord> *this, unsigned int __flags)
{
  ZRefCountedDummy<GW_MiniGameRecord> *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<GW_MiniGameRecord>::~ZRefCountedDummy<GW_MiniGameRecord>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::s_pInstance,
      v2);
  return v2;
}

//----- (00416C68) --------------------------------------------------------
void __thiscall ZRefCountedDummy<GW_MiniGameRecord>::~ZRefCountedDummy<GW_MiniGameRecord>(ZRefCountedDummy<GW_MiniGameRecord> *this)
{
  *(_DWORD *)(this != 0 ? (unsigned int)&this->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable';
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4437E4: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00416C80) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__thiscall ZArray<ZRef<GW_ItemSlotBase>>::GetCapacity(ZArray<ZRef<GW_ItemSlotBase> > *this)
{
  ZRef<GW_ItemSlotBase> *result; // eax@1
  int v2; // eax@2

  result = this->a;
  if ( this->a )
  {
    v2 = *(_DWORD *)&result[-1].gap0[0];
    if ( v2 < 0 )
      v2 = ~v2;
    result = (ZRef<GW_ItemSlotBase> *)((unsigned int)(v2 - 4) >> 3);
  }
  return result;
}

//----- (00416C97) --------------------------------------------------------
ZRef<GW_MiniGameRecord> *__thiscall ZRef<GW_MiniGameRecord>::operator=(ZRef<GW_MiniGameRecord> *this, ZRef<GW_MiniGameRecord> *r)
{
  ZRef<GW_MiniGameRecord> *v2; // esi@1

  v2 = this;
  ZRef<GW_MiniGameRecord>::_AddRef(r);
  if ( v2->p )
  {
    ZRef<GW_MiniGameRecord>::_ReleaseRaw(v2, 0);
    v2->p = 0;
  }
  v2->p = r->p;
  return v2;
}

//----- (00416CC6) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
  this->m_pNext = ZRecyclableStatic::_s_sStatic.m_pHead;
  ZRecyclableStatic::_s_sStatic.m_pHead = (ZRecyclableStatic::CallBack *)this;
  this->m_pStat = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->m_pAv = 0;
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);
// 4437EC: using guessed type int (__thiscall *ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00416CF9) --------------------------------------------------------
ZMap<long,long,long>::_PAIR *__thiscall ZMap<long,long,long>::_PAIR::`scalar deleting destructor'(ZMap<long,long,long>::_PAIR *this, unsigned int __flags)
{
  ZMap<long,long,long>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<long,long,long>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (00416D1A) --------------------------------------------------------
ZMap<long,unsigned short,long>::_PAIR *__thiscall ZMap<long,unsigned short,long>::_PAIR::`scalar deleting destructor'(ZMap<long,unsigned short,long>::_PAIR *this, unsigned int __flags)
{
  ZMap<long,unsigned short,long>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<long,unsigned short,long>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (00416D3B) --------------------------------------------------------
ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *__thiscall ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::`scalar deleting destructor'(ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *this, unsigned int __flags)
{
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (00416D5C) --------------------------------------------------------
ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *__thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::`scalar deleting destructor'(ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *this, unsigned int __flags)
{
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (00416D7D) --------------------------------------------------------
ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *__thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::`scalar deleting destructor'(ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *this, unsigned int __flags)
{
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (00416D9E) --------------------------------------------------------
ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::`vector deleting destructor'(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this, unsigned int __flags)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *v2; // esi@1

  v2 = this;
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00416DBE) --------------------------------------------------------
void __thiscall ZMap<long,long,long>::_PAIR::~_PAIR(ZMap<long,long,long>::_PAIR *this)
{
  this->vfptr = (ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable';
}
// 44378C: using guessed type int (__thiscall *ZRecyclable<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416DC5) --------------------------------------------------------
void __thiscall ZMap<long,unsigned short,long>::_PAIR::~_PAIR(ZMap<long,unsigned short,long>::_PAIR *this)
{
  this->vfptr = (ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable';
}
// 44379C: using guessed type int (__thiscall *ZRecyclable<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416DCC) --------------------------------------------------------
void __thiscall ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR::~_PAIR(ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *this)
{
  this->vfptr = (ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable';
}
// 4437AC: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416DD3) --------------------------------------------------------
void __thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR::~_PAIR(ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *this)
{
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *v1; // edi@1
  char *v2; // esi@1

  v1 = this;
  v2 = this->value.gap0;
  if ( this->value.p )
  {
    ZRef<GW_MiniGameRecord>::_ReleaseRaw(&this->value, 0);
    *((_DWORD *)v2 + 1) = 0;
  }
  v1->vfptr = (ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable';
}
// 4437BC: using guessed type int (__thiscall *ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416E13) --------------------------------------------------------
void __thiscall ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::~ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this)
{
  this->vfptr = (ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable';
}
// 4437BC: using guessed type int (__thiscall *ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416E1A) --------------------------------------------------------
void __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR::~_PAIR(ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *this)
{
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v1; // esi@1

  v1 = this;
  ZXString<char>::~ZXString<char>(&this->value);
  v1->vfptr = (ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable';
}
// 4437CC: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416E4A) --------------------------------------------------------
void __thiscall ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::~ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this)
{
  this->vfptr = (ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable';
}
// 4437CC: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (00416E51) --------------------------------------------------------
void __thiscall CashItemEntry::~CashItemEntry(CashItemEntry *this)
{
  CashItemEntry *v1; // esi@1

  v1 = this;
  if ( this->pItem.p )
  {
    ZRef<GW_ItemSlotBase>::_ReleaseRaw(&this->pItem, 0);
    v1->pItem.p = 0;
  }
}

//----- (00416E67) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::~ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *v1; // esi@1

  v1 = this;
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v1->vfptr = (ZRecyclableStatic::CallBackVtbl *)&ZRecyclableStatic::CallBack::`vftable';
}
// 443340: using guessed type int (__thiscall *ZRecyclableStatic::CallBack::`vftable')(void *p, unsigned int __flags);

//----- (00416E7C) --------------------------------------------------------
void __thiscall ZRef<GW_MiniGameRecord>::_AddRef(ZRef<GW_MiniGameRecord> *this)
{
  GW_MiniGameRecord *v1; // eax@1

  v1 = this->p;
  if ( v1 )
    InterlockedIncrement(this->p != 0 ? &v1[-1].nDraw : 4);
}

//----- (00416E99) --------------------------------------------------------
ZXString<char> *__thiscall ZArray<ZXString<char>>::_Realloc(ZArray<ZXString<char> > *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<ZXString<char> > *v4; // esi@1
  ZXString<char> *v5; // eax@1
  unsigned int v6; // edi@2
  unsigned int v7; // ebx@4
  unsigned int v8; // edi@8
  ZXString<char> *v9; // ST08_4@9
  char *v10; // esi@11
  ZXString<char> *v11; // eax@13
  ZArray<ZXString<char> > *v13; // [sp+Ch] [bp-4h]@1
  unsigned int ua; // [sp+18h] [bp+8h]@12
  unsigned int nModea; // [sp+1Ch] [bp+Ch]@8

  v4 = this;
  v5 = this->a;
  v13 = this;
  if ( this->a )
    v6 = (unsigned int)v5[-1]._m_pStr;
  else
    v6 = 0;
  v7 = u;
  if ( u > v6 )
  {
    if ( u > (unsigned int)ZArray<ZXString<char>>::GetCapacity(this) )
    {
      v10 = (char *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 4 * u + 4) + 4);
      if ( !(nMode & 2) )
      {
        ua = (unsigned int)&v10[4 * v6];
        if ( &v10[4 * v6] < &v10[4 * v7] )
        {
          do
          {
            v11 = (ZXString<char> *)ua;
            ua += 4;
            construct(v11);
          }
          while ( ua < (unsigned int)&v10[4 * v7] );
        }
      }
      if ( v13->a )
      {
        if ( !(nMode & 1) )
          memcpy(v10, v13->a, 4 * v6);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v13->a[-1]);
      }
      v13->a = (ZXString<char> *)v10;
      v4 = v13;
    }
    else if ( !(nMode & 2) )
    {
      v8 = (unsigned int)&v4->a[v6];
      nModea = (unsigned int)&v4->a[u];
      while ( v8 < nModea )
      {
        v9 = (ZXString<char> *)v8;
        v8 += 4;
        construct(v9);
      }
    }
  }
  else
  {
    ZArray<ZXString<char>>::_Destroy(&v5[u], &v5[v6]);
  }
  if ( v4->a )
    v4->a[-1]._m_pStr = (char *)v7;
  return v4->a;
}

//----- (00416F93) --------------------------------------------------------
void __cdecl ZArray<ZXString<char>>::_Destroy(ZXString<char> *b, ZXString<char> *e)
{
  ZXString<char> *i; // esi@1

  for ( i = b; i < e; ++i )
    ZXString<char>::~ZXString<char>(i);
}

//----- (00416FAC) --------------------------------------------------------
void __thiscall ZMap<long,long,long>::ResizeHashTable(ZMap<long,long,long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<long,long,long> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<long,long,long>::_PAIR **v5; // edi@3
  ZMap<long,long,long>::_PAIR **v6; // ebx@3
  ZMap<long,long,long>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<long,long,long>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<long,long,long>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<long,long,long>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<long,long,long>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<long,long,long>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                           &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                           4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<long,long,long>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (00417057) --------------------------------------------------------
void __thiscall ZMap<long,unsigned short,long>::ResizeHashTable(ZMap<long,unsigned short,long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<long,unsigned short,long> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<long,unsigned short,long>::_PAIR **v5; // edi@3
  ZMap<long,unsigned short,long>::_PAIR **v6; // ebx@3
  ZMap<long,unsigned short,long>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<long,unsigned short,long>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<long,unsigned short,long>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<long,unsigned short,long>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<long,unsigned short,long>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<long,unsigned short,long>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                     &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                     4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<long,unsigned short,long>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (00417102) --------------------------------------------------------
void __thiscall ZMap<unsigned short,_FILETIME,unsigned short>::ResizeHashTable(ZMap<unsigned short,_FILETIME,unsigned short> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<unsigned short,_FILETIME,unsigned short> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR **v5; // edi@3
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR **v6; // ebx@3
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<unsigned short,_FILETIME,unsigned short>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                                    &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                                    4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (004171AE) --------------------------------------------------------
void __thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::ResizeHashTable(ZMap<long,ZRef<GW_MiniGameRecord>,long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<long,ZRef<GW_MiniGameRecord>,long> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **v5; // edi@3
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **v6; // ebx@3
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<long,ZRef<GW_MiniGameRecord>,long>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                              &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                              4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (00417259) --------------------------------------------------------
GW_CoupleRecord *__thiscall ZList<GW_CoupleRecord>::_New(ZList<GW_CoupleRecord> *this, void *pPrev, void *pNext)
{
  ZList<GW_CoupleRecord> *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (GW_CoupleRecord *)(v4 != 0 ? v4 + 16 : 0);
}

//----- (00417298) --------------------------------------------------------
GW_FriendRecord *__thiscall ZList<GW_FriendRecord>::_New(ZList<GW_FriendRecord> *this, void *pPrev, void *pNext)
{
  ZList<GW_FriendRecord> *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (GW_FriendRecord *)(v4 != 0 ? v4 + 16 : 0);
}

//----- (004172D7) --------------------------------------------------------
GW_MarriageRecord *__thiscall ZList<GW_MarriageRecord>::_New(ZList<GW_MarriageRecord> *this, void *pPrev, void *pNext)
{
  ZList<GW_MarriageRecord> *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (GW_MarriageRecord *)(v4 != 0 ? v4 + 16 : 0);
}

//----- (00417316) --------------------------------------------------------
void __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::ResizeHashTable(ZMap<unsigned short,ZXString<char>,unsigned short> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<unsigned short,ZXString<char>,unsigned short> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **v5; // edi@3
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **v6; // ebx@3
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<unsigned short,ZXString<char>,unsigned short>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                                         &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                                         4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (004173C2) --------------------------------------------------------
CashItemEntry *__thiscall ZArray<CashItemEntry>::_Realloc(ZArray<CashItemEntry> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<CashItemEntry> *v4; // edi@1
  CashItemEntry *v5; // eax@1
  unsigned int v6; // esi@2
  unsigned int v7; // ebx@4
  int v8; // ecx@5
  CashItemEntry *v9; // esi@5
  CashItemEntry *v10; // eax@10
  unsigned int v11; // edi@10
  unsigned int v12; // esi@10
  CashItemEntry *v13; // ST08_4@12
  CashItemEntry *v14; // eax@13
  unsigned int v15; // edi@14
  CashItemEntry *v16; // eax@15
  CashItemEntry *an; // [sp+Ch] [bp-8h]@13
  ZArray<CashItemEntry> *v19; // [sp+10h] [bp-4h]@1
  unsigned int ua; // [sp+1Ch] [bp+8h]@14
  unsigned int nModea; // [sp+20h] [bp+Ch]@5

  v4 = this;
  v5 = this->a;
  v19 = this;
  if ( this->a )
    v6 = v5[-1].nPOS;
  else
    v6 = 0;
  v7 = u;
  if ( u > v6 )
  {
    if ( u > (unsigned int)ZArray<CashItemEntry>::GetCapacity(this) )
    {
      v14 = (CashItemEntry *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 12 * u + 4)
                            + 4);
      an = v14;
      if ( !(nMode & 2) )
      {
        v15 = (unsigned int)&v14[u];
        ua = (unsigned int)&v14[v6];
        if ( (unsigned int)&v14[v6] < v15 )
        {
          do
          {
            v16 = (CashItemEntry *)ua;
            ua += 12;
            construct(v16);
          }
          while ( ua < v15 );
          v14 = an;
        }
      }
      if ( v19->a )
      {
        if ( !(nMode & 1) )
          memcpy(v14, v19->a, 12 * v6);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v19->a[-1].nPOS);
        v14 = an;
      }
      v19->a = v14;
    }
    else
    {
      if ( nMode & 2 )
        goto LABEL_23;
      v10 = v4->a;
      v11 = (unsigned int)&v4->a[u];
      v12 = (unsigned int)&v10[v6];
      while ( v12 < v11 )
      {
        v13 = (CashItemEntry *)v12;
        v12 += 12;
        construct(v13);
      }
    }
    v4 = v19;
  }
  else
  {
    v8 = (int)&v5[v6];
    v9 = &v5[u];
    for ( nModea = v8; (unsigned int)v9 < nModea; ++v9 )
      CashItemEntry::~CashItemEntry(v9);
  }
LABEL_23:
  if ( v4->a )
    v4->a[-1].nPOS = v7;
  return v4->a;
}

//----- (004174D6) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (0041752B) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (00417580) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x14u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (004175D4) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x14u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (00417628) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (0041767D) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MiniGameRecord>,16,GW_MiniGameRecord> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x24u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (004176D1) --------------------------------------------------------
ZXString<char> *__cdecl construct(ZXString<char> *p)
{
  ZXString<char> *result; // eax@1

  result = p;
  if ( p )
    p->_m_pStr = 0;
  else
    result = 0;
  return result;
}

//----- (004176E0) --------------------------------------------------------
ZRef<GW_ItemSlotBase> *__cdecl construct(ZRef<GW_ItemSlotBase> *p)
{
  ZRef<GW_ItemSlotBase> *result; // eax@1

  result = p;
  if ( p )
    p->p = 0;
  else
    result = 0;
  return result;
}

//----- (004176F0) --------------------------------------------------------
CashItemEntry *__cdecl construct(CashItemEntry *p)
{
  CashItemEntry *result; // eax@1

  result = p;
  if ( p )
    p->pItem.p = 0;
  else
    result = 0;
  return result;
}

//----- (00417700) --------------------------------------------------------
void _E49_2()
{
  _E39_2();
  _E40_1();
  _E41_1();
  _E42_1();
  _E43();
  _E44_0();
  _E45_0();
  _E46_0();
  _E47_0();
  _E48_0();
}

//----- (00417732) --------------------------------------------------------
void _E39_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0041776D) --------------------------------------------------------
void _E40_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004177A8) --------------------------------------------------------
void _E41_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (004177E3) --------------------------------------------------------
void _E42_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0041781E) --------------------------------------------------------
void _E43()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00417859) --------------------------------------------------------
void _E44_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00417894) --------------------------------------------------------
void _E45_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance = v3;
}

//----- (004178CF) --------------------------------------------------------
void _E46_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance = v3;
}

//----- (0041790A) --------------------------------------------------------
void _E47_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance = v3;
}

//----- (00417945) --------------------------------------------------------
void _E48_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00417980) --------------------------------------------------------
ZXString<char> *__thiscall ZArray<ZXString<char>>::GetCapacity(ZArray<ZXString<char> > *this)
{
  ZXString<char> *result; // eax@1
  int v2; // eax@2

  result = this->a;
  if ( this->a )
  {
    v2 = (int)result[-2]._m_pStr;
    if ( v2 < 0 )
      v2 = ~v2;
    result = (ZXString<char> *)((unsigned int)(v2 - 4) >> 2);
  }
  return result;
}

//----- (00417997) --------------------------------------------------------
CashItemEntry *__thiscall ZArray<CashItemEntry>::GetCapacity(ZArray<CashItemEntry> *this)
{
  CashItemEntry *result; // eax@1
  int v2; // eax@2

  result = this->a;
  if ( this->a )
  {
    v2 = (int)result[-1].pItem.p;
    if ( v2 < 0 )
      v2 = ~v2;
    result = (CashItemEntry *)((v2 - 4) / 0xCu);
  }
  return result;
}

//----- (004179B2) --------------------------------------------------------
void __thiscall ZMap<long,long,long>::_CalcAutoGrow(ZMap<long,long,long> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (004179D6) --------------------------------------------------------
void __thiscall ZMap<long,unsigned short,long>::_CalcAutoGrow(ZMap<long,unsigned short,long> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (004179FA) --------------------------------------------------------
void __thiscall ZMap<unsigned short,_FILETIME,unsigned short>::_CalcAutoGrow(ZMap<unsigned short,_FILETIME,unsigned short> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (00417A1E) --------------------------------------------------------
void __thiscall ZMap<long,ZRef<GW_MiniGameRecord>,long>::_CalcAutoGrow(ZMap<long,ZRef<GW_MiniGameRecord>,long> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (00417A42) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<GW_CoupleRecord> *v0; // ecx@1

  v0 = (ZRefCountedDummy<GW_CoupleRecord> *)ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<GW_CoupleRecord>::ZRefCountedDummy<GW_CoupleRecord>(v0);
}

//----- (00417A77) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance,
    p);
}

//----- (00417A87) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (00417AAD) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<GW_FriendRecord> *v0; // ecx@1

  v0 = (ZRefCountedDummy<GW_FriendRecord> *)ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<GW_FriendRecord>::ZRefCountedDummy<GW_FriendRecord>(v0);
}

//----- (00417AE2) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance,
    p);
}

//----- (00417AF2) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (00417B18) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<GW_MarriageRecord> *v0; // ecx@1

  v0 = (ZRefCountedDummy<GW_MarriageRecord> *)ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<GW_MarriageRecord>::ZRefCountedDummy<GW_MarriageRecord>(v0);
}

//----- (00417B4D) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance,
    p);
}

//----- (00417B5D) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (00417B83) --------------------------------------------------------
void __thiscall ZMap<unsigned short,ZXString<char>,unsigned short>::_CalcAutoGrow(ZMap<unsigned short,ZXString<char>,unsigned short> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (00417BA7) --------------------------------------------------------
void __thiscall ZRefCountedDummy<GW_CoupleRecord>::ZRefCountedDummy<GW_CoupleRecord>(ZRefCountedDummy<GW_CoupleRecord> *this)
{
  ZRefCountedDummy<GW_CoupleRecord> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>Vtbl *)&ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<GW_CoupleRecord>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>Vtbl *)&ZRefCountedDummy<GW_CoupleRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4437F4: using guessed type void *ZRefCountedDummy<GW_CoupleRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>'};
// 4437FC: using guessed type int (__thiscall *ZRefCountedDummy<GW_CoupleRecord>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443804: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417BD5) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *__thiscall ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>Vtbl *)&ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance,
      this);
  return v2;
}
// 443804: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417BF7) --------------------------------------------------------
void __thiscall ZRefCountedDummy<GW_FriendRecord>::ZRefCountedDummy<GW_FriendRecord>(ZRefCountedDummy<GW_FriendRecord> *this)
{
  ZRefCountedDummy<GW_FriendRecord> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>Vtbl *)&ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<GW_FriendRecord>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>Vtbl *)&ZRefCountedDummy<GW_FriendRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 44380C: using guessed type void *ZRefCountedDummy<GW_FriendRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>'};
// 443814: using guessed type int (__thiscall *ZRefCountedDummy<GW_FriendRecord>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 44381C: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417C25) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *__thiscall ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>Vtbl *)&ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance,
      this);
  return v2;
}
// 44381C: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417C47) --------------------------------------------------------
void __thiscall ZRefCountedDummy<GW_MarriageRecord>::ZRefCountedDummy<GW_MarriageRecord>(ZRefCountedDummy<GW_MarriageRecord> *this)
{
  ZRefCountedDummy<GW_MarriageRecord> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>Vtbl *)&ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<GW_MarriageRecord>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>Vtbl *)&ZRefCountedDummy<GW_MarriageRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443824: using guessed type void *ZRefCountedDummy<GW_MarriageRecord>::`vftable'{for `ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>'};
// 44382C: using guessed type int (__thiscall *ZRefCountedDummy<GW_MarriageRecord>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443834: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417C75) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *__thiscall ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vector deleting destructor'(ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>Vtbl *)&ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance,
      this);
  return v2;
}
// 443834: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417C97) --------------------------------------------------------
ZRefCountedDummy<GW_CoupleRecord> *__thiscall ZRefCountedDummy<GW_CoupleRecord>::`scalar deleting destructor'(ZRefCountedDummy<GW_CoupleRecord> *this, unsigned int __flags)
{
  ZRefCountedDummy<GW_CoupleRecord> *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<GW_CoupleRecord>::~ZRefCountedDummy<GW_CoupleRecord>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance,
      v2);
  return v2;
}

//----- (00417CB8) --------------------------------------------------------
ZRefCountedDummy<GW_FriendRecord> *__thiscall ZRefCountedDummy<GW_FriendRecord>::`scalar deleting destructor'(ZRefCountedDummy<GW_FriendRecord> *this, unsigned int __flags)
{
  ZRefCountedDummy<GW_FriendRecord> *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<GW_FriendRecord>::~ZRefCountedDummy<GW_FriendRecord>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance,
      v2);
  return v2;
}

//----- (00417CD9) --------------------------------------------------------
ZRefCountedDummy<GW_MarriageRecord> *__thiscall ZRefCountedDummy<GW_MarriageRecord>::`vector deleting destructor'(ZRefCountedDummy<GW_MarriageRecord> *this, unsigned int __flags)
{
  ZRefCountedDummy<GW_MarriageRecord> *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<GW_MarriageRecord>::~ZRefCountedDummy<GW_MarriageRecord>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance,
      v2);
  return v2;
}

//----- (00417CFA) --------------------------------------------------------
void __thiscall ZRefCountedDummy<GW_CoupleRecord>::~ZRefCountedDummy<GW_CoupleRecord>(ZRefCountedDummy<GW_CoupleRecord> *this)
{
  *(_DWORD *)(this != 0 ? (unsigned int)&this->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable';
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443804: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417D12) --------------------------------------------------------
void __thiscall ZRefCountedDummy<GW_FriendRecord>::~ZRefCountedDummy<GW_FriendRecord>(ZRefCountedDummy<GW_FriendRecord> *this)
{
  *(_DWORD *)(this != 0 ? (unsigned int)&this->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable';
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 44381C: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417D2A) --------------------------------------------------------
void __thiscall ZRefCountedDummy<GW_MarriageRecord>::~ZRefCountedDummy<GW_MarriageRecord>(ZRefCountedDummy<GW_MarriageRecord> *this)
{
  *(_DWORD *)(this != 0 ? (unsigned int)&this->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable';
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443834: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::`vftable')(void *p, unsigned int __flags);

//----- (00417D42) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x34u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (00417D96) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x38u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (00417DEA) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x40u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (00417E5E) --------------------------------------------------------
void __thiscall CIPChecker::LoadIPList(CIPChecker *this)
{
  CIPChecker *v1; // edi@1
  _bstr_t::Data_t *v2; // ecx@1
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v3; // eax@1
  IWzResMan *v4; // eax@1
  Ztl_variant_t *v5; // eax@1
  int v6; // eax@1
  int v7; // eax@4
  int v8; // eax@6
  int v9; // eax@8
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *v10; // eax@12
  IUnknownVtbl *v11; // ecx@15
  int *v12; // ecx@16
  IWzProperty *v13; // eax@16
  Ztl_variant_t *v14; // eax@16
  int v15; // eax@17
  int v16; // eax@20
  IUnknownVtbl *v17; // ecx@23
  IUnknownVtbl *v18; // ecx@25
  IUnknownVtbl *v19; // ecx@29
  int v20; // eax@30
  IUnknownVtbl *v21; // ecx@33
  Ztl_bstr_t v22; // [sp-14h] [bp-90h]@1
  Ztl_variant_t *v23; // [sp-10h] [bp-8Ch]@1
  Ztl_variant_t *v24; // [sp-Ch] [bp-88h]@1
  void *v25; // [sp-8h] [bp-84h]@1
  int *v26; // [sp-4h] [bp-80h]@1
  int v27; // [sp+0h] [bp-7Ch]@1
  Ztl_variant_t result; // [sp+Ch] [bp-70h]@1
  _variant_t v29; // [sp+1Ch] [bp-60h]@1
  _variant_t v30; // [sp+2Ch] [bp-50h]@1
  VARIANTARG pvarg; // [sp+3Ch] [bp-40h]@10
  _DWORD *v32; // [sp+4Ch] [bp-30h]@16
  int v33; // [sp+50h] [bp-2Ch]@1
  int v34; // [sp+54h] [bp-28h]@12
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > v35; // [sp+58h] [bp-24h]@12
  _com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > v36; // [sp+5Ch] [bp-20h]@12
  Ztl_bstr_t __that; // [sp+60h] [bp-1Ch]@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v38; // [sp+64h] [bp-18h]@16
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v39; // [sp+68h] [bp-14h]@1
  int *v40; // [sp+6Ch] [bp-10h]@1
  int v41; // [sp+78h] [bp-4h]@1

  v40 = &v27;
  v1 = this;
  v39.m_pInterface = 0;
  v41 = 0;
  LOBYTE(v41) = 1;
  _variant_t::_variant_t(&v29, &vtMissing);
  LOBYTE(v41) = 2;
  _variant_t::_variant_t(&v30, &vtMissing);
  v26 = 0;
  v25 = 0;
  v24 = (Ztl_variant_t *)&v29;
  v23 = (Ztl_variant_t *)&v30;
  v22.m_Data = v2;
  v33 = (int)&v22;
  LOBYTE(v41) = 3;
  Ztl_bstr_t::Ztl_bstr_t(&v22, aIpcheck_img);
  LOBYTE(v41) = 4;
  v3 = get_rm();
  v4 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v3);
  LOBYTE(v41) = 3;
  v5 = IWzResMan::GetObjectA(v4, &result, v22, v23, v24);
  LOBYTE(v41) = 5;
  __that.m_Data = (_bstr_t::Data_t *)Ztl_variant_t::GetUnknown(v5, (char)v25, (char)v26);
  v6 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
         &v39,
         (int)&__that);
  if ( v6 < 0 && v6 != -2147467262 )
    _com_issue_error(v6);
  LOBYTE(v41) = 3;
  v7 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v7 < 0 )
    _com_issue_error(v7);
  LOBYTE(v41) = 2;
  v8 = ZComAPI::ZComVariantClear((tagVARIANT *)&v30.0);
  if ( v8 < 0 )
    _com_issue_error(v8);
  LOBYTE(v41) = 1;
  v9 = ZComAPI::ZComVariantClear((tagVARIANT *)&v29.0);
  if ( v9 < 0 )
    _com_issue_error(v9);
  v41 = 0;
  VariantInit(&pvarg);
  LOBYTE(v41) = 7;
  if ( !v39.m_pInterface )
    _com_issue_error(-2147467261);
  v10 = IWzProperty::Get_NewEnum(v39.m_pInterface, &v35);
  LOBYTE(v41) = 8;
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(
    &v36,
    v10);
  LOBYTE(v41) = 10;
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::_Release(&v35);
  v34 = 0;
  while ( 1 )
  {
    if ( !v36.m_pInterface )
      _com_issue_error(-2147467261);
    v11 = v36.m_pInterface->vfptr;
    v26 = &v34;
    v25 = &pvarg;
    v24 = (Ztl_variant_t *)1;
    v23 = (Ztl_variant_t *)v36.m_pInterface;
    if ( ((int (__stdcall *)(IEnumVARIANT *, signed int, VARIANTARG *, int *))v11[1].QueryInterface)(
           v36.m_pInterface,
           1,
           &pvarg,
           &v34) )
    {
      break;
    }
    DetachBSTR(&__that, &pvarg);
    v12 = v26;
    v26 = 0;
    v25 = 0;
    v24 = (Ztl_variant_t *)v12;
    v32 = &v24;
    LOBYTE(v41) = 11;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v24, &__that);
    v23 = &result;
    LOBYTE(v41) = 11;
    v13 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v39);
    v14 = IWzProperty::Getitem(v13, v23, (Ztl_bstr_t)v24);
    LOBYTE(v41) = 13;
    v33 = (int)Ztl_variant_t::GetUnknown(v14, (char)v25, (char)v26);
    v38.m_pInterface = 0;
    if ( v33 )
    {
      v15 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v38,
              (int)&v33);
      if ( v15 < 0 && v15 != -2147467262 )
        _com_issue_error(v15);
    }
    LOBYTE(v41) = 15;
    v16 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
    if ( v16 < 0 )
      _com_issue_error(v16);
    v26 = (int *)v38.m_pInterface;
    v32 = &v26;
    if ( v38.m_pInterface )
    {
      v17 = v38.m_pInterface->vfptr;
      v25 = v38.m_pInterface;
      v17->AddRef((IUnknown *)v38.m_pInterface);
    }
    CIPChecker::AddIP(v1, (_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> >)v26);
    LOBYTE(v41) = 11;
    if ( v38.m_pInterface )
    {
      v18 = v38.m_pInterface->vfptr;
      v26 = (int *)v38.m_pInterface;
      v18->Release((IUnknown *)v38.m_pInterface);
    }
    LOBYTE(v41) = 10;
    if ( __that.m_Data )
    {
      _bstr_t::Data_t::Release(__that.m_Data);
      __that.m_Data = 0;
    }
  }
  LOBYTE(v41) = 7;
  if ( v36.m_pInterface )
  {
    v19 = v36.m_pInterface->vfptr;
    v26 = (int *)v36.m_pInterface;
    v19->Release((IUnknown *)v36.m_pInterface);
  }
  LOBYTE(v41) = 0;
  v20 = ZComAPI::ZComVariantClear(&pvarg);
  if ( v20 < 0 )
    _com_issue_error(v20);
  v41 = -1;
  if ( v39.m_pInterface )
  {
    v21 = v39.m_pInterface->vfptr;
    v26 = (int *)v39.m_pInterface;
    v21->Release((IUnknown *)v39.m_pInterface);
  }
}

//----- (004180E6) --------------------------------------------------------
void __thiscall CIPChecker::AddIP(CIPChecker *this, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry)
{
  IWzProperty *v2; // eax@3
  Ztl_variant_t *v3; // eax@3
  int v4; // eax@3
  void *v5; // ecx@3
  IWzProperty *v6; // eax@5
  Ztl_variant_t *v7; // eax@5
  int v8; // eax@5
  char *v9; // eax@8
  void **v10; // eax@10
  _bstr_t::Data_t *v11; // ecx@10
  bool v12; // al@11
  char *v13; // eax@16
  signed int v14; // esi@19
  IWzProperty *v15; // eax@19
  Ztl_variant_t *v16; // eax@19
  unsigned int v17; // edi@19
  int v18; // eax@19
  _bstr_t::Data_t *v19; // ecx@19
  IWzProperty *v20; // eax@23
  Ztl_variant_t *v21; // eax@23
  unsigned int v22; // edi@23
  int v23; // eax@23
  _bstr_t::Data_t *v24; // ecx@23
  IWzProperty *v25; // eax@27
  Ztl_variant_t *v26; // eax@27
  unsigned int v27; // edi@27
  int v28; // eax@27
  CIPChecker::IPELEM *v29; // eax@33
  IUnknownVtbl *v30; // ecx@38
  Ztl_bstr_t v31; // [sp-8h] [bp-58h]@19
  void *v32; // [sp-4h] [bp-54h]@3
  Ztl_variant_t v33; // [sp+Ch] [bp-44h]@5
  Ztl_variant_t result; // [sp+1Ch] [bp-34h]@3
  Ztl_bstr_t *v35; // [sp+2Ch] [bp-24h]@19
  ZArray<CIPChecker::IPELEM> *v36; // [sp+30h] [bp-20h]@1
  void **v37; // [sp+34h] [bp-1Ch]@3
  unsigned __int32 v38; // [sp+38h] [bp-18h]@2
  Ztl_bstr_t v39; // [sp+3Ch] [bp-14h]@3
  Ztl_bstr_t __$ReturnUdt; // [sp+40h] [bp-10h]@5
  int v41; // [sp+4Ch] [bp-4h]@1

  v36 = (ZArray<CIPChecker::IPELEM> *)this;
  v41 = 0;
  if ( !pEntry.m_pInterface )
  {
    v38 = -2147467259;
    _CxxThrowException(&v38, &_TI1_AVZException__);
  }
  v32 = this;
  v37 = &v32;
  _bstr_t::_bstr_t((_bstr_t *)&v32, s);
  LOBYTE(v41) = 0;
  v2 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v3 = IWzProperty::Getitem(v2, &result, (Ztl_bstr_t)v32);
  LOBYTE(v41) = 2;
  DetachBSTR(&v39, (tagVARIANT *)&v3->0);
  LOBYTE(v41) = 4;
  v4 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v4 < 0 )
    _com_issue_error(v4);
  v32 = v5;
  v37 = &v32;
  _bstr_t::_bstr_t((_bstr_t *)&v32, aMask);
  LOBYTE(v41) = 4;
  v6 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v7 = IWzProperty::Getitem(v6, &v33, (Ztl_bstr_t)v32);
  LOBYTE(v41) = 6;
  DetachBSTR(&__$ReturnUdt, (tagVARIANT *)&v7->0);
  LOBYTE(v41) = 8;
  v8 = ZComAPI::ZComVariantClear((tagVARIANT *)&v33.0);
  if ( v8 < 0 )
    _com_issue_error(v8);
  if ( v39.m_Data )
    v9 = _bstr_t::Data_t::GetString(v39.m_Data);
  else
    v9 = 0;
  v10 = (void **)inet_addr(v9);
  v11 = __$ReturnUdt.m_Data;
  v37 = v10;
  if ( __$ReturnUdt.m_Data )
    v12 = __$ReturnUdt.m_Data->m_wstr == 0;
  else
    v12 = 1;
  if ( v12 )
  {
    v38 = -1;
  }
  else
  {
    if ( __$ReturnUdt.m_Data )
      v13 = _bstr_t::Data_t::GetString(__$ReturnUdt.m_Data);
    else
      v13 = 0;
    v38 = inet_addr(v13);
  }
  v32 = 0;
  v31.m_Data = v11;
  v35 = &v31;
  v14 = 0;
  Ztl_bstr_t::Ztl_bstr_t(&v31, aInternal);
  LOBYTE(v41) = 8;
  v15 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v16 = IWzProperty::Getitem(v15, &result, v31);
  LOBYTE(v41) = 10;
  v17 = get_int32(v16, (int)v32);
  LOBYTE(v41) = 8;
  v18 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v18 < 0 )
    _com_issue_error(v18);
  if ( v17 )
    v14 = 1;
  v32 = 0;
  v31.m_Data = v19;
  v35 = &v31;
  Ztl_bstr_t::Ztl_bstr_t(&v31, aMaster);
  LOBYTE(v41) = 8;
  v20 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v21 = IWzProperty::Getitem(v20, &result, v31);
  LOBYTE(v41) = 12;
  v22 = get_int32(v21, (int)v32);
  LOBYTE(v41) = 8;
  v23 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v23 < 0 )
    _com_issue_error(v23);
  if ( v22 )
    v14 |= 2u;
  v32 = 0;
  v31.m_Data = v24;
  v35 = &v31;
  Ztl_bstr_t::Ztl_bstr_t(&v31, aSkipcrc);
  LOBYTE(v41) = 8;
  v25 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v26 = IWzProperty::Getitem(v25, &result, v31);
  LOBYTE(v41) = 14;
  v27 = get_int32(v26, (int)v32);
  LOBYTE(v41) = 8;
  v28 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v28 < 0 )
    _com_issue_error(v28);
  if ( v27 )
    v14 |= 4u;
  if ( v37 == (void **)-1 || !v14 )
  {
    v36 = (ZArray<CIPChecker::IPELEM> *)-2147467259;
    _CxxThrowException(&v36, &_TI1_AVZException__);
  }
  result.llVal = __PAIR__(v14, v38);
  result.decVal.Hi32 = v38 & (unsigned int)v37;
  v29 = ZArray<CIPChecker::IPELEM>::InsertBefore(v36, -1);
  *(_QWORD *)&v29->dwIP = *(_QWORD *)&result.gap0[4];
  v29->dwFlag = result.decVal.Mid32;
  if ( __$ReturnUdt.m_Data )
  {
    _bstr_t::Data_t::Release(__$ReturnUdt.m_Data);
    __$ReturnUdt.m_Data = 0;
  }
  if ( v39.m_Data )
  {
    _bstr_t::Data_t::Release(v39.m_Data);
    v39.m_Data = 0;
  }
  v41 = -1;
  if ( pEntry.m_pInterface )
  {
    v30 = pEntry.m_pInterface->vfptr;
    v32 = pEntry.m_pInterface;
    v30->Release((IUnknown *)pEntry.m_pInterface);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00418385) --------------------------------------------------------
unsigned int __thiscall CIPChecker::GetFlag(CIPChecker *this, unsigned int dwIP)
{
  CIPChecker::IPELEM *v2; // ecx@1
  unsigned int result; // eax@1
  unsigned int v4; // esi@1
  unsigned int *v5; // edx@1

  v2 = this->m_aIPList.a;
  result = 0;
  v4 = 0;
  v5 = &v2->dwFlag;
  while ( v2 && v4 < v2[-1].dwFlag )
  {
    if ( (dwIP & *(v5 - 1)) == *(v5 - 2) )
      result |= *v5;
    ++v4;
    v5 += 3;
  }
  return result;
}

//----- (004183B2) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::_Release(_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *this)
{
  if ( this->m_pInterface )
    this->m_pInterface->vfptr->Release(this->m_pInterface);
}

//----- (004183BF) --------------------------------------------------------
CIPChecker::IPELEM *__thiscall ZArray<CIPChecker::IPELEM>::InsertBefore(ZArray<CIPChecker::IPELEM> *this, int nIndex)
{
  unsigned int v2; // ebx@2
  int v3; // edi@4
  ZArray<CIPChecker::IPELEM> *v5; // [sp+Ch] [bp-4h]@1

  v5 = this;
  if ( this->a )
    v2 = this->a[-1].dwFlag;
  else
    v2 = 0;
  v3 = nIndex;
  if ( nIndex == -1 )
    v3 = v2;
  ZArray<CIPChecker::IPELEM>::_Realloc(this, v2 + 1, 2, (ZAllocHelper *)&nIndex + 3);
  memmove((char *)v5->a + 4 * (3 * v3 + 3), &v5->a[v3], 12 * v2 - 12 * v3);
  return &v5->a[v3];
}

//----- (0041842A) --------------------------------------------------------
void _E14_1()
{
  _E12_2();
  _E13_2();
}

//----- (00418434) --------------------------------------------------------
void _E12_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0041846F) --------------------------------------------------------
void _E13_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (004184AA) --------------------------------------------------------
CIPChecker::IPELEM *__thiscall ZArray<CIPChecker::IPELEM>::_Realloc(ZArray<CIPChecker::IPELEM> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<CIPChecker::IPELEM> *v4; // esi@1
  unsigned int v5; // edi@2
  void *v6; // esi@8
  ZArray<CIPChecker::IPELEM> *v8; // [sp+Ch] [bp-4h]@1
  int nModea; // [sp+1Ch] [bp+Ch]@7

  v4 = this;
  v8 = this;
  if ( this->a )
    v5 = this->a[-1].dwFlag;
  else
    v5 = 0;
  if ( u > v5 )
  {
    if ( u > (unsigned int)ZArray<CIPChecker::IPELEM>::GetCapacity(this) )
    {
      v6 = (void *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 12 * u + 4) + 4);
      if ( v8->a )
      {
        if ( !(nMode & 1) )
          memcpy(v6, v8->a, 12 * v5);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v8->a[-1].dwFlag);
      }
      v8->a = (CIPChecker::IPELEM *)v6;
      v4 = v8;
    }
    else if ( !(nMode & 2) )
    {
      nModea = (int)&v4->a[v5];
    }
  }
  if ( v4->a )
    v4->a[-1].dwFlag = u;
  return v4->a;
}

//----- (0041856A) --------------------------------------------------------
void _E31_5()
{
  _E24_2();
  _E25_2();
  _E26_2();
  _E27_1();
  _E28_2();
  _E29_4();
  _E30_4();
}

//----- (0041858D) --------------------------------------------------------
void _E24_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004185C8) --------------------------------------------------------
void _E25_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00418603) --------------------------------------------------------
void _E26_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0041863E) --------------------------------------------------------
void _E27_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00418679) --------------------------------------------------------
void _E28_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004186B4) --------------------------------------------------------
void _E29_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004186EF) --------------------------------------------------------
void _E30_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0041872A) --------------------------------------------------------
unsigned int *__thiscall ZArray<CIPChecker::IPELEM>::GetCapacity(ZArray<CIPChecker::IPELEM> *this)
{
  unsigned int *result; // eax@1
  int v2; // eax@2

  result = &this->a->dwIP;
  if ( this->a )
  {
    v2 = *(result - 2);
    if ( v2 < 0 )
      v2 = ~v2;
    result = (unsigned int *)((v2 - 4) / 0xCu);
  }
  return result;
}

//----- (00418745) --------------------------------------------------------
char *__thiscall _bstr_t::Data_t::GetString(_bstr_t::Data_t *this)
{
  _bstr_t::Data_t *v1; // esi@1
  char *v2; // eax@2

  v1 = this;
  if ( !this->m_str )
  {
    v2 = _com_util::ZtlConvertBSTRToString(this->m_wstr);
    v1->m_str = v2;
    if ( !v2 )
    {
      if ( v1->m_wstr )
        _com_issue_error(-2147024882);
    }
  }
  return v1->m_str;
}

//----- (0041876F) --------------------------------------------------------
char *__stdcall _com_util::ZtlConvertBSTRToString(unsigned __int16 *pSrc)
{
  char *result; // eax@2
  unsigned int v2; // eax@3
  char *v3; // edi@3

  if ( pSrc )
  {
    v2 = dword_4A477C(0, 0, pSrc, -1, 0, 0, 0, 0);
    v3 = (char *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
    dword_4A477C(0, 0, pSrc, -1, v3, 0x3FFFFFFF, 0, 0);
    result = v3;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 4A477C: using guessed type int (__stdcall *dword_4A477C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (004187B7) --------------------------------------------------------
int _E26_3()
{
  _E23_1();
  return _E25_3();
}

//----- (004187C1) --------------------------------------------------------
void _E23_1()
{
  CIPCheckerServer::CIPCheckerServer(&g_IPCheckerServer);
}

//----- (004187CB) --------------------------------------------------------
int _E25_3()
{
  return atexit(_E24_3);
}

//----- (004187D7) --------------------------------------------------------
void __cdecl _E24_3()
{
  CIPCheckerServer::~CIPCheckerServer(&g_IPCheckerServer);
}

//----- (004187E1) --------------------------------------------------------
void __thiscall CIPCheckerServer::CIPCheckerServer(CIPCheckerServer *this)
{
  CIPCheckerServer *v1; // esi@1

  v1 = this;
  this->vfptr = (ZISocketCallBackVtbl *)ZISocketCallBack::`vftable';
  this->vfptr = (CVerboseObjVtbl *)&CVerboseObj::`vftable';
  TSingleton<CIPCheckerServer>::ms_pInstance = &this->m_lock != 0 ? (unsigned int)this : 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v1->m_sock._m_hSocket = -1;
  v1->m_sock._m_pThread.p = 0;
  v1->m_sock._m_pCallBack = 0;
  v1->m_sock.vfptr = (ZIStreamVtbl *)&ZSocket::`vftable';
  v1->m_bConnected = 0;
  v1->m_bConfigurationExist = 1;
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->m_lockSend.DebugInfo);
  v1->m_lSendBuff._m_uCount = 0;
  v1->m_lSendBuff._m_pHead = 0;
  v1->m_lSendBuff._m_pTail = 0;
  v1->m_lSendBuff.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  v1->m_pRecvBuff.p = 0;
  CInPacket::CInPacket(&v1->m_packetRecv, 0);
  v1->vfptr = (ZISocketCallBackVtbl *)CIPCheckerServer::`vftable'{for `ZISocketCallBack'};
  v1->vfptr = (CVerboseObjVtbl *)&CIPCheckerServer::`vftable'{for `CVerboseObj'};
  CIPCheckerServer::Disconnect(v1);
}
// 443420: using guessed type const char *(__thiscall *CVerboseObj::`vftable')(CVerboseObj *__hidden this);
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);
// 4434FC: using guessed type int (__thiscall *ZSocket::`vftable')(void *p, unsigned int __flags);
// 443524: using guessed type void (__thiscall *ZISocketCallBack::`vftable'[6])(ZISocketCallBack *this, ZSocket *pSocket, int);
// 44383C: using guessed type const char *(__thiscall *CIPCheckerServer::`vftable'{for `CVerboseObj'})(CIPCheckerServer *__hidden this);
// 443844: using guessed type void (__thiscall *CIPCheckerServer::`vftable'{for `ZISocketCallBack'}[6])(CIPCheckerServer *this, ZSocket *pSocket, int);
// 4A43DC: using guessed type int TSingleton<CIPCheckerServer>::ms_pInstance;

//----- (00418896) --------------------------------------------------------
char *CIPCheckerServer::GetLogTail()
{
  return aIpcheckerserve;
}

//----- (0041889C) --------------------------------------------------------
CIPCheckerServer *__thiscall CIPCheckerServer::`scalar deleting destructor'(CIPCheckerServer *this, unsigned int __flags)
{
  CIPCheckerServer *v2; // esi@1

  v2 = this;
  CIPCheckerServer::~CIPCheckerServer(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (004188BC) --------------------------------------------------------
void __thiscall CIPCheckerServer::~CIPCheckerServer(CIPCheckerServer *this)
{
  CIPCheckerServer *v1; // esi@1

  v1 = this;
  this->vfptr = (ZISocketCallBackVtbl *)CIPCheckerServer::`vftable'{for `ZISocketCallBack'};
  this->vfptr = (CVerboseObjVtbl *)&CIPCheckerServer::`vftable'{for `CVerboseObj'};
  CIPCheckerServer::Disconnect(this);
  ZArray<unsigned char>::RemoveAll(&v1->m_packetRecv.m_aRecvBuff);
  if ( v1->m_pRecvBuff.p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(&v1->m_pRecvBuff, 0);
    v1->m_pRecvBuff.p = 0;
  }
  v1->m_lSendBuff.vfptr = (ZList<ZRef<ZSocketBuffer> >Vtbl *)&ZList<ZRef<ZSocketBuffer>>::`vftable';
  ZList<ZRef<ZSocketBuffer>>::RemoveAll(&v1->m_lSendBuff);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lockSend.DebugInfo);
  ZSocket::~ZSocket(&v1->m_sock);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  TSingleton<CIPCheckerServer>::ms_pInstance = 0;
}
// 443428: using guessed type int (__thiscall *ZList<ZRef<ZSocketBuffer>>::`vftable')(void *p, unsigned int __flags);
// 44383C: using guessed type const char *(__thiscall *CIPCheckerServer::`vftable'{for `CVerboseObj'})(CIPCheckerServer *__hidden this);
// 443844: using guessed type void (__thiscall *CIPCheckerServer::`vftable'{for `ZISocketCallBack'}[6])(CIPCheckerServer *this, ZSocket *pSocket, int);
// 4A43DC: using guessed type int TSingleton<CIPCheckerServer>::ms_pInstance;

//----- (00418955) --------------------------------------------------------
void __thiscall CIPCheckerServer::Disconnect(CIPCheckerServer *this)
{
  CIPCheckerServer *v1; // esi@1
  int v2; // eax@3

  v1 = this;
  ZSocket::Close(&this->m_sock);
  v1->m_uRecvOffset = 0;
  if ( v1->m_pRecvBuff.p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw(&v1->m_pRecvBuff, 0);
    v1->m_pRecvBuff.p = 0;
  }
  v2 = (int)&v1->m_packetRecv.m_bLoopback;
  *(_DWORD *)(v2 + 4) = 0;
  *(_WORD *)(v2 + 12) = 0;
  *(_DWORD *)(v2 + 20) = 0;
  ZList<ZRef<ZSocketBuffer>>::RemoveAll(&v1->m_lSendBuff);
  v1->m_uSent0 = 0;
  v1->m_bConnected = 0;
}

//----- (00418999) --------------------------------------------------------
void __cdecl CIPCheckerServer::OnSocketReceive(ZSocket *pSocket, int nErr)
{
  CIPCheckerServer *this; // ecx@0
  CIPCheckerServer *v3; // esi@1
  ZSocketBuffer *v4; // eax@3
  ZSocketBuffer *v5; // eax@5
  ZSocketBuffer *v6; // edi@7
  unsigned int v7; // ebx@7
  ZSocketBuffer *v8; // ecx@7
  ZSocketBuffer *v9; // eax@8
  int v10; // eax@14
  int v11; // [sp+0h] [bp-50h]@1
  int *v12; // [sp+Ch] [bp-44h]@14
  int v13; // [sp+10h] [bp-40h]@14
  ZRef<ZSocketBuffer> pBuff; // [sp+14h] [bp-3Ch]@10
  ZSocketBuffer *v15; // [sp+24h] [bp-2Ch]@7
  int v16; // [sp+28h] [bp-28h]@21
  int v17; // [sp+2Ch] [bp-24h]@18
  int pnLastState; // [sp+30h] [bp-20h]@14
  int v19; // [sp+34h] [bp-1Ch]@2
  CIPCheckerServer *v20; // [sp+38h] [bp-18h]@1
  unsigned int len; // [sp+3Ch] [bp-14h]@6
  int *v22; // [sp+40h] [bp-10h]@1
  int v23; // [sp+4Ch] [bp-4h]@1

  v23 = 0;
  v3 = this;
  v22 = &v11;
  v20 = this;
  if ( nErr )
  {
    v19 = nErr;
    _CxxThrowException(&v19, &_TI1_AVZException__);
  }
  while ( 1 )
  {
    v4 = v3->m_pRecvBuff.p;
    if ( !v4 || v4->len == v3->m_uRecvOffset )
    {
      ZSocketBuffer::Alloc(0x5B4u);
      ZRef<ZSocketBuffer>::operator=(&v3->m_pRecvBuff, v5);
      v3->m_uRecvOffset = 0;
    }
    len = ZSocket::Receive(
            &v3->m_sock,
            &v3->m_pRecvBuff.p->buf[v3->m_uRecvOffset],
            v3->m_pRecvBuff.p->len - v3->m_uRecvOffset,
            0);
    if ( !len )
      break;
    v6 = v3->m_pRecvBuff.p;
    v7 = v3->m_uRecvOffset;
    v8 = (ZSocketBuffer *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x1Cu);
    v15 = v8;
    LOBYTE(v23) = 1;
    if ( v8 )
      ZSocketBuffer::ZSocketBuffer(v8, len, &v6->buf[v7], v6);
    else
      v9 = 0;
    pBuff.p = v9;
    if ( v9 )
      InterlockedIncrement(&v9->_m_nRef);
    v3->m_uRecvOffset += len;
    while ( pBuff.p )
    {
      v12 = &v3->m_packetRecv.m_bLoopback;
      v13 = 1;
      LOBYTE(v23) = 3;
      v10 = CInPacket::AppendBuffer(&v3->m_packetRecv, &pBuff, &pnLastState, 0);
      if ( v10 > 0 && pnLastState <= 0 )
      {
        if ( (v3->m_packetRecv.m_uRawSeq ^ (v3->m_uSeqRcv >> 16)) != -332 )
        {
          CVerboseObj::LogError((CVerboseObj *)&v3->vfptr, aIncorrectPacke);
          v17 = -2147467259;
          _CxxThrowException(&v17, &_TI1_AVZException__);
        }
        if ( v3->m_packetRecv.m_uDataLen > 0x8000u )
        {
          CVerboseObj::LogError((CVerboseObj *)&v3->vfptr, aReceivedPacket);
          v16 = -2147467259;
          _CxxThrowException(&v16, &_TI1_AVZException__);
        }
      }
      if ( v10 == 2 )
      {
        v3->m_uSeqRcv = 214013 * v3->m_uSeqRcv + 2531011;
        CIPCheckerServer::ProcessPacket(&v3->m_packetRecv);
        v3->m_packetRecv.m_nState = 0;
        v3->m_packetRecv.m_uLength = 0;
        v3->m_packetRecv.m_uOffset = 0;
      }
      else
      {
        v13 = 0;
      }
    }
    LOBYTE(v23) = 0;
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00418B8C) --------------------------------------------------------
void __thiscall CIPCheckerServer::OnSocketSend(CIPCheckerServer *this, ZSocket *pSocket, int nErr)
{
  int v3; // [sp+0h] [bp-2Ch]@1
  int v4; // [sp+14h] [bp-18h]@2
  CIPCheckerServer *v5; // [sp+18h] [bp-14h]@1
  int *v6; // [sp+1Ch] [bp-10h]@1
  int v7; // [sp+28h] [bp-4h]@1

  v7 = 0;
  v6 = &v3;
  v5 = this;
  if ( nErr )
  {
    v4 = nErr;
    _CxxThrowException(&v4, &_TI1_AVZException__);
  }
  CIPCheckerServer::Flush(this);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00418BD4) --------------------------------------------------------
void *__usercall _L115884@<eax>(int a1@<ebp>)
{
  int v1; // esi@1

  v1 = *(_DWORD *)(a1 - 20);
  CVerboseObj::LogException((CVerboseObj *)(v1 + 4), *(ZException **)(a1 - 28));
  *(_DWORD *)(v1 + 52) = 0;
  return &_L109086;
}

//----- (00418BEC) --------------------------------------------------------
void *__usercall _L115885@<eax>(int a1@<ebp>)
{
  int v1; // esi@1

  v1 = *(_DWORD *)(a1 - 20);
  CVerboseObj::LogException((CVerboseObj *)(v1 + 4), *(_com_error **)(a1 - 32));
  *(_DWORD *)(v1 + 52) = 0;
  return &_L109086;
}

//----- (00418C04) --------------------------------------------------------
void __thiscall CIPCheckerServer::OnSocketClose(CIPCheckerServer *this, ZSocket *pSocket, int nErr)
{
  this->m_bConnected = 0;
}

//----- (00418C0B) --------------------------------------------------------
int __thiscall CIPCheckerServer::Connect(CIPCheckerServer *this)
{
  CIPCheckerServer *v1; // edi@1
  struct _RTL_CRITICAL_SECTION *v2; // esi@1
  int v3; // eax@1
  int v4; // ecx@4
  IWzProperty *v5; // eax@4
  Ztl_variant_t *v6; // eax@4
  int v7; // eax@5
  int v8; // eax@8
  IWzProperty *v9; // eax@12
  Ztl_variant_t *v10; // eax@12
  int v11; // eax@12
  ZSocketThread *v12; // ecx@12
  IWzProperty *v13; // eax@14
  Ztl_variant_t *v14; // eax@14
  int v15; // eax@14
  int v16; // eax@16
  SOCKET v17; // eax@16
  unsigned __int16 *v18; // eax@19
  void *v19; // esp@21
  unsigned __int16 *v20; // ebx@22
  unsigned __int16 *v21; // eax@25
  int v22; // eax@27
  sockaddr *v23; // eax@27
  int v24; // eax@27
  unsigned int v25; // eax@29
  ZSocketThread *v26; // ecx@29
  _WORD *v27; // ebx@31
  int v28; // esi@31
  int v29; // esi@31
  ZSocketBuffer *v30; // ecx@31
  unsigned int v31; // eax@32
  IUnknownVtbl *v32; // ecx@45
  IUnknownVtbl *v33; // ecx@47
  IUnknownVtbl *v35; // ecx@54
  IUnknownVtbl *v36; // ecx@56
  int v37; // [sp-Ch] [bp-7Ch]@4
  Ztl_variant_t *v38; // [sp-8h] [bp-78h]@4
  ZSocketThread *v39; // [sp-4h] [bp-74h]@4
  int v40; // [sp+0h] [bp-70h]@1
  Ztl_variant_t v41; // [sp+Ch] [bp-64h]@14
  Ztl_variant_t result; // [sp+1Ch] [bp-54h]@4
  Ztl_variant_t v43; // [sp+2Ch] [bp-44h]@12
  _DWORD *v44; // [sp+3Ch] [bp-34h]@4
  CIPCheckerServer *v45; // [sp+40h] [bp-30h]@1
  int v46; // [sp+44h] [bp-2Ch]@17
  char *sAddr; // [sp+48h] [bp-28h]@4
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v48; // [sp+4Ch] [bp-24h]@4
  Ztl_bstr_t v49; // [sp+50h] [bp-20h]@14
  Ztl_bstr_t v50; // [sp+54h] [bp-1Ch]@12
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v51; // [sp+58h] [bp-18h]@4
  char v52; // [sp+5Fh] [bp-11h]@29
  int *v53; // [sp+60h] [bp-10h]@1
  int v54; // [sp+6Ch] [bp-4h]@4

  v1 = this;
  v53 = &v40;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_lockSend.DebugInfo;
  v45 = this;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo);
  LeaveCriticalSection(v2);
  v3 = *(_DWORD *)(&v1->m_sock != 0 ? (unsigned int)&v1->m_sock._m_hSocket : 0);
  if ( v3 && v3 != -1 )
  {
    ZSocket::DetachThread(&v1->m_sock);
    ZSocketBase::CloseSocket((ZSocketBase *)&v1->m_sock._m_hSocket);
    CIPCheckerServer::Disconnect(v1);
  }
  v48.m_pInterface = g_pPropConf.m_pInterface;
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_AddRef(&v48);
  v39 = 0;
  v38 = 0;
  v37 = v4;
  v44 = &v37;
  v54 = 0;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v37, aIpcheckerser_1);
  LOBYTE(v54) = 0;
  v5 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v48);
  v6 = IWzProperty::Getitem(v5, &result, (Ztl_bstr_t)v37);
  LOBYTE(v54) = 2;
  sAddr = (char *)Ztl_variant_t::GetUnknown(v6, (char)v38, (char)v39);
  v51.m_pInterface = 0;
  if ( sAddr )
  {
    v7 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
           &v51,
           (int)&sAddr);
    if ( v7 < 0 && v7 != -2147467262 )
      _com_issue_error(v7);
  }
  LOBYTE(v54) = 4;
  v8 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v8 < 0 )
    _com_issue_error(v8);
  if ( !v51.m_pInterface )
  {
    CVerboseObj::LogError((CVerboseObj *)&v1->vfptr, aNoIpcheckerser);
    v1->m_bConfigurationExist = 0;
    _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_Release(&v51);
    _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_Release(&v48);
    return 0;
  }
  v44 = &v39;
  _bstr_t::_bstr_t((_bstr_t *)&v39, s);
  v38 = &v43;
  LOBYTE(v54) = 4;
  v9 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v51);
  v10 = IWzProperty::Getitem(v9, v38, (Ztl_bstr_t)v39);
  LOBYTE(v54) = 6;
  DetachBSTR(&v50, (tagVARIANT *)&v10->0);
  LOBYTE(v54) = 8;
  v11 = ZComAPI::ZComVariantClear((tagVARIANT *)&v43.0);
  if ( v11 < 0 )
    _com_issue_error(v11);
  v39 = v12;
  v44 = &v39;
  _bstr_t::_bstr_t((_bstr_t *)&v39, aPort);
  v38 = &v41;
  LOBYTE(v54) = 8;
  v13 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v51);
  v14 = IWzProperty::Getitem(v13, v38, (Ztl_bstr_t)v39);
  LOBYTE(v54) = 10;
  DetachBSTR(&v49, (tagVARIANT *)&v14->0);
  LOBYTE(v54) = 12;
  v15 = ZComAPI::ZComVariantClear((tagVARIANT *)&v41.0);
  if ( v15 < 0 )
    _com_issue_error(v15);
  LOBYTE(v54) = 13;
  v1->m_uSeqRcv = CRand32::Random(&g_rand);
  v16 = CRand32::Random(&g_rand);
  v39 = 0;
  v38 = (Ztl_variant_t *)1;
  v37 = 2;
  v1->m_uSeqSnd = v16;
  v17 = socket(v37, (int)v38, (int)v39);
  v1->m_sock._m_hSocket = v17;
  if ( v17 == -1 )
  {
    v46 = WSAGetLastError();
    _CxxThrowException(&v46, &_TI1_AVZException__);
  }
  if ( v50.m_Data )
    v18 = v50.m_Data->m_wstr;
  else
    v18 = 0;
  v19 = alloca(dword_4A477C(0, 0, v18, -1, 0, 0, 0, 0));
  sAddr = (char *)&v40;
  if ( v49.m_Data )
    v20 = v49.m_Data->m_wstr;
  else
    v20 = 0;
  if ( v50.m_Data )
    v21 = v50.m_Data->m_wstr;
  else
    v21 = 0;
  dword_4A477C(0, 0, v21, -1, sAddr, 0x3FFFFFFF, 0, 0);
  v22 = _wtoi(v20);
  ZInetAddr::ZInetAddr((ZInetAddr *)&result, sAddr, v22);
  LOBYTE(v54) = 14;
  v24 = ZSocket::Connect(&v1->m_sock, v23, 16);
  LOBYTE(v54) = 13;
  if ( v24 == 0 )
  {
    LOBYTE(v54) = 12;
    CIPCheckerServer::Disconnect(v1);
    CVerboseObj::LogError((CVerboseObj *)&v1->vfptr, aFailedInConnec);
    if ( v49.m_Data )
    {
      _bstr_t::Data_t::Release(v49.m_Data);
      v49.m_Data = 0;
    }
    if ( v50.m_Data )
    {
      _bstr_t::Data_t::Release(v50.m_Data);
      v50.m_Data = 0;
    }
    LOBYTE(v54) = 0;
    if ( v51.m_pInterface )
    {
      v35 = v51.m_pInterface->vfptr;
      v39 = (ZSocketThread *)v51.m_pInterface;
      v35->Release((IUnknown *)v51.m_pInterface);
    }
    v54 = -1;
    if ( v48.m_pInterface )
    {
      v36 = v48.m_pInterface->vfptr;
      v39 = (ZSocketThread *)v48.m_pInterface;
      v36->Release((IUnknown *)v48.m_pInterface);
    }
    return 0;
  }
  ZSocketBase::SetNonBlocking((ZSocketBase *)&v1->m_sock._m_hSocket, 1);
  v39 = 0;
  v38 = (Ztl_variant_t *)35;
  v1->m_sock._m_pCallBack = (ZISocketCallBack *)v1;
  ZSocket::AttachThread(&v1->m_sock, (int)v38, v39);
  v39 = (ZSocketThread *)&v52;
  ZSocketBuffer::Alloc(0x5B4u);
  v26 = v39;
  v43.decVal.Mid32 = v25;
  if ( v25 )
  {
    InterlockedIncrement((volatile LONG *)(v25 + 4));
    v25 = v43.decVal.Mid32;
  }
  v27 = *(_WORD **)(v25 + 16);
  v39 = (ZSocketThread *)(v27 + 1);
  v38 = (Ztl_variant_t *)v26;
  v44 = &v38;
  LOBYTE(v54) = 15;
  get_cmdline_arg((ZXString<char> *)&v38, 1);
  v28 = (int)v27 + CIOBufferManipulator::EncodeStr((ZXString<char>)v38, (char *)v39) + 2;
  *(_DWORD *)v28 = v1->m_uSeqRcv;
  *(_DWORD *)(v28 + 4) = v1->m_uSeqSnd;
  v29 = v28 + 8;
  *v27 = v29 - (_WORD)v27 - 2;
  sAddr = (char *)v43.decVal.Mid32;
  v30 = (ZSocketBuffer *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x1Cu);
  v44 = v30;
  LOBYTE(v54) = 16;
  if ( v30 )
  {
    v39 = (ZSocketThread *)sAddr;
    ZSocketBuffer::ZSocketBuffer(v30, v29 - (_DWORD)v27, *((char **)sAddr + 4), (ZSocketBuffer *)sAddr);
  }
  else
  {
    v31 = 0;
  }
  result.decVal.Mid32 = v31;
  if ( v31 )
    InterlockedIncrement((volatile LONG *)(v31 + 4));
  LOBYTE(v54) = 17;
  ZList<ZRef<ZSocketBuffer>>::AddTail(&v1->m_lSendBuff, (ZRef<ZSocketBuffer> *)&result.boolVal);
  LOBYTE(v54) = 15;
  if ( result.decVal.Mid32 )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw((ZRef<ZSocketBuffer> *)&result.boolVal, 0);
    result.decVal.Mid32 = 0;
  }
  CIPCheckerServer::Flush(v1);
  v1->m_bConnected = 1;
  CVerboseObj::LogReport((CVerboseObj *)&v1->vfptr, aIpcheckerser_2);
  LOBYTE(v54) = 13;
  if ( v43.decVal.Mid32 )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw((ZRef<ZSocketBuffer> *)&v43.boolVal, 0);
    v43.decVal.Mid32 = 0;
  }
  if ( v49.m_Data )
  {
    _bstr_t::Data_t::Release(v49.m_Data);
    v49.m_Data = 0;
  }
  if ( v50.m_Data )
  {
    _bstr_t::Data_t::Release(v50.m_Data);
    v50.m_Data = 0;
  }
  LOBYTE(v54) = 0;
  if ( v51.m_pInterface )
  {
    v32 = v51.m_pInterface->vfptr;
    v39 = (ZSocketThread *)v51.m_pInterface;
    v32->Release((IUnknown *)v51.m_pInterface);
  }
  v54 = -1;
  if ( v48.m_pInterface )
  {
    v33 = v48.m_pInterface->vfptr;
    v39 = (ZSocketThread *)v48.m_pInterface;
    v33->Release((IUnknown *)v48.m_pInterface);
  }
  return 1;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A477C: using guessed type int (__stdcall *dword_4A477C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00419072) --------------------------------------------------------
void __thiscall CIPCheckerServer::SendPacket(CIPCheckerServer *this, COutPacket *oPacket)
{
  int v2; // ebp@0
  CIPCheckerServer *v3; // esi@1
  int v4; // eax@1
  unsigned int v5; // eax@3
  int v6; // [sp+0h] [bp-28h]@1
  ZCriticalSectionEx<4000> *v7; // [sp+10h] [bp-18h]@3
  CIPCheckerServer *v8; // [sp+14h] [bp-14h]@1
  int *v9; // [sp+18h] [bp-10h]@1
  int v10; // [sp+24h] [bp-4h]@3

  v3 = this;
  v4 = *(_DWORD *)(&this->m_sock != 0 ? (unsigned int)&this->m_sock._m_hSocket : 0);
  v9 = &v6;
  v8 = this;
  if ( v4 )
  {
    if ( v4 != -1 )
    {
      v10 = 0;
      v7 = &this->m_lockSend;
      EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo);
      LOBYTE(v10) = 1;
      COutPacket::MakeBufferList(oPacket, v2, &v3->m_lSendBuff, 0x14Bu, &v3->m_uSeqSnd, 0, 0);
      v5 = v3->m_uSeqSnd;
      LOBYTE(v10) = 0;
      v3->m_uSeqSnd = 214013 * v5 + 2531011;
      LeaveCriticalSection((LPCRITICAL_SECTION)&v3->m_lockSend.DebugInfo);
      CIPCheckerServer::Flush(v3);
    }
  }
}

//----- (00419104) --------------------------------------------------------
void *__usercall _L116645@<eax>(int a1@<ebp>)
{
  int v1; // esi@1

  v1 = *(_DWORD *)(a1 - 20);
  CVerboseObj::LogException((CVerboseObj *)(v1 + 4), *(ZException **)(a1 - 28));
  *(_DWORD *)(v1 + 52) = 0;
  return &_L109168;
}

//----- (0041911C) --------------------------------------------------------
void __thiscall CIPCheckerServer::Flush(CIPCheckerServer *this)
{
  CIPCheckerServer *v1; // esi@1
  int v2; // eax@1
  ZRef<ZSocketBuffer> *v3; // eax@4
  ZSocketBuffer *v4; // edi@5
  int v5; // eax@5
  int v6; // [sp+0h] [bp-28h]@1
  LPCRITICAL_SECTION lpCriticalSection; // [sp+10h] [bp-18h]@3
  CIPCheckerServer *v8; // [sp+14h] [bp-14h]@1
  int *v9; // [sp+18h] [bp-10h]@1
  int v10; // [sp+24h] [bp-4h]@3

  v1 = this;
  v2 = *(_DWORD *)(&this->m_sock != 0 ? (unsigned int)&this->m_sock._m_hSocket : 0);
  v9 = &v6;
  v8 = this;
  if ( v2 && v2 != -1 )
  {
    v10 = 0;
    lpCriticalSection = (LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo;
    EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockSend.DebugInfo);
    LOBYTE(v10) = 1;
    while ( 1 )
    {
      v3 = v1->m_lSendBuff._m_pHead;
      if ( !v3 )
        break;
      v4 = v3->p;
      v5 = ZSocket::Send(&v1->m_sock, &v4->buf[v1->m_uSent0], v4->len - v1->m_uSent0, 0);
      if ( !v5 )
        break;
      v1->m_uSent0 += v5;
      if ( v1->m_uSent0 >= v4->len )
      {
        ZList<ZRef<ZSocketBuffer>>::RemoveAt(&v1->m_lSendBuff, (__POSITION *)v1->m_lSendBuff._m_pHead);
        v1->m_uSent0 = 0;
      }
    }
    LeaveCriticalSection(lpCriticalSection);
  }
}

//----- (004191D2) --------------------------------------------------------
void __stdcall CIPCheckerServer::ProcessPacket(CInPacket *iPacket)
{
  if ( TSingleton<CLoginAcceptor>::ms_pInstance )
  {
    if ( !CInPacket::Decode1(iPacket) )
      CIPCheckerServer::LoopbackPacket(18, iPacket);
  }
}

//----- (004191FC) --------------------------------------------------------
void __stdcall CIPCheckerServer::LoopbackPacket(int nType, CInPacket *iPacket)
{
  unsigned int v3; // eax@1
  COutPacket oPacket; // [sp+4h] [bp-24h]@2
  ZRef<CClientSocket> result; // [sp+14h] [bp-14h]@1
  int v6; // [sp+24h] [bp-4h]@1

  v3 = CInPacket::Decode4(iPacket);
  CLoginAcceptor::GetSocket(TSingleton<CLoginAcceptor>::ms_pInstance, &result, v3);
  v6 = 0;
  if ( result.p )
  {
    COutPacket::COutPacket(&oPacket, nType, 1);
    LOBYTE(v6) = 1;
    CInPacket::CopyTo(iPacket, &oPacket);
    CClientSocket::SendPacket(result.p, &oPacket, 0);
    LOBYTE(v6) = 0;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
  }
  v6 = -1;
  if ( result.p )
    ZRef<CClientSocket>::_ReleaseRaw(&result, 0);
}

//----- (00419282) --------------------------------------------------------
void TSingleton<CIPCheckerServer>::~TSingleton<CIPCheckerServer>()
{
  TSingleton<CIPCheckerServer>::ms_pInstance = 0;
}
// 4A43DC: using guessed type int TSingleton<CIPCheckerServer>::ms_pInstance;

//----- (0041928A) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_Release(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this)
{
  if ( this->m_pInterface )
    this->m_pInterface->vfptr->Release((IUnknown *)this->m_pInterface);
}

//----- (00419297) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_AddRef(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *this)
{
  if ( this->m_pInterface )
    this->m_pInterface->vfptr->AddRef((IUnknown *)this->m_pInterface);
}

//----- (004192A4) --------------------------------------------------------
void _E42_2()
{
  _E35_5();
  _E36_5();
  _E37_4();
  _E38_1();
  _E39_3();
  _E40_2();
  _E41_2();
}

//----- (004192C7) --------------------------------------------------------
void _E35_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00419302) --------------------------------------------------------
void _E36_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (0041933D) --------------------------------------------------------
void _E37_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00419378) --------------------------------------------------------
void _E38_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (004193B3) --------------------------------------------------------
void _E39_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (004193EE) --------------------------------------------------------
void _E40_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (00419429) --------------------------------------------------------
void _E41_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00419464) --------------------------------------------------------
void _E61_0()
{
  _E53_2();
  _E54_2();
  _E55_2();
  _E56_2();
  _E57_1();
  _E58_1();
  _E59_0();
  _E60_0();
}

//----- (0041948C) --------------------------------------------------------
void _E53_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004194C7) --------------------------------------------------------
void _E54_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00419502) --------------------------------------------------------
void _E55_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0041953D) --------------------------------------------------------
void _E56_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00419578) --------------------------------------------------------
void _E57_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004195B3) --------------------------------------------------------
void _E58_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004195EE) --------------------------------------------------------
void _E59_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (00419629) --------------------------------------------------------
void _E60_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00419664) --------------------------------------------------------
void __thiscall ZSocketBase::CloseSocket(ZSocketBase *this)
{
  ZSocketBase *v1; // esi@1

  v1 = this;
  if ( this->_m_hSocket != -1 )
  {
    closesocket(this->_m_hSocket);
    v1->_m_hSocket = -1;
  }
}

//----- (0041967A) --------------------------------------------------------
BOOL __thiscall ZSocket::Connect(ZSocket *this, sockaddr *pAddr, int nAddr)
{
  return connect(*(_DWORD *)(this != 0 ? (unsigned int)&this->_m_hSocket : 0), pAddr, nAddr) != -1
      || WSAGetLastError() == 10035;
}

//----- (004196B2) --------------------------------------------------------
void __thiscall CIPFilter::CIPFilter(CIPFilter *this)
{
  CIPFilter *v1; // esi@1

  v1 = this;
  TSingleton<CIPFilter>::ms_pInstance = this;
  this->m_bIsReloadingIPList = 0;
  `eh vector constructor iterator'(
    this->m_aaIPList,
    4u,
    3,
    (int)ZArray<CIPRange>::ZArray<CIPRange>,
    (void (__thiscall *)(void *))ZArray<CIPRange>::~ZArray<CIPRange>);
  v1->m_bIPListLoaded = 0;
  `eh vector constructor iterator'(
    v1->m_aaGeoIPList,
    4u,
    3,
    (int)ZArray<CIPRange>::ZArray<CIPRange>,
    (void (__thiscall *)(void *))ZArray<CIPRange>::~ZArray<CIPRange>);
  v1->m_bGeoIPLoaded = 0;
  v1->m_dwMaxUnlimitedAccountID = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  CIPFilter::LoadIPList(v1);
  CIPFilter::LoadGeoIPList(v1);
}

//----- (00419737) --------------------------------------------------------
void __thiscall CIPFilter::AddIP(CIPFilter *this, unsigned int dwBlockType, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry)
{
  IWzProperty *v3; // eax@1
  Ztl_variant_t *v4; // eax@1
  int v5; // eax@1
  void *v6; // ecx@1
  IWzProperty *v7; // eax@3
  Ztl_variant_t *v8; // eax@3
  int v9; // eax@3
  char *v10; // eax@6
  bool v11; // al@9
  unsigned __int32 v12; // esi@12
  char *v13; // eax@14
  unsigned int v14; // eax@19
  CIPRange *v15; // eax@19
  IUnknownVtbl *v16; // ecx@24
  void *v17; // [sp-4h] [bp-4Ch]@1
  Ztl_variant_t v18; // [sp+Ch] [bp-3Ch]@3
  CIPFilter *v19; // [sp+1Ch] [bp-2Ch]@1
  unsigned int dwBegin; // [sp+20h] [bp-28h]@1
  Ztl_bstr_t v21; // [sp+24h] [bp-24h]@1
  Ztl_bstr_t v22; // [sp+28h] [bp-20h]@3
  Ztl_variant_t result; // [sp+2Ch] [bp-1Ch]@1
  int v24; // [sp+44h] [bp-4h]@1

  v19 = this;
  v17 = this;
  dwBegin = (unsigned int)&v17;
  v24 = 0;
  _bstr_t::_bstr_t((_bstr_t *)&v17, s);
  LOBYTE(v24) = 0;
  v3 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v4 = IWzProperty::Getitem(v3, &result, (Ztl_bstr_t)v17);
  LOBYTE(v24) = 2;
  DetachBSTR(&v21, (tagVARIANT *)&v4->0);
  LOBYTE(v24) = 4;
  v5 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v5 < 0 )
    _com_issue_error(v5);
  v17 = v6;
  dwBegin = (unsigned int)&v17;
  _bstr_t::_bstr_t((_bstr_t *)&v17, aMask);
  LOBYTE(v24) = 4;
  v7 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v8 = IWzProperty::Getitem(v7, &v18, (Ztl_bstr_t)v17);
  LOBYTE(v24) = 6;
  DetachBSTR(&v22, (tagVARIANT *)&v8->0);
  LOBYTE(v24) = 8;
  v9 = ZComAPI::ZComVariantClear((tagVARIANT *)&v18.0);
  if ( v9 < 0 )
    _com_issue_error(v9);
  if ( v21.m_Data )
    v10 = _bstr_t::Data_t::GetString(v21.m_Data);
  else
    v10 = 0;
  result.decVal.Mid32 = inet_addr(v10);
  if ( v22.m_Data )
    v11 = v22.m_Data->m_wstr == 0;
  else
    v11 = 1;
  if ( v11 )
  {
    v12 = -1;
  }
  else
  {
    if ( v22.m_Data )
      v13 = _bstr_t::Data_t::GetString(v22.m_Data);
    else
      v13 = 0;
    v12 = inet_addr(v13);
  }
  if ( result.decVal.Mid32 == -1 )
  {
    dwBlockType = -2147467259;
    _CxxThrowException(&dwBlockType, &_TI1_AVZException__);
  }
  dwBegin = ntohl(result.decVal.Mid32 & v12);
  v14 = ntohl(result.decVal.Mid32 | ~v12);
  result.llVal = 0i64;
  CIPRange::SetRange((CIPRange *)&result.boolVal, dwBegin, v14);
  v15 = ZArray<CIPRange>::InsertBefore(&v19->m_aaIPList[dwBlockType], -1);
  *v15 = *(CIPRange *)&result.boolVal;
  if ( v22.m_Data )
  {
    _bstr_t::Data_t::Release(v22.m_Data);
    v22.m_Data = 0;
  }
  if ( v21.m_Data )
  {
    _bstr_t::Data_t::Release(v21.m_Data);
    v21.m_Data = 0;
  }
  v24 = -1;
  if ( pEntry.m_pInterface )
  {
    v16 = pEntry.m_pInterface->vfptr;
    v17 = pEntry.m_pInterface;
    v16->Release((IUnknown *)pEntry.m_pInterface);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (004198DA) --------------------------------------------------------
void __thiscall CIPFilter::AddGeoIP(CIPFilter *this, unsigned int dwBlockType, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry)
{
  IWzProperty *v3; // eax@1
  Ztl_variant_t *v4; // eax@1
  int v5; // eax@1
  void *v6; // ecx@1
  IWzProperty *v7; // eax@3
  Ztl_variant_t *v8; // eax@3
  int v9; // eax@3
  char *v10; // eax@6
  char *v11; // eax@10
  char *v12; // eax@14
  unsigned __int32 v13; // eax@16
  char *v14; // eax@17
  unsigned __int32 v15; // eax@19
  unsigned int v16; // eax@19
  CIPRange *v17; // eax@19
  IUnknownVtbl *v18; // ecx@24
  void *v19; // [sp-4h] [bp-4Ch]@1
  Ztl_variant_t v20; // [sp+Ch] [bp-3Ch]@3
  Ztl_variant_t result; // [sp+1Ch] [bp-2Ch]@1
  CIPFilter *v22; // [sp+2Ch] [bp-1Ch]@1
  unsigned int dwBegin; // [sp+30h] [bp-18h]@1
  Ztl_bstr_t v24; // [sp+34h] [bp-14h]@1
  Ztl_bstr_t v25; // [sp+38h] [bp-10h]@3
  int v26; // [sp+44h] [bp-4h]@1

  v22 = this;
  v19 = this;
  dwBegin = (unsigned int)&v19;
  v26 = 0;
  _bstr_t::_bstr_t((_bstr_t *)&v19, aBeginip);
  LOBYTE(v26) = 0;
  v3 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v4 = IWzProperty::Getitem(v3, &result, (Ztl_bstr_t)v19);
  LOBYTE(v26) = 2;
  DetachBSTR(&v24, (tagVARIANT *)&v4->0);
  LOBYTE(v26) = 4;
  v5 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v5 < 0 )
    _com_issue_error(v5);
  v19 = v6;
  dwBegin = (unsigned int)&v19;
  _bstr_t::_bstr_t((_bstr_t *)&v19, aEndip);
  LOBYTE(v26) = 4;
  v7 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&pEntry);
  v8 = IWzProperty::Getitem(v7, &v20, (Ztl_bstr_t)v19);
  LOBYTE(v26) = 6;
  DetachBSTR(&v25, (tagVARIANT *)&v8->0);
  LOBYTE(v26) = 8;
  v9 = ZComAPI::ZComVariantClear((tagVARIANT *)&v20.0);
  if ( v9 < 0 )
    _com_issue_error(v9);
  if ( v24.m_Data )
    v10 = _bstr_t::Data_t::GetString(v24.m_Data);
  else
    v10 = 0;
  if ( inet_addr(v10) == -1
    || (!v25.m_Data ? (v11 = 0) : (v11 = _bstr_t::Data_t::GetString(v25.m_Data)), inet_addr(v11) == -1) )
  {
    dwBlockType = -2147467259;
    _CxxThrowException(&dwBlockType, &_TI1_AVZException__);
  }
  if ( v24.m_Data )
    v12 = _bstr_t::Data_t::GetString(v24.m_Data);
  else
    v12 = 0;
  v13 = inet_addr(v12);
  dwBegin = ntohl(v13);
  if ( v25.m_Data )
    v14 = _bstr_t::Data_t::GetString(v25.m_Data);
  else
    v14 = 0;
  v15 = inet_addr(v14);
  v16 = ntohl(v15);
  result.llVal = 0i64;
  CIPRange::SetRange((CIPRange *)&result.boolVal, dwBegin, v16);
  v17 = ZArray<CIPRange>::InsertBefore(&v22->m_aaGeoIPList[dwBlockType], -1);
  *v17 = *(CIPRange *)&result.boolVal;
  if ( v25.m_Data )
  {
    _bstr_t::Data_t::Release(v25.m_Data);
    v25.m_Data = 0;
  }
  if ( v24.m_Data )
  {
    _bstr_t::Data_t::Release(v24.m_Data);
    v24.m_Data = 0;
  }
  v26 = -1;
  if ( pEntry.m_pInterface )
  {
    v18 = pEntry.m_pInterface->vfptr;
    v19 = pEntry.m_pInterface;
    v18->Release((IUnknown *)pEntry.m_pInterface);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00419A85) --------------------------------------------------------
void __cdecl `anonymous namespace'::Merge(ZArray<CIPRange> *aIPList)
{
  ZArray<CIPRange> *v1; // ebx@1
  signed int i; // edi@3
  ZArray<CIPRange> v3; // eax@4
  unsigned int v4; // ecx@5
  unsigned int v5; // edx@8
  unsigned int v6; // esi@8
  int v7; // ecx@8
  int v8; // eax@8
  unsigned int v9; // eax@12
  unsigned int v10; // eax@14
  unsigned int idx; // [sp+Ch] [bp-4h]@3

  v1 = aIPList;
  if ( aIPList->a && aIPList->a[-1].m_dwEnd )
  {
    idx = 0;
    for ( i = 1; ; ++i )
    {
      while ( 1 )
      {
        v3.a = v1->a;
        if ( v1->a )
          v4 = v3.a[-1].m_dwEnd;
        else
          v4 = 0;
        if ( idx >= v4 - 1 )
          return;
        v5 = *((_DWORD *)&v3.a[i] - 1);
        v6 = v3.a[i].m_dwBegin;
        v7 = (int)&v3.a[i - 1];
        v8 = (int)&v3.a[i];
        if ( v5 < v6 )
          break;
LABEL_12:
        v9 = *(_DWORD *)(v8 + 4);
        if ( v9 >= v5 )
          v5 = v9;
        v10 = *(_DWORD *)v7;
        if ( v5 >= *(_DWORD *)v7 )
          v10 = v5;
        *(_DWORD *)(v7 + 4) = v10;
        ZArray<CIPRange>::RemoveAt(v1, (__POSITION *)&v1->a[i]);
      }
      if ( v5 + 1 == v6 )
      {
        v1 = aIPList;
        goto LABEL_12;
      }
      ++idx;
      v1 = aIPList;
    }
  }
}

//----- (00419B02) --------------------------------------------------------
void __thiscall CIPFilter::LoadIPList(CIPFilter *this)
{
  CIPFilter *v1; // ebx@1
  IWzResMan *v2; // esi@3
  int v3; // eax@3
  _bstr_t::Data_t *v4; // ecx@5
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v5; // eax@5
  IWzResMan *v6; // eax@5
  Ztl_variant_t *v7; // eax@5
  int v8; // eax@5
  int v9; // eax@8
  int v10; // eax@10
  int v11; // eax@12
  signed int v12; // esi@14
  Ztl_variant_t *v13; // ecx@15
  IWzProperty *v14; // eax@16
  Ztl_variant_t *v15; // eax@16
  int v16; // eax@17
  int v17; // eax@20
  int *v18; // ecx@20
  IWzProperty *v19; // eax@22
  Ztl_variant_t *v20; // eax@22
  int v21; // eax@22
  void *v22; // ecx@22
  IWzProperty *v23; // eax@24
  Ztl_variant_t *v24; // eax@24
  int v25; // eax@24
  Ztl_variant_t *v26; // ecx@24
  IWzProperty *v27; // eax@26
  Ztl_variant_t *v28; // eax@26
  int v29; // eax@27
  int v30; // eax@30
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *v31; // eax@34
  IUnknownVtbl *v32; // ecx@35
  IUnknownVtbl *v33; // ecx@39
  int *v34; // ecx@40
  IWzProperty *v35; // eax@40
  Ztl_variant_t *v36; // eax@40
  int v37; // eax@41
  int v38; // eax@44
  unsigned __int16 *v39; // eax@47
  unsigned __int16 *v40; // eax@49
  void *v41; // ecx@49
  IWzProperty *v42; // eax@49
  Ztl_variant_t *v43; // eax@49
  unsigned int v44; // esi@49
  int v45; // eax@49
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *v46; // eax@53
  IUnknownVtbl *v47; // ecx@54
  IUnknownVtbl *v48; // ecx@58
  Ztl_variant_t *v49; // ecx@58
  IWzProperty *v50; // eax@59
  Ztl_variant_t *v51; // eax@59
  int v52; // eax@60
  int v53; // eax@63
  IUnknownVtbl *v54; // ecx@68
  IUnknownVtbl *v55; // ecx@70
  CIPRange *v56; // eax@71
  ZArray<CIPRange> *v57; // esi@71
  unsigned int v58; // ecx@72
  IUnknownVtbl *v59; // ecx@75
  IUnknownVtbl *v60; // ecx@77
  IUnknownVtbl *v61; // ecx@81
  int v62; // eax@82
  IUnknownVtbl *v63; // ecx@85
  IUnknownVtbl *v64; // ecx@87
  IWzProperty *v65; // eax@88
  bool v66; // zf@88
  IUnknownVtbl *v67; // ecx@89
  Ztl_bstr_t v68; // [sp-14h] [bp-D8h]@5
  Ztl_variant_t *v69; // [sp-10h] [bp-D4h]@5
  Ztl_variant_t *v70; // [sp-Ch] [bp-D0h]@5
  void *v71; // [sp-8h] [bp-CCh]@5
  int *v72; // [sp-4h] [bp-C8h]@5
  int v73; // [sp+0h] [bp-C4h]@1
  Ztl_variant_t v74; // [sp+Ch] [bp-B8h]@59
  Ztl_variant_t v75; // [sp+1Ch] [bp-A8h]@40
  Ztl_variant_t v76; // [sp+2Ch] [bp-98h]@49
  Ztl_variant_t result; // [sp+3Ch] [bp-88h]@5
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > v78; // [sp+4Ch] [bp-78h]@34
  int v79; // [sp+50h] [bp-74h]@40
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > v80; // [sp+54h] [bp-70h]@53
  int v81; // [sp+58h] [bp-6Ch]@16
  int v82; // [sp+5Ch] [bp-68h]@26
  _variant_t v83; // [sp+60h] [bp-64h]@5
  _variant_t v84; // [sp+70h] [bp-54h]@5
  LPCRITICAL_SECTION lpCriticalSection; // [sp+80h] [bp-44h]@5
  int v86; // [sp+84h] [bp-40h]@36
  void **v87; // [sp+88h] [bp-3Ch]@40
  ZXString<unsigned short> v88; // [sp+8Ch] [bp-38h]@46
  _com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > v89; // [sp+90h] [bp-34h]@53
  Ztl_bstr_t __that; // [sp+94h] [bp-30h]@40
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry; // [sp+98h] [bp-2Ch]@59
  _com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > v92; // [sp+9Ch] [bp-28h]@5
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v93; // [sp+A0h] [bp-24h]@16
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v94; // [sp+A4h] [bp-20h]@26
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v95; // [sp+A8h] [bp-1Ch]@40
  int v96; // [sp+ACh] [bp-18h]@16
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v97; // [sp+B0h] [bp-14h]@1
  int *v98; // [sp+B4h] [bp-10h]@1
  int v99; // [sp+C0h] [bp-4h]@1

  v98 = &v73;
  v1 = this;
  v97.m_pInterface = 0;
  v99 = 0;
  LOBYTE(v99) = 1;
  if ( !g_rm.m_pInterface )
    _com_issue_error(-2147467261);
  v2 = g_rm.m_pInterface;
  v3 = ((int (__stdcall *)(IWzResMan *, _DWORD))g_rm.m_pInterface->vfptr[3].QueryInterface)(g_rm.m_pInterface, 0);
  if ( v3 < 0 )
    _com_issue_errorex(v3, (IUnknown *)&v2->vfptr, &_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf);
  _variant_t::_variant_t(&v84, &vtMissing);
  LOBYTE(v99) = 2;
  _variant_t::_variant_t(&v83, &vtMissing);
  v72 = 0;
  v71 = 0;
  v70 = (Ztl_variant_t *)&v84;
  v69 = (Ztl_variant_t *)&v83;
  v68.m_Data = v4;
  lpCriticalSection = (LPCRITICAL_SECTION)&v68;
  LOBYTE(v99) = 3;
  Ztl_bstr_t::Ztl_bstr_t(&v68, aIplist_img);
  LOBYTE(v99) = 4;
  v5 = get_rm();
  v6 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v5);
  LOBYTE(v99) = 3;
  v7 = IWzResMan::GetObjectA(v6, &result, v68, v69, v70);
  LOBYTE(v99) = 5;
  v92.m_pInterface = (IEnumVARIANT *)Ztl_variant_t::GetUnknown(v7, (char)v71, (char)v72);
  v8 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
         &v97,
         (int)&v92);
  if ( v8 < 0 && v8 != -2147467262 )
    _com_issue_error(v8);
  LOBYTE(v99) = 3;
  v9 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v9 < 0 )
    _com_issue_error(v9);
  LOBYTE(v99) = 2;
  v10 = ZComAPI::ZComVariantClear((tagVARIANT *)&v83.0);
  if ( v10 < 0 )
    _com_issue_error(v10);
  LOBYTE(v99) = 1;
  v11 = ZComAPI::ZComVariantClear((tagVARIANT *)&v84.0);
  if ( v11 < 0 )
    _com_issue_error(v11);
  v99 = 0;
  lpCriticalSection = (LPCRITICAL_SECTION)&v1->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  LOBYTE(v99) = 7;
  v12 = 0;
  do
    ZArray<CIPRange>::RemoveAll((ZArray<CIPRange> *)v1 + ++v12);
  while ( v12 < 3 );
  v72 = 0;
  v71 = 0;
  v70 = v13;
  v96 = (int)&v70;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v70, aInfo);
  v69 = &result;
  LOBYTE(v99) = 7;
  v14 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v97);
  v15 = IWzProperty::Getitem(v14, v69, (Ztl_bstr_t)v70);
  LOBYTE(v99) = 9;
  v81 = (int)Ztl_variant_t::GetUnknown(v15, (char)v71, (char)v72);
  v93.m_pInterface = 0;
  if ( v81 )
  {
    v16 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
            &v93,
            (int)&v81);
    if ( v16 < 0 && v16 != -2147467262 )
      _com_issue_error(v16);
  }
  LOBYTE(v99) = 11;
  v17 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  v18 = v72;
  if ( v17 < 0 )
    _com_issue_error(v17);
  v72 = 0;
  v71 = v18;
  v96 = (int)&v71;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v71, aBblocktypeever);
  v70 = (Ztl_variant_t *)&v84;
  LOBYTE(v99) = 11;
  v19 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v93);
  v20 = IWzProperty::Getitem(v19, v70, (Ztl_bstr_t)v71);
  LOBYTE(v99) = 13;
  v1->m_dwBlockTypeEverywhere = get_int32(v20, (int)v72);
  LOBYTE(v99) = 11;
  v21 = ZComAPI::ZComVariantClear((tagVARIANT *)&v84.0);
  if ( v21 < 0 )
    _com_issue_error(v21);
  v72 = 0;
  v71 = v22;
  v96 = (int)&v71;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v71, aDwmaxunlimited);
  v70 = (Ztl_variant_t *)&v84;
  LOBYTE(v99) = 11;
  v23 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v93);
  v24 = IWzProperty::Getitem(v23, v70, (Ztl_bstr_t)v71);
  LOBYTE(v99) = 15;
  v1->m_dwMaxUnlimitedAccountID = get_int32(v24, (int)v72);
  LOBYTE(v99) = 11;
  v25 = ZComAPI::ZComVariantClear((tagVARIANT *)&v84.0);
  if ( v25 < 0 )
    _com_issue_error(v25);
  v72 = 0;
  v71 = 0;
  v70 = v26;
  v96 = (int)&v70;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v70, aData);
  v69 = (Ztl_variant_t *)&v84;
  LOBYTE(v99) = 11;
  v27 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v97);
  v28 = IWzProperty::Getitem(v27, v69, (Ztl_bstr_t)v70);
  LOBYTE(v99) = 17;
  v82 = (int)Ztl_variant_t::GetUnknown(v28, (char)v71, (char)v72);
  v94.m_pInterface = 0;
  if ( v82 )
  {
    v29 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
            &v94,
            (int)&v82);
    if ( v29 < 0 && v29 != -2147467262 )
      _com_issue_error(v29);
  }
  LOBYTE(v99) = 19;
  v30 = ZComAPI::ZComVariantClear((tagVARIANT *)&v84.0);
  if ( v30 < 0 )
    _com_issue_error(v30);
  VariantInit((VARIANTARG *)&v83.0);
  LOBYTE(v99) = 20;
  if ( !v94.m_pInterface )
    _com_issue_error(-2147467261);
  v31 = IWzProperty::Get_NewEnum(v94.m_pInterface, &v78);
  LOBYTE(v99) = 21;
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(
    &v92,
    v31);
  LOBYTE(v99) = 23;
  if ( v78.m_pInterface )
  {
    v32 = v78.m_pInterface->vfptr;
    v72 = (int *)v78.m_pInterface;
    v32->Release(v78.m_pInterface);
  }
  v86 = 0;
  while ( 1 )
  {
    if ( !v92.m_pInterface )
      _com_issue_error(-2147467261);
    v33 = v92.m_pInterface->vfptr;
    v72 = &v86;
    v71 = &v83;
    v70 = (Ztl_variant_t *)1;
    v69 = (Ztl_variant_t *)v92.m_pInterface;
    if ( ((int (__stdcall *)(IEnumVARIANT *, signed int, _variant_t *, int *))v33[1].QueryInterface)(
           v92.m_pInterface,
           1,
           &v83,
           &v86) )
    {
      break;
    }
    DetachBSTR(&__that, (tagVARIANT *)&v83.0);
    v34 = v72;
    v72 = 0;
    v71 = 0;
    v70 = (Ztl_variant_t *)v34;
    v87 = (void **)&v70;
    LOBYTE(v99) = 24;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v70, &__that);
    v69 = &v75;
    LOBYTE(v99) = 24;
    v35 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v94);
    v36 = IWzProperty::Getitem(v35, v69, (Ztl_bstr_t)v70);
    LOBYTE(v99) = 26;
    v79 = (int)Ztl_variant_t::GetUnknown(v36, (char)v71, (char)v72);
    v95.m_pInterface = 0;
    if ( v79 )
    {
      v37 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v95,
              (int)&v79);
      if ( v37 < 0 && v37 != -2147467262 )
        _com_issue_error(v37);
    }
    LOBYTE(v99) = 28;
    v38 = ZComAPI::ZComVariantClear((tagVARIANT *)&v75.0);
    if ( v38 < 0 )
      _com_issue_error(v38);
    v88._m_pStr = 0;
    LOBYTE(v99) = 29;
    if ( __that.m_Data )
      v39 = __that.m_Data->m_wstr;
    else
      v39 = 0;
    v72 = (int *)v39;
    ZXString<unsigned short>::Format(&v88, aBlockS, v39);
    v72 = 0;
    v40 = ZXString<unsigned short>::operator unsigned short const *(&v88);
    v71 = v41;
    v87 = &v71;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v71, v40);
    v70 = &v76;
    LOBYTE(v99) = 29;
    v42 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v93);
    v43 = IWzProperty::Getitem(v42, v70, (Ztl_bstr_t)v71);
    LOBYTE(v99) = 31;
    v44 = get_int32(v43, (int)v72);
    LOBYTE(v99) = 29;
    v45 = ZComAPI::ZComVariantClear((tagVARIANT *)&v76.0);
    if ( v45 < 0 )
      _com_issue_error(v45);
    if ( !v95.m_pInterface )
      _com_issue_error(-2147467261);
    v46 = IWzProperty::Get_NewEnum(v95.m_pInterface, &v80);
    LOBYTE(v99) = 32;
    _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(
      &v89,
      v46);
    LOBYTE(v99) = 34;
    if ( v80.m_pInterface )
    {
      v47 = v80.m_pInterface->vfptr;
      v72 = (int *)v80.m_pInterface;
      v47->Release(v80.m_pInterface);
    }
    v86 = 0;
    while ( 1 )
    {
      if ( !v89.m_pInterface )
        _com_issue_error(-2147467261);
      v48 = v89.m_pInterface->vfptr;
      v72 = &v86;
      v71 = &v83;
      v70 = (Ztl_variant_t *)1;
      v69 = (Ztl_variant_t *)v89.m_pInterface;
      if ( ((int (__stdcall *)(IEnumVARIANT *, signed int, _variant_t *, int *))v48[1].QueryInterface)(
             v89.m_pInterface,
             1,
             &v83,
             &v86) )
      {
        break;
      }
      v72 = 0;
      v71 = 0;
      v70 = v49;
      v87 = (void **)&v70;
      DetachBSTR((Ztl_bstr_t *)&v70, (tagVARIANT *)&v83.0);
      v69 = &v74;
      LOBYTE(v99) = 34;
      v50 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v95);
      v51 = IWzProperty::Getitem(v50, v69, (Ztl_bstr_t)v70);
      LOBYTE(v99) = 36;
      v96 = (int)Ztl_variant_t::GetUnknown(v51, (char)v71, (char)v72);
      pEntry.m_pInterface = 0;
      if ( v96 )
      {
        v52 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
                &pEntry,
                (int)&v96);
        if ( v52 < 0 && v52 != -2147467262 )
          _com_issue_error(v52);
      }
      LOBYTE(v99) = 38;
      v53 = ZComAPI::ZComVariantClear((tagVARIANT *)&v74.0);
      if ( v53 < 0 )
        _com_issue_error(v53);
      if ( pEntry.m_pInterface )
      {
        v72 = (int *)pEntry.m_pInterface;
        v87 = (void **)&v72;
        if ( pEntry.m_pInterface )
        {
          v54 = pEntry.m_pInterface->vfptr;
          v71 = pEntry.m_pInterface;
          v54->AddRef((IUnknown *)pEntry.m_pInterface);
        }
        CIPFilter::AddIP(v1, v44, (_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> >)v72);
        LOBYTE(v99) = 34;
        if ( pEntry.m_pInterface )
        {
          v55 = pEntry.m_pInterface->vfptr;
          v72 = (int *)pEntry.m_pInterface;
          v55->Release((IUnknown *)pEntry.m_pInterface);
        }
      }
      else
      {
        LOBYTE(v99) = 34;
      }
    }
    v56 = v1->m_aaIPList[v44].a;
    v57 = &v1->m_aaIPList[v44];
    if ( v56 )
      v58 = v56[-1].m_dwEnd;
    else
      v58 = 0;
    v72 = 0;
    std::_Sort_0(v56, &v56[v58]);
    `anonymous namespace'::Merge(v57);
    LOBYTE(v99) = 29;
    if ( v89.m_pInterface )
    {
      v59 = v89.m_pInterface->vfptr;
      v72 = (int *)v89.m_pInterface;
      v59->Release((IUnknown *)v89.m_pInterface);
    }
    LOBYTE(v99) = 28;
    ZXString<unsigned short>::~ZXString<unsigned short>(&v88);
    LOBYTE(v99) = 24;
    if ( v95.m_pInterface )
    {
      v60 = v95.m_pInterface->vfptr;
      v72 = (int *)v95.m_pInterface;
      v60->Release((IUnknown *)v95.m_pInterface);
    }
    LOBYTE(v99) = 23;
    if ( __that.m_Data )
    {
      _bstr_t::Data_t::Release(__that.m_Data);
      __that.m_Data = 0;
    }
  }
  LOBYTE(v99) = 20;
  if ( v92.m_pInterface )
  {
    v61 = v92.m_pInterface->vfptr;
    v72 = (int *)v92.m_pInterface;
    v61->Release((IUnknown *)v92.m_pInterface);
  }
  LOBYTE(v99) = 19;
  v62 = ZComAPI::ZComVariantClear((tagVARIANT *)&v83.0);
  if ( v62 < 0 )
    _com_issue_error(v62);
  LOBYTE(v99) = 11;
  if ( v94.m_pInterface )
  {
    v63 = v94.m_pInterface->vfptr;
    v72 = (int *)v94.m_pInterface;
    v63->Release((IUnknown *)v94.m_pInterface);
  }
  LOBYTE(v99) = 7;
  if ( v93.m_pInterface )
  {
    v64 = v93.m_pInterface->vfptr;
    v72 = (int *)v93.m_pInterface;
    v64->Release((IUnknown *)v93.m_pInterface);
  }
  LeaveCriticalSection(lpCriticalSection);
  v65 = v97.m_pInterface;
  v99 = -1;
  v66 = v97.m_pInterface == 0;
  v1->m_bIPListLoaded = 1;
  if ( !v66 )
  {
    v67 = v65->vfptr;
    v72 = (int *)v65;
    v67->Release((IUnknown *)v65);
  }
}

//----- (0041A180) --------------------------------------------------------
void __thiscall CIPFilter::LoadGeoIPList(CIPFilter *this)
{
  CIPFilter *v1; // ebx@1
  IWzResMan *v2; // esi@3
  int v3; // eax@3
  _bstr_t::Data_t *v4; // ecx@5
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v5; // eax@5
  IWzResMan *v6; // eax@5
  Ztl_variant_t *v7; // eax@5
  int v8; // eax@5
  int v9; // eax@8
  int v10; // eax@10
  int v11; // eax@12
  signed int v12; // esi@14
  Ztl_variant_t *v13; // ecx@15
  IWzProperty *v14; // eax@16
  Ztl_variant_t *v15; // eax@16
  int v16; // eax@17
  int v17; // eax@20
  int *v18; // ecx@20
  IWzProperty *v19; // eax@22
  Ztl_variant_t *v20; // eax@22
  int v21; // eax@22
  Ztl_variant_t *v22; // ecx@22
  IWzProperty *v23; // eax@24
  Ztl_variant_t *v24; // eax@24
  int v25; // eax@25
  int v26; // eax@28
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *v27; // eax@32
  IUnknownVtbl *v28; // ecx@35
  int *v29; // ecx@36
  IWzProperty *v30; // eax@36
  Ztl_variant_t *v31; // eax@36
  int v32; // eax@37
  int v33; // eax@40
  unsigned __int16 *v34; // eax@43
  unsigned __int16 *v35; // eax@45
  void *v36; // ecx@45
  IWzProperty *v37; // eax@45
  Ztl_variant_t *v38; // eax@45
  unsigned int v39; // esi@45
  int v40; // eax@45
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *v41; // eax@49
  IUnknownVtbl *v42; // ecx@50
  IUnknownVtbl *v43; // ecx@54
  Ztl_variant_t *v44; // ecx@54
  IWzProperty *v45; // eax@55
  Ztl_variant_t *v46; // eax@55
  int v47; // eax@56
  int v48; // eax@59
  IUnknownVtbl *v49; // ecx@64
  IUnknownVtbl *v50; // ecx@66
  CIPRange *v51; // eax@67
  ZArray<CIPRange> *v52; // esi@67
  unsigned int v53; // ecx@68
  IUnknownVtbl *v54; // ecx@71
  IUnknownVtbl *v55; // ecx@73
  IUnknownVtbl *v56; // ecx@77
  int v57; // eax@78
  IUnknownVtbl *v58; // ecx@81
  IUnknownVtbl *v59; // ecx@83
  IWzProperty *v60; // eax@84
  bool v61; // zf@84
  IUnknownVtbl *v62; // ecx@85
  Ztl_bstr_t v63; // [sp-14h] [bp-D8h]@5
  Ztl_variant_t *v64; // [sp-10h] [bp-D4h]@5
  Ztl_variant_t *v65; // [sp-Ch] [bp-D0h]@5
  void *v66; // [sp-8h] [bp-CCh]@5
  int *v67; // [sp-4h] [bp-C8h]@5
  int v68; // [sp+0h] [bp-C4h]@1
  Ztl_variant_t v69; // [sp+Ch] [bp-B8h]@55
  Ztl_variant_t v70; // [sp+1Ch] [bp-A8h]@45
  Ztl_variant_t v71; // [sp+2Ch] [bp-98h]@36
  Ztl_variant_t result; // [sp+3Ch] [bp-88h]@5
  _variant_t v73; // [sp+4Ch] [bp-78h]@5
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > v74; // [sp+5Ch] [bp-68h]@49
  int v75; // [sp+60h] [bp-64h]@16
  int v76; // [sp+64h] [bp-60h]@36
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > v77; // [sp+68h] [bp-5Ch]@32
  int v78; // [sp+6Ch] [bp-58h]@24
  _variant_t v79; // [sp+70h] [bp-54h]@5
  LPCRITICAL_SECTION lpCriticalSection; // [sp+80h] [bp-44h]@5
  void **v81; // [sp+84h] [bp-40h]@36
  _com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > v82; // [sp+88h] [bp-3Ch]@49
  ZXString<unsigned short> v83; // [sp+8Ch] [bp-38h]@42
  int v84; // [sp+90h] [bp-34h]@32
  Ztl_bstr_t __that; // [sp+94h] [bp-30h]@36
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v86; // [sp+98h] [bp-2Ch]@16
  int v87; // [sp+9Ch] [bp-28h]@16
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry; // [sp+A0h] [bp-24h]@55
  _com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > v89; // [sp+A4h] [bp-20h]@5
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v90; // [sp+A8h] [bp-1Ch]@36
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v91; // [sp+ACh] [bp-18h]@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v92; // [sp+B0h] [bp-14h]@24
  int *v93; // [sp+B4h] [bp-10h]@1
  int v94; // [sp+C0h] [bp-4h]@1

  v93 = &v68;
  v1 = this;
  v91.m_pInterface = 0;
  v94 = 0;
  LOBYTE(v94) = 1;
  if ( !g_rm.m_pInterface )
    _com_issue_error(-2147467261);
  v2 = g_rm.m_pInterface;
  v3 = ((int (__stdcall *)(IWzResMan *, _DWORD))g_rm.m_pInterface->vfptr[3].QueryInterface)(g_rm.m_pInterface, 0);
  if ( v3 < 0 )
    _com_issue_errorex(v3, (IUnknown *)&v2->vfptr, &_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf);
  _variant_t::_variant_t(&v73, &vtMissing);
  LOBYTE(v94) = 2;
  _variant_t::_variant_t(&v79, &vtMissing);
  v67 = 0;
  v66 = 0;
  v65 = (Ztl_variant_t *)&v73;
  v64 = (Ztl_variant_t *)&v79;
  v63.m_Data = v4;
  lpCriticalSection = (LPCRITICAL_SECTION)&v63;
  LOBYTE(v94) = 3;
  Ztl_bstr_t::Ztl_bstr_t(&v63, aGeoiplist_img);
  LOBYTE(v94) = 4;
  v5 = get_rm();
  v6 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v5);
  LOBYTE(v94) = 3;
  v7 = IWzResMan::GetObjectA(v6, &result, v63, v64, v65);
  LOBYTE(v94) = 5;
  v89.m_pInterface = (IEnumVARIANT *)Ztl_variant_t::GetUnknown(v7, (char)v66, (char)v67);
  v8 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
         &v91,
         (int)&v89);
  if ( v8 < 0 && v8 != -2147467262 )
    _com_issue_error(v8);
  LOBYTE(v94) = 3;
  v9 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v9 < 0 )
    _com_issue_error(v9);
  LOBYTE(v94) = 2;
  v10 = ZComAPI::ZComVariantClear((tagVARIANT *)&v79.0);
  if ( v10 < 0 )
    _com_issue_error(v10);
  LOBYTE(v94) = 1;
  v11 = ZComAPI::ZComVariantClear((tagVARIANT *)&v73.0);
  if ( v11 < 0 )
    _com_issue_error(v11);
  v94 = 0;
  lpCriticalSection = (LPCRITICAL_SECTION)&v1->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  LOBYTE(v94) = 7;
  v12 = 0;
  do
    ZArray<CIPRange>::RemoveAll(&v1->m_aaGeoIPList[v12++]);
  while ( v12 < 3 );
  v67 = 0;
  v66 = 0;
  v65 = v13;
  v87 = (int)&v65;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v65, aInfo);
  v64 = &result;
  LOBYTE(v94) = 7;
  v14 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v91);
  v15 = IWzProperty::Getitem(v14, v64, (Ztl_bstr_t)v65);
  LOBYTE(v94) = 9;
  v75 = (int)Ztl_variant_t::GetUnknown(v15, (char)v66, (char)v67);
  v86.m_pInterface = 0;
  if ( v75 )
  {
    v16 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
            &v86,
            (int)&v75);
    if ( v16 < 0 && v16 != -2147467262 )
      _com_issue_error(v16);
  }
  LOBYTE(v94) = 11;
  v17 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  v18 = v67;
  if ( v17 < 0 )
    _com_issue_error(v17);
  v67 = 0;
  v66 = v18;
  v87 = (int)&v66;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v66, aBblocktypeever);
  v65 = (Ztl_variant_t *)&v73;
  LOBYTE(v94) = 11;
  v19 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v86);
  v20 = IWzProperty::Getitem(v19, v65, (Ztl_bstr_t)v66);
  LOBYTE(v94) = 13;
  v1->m_dwBlockTypeEverywhereGeoIP = get_int32(v20, (int)v67);
  LOBYTE(v94) = 11;
  v21 = ZComAPI::ZComVariantClear((tagVARIANT *)&v73.0);
  if ( v21 < 0 )
    _com_issue_error(v21);
  v67 = 0;
  v66 = 0;
  v65 = v22;
  v87 = (int)&v65;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v65, aData);
  v64 = (Ztl_variant_t *)&v73;
  LOBYTE(v94) = 11;
  v23 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v91);
  v24 = IWzProperty::Getitem(v23, v64, (Ztl_bstr_t)v65);
  LOBYTE(v94) = 15;
  v78 = (int)Ztl_variant_t::GetUnknown(v24, (char)v66, (char)v67);
  v92.m_pInterface = 0;
  if ( v78 )
  {
    v25 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
            &v92,
            (int)&v78);
    if ( v25 < 0 && v25 != -2147467262 )
      _com_issue_error(v25);
  }
  LOBYTE(v94) = 17;
  v26 = ZComAPI::ZComVariantClear((tagVARIANT *)&v73.0);
  if ( v26 < 0 )
    _com_issue_error(v26);
  VariantInit((VARIANTARG *)&v79.0);
  LOBYTE(v94) = 18;
  if ( !v92.m_pInterface )
    _com_issue_error(-2147467261);
  v27 = IWzProperty::Get_NewEnum(v92.m_pInterface, &v77);
  LOBYTE(v94) = 19;
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(
    &v89,
    v27);
  LOBYTE(v94) = 21;
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::_Release(&v77);
  v84 = 0;
  while ( 1 )
  {
    if ( !v89.m_pInterface )
      _com_issue_error(-2147467261);
    v28 = v89.m_pInterface->vfptr;
    v67 = &v84;
    v66 = &v79;
    v65 = (Ztl_variant_t *)1;
    v64 = (Ztl_variant_t *)v89.m_pInterface;
    if ( ((int (__stdcall *)(IEnumVARIANT *, signed int, _variant_t *, int *))v28[1].QueryInterface)(
           v89.m_pInterface,
           1,
           &v79,
           &v84) )
    {
      break;
    }
    DetachBSTR(&__that, (tagVARIANT *)&v79.0);
    v29 = v67;
    v67 = 0;
    v66 = 0;
    v65 = (Ztl_variant_t *)v29;
    v81 = (void **)&v65;
    LOBYTE(v94) = 22;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v65, &__that);
    v64 = &v71;
    LOBYTE(v94) = 22;
    v30 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v92);
    v31 = IWzProperty::Getitem(v30, v64, (Ztl_bstr_t)v65);
    LOBYTE(v94) = 24;
    v76 = (int)Ztl_variant_t::GetUnknown(v31, (char)v66, (char)v67);
    v90.m_pInterface = 0;
    if ( v76 )
    {
      v32 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v90,
              (int)&v76);
      if ( v32 < 0 && v32 != -2147467262 )
        _com_issue_error(v32);
    }
    LOBYTE(v94) = 26;
    v33 = ZComAPI::ZComVariantClear((tagVARIANT *)&v71.0);
    if ( v33 < 0 )
      _com_issue_error(v33);
    v83._m_pStr = 0;
    LOBYTE(v94) = 27;
    if ( __that.m_Data )
      v34 = __that.m_Data->m_wstr;
    else
      v34 = 0;
    v67 = (int *)v34;
    ZXString<unsigned short>::Format(&v83, aBlockS, v34);
    v67 = 0;
    v35 = ZXString<unsigned short>::operator unsigned short const *(&v83);
    v66 = v36;
    v81 = &v66;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v66, v35);
    v65 = &v70;
    LOBYTE(v94) = 27;
    v37 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v86);
    v38 = IWzProperty::Getitem(v37, v65, (Ztl_bstr_t)v66);
    LOBYTE(v94) = 29;
    v39 = get_int32(v38, (int)v67);
    LOBYTE(v94) = 27;
    v40 = ZComAPI::ZComVariantClear((tagVARIANT *)&v70.0);
    if ( v40 < 0 )
      _com_issue_error(v40);
    if ( !v90.m_pInterface )
      _com_issue_error(-2147467261);
    v41 = IWzProperty::Get_NewEnum(v90.m_pInterface, &v74);
    LOBYTE(v94) = 30;
    _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(
      &v82,
      v41);
    LOBYTE(v94) = 32;
    if ( v74.m_pInterface )
    {
      v42 = v74.m_pInterface->vfptr;
      v67 = (int *)v74.m_pInterface;
      v42->Release(v74.m_pInterface);
    }
    v84 = 0;
    while ( 1 )
    {
      if ( !v82.m_pInterface )
        _com_issue_error(-2147467261);
      v43 = v82.m_pInterface->vfptr;
      v67 = &v84;
      v66 = &v79;
      v65 = (Ztl_variant_t *)1;
      v64 = (Ztl_variant_t *)v82.m_pInterface;
      if ( ((int (__stdcall *)(IEnumVARIANT *, signed int, _variant_t *, int *))v43[1].QueryInterface)(
             v82.m_pInterface,
             1,
             &v79,
             &v84) )
      {
        break;
      }
      v67 = 0;
      v66 = 0;
      v65 = v44;
      v81 = (void **)&v65;
      DetachBSTR((Ztl_bstr_t *)&v65, (tagVARIANT *)&v79.0);
      v64 = &v69;
      LOBYTE(v94) = 32;
      v45 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v90);
      v46 = IWzProperty::Getitem(v45, v64, (Ztl_bstr_t)v65);
      LOBYTE(v94) = 34;
      v87 = (int)Ztl_variant_t::GetUnknown(v46, (char)v66, (char)v67);
      pEntry.m_pInterface = 0;
      if ( v87 )
      {
        v47 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
                &pEntry,
                (int)&v87);
        if ( v47 < 0 && v47 != -2147467262 )
          _com_issue_error(v47);
      }
      LOBYTE(v94) = 36;
      v48 = ZComAPI::ZComVariantClear((tagVARIANT *)&v69.0);
      if ( v48 < 0 )
        _com_issue_error(v48);
      if ( pEntry.m_pInterface )
      {
        v67 = (int *)pEntry.m_pInterface;
        v81 = (void **)&v67;
        if ( pEntry.m_pInterface )
        {
          v49 = pEntry.m_pInterface->vfptr;
          v66 = pEntry.m_pInterface;
          v49->AddRef((IUnknown *)pEntry.m_pInterface);
        }
        CIPFilter::AddGeoIP(
          v1,
          v39,
          (_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> >)v67);
        LOBYTE(v94) = 32;
        if ( pEntry.m_pInterface )
        {
          v50 = pEntry.m_pInterface->vfptr;
          v67 = (int *)pEntry.m_pInterface;
          v50->Release((IUnknown *)pEntry.m_pInterface);
        }
      }
      else
      {
        LOBYTE(v94) = 32;
      }
    }
    v51 = v1->m_aaGeoIPList[v39].a;
    v52 = &v1->m_aaGeoIPList[v39];
    if ( v51 )
      v53 = v51[-1].m_dwEnd;
    else
      v53 = 0;
    v67 = 0;
    std::_Sort_0(v51, &v51[v53]);
    `anonymous namespace'::Merge(v52);
    LOBYTE(v94) = 27;
    if ( v82.m_pInterface )
    {
      v54 = v82.m_pInterface->vfptr;
      v67 = (int *)v82.m_pInterface;
      v54->Release((IUnknown *)v82.m_pInterface);
    }
    LOBYTE(v94) = 26;
    ZXString<unsigned short>::~ZXString<unsigned short>(&v83);
    LOBYTE(v94) = 22;
    if ( v90.m_pInterface )
    {
      v55 = v90.m_pInterface->vfptr;
      v67 = (int *)v90.m_pInterface;
      v55->Release((IUnknown *)v90.m_pInterface);
    }
    LOBYTE(v94) = 21;
    if ( __that.m_Data )
    {
      _bstr_t::Data_t::Release(__that.m_Data);
      __that.m_Data = 0;
    }
  }
  LOBYTE(v94) = 18;
  if ( v89.m_pInterface )
  {
    v56 = v89.m_pInterface->vfptr;
    v67 = (int *)v89.m_pInterface;
    v56->Release((IUnknown *)v89.m_pInterface);
  }
  LOBYTE(v94) = 17;
  v57 = ZComAPI::ZComVariantClear((tagVARIANT *)&v79.0);
  if ( v57 < 0 )
    _com_issue_error(v57);
  LOBYTE(v94) = 11;
  if ( v92.m_pInterface )
  {
    v58 = v92.m_pInterface->vfptr;
    v67 = (int *)v92.m_pInterface;
    v58->Release((IUnknown *)v92.m_pInterface);
  }
  LOBYTE(v94) = 7;
  if ( v86.m_pInterface )
  {
    v59 = v86.m_pInterface->vfptr;
    v67 = (int *)v86.m_pInterface;
    v59->Release((IUnknown *)v86.m_pInterface);
  }
  LeaveCriticalSection(lpCriticalSection);
  v60 = v91.m_pInterface;
  v94 = -1;
  v61 = v91.m_pInterface == 0;
  v1->m_bGeoIPLoaded = 1;
  if ( !v61 )
  {
    v62 = v60->vfptr;
    v67 = (int *)v60;
    v62->Release((IUnknown *)v60);
  }
}

//----- (0041A7AB) --------------------------------------------------------
signed int __thiscall CIPFilter::IsBlocked(CIPFilter *this, unsigned int dwIP)
{
  CIPFilter *v2; // esi@1
  bool v3; // zf@1
  signed int result; // eax@6
  CIPRange **v5; // edi@7
  CIPRange *v6; // eax@8
  unsigned int v7; // ecx@9
  signed int v8; // edi@15
  CIPRange **v9; // esi@15
  CIPRange *v10; // eax@16
  unsigned int v11; // ecx@17
  unsigned int v12; // esi@21
  unsigned int v13; // ST08_4@24
  char *v14; // eax@24
  signed int v15; // esi@25
  struct _RTL_CRITICAL_SECTION *v16; // [sp-4h] [bp-20h]@4
  unsigned int _V; // [sp+Ch] [bp-10h]@8
  unsigned int dwGeoIPListBlockType; // [sp+10h] [bp-Ch]@1
  unsigned int dwIPListBlockType; // [sp+14h] [bp-8h]@1
  int i; // [sp+18h] [bp-4h]@7

  v2 = this;
  dwIPListBlockType = this->m_dwBlockTypeEverywhere;
  v3 = this->m_bIPListLoaded == 0;
  dwGeoIPListBlockType = this->m_dwBlockTypeEverywhereGeoIP;
  if ( v3 )
    return 0;
  if ( !this->m_bGeoIPLoaded )
    dwGeoIPListBlockType = 1;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v16 = (struct _RTL_CRITICAL_SECTION *)&v2->m_lock.DebugInfo;
  if ( v2->m_bIsReloadingIPList )
  {
    LeaveCriticalSection(v16);
    return 0;
  }
  LeaveCriticalSection(v16);
  i = 0;
  v5 = (CIPRange **)v2->m_aaIPList;
  while ( 1 )
  {
    _V = ntohl(dwIP);
    v6 = *v5;
    v7 = *v5 ? v6[-1].m_dwEnd : 0;
    if ( (unsigned __int8)std::binary_search(v6, &v6[v7], &_V) )
      break;
    ++i;
    ++v5;
    if ( i >= 3 )
      goto LABEL_15;
  }
  dwIPListBlockType = i;
LABEL_15:
  v8 = 0;
  v9 = (CIPRange **)v2->m_aaGeoIPList;
  while ( 1 )
  {
    _V = ntohl(dwIP);
    v10 = *v9;
    v11 = *v9 ? v10[-1].m_dwEnd : 0;
    if ( (unsigned __int8)std::binary_search(v10, &v10[v11], &_V) )
      break;
    ++v8;
    ++v9;
    if ( v8 >= 3 )
    {
      v12 = dwGeoIPListBlockType;
      goto LABEL_23;
    }
  }
  v12 = v8;
LABEL_23:
  if ( dwIPListBlockType != v12 )
  {
    v13 = dwIPListBlockType;
    v14 = inet_ntoa((struct in_addr)dwIP);
    LogReport(aMismatchedGeog, v14, v13, v12);
  }
  v15 = dwIPListBlockType * v12;
  result = 2;
  if ( v15 < 2 )
    result = v15;
  return result;
}

//----- (0041A8B4) --------------------------------------------------------
BOOL __cdecl operator<(CIPRange *lhs, unsigned int rhs)
{
  return lhs->m_dwEnd < rhs;
}

//----- (0041A8C4) --------------------------------------------------------
BOOL __cdecl operator<(unsigned int lhs, CIPRange *rhs)
{
  return lhs < rhs->m_dwBegin;
}

//----- (0041A8D3) --------------------------------------------------------
void __thiscall CIPRange::SetRange(CIPRange *this, unsigned int dwBegin, unsigned int dwEnd)
{
  struct in_addr *v3; // esi@1
  char *v4; // ST08_4@2
  char *v5; // eax@2
  struct in_addr v6; // eax@2

  v3 = (struct in_addr *)this;
  this->m_dwBegin = dwBegin;
  this->m_dwEnd = dwEnd;
  if ( dwBegin > dwEnd )
  {
    v4 = inet_ntoa((struct in_addr)dwEnd);
    v5 = inet_ntoa(*v3);
    LogError(aInCiprangeSetr, v5, v4);
    v6 = (struct in_addr)v3->S_un.S_addr;
    *v3 = v3[1];
    v3[1] = v6;
  }
}

//----- (0041A913) --------------------------------------------------------
void TSingleton<CIPFilter>::~TSingleton<CIPFilter>()
{
  TSingleton<CIPFilter>::ms_pInstance = 0;
}

//----- (0041A91B) --------------------------------------------------------
void __thiscall ZArray<CIPRange>::ZArray<CIPRange>(ZArray<CIPRange> *this)
{
  this->a = 0;
}

//----- (0041A926) --------------------------------------------------------
void __thiscall ZXString<unsigned short>::~ZXString<unsigned short>(ZXString<unsigned short> *this)
{
  unsigned __int16 *v1; // eax@1
  unsigned __int16 *v2; // esi@2

  v1 = this->_m_pStr;
  if ( this->_m_pStr )
  {
    v2 = v1 - 6;
    if ( InterlockedDecrement((volatile LONG *)v1 - 3) <= 0 )
      ZAllocEx<ZAllocStrSelector<unsigned short>>::Free(&ZAllocEx<ZAllocStrSelector<unsigned short>>::_s_alloc, v2);
  }
}

//----- (0041A948) --------------------------------------------------------
unsigned __int16 *__thiscall ZXString<unsigned short>::operator unsigned short const *(ZXString<unsigned short> *this)
{
  return this->_m_pStr;
}

//----- (0041A94B) --------------------------------------------------------
void __thiscall ZArray<CIPRange>::RemoveAll(ZArray<CIPRange> *this)
{
  ZArray<CIPRange> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &this->a[-1].m_dwEnd);
    v1->a = 0;
  }
}

//----- (0041A96D) --------------------------------------------------------
CIPRange *__thiscall ZArray<CIPRange>::InsertBefore(ZArray<CIPRange> *this, int nIndex)
{
  ZArray<CIPRange> *v2; // edi@1
  int v3; // esi@4
  CIPRange *v4; // eax@6
  int v5; // edi@6
  int v6; // ebx@6
  unsigned int v7; // esi@6
  unsigned int v8; // edi@6
  CIPRange *v9; // ST08_4@8
  ZArray<CIPRange> *v11; // [sp+Ch] [bp-8h]@1
  unsigned int c; // [sp+10h] [bp-4h]@2

  v2 = this;
  v11 = this;
  if ( this->a )
    c = this->a[-1].m_dwEnd;
  else
    c = 0;
  v3 = nIndex;
  if ( nIndex == -1 )
    v3 = c;
  ZArray<CIPRange>::_Realloc(this, c + 1, 2, (ZAllocHelper *)&nIndex + 3);
  v4 = v2->a;
  v5 = 8 * v3 + 8;
  v6 = v3;
  memmove((char *)v4 + v5, &v4[v3], 8 * (c + 0x1FFFFFFF * v3));
  v7 = (unsigned int)&v11->a->m_dwBegin + v5;
  v8 = (unsigned int)&v11->a[v6].m_dwBegin;
  while ( v8 < v7 )
  {
    v9 = (CIPRange *)v8;
    v8 += 8;
    construct(v9);
  }
  return &v11->a[v6];
}

//----- (0041A9FD) --------------------------------------------------------
void __thiscall ZArray<CIPRange>::RemoveAt(ZArray<CIPRange> *this, __POSITION *pos)
{
  ZArray<CIPRange> *v2; // esi@1

  v2 = this;
  memmove(pos, &pos[8], 8 * ((signed int)((signed int)&this->a[-1] + 8 * this->a[-1].m_dwEnd - (signed int)pos) >> 3));
  --v2->a[-1].m_dwEnd;
}

//----- (0041AA31) --------------------------------------------------------
ZXString<unsigned short> *ZXString<unsigned short>::Format(ZXString<unsigned short> *this, const unsigned __int16 *sFormat, ...)
{
  va_list va; // [sp+Ch] [bp+Ch]@1

  va_start(va, sFormat);
  ZXString<unsigned short>::_FormatV(this, sFormat, va);
  return this;
}

//----- (0041AA48) --------------------------------------------------------
BOOL __cdecl std::binary_search(CIPRange *_F, CIPRange *_L, const unsigned int *_V)
{
  CIPRange *v3; // eax@1

  v3 = std::_Lower_bound(_F, _L, _V);
  return v3 != _L && !(unsigned __int8)operator<(*_V, v3);
}

//----- (0041AA7D) --------------------------------------------------------
void _E15()
{
  _E13_3();
  _E14_2();
}

//----- (0041AA87) --------------------------------------------------------
void _E13_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0041AAC2) --------------------------------------------------------
void _E14_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (0041AAFD) --------------------------------------------------------
CIPRange *__thiscall ZArray<CIPRange>::_Realloc(ZArray<CIPRange> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<CIPRange> *v4; // ebx@1
  unsigned int v5; // edi@2
  unsigned int v6; // esi@4
  unsigned int v7; // esi@7
  CIPRange *v8; // ST08_4@8
  char *v9; // esi@10
  CIPRange *v10; // eax@12
  CIPRange *p; // [sp+Ch] [bp-4h]@11
  unsigned int nModea; // [sp+1Ch] [bp+Ch]@7

  v4 = this;
  if ( this->a )
    v5 = this->a[-1].m_dwEnd;
  else
    v5 = 0;
  v6 = u;
  if ( u > v5 )
  {
    if ( u > (unsigned int)ZArray<CIPRange>::GetCapacity(this) )
    {
      v9 = (char *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 8 * u + 4) + 4);
      if ( !(nMode & 2) )
      {
        p = (CIPRange *)&v9[8 * v5];
        if ( &v9[8 * v5] < &v9[8 * u] )
        {
          do
          {
            v10 = p;
            ++p;
            construct(v10);
          }
          while ( p < (CIPRange *)&v9[8 * u] );
        }
      }
      if ( v4->a )
      {
        if ( !(nMode & 1) )
          memcpy(v9, v4->a, 8 * v5);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v4->a[-1].m_dwEnd);
      }
      v4->a = (CIPRange *)v9;
    }
    else
    {
      if ( nMode & 2 )
        goto LABEL_19;
      v7 = (unsigned int)&v4->a[v5].m_dwBegin;
      nModea = (unsigned int)&v4->a[u].m_dwBegin;
      while ( v7 < nModea )
      {
        v8 = (CIPRange *)v7;
        v7 += 8;
        construct(v8);
      }
    }
    v6 = u;
  }
LABEL_19:
  if ( v4->a )
    v4->a[-1].m_dwEnd = v6;
  return v4->a;
}

//----- (0041ABE9) --------------------------------------------------------
void __thiscall ZXString<unsigned short>::_FormatV(ZXString<unsigned short> *this, const unsigned __int16 *lpszFormat, char *argList)
{
  signed int v3; // edi@1
  signed int v4; // esi@1
  wchar_t *v5; // eax@3
  int v6; // eax@3
  ZXString<unsigned short> *v7; // [sp+8h] [bp-14h]@1
  ZXString<unsigned short> s; // [sp+Ch] [bp-10h]@1
  int v9; // [sp+18h] [bp-4h]@1

  s._m_pStr = 0;
  v7 = this;
  v3 = -1;
  v9 = 0;
  v4 = 16;
  do
  {
    if ( v3 >= 0 )
      break;
    v5 = ZXString<unsigned short>::GetBuffer(&s, v4, 0);
    v6 = _vsnwprintf(v5, v4, lpszFormat, argList);
    v3 = v6;
    if ( v6 < 0 )
      v6 = 0;
    ZXString<unsigned short>::ReleaseBuffer(&s, v6);
    v4 *= 2;
  }
  while ( v4 <= 1024 );
  ZXString<unsigned short>::operator=(v7, &s);
  v9 = -1;
  ZXString<unsigned short>::~ZXString<unsigned short>(&s);
}

//----- (0041AC6E) --------------------------------------------------------
void __cdecl std::_Sort_0(CIPRange *_F, CIPRange *_L)
{
  CIPRange *i; // edx@3
  unsigned int v3; // esi@4
  unsigned int v4; // edi@4
  CIPRange *v5; // ecx@4
  int j; // eax@4

  if ( (signed int)(((char *)_L - (char *)_F) & 0xFFFFFFF8) > 128 )
  {
    std::_Sort(_F, _L);
    std::_Insertion_sort_1(_F, _F + 16);
    for ( i = _F + 16; i != _L; v5->m_dwEnd = v4 )
    {
      v3 = i->m_dwBegin;
      v4 = i->m_dwEnd;
      v5 = i;
      for ( j = (int)&i[-1]; v3 < *(_DWORD *)j; j -= 8 )
      {
        v5->m_dwBegin = *(_DWORD *)j;
        v5->m_dwEnd = *(_DWORD *)(j + 4);
        v5 = (CIPRange *)j;
      }
      ++i;
      v5->m_dwBegin = v3;
    }
  }
  else
  {
    std::_Insertion_sort_1(_F, _L);
  }
}

//----- (0041ACE3) --------------------------------------------------------
CIPRange *__cdecl construct(CIPRange *p)
{
  CIPRange *result; // eax@1

  result = p;
  if ( p )
  {
    p->m_dwBegin = 0;
    p->m_dwEnd = 0;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041ACF6) --------------------------------------------------------
void _E33_3()
{
  _E26_4();
  _E27_2();
  _E28_3();
  _E29_5();
  _E30_5();
  _E31_6();
  _E32_4();
}

//----- (0041AD19) --------------------------------------------------------
void _E26_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0041AD54) --------------------------------------------------------
void _E27_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0041AD8F) --------------------------------------------------------
void _E28_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0041ADCA) --------------------------------------------------------
void _E29_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0041AE05) --------------------------------------------------------
void _E30_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0041AE40) --------------------------------------------------------
void _E31_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0041AE7B) --------------------------------------------------------
void _E32_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0041AEB6) --------------------------------------------------------
unsigned int *__thiscall ZArray<CIPRange>::GetCapacity(ZArray<CIPRange> *this)
{
  unsigned int *result; // eax@1
  int v2; // eax@2

  result = &this->a->m_dwBegin;
  if ( this->a )
  {
    v2 = *(result - 2);
    if ( v2 < 0 )
      v2 = ~v2;
    result = (unsigned int *)((unsigned int)(v2 - 4) >> 3);
  }
  return result;
}

//----- (0041AECD) --------------------------------------------------------
ZXString<unsigned short> *__thiscall ZXString<unsigned short>::operator=(ZXString<unsigned short> *this, ZXString<unsigned short> *s)
{
  ZXString<unsigned short> *v2; // esi@1
  ZXString<unsigned short> *result; // eax@2
  unsigned __int16 *v4; // eax@3
  volatile LONG *v5; // edi@4
  unsigned __int16 *v6; // eax@7
  unsigned __int16 *v7; // edi@8
  ZXString<unsigned short> v8; // eax@13
  unsigned __int16 *v9; // ebx@14

  v2 = this;
  if ( this == s )
  {
    result = this;
  }
  else
  {
    v4 = s->_m_pStr;
    if ( s->_m_pStr )
      v5 = (volatile LONG *)(v4 - 6);
    else
      v5 = 0;
    if ( v5 )
    {
      if ( *v5 == -1 )
      {
        ZXString<unsigned short>::Assign(this, v4, -1);
      }
      else
      {
        InterlockedIncrement(v5);
        v8._m_pStr = v2->_m_pStr;
        if ( v2->_m_pStr )
        {
          v9 = v8._m_pStr - 6;
          if ( InterlockedDecrement((volatile LONG *)v8._m_pStr - 3) <= 0 )
            ZAllocEx<ZAllocStrSelector<unsigned short>>::Free(
              &ZAllocEx<ZAllocStrSelector<unsigned short>>::_s_alloc,
              v9);
        }
        v2->_m_pStr = (unsigned __int16 *)(v5 + 3);
      }
    }
    else
    {
      v6 = this->_m_pStr;
      if ( this->_m_pStr )
      {
        v7 = v6 - 6;
        if ( InterlockedDecrement((volatile LONG *)v6 - 3) <= 0 )
          ZAllocEx<ZAllocStrSelector<unsigned short>>::Free(&ZAllocEx<ZAllocStrSelector<unsigned short>>::_s_alloc, v7);
        v2->_m_pStr = 0;
      }
    }
    result = v2;
  }
  return result;
}

//----- (0041AF57) --------------------------------------------------------
unsigned __int16 *__thiscall ZXString<unsigned short>::GetBuffer(ZXString<unsigned short> *this, int nMinLength, int bRetain)
{
  ZXString<unsigned short> *v3; // ebx@1
  unsigned __int16 *v4; // edi@2
  int v5; // eax@8
  ZXString<unsigned short>::_ZXStringData *v6; // eax@12
  ZXString<unsigned short>::_ZXStringData *v7; // esi@12
  unsigned __int16 *v8; // eax@12

  v3 = this;
  if ( this->_m_pStr )
    v4 = this->_m_pStr - 6;
  else
    v4 = 0;
  if ( v4 )
  {
    if ( *(_DWORD *)v4 <= 1 && *((_DWORD *)v4 + 1) >= nMinLength )
    {
      *(_DWORD *)v4 = -1;
      return v3->_m_pStr;
    }
    v5 = *((_DWORD *)v4 + 2) >> 1;
  }
  else
  {
    v5 = 0;
  }
  if ( v5 < nMinLength )
    v5 = nMinLength;
  v6 = ZXString<unsigned short>::_Alloc(v5);
  v7 = v6;
  v6->nRef = -1;
  v8 = (unsigned __int16 *)&v6[1];
  v3->_m_pStr = v8;
  if ( bRetain && v4 )
  {
    memcpy(v8, v4 + 6, 2 * (*((_DWORD *)v4 + 2) >> 1) + 2);
    v7->nByteLen = *((_DWORD *)v4 + 2);
  }
  else
  {
    v7->nByteLen = 0;
    *v3->_m_pStr = 0;
  }
  if ( v4 && InterlockedDecrement((volatile LONG *)v4) <= 0 )
    ZAllocEx<ZAllocStrSelector<unsigned short>>::Free(&ZAllocEx<ZAllocStrSelector<unsigned short>>::_s_alloc, v4);
  return v3->_m_pStr;
}

//----- (0041AFF5) --------------------------------------------------------
void __thiscall ZXString<unsigned short>::ReleaseBuffer(ZXString<unsigned short> *this, int nLength)
{
  size_t v2; // eax@1
  unsigned __int16 *v3; // esi@1

  v2 = nLength;
  v3 = this->_m_pStr - 6;
  *(_DWORD *)v3 = 1;
  if ( nLength == -1 )
    v2 = wcslen(v3 + 6);
  else
    this->_m_pStr[nLength] = 0;
  *((_DWORD *)v3 + 2) = 2 * v2;
}

//----- (0041B026) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocStrSelector<unsigned short>>::Free(ZAllocEx<ZAllocStrSelector<unsigned short> > *this, void *p)
{
  ZAllocEx<ZAllocStrSelector<unsigned short> > *v2; // ebp@1
  unsigned int v3; // eax@2
  signed int v4; // esi@5
  int v5; // eax@12

  v2 = this;
  if ( p )
  {
    v3 = *((_DWORD *)p - 1);
    if ( (v3 & 0x80000000) != 0 )
      v3 = ~v3;
    if ( v3 > 0x4E )
    {
      if ( v3 <= 0x8E )
      {
        v4 = 2;
        goto LABEL_8;
      }
      v4 = v3 > 0x10E ? -1 : 3;
    }
    else
    {
      v4 = v3 > 0x2E;
    }
    if ( v4 < 0 )
    {
      v5 = dword_4A46D4(0, (char *)p - 4);
      dword_4A46D0(v5);
      return;
    }
LABEL_8:
    EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
    *(_DWORD *)p = v2->m_apBuff[v4];
    v2->m_apBuff[v4] = p;
    LeaveCriticalSection((LPCRITICAL_SECTION)&v2->m_lock.DebugInfo);
  }
}
// 4A46D0: using guessed type int (__stdcall *dword_4A46D0)(_DWORD);
// 4A46D4: using guessed type int (__stdcall *dword_4A46D4)(_DWORD, _DWORD);

//----- (0041B0A3) --------------------------------------------------------
void __cdecl std::_Sort(CIPRange *_F, CIPRange *_L)
{
  CIPRange *v2; // esi@1
  CIPRange *v3; // edi@1
  signed int v4; // eax@1
  signed int i; // ecx@1
  CIPRange v6; // ST24_8@3
  CIPRange *v7; // eax@3
  CIPRange *v8; // eax@3
  CIPRange result; // [sp+Ch] [bp-8h]@3
  CIPRange *_M; // [sp+20h] [bp+Ch]@3

  v2 = _F;
  v3 = _L;
  v4 = (char *)_L - (char *)_F;
  for ( i = ((char *)_L - (char *)_F) & 0xFFFFFFF8; i > 128; i = ((char *)v3 - (char *)v2) & 0xFFFFFFF8 )
  {
    v6.m_dwEnd = v3[-1].m_dwEnd;
    v6.m_dwBegin = v3[-1].m_dwBegin;
    v7 = std::_Median(&result, *v2, v2[(v4 >> 3) / 2], v6);
    v8 = std::_Unguarded_partition(v2, v3, *v7);
    _M = v8;
    if ( (signed int)(((char *)v3 - (char *)v8) & 0xFFFFFFF8) > (signed int)(((char *)v8 - (char *)v2) & 0xFFFFFFF8) )
    {
      std::_Sort(v2, v8, 0);
      v2 = _M;
    }
    else
    {
      std::_Sort(v8, v3, 0);
      v3 = _M;
    }
    v4 = (char *)v3 - (char *)v2;
  }
}

//----- (0041B138) --------------------------------------------------------
CIPRange *__cdecl std::_Lower_bound(CIPRange *_F, CIPRange *_L, const unsigned int *_V)
{
  signed int v3; // edi@1

  v3 = _L - _F;
  while ( v3 > 0 )
  {
    if ( (unsigned __int8)operator<(&_F[v3 / 2], *_V) )
    {
      _F += v3 / 2 + 1;
      v3 += -1 - v3 / 2;
    }
    else
    {
      v3 /= 2;
    }
  }
  return _F;
}

//----- (0041B188) --------------------------------------------------------
ZXString<unsigned short>::_ZXStringData *__cdecl ZXString<unsigned short>::_Alloc(int nCap)
{
  ZXString<unsigned short>::_ZXStringData *result; // eax@1

  result = (ZXString<unsigned short>::_ZXStringData *)ZAllocEx<ZAllocStrSelector<unsigned short>>::Alloc(
                                                        &ZAllocEx<ZAllocStrSelector<unsigned short>>::_s_alloc,
                                                        2 * nCap + 14);
  result->nCap = nCap;
  return result;
}

//----- (0041B1A1) --------------------------------------------------------
void __cdecl std::_Insertion_sort_1(CIPRange *_F, CIPRange *_L)
{
  CIPRange *i; // eax@2
  unsigned int v3; // edx@3
  unsigned int v4; // esi@3
  unsigned int v5; // esi@4
  CIPRange *v6; // edx@4
  int k; // ecx@4
  CIPRange *j; // ecx@8
  unsigned int v9; // ebx@9
  unsigned int v10; // [sp+8h] [bp-4h]@4

  if ( _F != _L )
  {
    for ( i = _F + 1; i != _L; ++i )
    {
      v3 = i->m_dwBegin;
      v4 = i->m_dwEnd;
      if ( i->m_dwBegin < _F->m_dwBegin )
      {
        for ( j = i; j != _F; j[1].m_dwEnd = j->m_dwEnd )
        {
          v9 = j[-1].m_dwBegin;
          --j;
          j[1].m_dwBegin = v9;
        }
        _F->m_dwBegin = v3;
        _F->m_dwEnd = v4;
      }
      else
      {
        v5 = i->m_dwBegin;
        v10 = i->m_dwEnd;
        v6 = i;
        for ( k = (int)&i[-1]; v5 < *(_DWORD *)k; k -= 8 )
        {
          v6->m_dwBegin = *(_DWORD *)k;
          v6->m_dwEnd = *(_DWORD *)(k + 4);
          v6 = (CIPRange *)k;
        }
        v6->m_dwBegin = v5;
        v6->m_dwEnd = v10;
      }
    }
  }
}

//----- (0041B219) --------------------------------------------------------
CIPRange *__cdecl std::_Median(CIPRange *result, CIPRange __$ReturnUdt, CIPRange _X, CIPRange _Y)
{
  CIPRange *v4; // ecx@3
  unsigned int v5; // edx@8
  CIPRange *v6; // eax@8
  unsigned int v7; // ecx@8

  if ( __$ReturnUdt.m_dwBegin >= _X.m_dwBegin )
  {
    if ( __$ReturnUdt.m_dwBegin < _Y.m_dwBegin )
      goto LABEL_4;
    v4 = &_Y;
    if ( _X.m_dwBegin < _Y.m_dwBegin )
      goto LABEL_8;
LABEL_7:
    v4 = &_X;
    goto LABEL_8;
  }
  if ( _X.m_dwBegin < _Y.m_dwBegin )
    goto LABEL_7;
  v4 = &_Y;
  if ( __$ReturnUdt.m_dwBegin >= _Y.m_dwBegin )
LABEL_4:
    v4 = &__$ReturnUdt;
LABEL_8:
  v5 = v4->m_dwBegin;
  v6 = result;
  v7 = v4->m_dwEnd;
  result->m_dwBegin = v5;
  result->m_dwEnd = v7;
  return v6;
}

//----- (0041B257) --------------------------------------------------------
CIPRange *__cdecl std::_Unguarded_partition(CIPRange *_F, CIPRange *_L, CIPRange _Piv)
{
  CIPRange *v3; // ecx@1
  CIPRange *result; // eax@1
  unsigned int v5; // edx@5
  unsigned int v6; // esi@5

  v3 = _L;
  for ( result = _F; ; ++result )
  {
    if ( result->m_dwBegin < _Piv.m_dwBegin )
      continue;
    do
      --v3;
    while ( _Piv.m_dwBegin < v3->m_dwBegin );
    if ( v3 <= result )
      break;
    v5 = result->m_dwBegin;
    v6 = result->m_dwEnd;
    result->m_dwBegin = v3->m_dwBegin;
    result->m_dwEnd = v3->m_dwEnd;
    v3->m_dwBegin = v5;
    v3->m_dwEnd = v6;
  }
  return result;
}

//----- (0041B292) --------------------------------------------------------
void __thiscall ZXString<unsigned short>::Assign(ZXString<unsigned short> *this, const unsigned __int16 *s, int n)
{
  ZXString<unsigned short> *v3; // edi@1
  int v4; // esi@3
  unsigned __int16 *v5; // eax@5

  v3 = this;
  if ( s )
  {
    v4 = n;
    if ( n == -1 )
      v4 = wcslen(s);
    v5 = ZXString<unsigned short>::GetBuffer(v3, v4, 0);
    memcpy(v5, s, 2 * v4);
    ZXString<unsigned short>::ReleaseBuffer(v3, v4);
  }
  else
  {
    ZXString<unsigned short>::Empty(this);
  }
}

//----- (0041B2E1) --------------------------------------------------------
void __thiscall ZXString<unsigned short>::Empty(ZXString<unsigned short> *this)
{
  ZXString<unsigned short> *v1; // esi@1
  unsigned __int16 *v2; // eax@1
  unsigned __int16 *v3; // edi@2

  v1 = this;
  v2 = this->_m_pStr;
  if ( this->_m_pStr )
  {
    v3 = v2 - 6;
    if ( InterlockedDecrement((volatile LONG *)v2 - 3) <= 0 )
      ZAllocEx<ZAllocStrSelector<unsigned short>>::Free(&ZAllocEx<ZAllocStrSelector<unsigned short>>::_s_alloc, v3);
    v1->_m_pStr = 0;
  }
}

//----- (0041B30A) --------------------------------------------------------
int __thiscall ZAllocEx<ZAllocStrSelector<unsigned short>>::Alloc(ZAllocEx<ZAllocStrSelector<unsigned short> > *this, unsigned int uSize)
{
  ZAllocEx<ZAllocStrSelector<unsigned short> > *v2; // edi@1
  signed int v3; // esi@2
  int v4; // eax@12
  unsigned int *v5; // eax@12
  struct _RTL_CRITICAL_SECTION *v7; // ebx@17
  bool v8; // zf@17
  char **v9; // edi@17
  char *v10; // eax@18
  char *v11; // esi@19
  ZAllocEx<ZAllocStrSelector<unsigned short> > *v12; // [sp+10h] [bp-14h]@1
  signed int uBlockSize; // [sp+14h] [bp-10h]@9
  signed int u; // [sp+2Ch] [bp+8h]@9

  v2 = this;
  v12 = this;
  if ( uSize > 0x4E )
  {
    if ( uSize <= 0x8E )
    {
      v3 = 2;
      goto LABEL_5;
    }
    v3 = uSize > 0x10E ? -1 : 3;
  }
  else
  {
    v3 = uSize > 0x2E;
  }
  if ( v3 < 0 )
  {
    v4 = dword_4A46D4(0, uSize + 4);
    v5 = (unsigned int *)dword_4A46CC(v4);
    *v5 = uSize;
    return (int)(v5 + 1);
  }
LABEL_5:
  if ( v3 )
  {
    switch ( v3 )
    {
      case 1:
        u = 32;
        uBlockSize = 78;
        break;
      case 2:
        u = 16;
        uBlockSize = 142;
        break;
      case 3:
        u = 8;
        uBlockSize = 270;
        break;
      default:
        u = 0;
        uBlockSize = 0;
        break;
    }
  }
  else
  {
    u = 64;
    uBlockSize = 46;
  }
  v7 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v8 = v2->m_apBuff[v3] == 0;
  v9 = (char **)&v2->m_apBuff[v3];
  if ( v8 )
  {
    v10 = ZAllocBase::_AllocRawBlocks(uBlockSize, u);
    *((_DWORD *)v10 - 2) = v12->m_apBlockHead[v3];
    v12->m_apBlockHead[v3] = v10;
    *v9 = v10;
  }
  v11 = *v9;
  *v9 = *(char **)*v9;
  LeaveCriticalSection(v7);
  return (int)v11;
}
// 4A46CC: using guessed type int (__stdcall *dword_4A46CC)(_DWORD);
// 4A46D4: using guessed type int (__stdcall *dword_4A46D4)(_DWORD, _DWORD);

//----- (0041B42E) --------------------------------------------------------
int _E15_0()
{
  return atexit(_E14_3);
}

//----- (0041B43A) --------------------------------------------------------
void __cdecl _E14_3()
{
  CLog::~CLog(&g_log);
}

//----- (0041B444) --------------------------------------------------------
void __thiscall CLog::~CLog(CLog *this)
{
  CLog *v1; // esi@1

  v1 = this;
  this->vfptr = (ZThreadVtbl *)&CLog::`vftable';
  if ( this->_m_hThread )
  {
    this->m_bTerminate = 1;
    ZThread::JoinThread((ZThread *)&this->vfptr, 0xFFFFFFFF);
  }
  v1->m_lFileLog.vfptr = (ZList<CLog::FILELOG>Vtbl *)&ZList<CLog::FILELOG>::`vftable';
  ZList<CLog::FILELOG>::RemoveAll(&v1->m_lFileLog);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lockFileLog.DebugInfo);
  ZArray<CLog::FILEINFO>::RemoveAll(&v1->m_afi);
  v1->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  ZThread::CloseThread((ZThread *)&v1->vfptr);
  TSingleton<CLog>::ms_pInstance = 0;
}
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);
// 443864: using guessed type int (__thiscall *ZList<CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);
// 44386C: using guessed type int (__thiscall *CLog::`vftable')(void *p, unsigned int __flags);

//----- (0041B4C4) --------------------------------------------------------
#error "41B55A: positive sp value has been found (funcsize=62)"

//----- (0041B55D) --------------------------------------------------------
void __stdcall CLog::CreateNewFile(CLog::FILEINFO *fi, _SYSTEMTIME *st)
{
  int v3; // [sp+0h] [bp-20h]@1
  ZXString<char> v4; // [sp+Ch] [bp-14h]@1
  int *v5; // [sp+10h] [bp-10h]@1
  int v6; // [sp+1Ch] [bp-4h]@1

  v5 = &v3;
  v4._m_pStr = 0;
  v6 = 0;
  dword_4A46EC(aCMslog, 0);
  ZXString<char>::Format(
    &v4,
    aCMslogS_02d02d,
    fi->sFileTitle._m_pStr,
    st->wMonth,
    st->wDay,
    st->wHour,
    st->wMinute,
    st->wSecond);
  fi->stCreated = *st;
  LOBYTE(v6) = 1;
  ZRef<ZFileStream>::_Alloc(&fi->pfs);
  ZFileStream::OpenForWriting(fi->pfs.p, v4._m_pStr, 2u, 0x80u, 1u, 0x40000000u, 0, 0);
  v6 = -1;
  ZXString<char>::~ZXString<char>(&v4);
}
// 4A46EC: using guessed type int (__stdcall *dword_4A46EC)(_DWORD, _DWORD);

//----- (0041B605) --------------------------------------------------------
void *__usercall _L110153@<eax>(int a1@<ebp>)
{
  int v1; // eax@1
  int v2; // esi@1

  v1 = *(_DWORD *)(a1 + 8);
  v2 = v1 + 12;
  if ( *(_DWORD *)(v1 + 16) )
  {
    ZRef<ZFileStream>::_ReleaseRaw((ZRef<ZFileStream> *)(v1 + 12), 0);
    *(_DWORD *)(v2 + 4) = 0;
  }
  return &_L105130;
}

//----- (0041B623) --------------------------------------------------------
#error "41B7A8: positive sp value has been found (funcsize=139)"

//----- (0041B7AB) --------------------------------------------------------
#error "41B9A9: positive sp value has been found (funcsize=173)"

//----- (0041B9AC) --------------------------------------------------------
void CLog::OutputLog(CLog *this, unsigned int uIdx, unsigned int dwPrefixFlag, const char *sTail, const char *sFormat, ...)
{
  va_list va; // [sp+1Ch] [bp+1Ch]@1

  va_start(va, sFormat);
  CLog::OutputLogV(this, uIdx, dwPrefixFlag, sTail, sFormat, va);
}

//----- (0041B9C9) --------------------------------------------------------
void LogReport(const char *sFormat, ...)
{
  va_list va; // [sp+8h] [bp+8h]@1

  va_start(va, sFormat);
  CLog::OutputLogV(&g_log, 0, 1u, 0, sFormat, va);
}

//----- (0041B9E3) --------------------------------------------------------
void LogError(const char *sFormat, ...)
{
  va_list va; // [sp+8h] [bp+8h]@1

  va_start(va, sFormat);
  CLog::OutputLogV(&g_log, 0, 2u, 0, sFormat, va);
}

//----- (0041B9FD) --------------------------------------------------------
void __cdecl LogException(ZException *e)
{
  int v1; // eax@1
  _com_error *v2; // eax@6
  char *v3; // ST08_4@6
  _com_error v4; // [sp+0h] [bp-1Ch]@6
  int v5; // [sp+18h] [bp-4h]@6

  v1 = e->m_hr;
  if ( e->m_hr != -2147467259 && v1 != 64 && v1 != 121 && v1 != 10053 && v1 != 10054 )
  {
    _com_error::_com_error(&v4, v1, 0, 0);
    v5 = 0;
    v3 = format_com_error((ZXString<char> *)&e, v2)->_m_pStr;
    LOBYTE(v5) = 1;
    LogError(v3);
    LOBYTE(v5) = 0;
    ZXString<char>::~ZXString<char>((ZXString<char> *)&e);
    _com_error::~_com_error(&v4);
  }
}

//----- (0041BA77) --------------------------------------------------------
void __cdecl LogException(_com_error *e)
{
  ZXString<char> *v1; // eax@1

  v1 = format_com_error((ZXString<char> *)&e, e);
  LogError(v1->_m_pStr);
  ZXString<char>::~ZXString<char>((ZXString<char> *)&e);
}

//----- (0041BAB3) --------------------------------------------------------
void TSingleton<CLog>::~TSingleton<CLog>()
{
  TSingleton<CLog>::ms_pInstance = 0;
}

//----- (0041BAC0) --------------------------------------------------------
void __thiscall ZList<CLog::FILELOG>::~ZList<CLog::FILELOG>(ZList<CLog::FILELOG> *this)
{
  this->vfptr = (ZList<CLog::FILELOG>Vtbl *)&ZList<CLog::FILELOG>::`vftable';
  ZList<CLog::FILELOG>::RemoveAll(this);
}
// 443864: using guessed type int (__thiscall *ZList<CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);

//----- (0041BACB) --------------------------------------------------------
int ZStrUtil::Snprintf(char *buffer, unsigned int count, const char *format, ...)
{
  va_list va; // [sp+10h] [bp+10h]@1

  va_start(va, format);
  return _vsnprintf(buffer, count, format, va);
}

//----- (0041BAE5) --------------------------------------------------------
ZList<CLog::FILELOG> *__thiscall ZList<CLog::FILELOG>::`vector deleting destructor'(ZList<CLog::FILELOG> *this, unsigned int __flags)
{
  ZList<CLog::FILELOG> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZList<CLog::FILELOG>Vtbl *)&ZList<CLog::FILELOG>::`vftable';
  ZList<CLog::FILELOG>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 443864: using guessed type int (__thiscall *ZList<CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);

//----- (0041BB0B) --------------------------------------------------------
void __thiscall ZRef<ZFileStream>::_Alloc(ZRef<ZFileStream> *this)
{
  ZRef<ZFileStream> *v1; // esi@1
  int v2; // eax@3

  v1 = this;
  if ( this->p )
  {
    ZRef<ZFileStream>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
  ZRefCounted_Alloc();
  *(_DWORD *)(v2 + 4) = 1;
  v1->p = (ZFileStream *)(v2 != 0 ? v2 + 16 : 0);
}

//----- (0041BB3E) --------------------------------------------------------
void __thiscall ZRef<ZFileStream>::_ReleaseRaw(ZRef<ZFileStream> *this, void *__formal)
{
  ZRefCounted *v2; // esi@1

  v2 = (ZRefCounted *)(this->p != 0 ? &this->p[-1].m_uMapEnd : 0);
  if ( !InterlockedDecrement(&v2->_m_nRef) )
  {
    InterlockedIncrement(&v2->_m_nRef);
    ZRefCountedAccessorBase::_Delete(v2);
  }
}

//----- (0041BB6D) --------------------------------------------------------
void __thiscall ZArray<CLog::FILEINFO>::RemoveAll(ZArray<CLog::FILEINFO> *this)
{
  ZArray<CLog::FILEINFO> *v1; // ebx@1
  CLog::FILEINFO *v2; // edi@2
  CLog::FILEINFO *i; // esi@2

  v1 = this;
  if ( this->a )
  {
    v2 = &this->a[*(_DWORD *)&this->a[-1].stCreated.wSecond];
    for ( i = this->a; i < v2; ++i )
      CLog::FILEINFO::~FILEINFO(i);
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v1->a[-1].stCreated.wSecond);
    v1->a = 0;
  }
}

//----- (0041BBAA) --------------------------------------------------------
CLog::FILEINFO *__thiscall ZArray<CLog::FILEINFO>::_Alloc(ZArray<CLog::FILEINFO> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<CLog::FILEINFO> *v3; // ebx@1
  CLog::FILEINFO *result; // eax@2
  int v5; // eax@3
  unsigned int v6; // esi@3
  CLog::FILEINFO *v7; // edi@3
  CLog::FILEINFO *v8; // ST00_4@5

  v3 = this;
  ZArray<CLog::FILEINFO>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 36 * u + 4) + 4;
    v3->a = (CLog::FILEINFO *)v5;
    *(_DWORD *)(v5 - 4) = u;
    v6 = (unsigned int)&v3->a[u];
    v7 = v3->a;
    while ( (unsigned int)v7 < v6 )
    {
      v8 = v7;
      ++v7;
      construct(v8);
    }
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041BBFC) --------------------------------------------------------
void __thiscall ZList<CLog::FILELOG>::RemoveAll(ZList<CLog::FILELOG> *this)
{
  ZList<CLog::FILELOG> *v1; // esi@1
  CLog::FILELOG *i; // eax@1
  ZRefCounted *v3; // eax@2
  int v4; // edi@2

  v1 = this;
  for ( i = this->_m_pHead; i; i = (CLog::FILELOG *)(v4 != 0 ? v4 + 16 : 0) )
  {
    v3 = (ZRefCounted *)(i != 0 ? (unsigned int)&i[-2] : 0);
    v4 = v3->_m_nRef;
    ZRefCountedAccessorBase::_Delete(v3);
  }
  v1->_m_pTail = 0;
  v1->_m_pHead = 0;
  v1->_m_uCount = 0;
}

//----- (0041BC36) --------------------------------------------------------
void __thiscall ZList<CLog::FILELOG>::MoveAfter(ZList<CLog::FILELOG> *this, ZList<CLog::FILELOG> *l, __POSITION *posFrom, __POSITION *posTo, __POSITION *pos)
{
  CLog::FILELOG *v5; // edi@2
  CLog::FILELOG *v6; // ebx@4
  int v7; // eax@8
  int v8; // eax@9
  int v9; // edi@10
  int v10; // esi@10
  int v11; // eax@11
  int v12; // edx@12
  int v13; // esi@12
  int v14; // edx@13
  CLog::FILELOG *v15; // esi@14
  ZList<CLog::FILELOG> *v16; // edx@14
  int v17; // edx@15
  int v18; // esi@15
  char *v19; // edx@16
  int v20; // edx@19
  int v21; // edx@19
  int v22; // edx@21
  int v23; // eax@21
  int v24; // eax@22
  CLog::FILELOG *pFrom; // [sp+Ch] [bp-8h]@4
  ZList<CLog::FILELOG> *la; // [sp+1Ch] [bp+8h]@19
  unsigned int uCount; // [sp+20h] [bp+Ch]@7

  if ( l->_m_uCount )
  {
    v5 = (CLog::FILELOG *)posFrom;
    if ( !posFrom )
      v5 = l->_m_pHead;
    v6 = (CLog::FILELOG *)posTo;
    pFrom = v5;
    if ( !posTo )
      v6 = l->_m_pTail;
    if ( v5 == v6 )
    {
      uCount = 1;
    }
    else
    {
      v7 = (int)v5;
      uCount = 1;
      do
      {
        v8 = *(_DWORD *)(v7 != 0 ? v7 - 16 + 4 : 4);
        v7 = v8 != 0 ? v8 + 16 : 0;
        ++uCount;
      }
      while ( (CLog::FILELOG *)v7 != v6 );
    }
    v9 = v5 != 0 ? (unsigned int)&v5[-2] : 0;
    v10 = *(_DWORD *)(v9 + 8);
    if ( *(_DWORD *)(v9 + 8) != 0 ? v10 + 16 : 0 )
    {
      v11 = v6 != 0 ? (unsigned int)&v6[-2] : 0;
      v12 = *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0;
      v13 = v10 != 0 ? v10 + 16 : 0;
      *(_DWORD *)(v13 != 0 ? v13 - 16 + 4 : 4) = v12 != 0 ? v12 - 16 : 0;
    }
    else
    {
      v11 = v6 != 0 ? (unsigned int)&v6[-2] : 0;
      l->_m_pHead = (CLog::FILELOG *)(*(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0);
    }
    v14 = *(_DWORD *)(v9 + 8);
    if ( *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0 )
    {
      v17 = v14 != 0 ? v14 + 16 : 0;
      v18 = *(_DWORD *)(v11 + 4) != 0 ? *(_DWORD *)(v11 + 4) + 16 : 0;
      *(_DWORD *)(v18 != 0 ? v18 - 16 + 8 : 8) = v17 != 0 ? v17 - 16 : 0;
      v16 = l;
    }
    else
    {
      v15 = (CLog::FILELOG *)(v14 != 0 ? v14 + 16 : 0);
      v16 = l;
      l->_m_pTail = v15;
    }
    v16->_m_uCount -= uCount;
    v19 = (char *)pos;
    if ( pos || (v19 = (char *)this->_m_pTail) != 0 )
    {
      v20 = (int)(v19 - 16);
      la = (ZList<CLog::FILELOG> *)v20;
      v21 = *(_DWORD *)(v20 + 4) != 0 ? *(_DWORD *)(v20 + 4) + 16 : 0;
      if ( v21 )
      {
        v22 = v21 - 16;
        *(_DWORD *)(v22 + 8) = v11;
        v23 = v11 != 0 ? v11 + 16 : 0;
        *(_DWORD *)(v23 != 0 ? v23 - 16 + 4 : 4) = v22;
      }
      else
      {
        this->_m_pTail = v6;
        *(_DWORD *)(v11 + 4) = 0;
      }
      *(_DWORD *)(v9 + 8) = la;
      v24 = la != 0 ? (unsigned int)&la->_m_pTail : 0;
      *(_DWORD *)(v24 != 0 ? v24 - 16 + 4 : 4) = v9;
      this->_m_uCount += uCount;
    }
    else
    {
      this->_m_pHead = pFrom;
      this->_m_pTail = v6;
      this->_m_uCount = uCount;
      *(_DWORD *)(v9 + 8) = 0;
      *(_DWORD *)(v11 + 4) = 0;
    }
  }
}

//----- (0041BDF7) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<ZFileStream> *v0; // ecx@1

  v0 = (ZRefCountedDummy<ZFileStream> *)ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<ZFileStream>::ZRefCountedDummy<ZFileStream>(v0);
}

//----- (0041BE2C) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance,
    p);
}

//----- (0041BE3C) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0041BE62) --------------------------------------------------------
void _E24_4()
{
  _E21_0();
  _E22_0();
  _E23_2();
}

//----- (0041BE71) --------------------------------------------------------
void _E21_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0041BEAC) --------------------------------------------------------
void _E22_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (0041BEE7) --------------------------------------------------------
void _E23_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0041BF22) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZFileStream>::ZRefCountedDummy<ZFileStream>(ZRefCountedDummy<ZFileStream> *this)
{
  ZRefCountedDummy<ZFileStream> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>Vtbl *)&ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable';
  v1->t.m_hFile = (void *)-1;
  v1->t.m_hMap = 0;
  v1->t.m_pMap = 0;
  v1->t.m_abBuff.p = 0;
  v1->t.m_state = 0;
  v1->t.vfptr = (ZIStreamVtbl *)&ZFileStream::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<ZFileStream>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>Vtbl *)&ZRefCountedDummy<ZFileStream>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443878: using guessed type int (__stdcall *ZRefCountedDummy<ZFileStream>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>'})(int);
// 443880: using guessed type int (__thiscall *ZRefCountedDummy<ZFileStream>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443888: using guessed type int (__thiscall *ZFileStream::`vftable')(void *p, unsigned int __flags);
// 4438D0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable')(void *p, unsigned int __flags);

//----- (0041BF6A) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *__thiscall ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>Vtbl *)&ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance,
      this);
  return v2;
}
// 4438D0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable')(void *p, unsigned int __flags);

//----- (0041BF8C) --------------------------------------------------------
ZRefCountedDummy<ZFileStream> *__thiscall ZRefCountedDummy<ZFileStream>::`scalar deleting destructor'(ZRefCountedDummy<ZFileStream> *this, unsigned int __flags)
{
  ZRefCountedDummy<ZFileStream> *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<ZFileStream>::~ZRefCountedDummy<ZFileStream>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance,
      v2);
  return v2;
}

//----- (0041BFAD) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZFileStream>::~ZRefCountedDummy<ZFileStream>(ZRefCountedDummy<ZFileStream> *this)
{
  ZRefCountedDummy<ZFileStream> *v1; // edi@1
  char *v2; // ST08_4@1

  v1 = this;
  v2 = (char *)&this->t;
  *(_DWORD *)v2 = &ZFileStream::`vftable';
  ZFileStream::Close(&this->t);
  ZFixedArray<unsigned char,65536,0>::~ZFixedArray<unsigned char,65536,0>((ZFixedArray<unsigned char,65536,0> *)v2 + 12);
  *(_DWORD *)v2 = &ZIStream::`vftable';
  *(_DWORD *)(v1 != 0 ? (unsigned int)&v1->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443550: using guessed type int (__thiscall *ZIStream::`vftable')(void *p, unsigned int __flags);
// 443888: using guessed type int (__thiscall *ZFileStream::`vftable')(void *p, unsigned int __flags);
// 4438D0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable')(void *p, unsigned int __flags);

//----- (0041C012) --------------------------------------------------------
void __thiscall ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::~ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this)
{
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>Vtbl *)&ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable';
}
// 4438D0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::`vftable')(void *p, unsigned int __flags);

//----- (0041C019) --------------------------------------------------------
void __thiscall CLog::FILEINFO::~FILEINFO(CLog::FILEINFO *this)
{
  CLog::FILEINFO *v1; // edi@1
  char *v2; // esi@1

  v1 = this;
  v2 = this->pfs.gap0;
  if ( this->pfs.p )
  {
    ZRef<ZFileStream>::_ReleaseRaw(&this->pfs, 0);
    *((_DWORD *)v2 + 1) = 0;
  }
  ZXString<char>::~ZXString<char>(&v1->sFileTitle);
}

//----- (0041C05F) --------------------------------------------------------
void __thiscall ZISeekableStream::~ZISeekableStream(ZISeekableStream *this)
{
  this->vfptr = (ZIStreamVtbl *)&ZIStream::`vftable';
}
// 443550: using guessed type int (__thiscall *ZIStream::`vftable')(void *p, unsigned int __flags);

//----- (0041C066) --------------------------------------------------------
ZFileStream *__thiscall ZFileStream::`scalar deleting destructor'(ZFileStream *this, unsigned int __flags)
{
  ZFileStream *v2; // esi@1

  v2 = this;
  ZFileStream::~ZFileStream(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0041C086) --------------------------------------------------------
void __thiscall ZFileStream::~ZFileStream(ZFileStream *this)
{
  ZFileStream *v1; // esi@1

  v1 = this;
  this->vfptr = (ZIStreamVtbl *)&ZFileStream::`vftable';
  ZFileStream::Close(this);
  ZFixedArray<unsigned char,65536,0>::~ZFixedArray<unsigned char,65536,0>(&v1->m_abBuff);
  v1->vfptr = (ZIStreamVtbl *)&ZIStream::`vftable';
}
// 443550: using guessed type int (__thiscall *ZIStream::`vftable')(void *p, unsigned int __flags);
// 443888: using guessed type int (__thiscall *ZFileStream::`vftable')(void *p, unsigned int __flags);

//----- (0041C0C8) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x48u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (0041C11C) --------------------------------------------------------
CLog::FILEINFO *__cdecl construct(CLog::FILEINFO *p)
{
  CLog::FILEINFO *result; // eax@1

  result = p;
  if ( p )
  {
    p->sFileTitle._m_pStr = 0;
    p->pfs.p = 0;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041C130) --------------------------------------------------------
void _E39_4()
{
  _E33_4();
  _E34_5();
  _E35_6();
  _E36_6();
  _E37_5();
  _E38_2();
}

//----- (0041C14E) --------------------------------------------------------
void _E33_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0041C189) --------------------------------------------------------
void _E34_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0041C1C4) --------------------------------------------------------
void _E35_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0041C1FF) --------------------------------------------------------
void _E36_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0041C23A) --------------------------------------------------------
void _E37_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0041C275) --------------------------------------------------------
void _E38_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0041C2B0) --------------------------------------------------------
int __thiscall ZFileStream::Close(ZFileStream *this)
{
  ZFileStream *v1; // esi@1
  int v2; // edi@1
  int v3; // ebx@1
  void *v4; // eax@1
  int v5; // eax@3
  int v7; // [sp+0h] [bp-Ch]@1

  v1 = this;
  v2 = ZFileStream::Unmap(this, 1);
  v3 = ((int (__cdecl *)())dword_4A474C)();
  v4 = v1->m_hFile;
  if ( v4 != (void *)-1 )
  {
    if ( v4 )
      v5 = dword_4A4638(v1->m_hFile);
    else
      v5 = 1;
    if ( v5 && v2 )
    {
      v2 = 1;
    }
    else
    {
      v2 = 0;
      if ( !v3 )
        v3 = dword_4A474C(v7);
    }
    v1->m_hFile = (void *)-1;
  }
  v1->m_state = 0;
  dword_4A4750(v3);
  return v2;
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);
// 4A4750: using guessed type int (__stdcall *dword_4A4750)(_DWORD);

//----- (0041C30E) --------------------------------------------------------
void __thiscall ZFileStream::OpenForWriting(ZFileStream *this, const char *sFileName, unsigned int dwCreationDisposition, unsigned int dwFlagsAndAttributes, unsigned int dwShareMode, unsigned int dwDesiredAccess, _SECURITY_ATTRIBUTES *lpSecurityAttributes, void *hTemplateFile)
{
  ZFileStream *v8; // esi@1
  int v9; // eax@3

  v8 = this;
  if ( !ZFileStream::Close(this) )
  {
    dwDesiredAccess = ((int (__cdecl *)())dword_4A474C)();
    _CxxThrowException(&dwDesiredAccess, &_TI1_AVZException__);
  }
  v9 = dword_4A46FC(
         sFileName,
         dwDesiredAccess,
         dwShareMode,
         lpSecurityAttributes,
         dwCreationDisposition,
         dwFlagsAndAttributes,
         hTemplateFile);
  v8->m_hFile = (void *)v9;
  if ( v9 == -1 )
  {
    dwDesiredAccess = ((int (__cdecl *)())dword_4A474C)();
    _CxxThrowException(&dwDesiredAccess, &_TI1_AVZException__);
  }
  LODWORD(v8->m_uPos) = 0;
  v8->m_state |= 1u;
  HIDWORD(v8->m_uPos) = 0;
  if ( BYTE3(dwDesiredAccess) & 0x40 )
    v8->m_state |= 2u;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A46FC: using guessed type int (__stdcall *dword_4A46FC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0041C38E) --------------------------------------------------------
__int64 __thiscall ZFileStream::GetPosition(ZFileStream *this)
{
  __int64 result; // rax@1
  int v2; // [sp+4h] [bp-4h]@2

  result = LODWORD(this->m_uPos);
  if ( HIDWORD(this->m_uPos) )
  {
    v2 = 1;
    _CxxThrowException(&v2, &_TI1_AVZException__);
  }
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041C3BD) --------------------------------------------------------
unsigned __int64 __thiscall ZFileStream::GetPosition64(ZFileStream *this)
{
  return this->m_uPos;
}

//----- (0041C3C4) --------------------------------------------------------
void __thiscall ZFileStream::SetPosition(ZFileStream *this, int nPos, unsigned int uMethod)
{
  ((void (__stdcall *)(_DWORD, _DWORD, _DWORD))this->vfptr[1].ReadEOF)(nPos, (unsigned __int64)nPos >> 32, uMethod);
}

//----- (0041C3D9) --------------------------------------------------------
void __thiscall ZFileStream::SetPosition64(ZFileStream *this, __int64 nPos, unsigned int uMethod)
{
  unsigned int v3; // edx@1
  unsigned int v4; // eax@1
  ZFileStream *v5; // esi@1
  unsigned int v6; // ecx@1

  v3 = uMethod;
  v4 = HIDWORD(nPos);
  v5 = this;
  v6 = nPos;
  if ( uMethod == 1 )
  {
    v4 = (nPos + v5->m_uPos) >> 32;
    v6 = nPos + LODWORD(v5->m_uPos);
    v3 = 0;
  }
  if ( !v5->m_pMap || v3 || v5->m_uMapBegin > __PAIR__(v4, v6) && __PAIR__(v4, v6) < v5->m_uMapEnd )
  {
    v5->m_uPos = ZFileStream::_SetRealPosition(v5->m_hFile, __PAIR__(v4, v6), v3);
  }
  else
  {
    LODWORD(v5->m_uPos) = v6;
    HIDWORD(v5->m_uPos) = v4;
  }
}

//----- (0041C444) --------------------------------------------------------
__int64 __cdecl ZFileStream::_SetRealPosition(void *hFile, unsigned __int64 uPos, unsigned int uMethod)
{
  _LARGE_INTEGER li; // [sp+0h] [bp-8h]@1

  li.QuadPart = uPos;
  if ( dword_4A4710(hFile, uPos, (char *)&li.QuadPart + 4, uMethod) == -1 && dword_4A474C(-1) )
  {
    uMethod = dword_4A474C(li.LowPart);
    _CxxThrowException(&uMethod, &_TI1_AVZException__);
  }
  return li.QuadPart;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4710: using guessed type int (__stdcall *dword_4A4710)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0041C497) --------------------------------------------------------
int __thiscall ZFileStream::GetLength(ZFileStream *this)
{
  int result; // eax@1
  int v2; // edx@1
  int v3; // [sp+0h] [bp-4h]@2

  result = ((int (__stdcall *)(ZFileStream *))this->vfptr[1].WriteEOF)(this);
  if ( v2 )
    _CxxThrowException(&v3, 1);
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041C4C1) --------------------------------------------------------
unsigned __int64 __thiscall ZFileStream::GetLength64(ZFileStream *this)
{
  _ULARGE_INTEGER uli; // [sp+0h] [bp-Ch]@1
  int v3; // [sp+8h] [bp-4h]@3

  if ( dword_4A470C(this->m_hFile, (char *)&uli.QuadPart + 4) == -1 && dword_4A474C(-1) )
  {
    v3 = dword_4A474C(uli.LowPart);
    _CxxThrowException(&v3, &_TI1_AVZException__);
  }
  return uli.QuadPart;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A470C: using guessed type int (__stdcall *dword_4A470C)(_DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0041C505) --------------------------------------------------------
void __thiscall ZFileStream::SetLength(ZFileStream *this, unsigned int uLen)
{
  ((void (__stdcall *)(_DWORD, _DWORD))this->vfptr[1].CopyTo)(uLen, 0);
}

//----- (0041C513) --------------------------------------------------------
void __cdecl ZFileStream::SetLength64(unsigned __int64 uLen)
{
  ZFileStream *this; // ecx@0
  ZFileStream *v2; // esi@1
  bool v3; // zf@1
  __int64 v4; // rax@3
  int v5; // ecx@3
  int v6; // eax@4
  unsigned __int64 v7; // ST04_8@4
  void *v8; // [sp-4h] [bp-28h]@3
  int v9; // [sp+0h] [bp-24h]@1
  int v10; // [sp+Ch] [bp-18h]@5
  int v11; // [sp+10h] [bp-14h]@2
  int *v12; // [sp+14h] [bp-10h]@1
  int v13; // [sp+20h] [bp-4h]@4
  int uPos_4; // [sp+30h] [bp+Ch]@4

  v2 = this;
  v3 = this->m_pMap == 0;
  v12 = &v9;
  if ( !v3 )
  {
    v11 = 1;
    _CxxThrowException(&v11, &_TI1_AVZException__);
  }
  v4 = ZFileStream::_SetRealPosition(this->m_hFile, uLen, 0);
  v8 = v2->m_hFile;
  if ( !dword_4A4714(v5, HIDWORD(v4)) )
  {
    v6 = dword_4A474C(v8);
    HIDWORD(v7) = HIDWORD(v2->m_uPos);
    uPos_4 = v6;
    LODWORD(v7) = v2->m_uPos;
    v13 = 0;
    ZFileStream::_SetRealPosition(v2->m_hFile, v7, 0);
    v13 = -1;
    v10 = uPos_4;
    _CxxThrowException(&v10, &_TI1_AVZException__);
  }
  ZFileStream::_SetRealPosition(v2->m_hFile, v2->m_uPos, 0);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4714: using guessed type int (__fastcall *dword_4A4714)(_DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0041C5C2) --------------------------------------------------------
unsigned int __userpurge ZFileStream::Read@<eax>(__int64 this@<ebx:ecx>, void *pData, unsigned int uSize)
{
  int v3; // esi@1
  unsigned __int64 v4; // rax@2
  unsigned int v5; // ebx@7
  unsigned __int8 v6; // cf@7
  unsigned int result; // eax@7
  unsigned __int64 v8; // ST08_8@8
  int v9; // [sp+0h] [bp-10h]@10
  unsigned int dwRead; // [sp+Ch] [bp-4h]@9

  v3 = this;
  if ( *(_DWORD *)(this + 24) )
  {
    HIDWORD(v4) = *(_DWORD *)(this + 12);
    LODWORD(this) = *(_DWORD *)(this + 36);
    LODWORD(v4) = *(_DWORD *)(v3 + 8);
    if ( (unsigned int)this <= HIDWORD(v4) )
    {
      if ( (unsigned int)this < HIDWORD(v4)
        || (LODWORD(this) = *(_DWORD *)(v3 + 32), (unsigned int)this <= (unsigned int)v4) )
      {
        this = *(_QWORD *)(v3 + 40);
        if ( v4 <= this )
        {
          if ( v4 + uSize <= *(_QWORD *)(v3 + 40) )
          {
            v5 = uSize;
            memcpy(pData, (const void *)(*(_DWORD *)(v3 + 24) + *(_DWORD *)(v3 + 8)), uSize);
            v6 = __CFADD__(v5, *(_DWORD *)(v3 + 8));
            *(_DWORD *)(v3 + 8) += v5;
            result = v5;
            *(_DWORD *)(v3 + 12) += v6;
            return result;
          }
          HIDWORD(v8) = HIDWORD(v4);
          LODWORD(v8) = *(_DWORD *)(v3 + 8);
          *(_QWORD *)(v3 + 8) = ZFileStream::_SetRealPosition((void *)*(_DWORD *)(v3 + 16), v8, 0);
        }
      }
    }
  }
  dwRead = 0;
  if ( !dword_4A4700(this, *(_DWORD *)(v3 + 16), pData, uSize, &dwRead, 0) && ((int (__cdecl *)())dword_4A474C)() != 109 )
  {
    uSize = dword_4A474C(v9);
    _CxxThrowException(&uSize, &_TI1_AVZException__);
  }
  result = dwRead;
  *(_QWORD *)(v3 + 8) += dwRead;
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4700: using guessed type int (__thiscall *dword_4A4700)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0041C693) --------------------------------------------------------
ZRefCountedDummy<ZFileStream> *__thiscall ZRefCountedDummy<ZFileStream>::`vector deleting destructor'(ZRefCountedDummy<ZFileStream> *this, unsigned int a2)
{
  return ZRefCountedDummy<ZFileStream>::`scalar deleting destructor'(
           (ZRefCountedDummy<ZFileStream> *)((char *)this - 12),
           a2);
}

//----- (0041C69B) --------------------------------------------------------
unsigned int __thiscall ZFileStream::ReadFromSpecificPos(ZFileStream *this, unsigned int uPos, char *pData, unsigned int uSize)
{
  ZFileStream *v4; // esi@1
  unsigned __int64 v5; // rax@2
  unsigned int v6; // ebx@5
  unsigned __int8 v7; // cf@5
  unsigned int result; // eax@5
  void *v9; // ST04_4@7
  DWORD v10; // eax@7
  int v11; // ecx@7
  int v12; // eax@8
  int v13; // [sp+0h] [bp-10h]@11
  unsigned int dwRead; // [sp+Ch] [bp-4h]@7

  v4 = this;
  if ( this->m_pMap )
  {
    v5 = this->m_uPos;
    if ( this->m_uMapBegin <= v5 && v5 <= this->m_uMapEnd )
    {
      if ( v5 + uSize <= this->m_uMapEnd )
      {
        v6 = uSize;
        memcpy(pData, (char *)this->m_pMap + LODWORD(this->m_uPos), uSize);
        v7 = __CFADD__(v6, v4->m_uPos);
        LODWORD(v4->m_uPos) += v6;
        result = v6;
        HIDWORD(v4->m_uPos) += v7;
        return result;
      }
      this->m_uPos = ZFileStream::_SetRealPosition(this->m_hFile, this->m_uPos, 0);
    }
  }
  v9 = v4->m_hFile;
  dwRead = 0;
  v10 = SetFilePointer(v9, 0, 0, 1u);
  if ( v10 != uPos )
  {
    v12 = dword_4A4710(v4->m_hFile, uPos, 0, 0);
    if ( v12 != uPos )
    {
      uPos = ((int (__cdecl *)())dword_4A474C)();
      _CxxThrowException(&uPos, &_TI1_AVZException__);
    }
  }
  if ( !dword_4A4700(v11, v4->m_hFile, pData, uSize, &dwRead, 0) && ((int (__cdecl *)())dword_4A474C)() != 109 )
  {
    uPos = dword_4A474C(v13);
    _CxxThrowException(&uPos, &_TI1_AVZException__);
  }
  result = dwRead;
  v4->m_uPos += dwRead;
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4700: using guessed type int (__thiscall *dword_4A4700)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A4710: using guessed type int (__stdcall *dword_4A4710)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0041C7AB) --------------------------------------------------------
unsigned int __thiscall ZFileStream::Write(ZFileStream *this, const void *pData, unsigned int uSize)
{
  ZFileStream *v3; // esi@1
  unsigned __int64 v4; // rax@2
  unsigned int v5; // ebx@5
  unsigned __int8 v6; // cf@5
  unsigned int result; // eax@5
  unsigned int dwWritten; // [sp+Ch] [bp-4h]@7

  v3 = this;
  if ( this->m_pMap )
  {
    v4 = this->m_uPos;
    if ( this->m_uMapBegin <= v4 && v4 <= this->m_uMapEnd )
    {
      if ( v4 + uSize <= this->m_uMapEnd )
      {
        v5 = uSize;
        memcpy((char *)this->m_pMap + LODWORD(this->m_uPos), pData, uSize);
        v6 = __CFADD__(v5, v3->m_uPos);
        LODWORD(v3->m_uPos) += v5;
        result = v5;
        HIDWORD(v3->m_uPos) += v6;
        return result;
      }
      this->m_uPos = ZFileStream::_SetRealPosition(this->m_hFile, this->m_uPos, 0);
    }
  }
  dwWritten = 0;
  if ( !dword_4A4704(v3->m_hFile, pData, uSize, &dwWritten, 0) )
  {
    uSize = ((int (__cdecl *)())dword_4A474C)();
    _CxxThrowException(&uSize, &_TI1_AVZException__);
  }
  result = dwWritten;
  v3->m_uPos += dwWritten;
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4704: using guessed type int (__stdcall *dword_4A4704)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0041C871) --------------------------------------------------------
void __thiscall ZFileStream::Flush(ZFileStream *this, int bAll)
{
  ZFileStream *v2; // esi@1
  void *v3; // eax@1
  int v4; // [sp+4h] [bp-4h]@3

  v2 = this;
  v3 = this->m_pMap;
  if ( v3 && !dword_4A46E8(v3, 0) )
  {
    v4 = ((int (__cdecl *)())dword_4A474C)();
    _CxxThrowException(&v4, &_TI1_AVZException__);
  }
  if ( v2->m_state & 2 )
  {
    if ( !dword_4A4708(v2->m_hFile) )
    {
      v4 = ((int (__cdecl *)())dword_4A474C)();
      _CxxThrowException(&v4, &_TI1_AVZException__);
    }
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A46E8: using guessed type int (__stdcall *dword_4A46E8)(_DWORD, _DWORD);
// 4A4708: using guessed type int (__stdcall *dword_4A4708)(_DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0041C8D2) --------------------------------------------------------
unsigned int __thiscall ZFileStream::ReadEOF(ZFileStream *this, void *pData, unsigned int uSize)
{
  ZFileStream *v3; // esi@1
  unsigned int v4; // edi@1
  unsigned __int64 v5; // rax@2
  char *v6; // ebx@5
  int v7; // eax@6

  v3 = this;
  v4 = uSize;
  if ( this->m_pMap && (v5 = this->m_uPos, this->m_uMapBegin <= v5) && uSize + v5 <= this->m_uMapEnd )
  {
    memcpy(pData, (char *)this->m_pMap + LODWORD(this->m_uPos), uSize);
    v3->m_uPos += uSize;
  }
  else
  {
    v6 = (char *)pData;
    if ( uSize )
    {
      while ( 1 )
      {
        v7 = (*(int (__thiscall **)(ZFileStream *, void *, unsigned int))&v3->vfptr->gap4[0])(v3, v6, uSize);
        if ( !v7 )
          break;
        v6 += v7;
        uSize -= v7;
        if ( !uSize )
          return v4;
      }
      v4 -= uSize;
    }
  }
  return v4;
}

//----- (0041C959) --------------------------------------------------------
unsigned int __thiscall ZFileStream::WriteEOF(ZFileStream *this, const void *pData, unsigned int uSize)
{
  ZFileStream *v3; // esi@1
  unsigned int v4; // edi@1
  unsigned __int64 v5; // rax@2
  char *v6; // ebx@5
  int v7; // eax@6

  v3 = this;
  v4 = uSize;
  if ( this->m_pMap && (v5 = this->m_uPos, this->m_uMapBegin <= v5) && uSize + v5 <= this->m_uMapEnd )
  {
    memcpy((char *)this->m_pMap + LODWORD(this->m_uPos), pData, uSize);
    v3->m_uPos += uSize;
  }
  else
  {
    v6 = (char *)pData;
    if ( uSize )
    {
      while ( 1 )
      {
        v7 = v3->vfptr->Write((ZIStream *)v3, v6, uSize);
        if ( !v7 )
          break;
        v6 += v7;
        uSize -= v7;
        if ( !uSize )
          return v4;
      }
      v4 -= uSize;
    }
  }
  return v4;
}

//----- (0041C9E0) --------------------------------------------------------
int __thiscall ZFileStream::CopyTo(ZFileStream *this, ZIStream *pStream, unsigned int uSize)
{
  ZFileStream *v3; // esi@1
  char *v4; // edx@1
  unsigned int v5; // edi@1
  unsigned int v6; // ecx@2
  unsigned int v7; // eax@2
  int v8; // ebx@5
  unsigned __int8 v9; // cf@9
  int result; // eax@9
  __int64 v11; // rax@11
  unsigned __int64 v12; // rax@11

  v3 = this;
  v4 = (char *)this->m_pMap;
  v5 = uSize;
  if ( v4 )
  {
    v6 = HIDWORD(this->m_uPos);
    v7 = v3->m_uPos;
    if ( v3->m_uMapBegin <= __PAIR__(v6, v7) )
    {
      if ( !uSize )
      {
        if ( v3->m_state & 4 )
        {
          v8 = (v3->m_uMapEnd - __PAIR__(v6, v7)) >> 32;
          v5 = LODWORD(v3->m_uMapEnd) - v7;
LABEL_7:
          if ( v5 != ((int (__stdcall *)(char *, unsigned int))pStream->vfptr->WriteEOF)(&v4[LODWORD(v3->m_uPos)], v5) )
          {
            pStream = (ZIStream *)38;
            _CxxThrowException(&pStream, &_TI1_AVZException__);
          }
          v9 = __CFADD__(v5, v3->m_uPos);
          LODWORD(v3->m_uPos) += v5;
          result = v5;
          HIDWORD(v3->m_uPos) += v8 + v9;
          return result;
        }
        goto LABEL_11;
      }
      v8 = 0;
      if ( uSize + __PAIR__(v6, v7) <= v3->m_uMapEnd )
        goto LABEL_7;
    }
  }
  if ( uSize )
  {
    HIDWORD(v12) = 0;
    goto LABEL_13;
  }
LABEL_11:
  LODWORD(v11) = ((int (__thiscall *)(ZFileStream *))v3->vfptr[1].WriteEOF)(v3);
  v12 = v11 - v3->m_uPos;
LABEL_13:
  if ( HIDWORD(v12) )
  {
    pStream = (ZIStream *)87;
    _CxxThrowException(&pStream, &_TI1_AVZException__);
  }
  return ((int (__stdcall *)(ZFileStream *, unsigned int))pStream->vfptr->CopyFrom)(v3, v5);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041CAAB) --------------------------------------------------------
int __thiscall ZFileStream::CopyFrom(ZFileStream *this, ZIStream *pStream, unsigned int uSize)
{
  ZFileStream *v3; // esi@1
  unsigned int v4; // ecx@2
  unsigned int v5; // eax@2
  unsigned int v6; // edx@5
  int result; // eax@8
  char *v8; // eax@9

  v3 = this;
  if ( this->m_pMap )
  {
    v4 = HIDWORD(this->m_uPos);
    v5 = v3->m_uPos;
    if ( v3->m_uMapBegin <= __PAIR__(v4, v5) )
    {
      if ( uSize )
      {
        if ( uSize + __PAIR__(v4, v5) <= v3->m_uMapEnd )
        {
          v6 = uSize;
          goto LABEL_8;
        }
      }
      else if ( v3->m_state & 4 )
      {
        v6 = LODWORD(v3->m_uMapEnd) - v5;
LABEL_8:
        result = ((int (__stdcall *)(_DWORD, _DWORD))pStream->vfptr->ReadEOF)(
                   (char *)v3->m_pMap + LODWORD(v3->m_uPos),
                   v6);
        v3->m_uPos += (unsigned int)result;
        return result;
      }
    }
  }
  v8 = ZFixedArray<unsigned char,65536,0>::_Alloc(&v3->m_abBuff);
  return ZIStream::CopyFromHelper((ZIStream *)&v3->vfptr, pStream, uSize, v8, 0x10000u);
}

//----- (0041CB3D) --------------------------------------------------------
int __thiscall ZFileStream::Unmap(ZFileStream *this, int bDestroyMappingObject)
{
  ZFileStream *v2; // esi@1
  void *v3; // eax@1
  int v4; // edi@1
  int v5; // eax@3
  void *v6; // ST00_4@3
  int v8; // [sp+0h] [bp-18h]@0
  _LARGE_INTEGER li; // [sp+Ch] [bp-Ch]@3
  unsigned int dwError; // [sp+14h] [bp-4h]@1

  v2 = this;
  v3 = this->m_pMap;
  dwError = 0;
  v4 = 1;
  if ( v3 )
  {
    v4 = dword_4A46E4(v3);
    if ( !v4 )
    {
LABEL_6:
      dwError = dword_4A474C(v8);
      goto LABEL_7;
    }
    v5 = v2->m_uPos;
    li.HighPart = HIDWORD(v2->m_uPos);
    v6 = v2->m_hFile;
    v2->m_pMap = 0;
    if ( dword_4A4710(v6, v5, (char *)&li.QuadPart + 4, 0) == -1 && ((int (__cdecl *)())dword_4A474C)() )
    {
      v4 = 0;
      goto LABEL_6;
    }
  }
LABEL_7:
  if ( bDestroyMappingObject && v2->m_hMap )
  {
    if ( dword_4A4638(v2->m_hMap) && v4 )
    {
      v4 = 1;
    }
    else
    {
      v4 = 0;
      if ( !dwError )
        dwError = dword_4A474C(v8);
    }
    v2->m_hMap = 0;
  }
  dword_4A4750(dwError);
  return v4;
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);
// 4A46E4: using guessed type int (__stdcall *dword_4A46E4)(_DWORD);
// 4A4710: using guessed type int (__stdcall *dword_4A4710)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);
// 4A4750: using guessed type int (__stdcall *dword_4A4750)(_DWORD);

//----- (0041CBE4) --------------------------------------------------------
void __thiscall _com_error::_com_error(_com_error *this, int hr, IErrorInfo *perrinfo, char fAddRef)
{
  this->m_pszMsg = 0;
  this->m_hresult = hr;
  this->m_perrinfo = perrinfo;
  this->vfptr = (_com_errorVtbl *)&_com_error::`vftable';
  if ( perrinfo )
  {
    if ( fAddRef )
      perrinfo->vfptr->AddRef((IUnknown *)perrinfo);
  }
}
// 4438D8: using guessed type int (__thiscall *_com_error::`vftable')(void *p, unsigned int __flags);

//----- (0041CC16) --------------------------------------------------------
_com_error *__thiscall _com_error::`scalar deleting destructor'(_com_error *this, unsigned int __flags)
{
  _com_error *v2; // esi@1

  v2 = this;
  _com_error::~_com_error(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0041CC36) --------------------------------------------------------
void __thiscall _com_error::~_com_error(_com_error *this)
{
  _com_error *v1; // esi@1
  IErrorInfo *v2; // eax@1
  char *v3; // esi@3

  v1 = this;
  v2 = this->m_perrinfo;
  this->vfptr = (_com_errorVtbl *)&_com_error::`vftable';
  if ( v2 )
    v2->vfptr->Release((IUnknown *)v2);
  v3 = v1->m_pszMsg;
  if ( v3 )
    LocalFree(v3);
}
// 4438D8: using guessed type int (__thiscall *_com_error::`vftable')(void *p, unsigned int __flags);

//----- (0041CC5C) --------------------------------------------------------
void __thiscall CLog::CLog(CLog *this)
{
  CLog *v1; // esi@1

  v1 = this;
  TSingleton<CLog>::ms_pInstance = (CLog *)(&this->m_afi != 0 ? (unsigned int)this : 0);
  this->_m_dwThreadId = 0;
  this->_m_hThread = 0;
  this->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  this->m_afi.a = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lockFileLog.DebugInfo);
  v1->m_lFileLog._m_uCount = 0;
  v1->m_lFileLog._m_pHead = 0;
  v1->m_lFileLog._m_pTail = 0;
  v1->m_lFileLog.vfptr = (ZList<CLog::FILELOG>Vtbl *)&ZList<CLog::FILELOG>::`vftable';
  v1->vfptr = (ZThreadVtbl *)&CLog::`vftable';
}
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);
// 443864: using guessed type int (__thiscall *ZList<CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);
// 44386C: using guessed type int (__thiscall *CLog::`vftable')(void *p, unsigned int __flags);

//----- (0041CCA9) --------------------------------------------------------
void __thiscall CLog::AddFileLog(CLog *this, int uIdx, ZXString<char> sLog)
{
  CLog *v3; // edi@1
  struct _RTL_CRITICAL_SECTION *v4; // esi@1
  CLog::FILELOG *v5; // eax@1

  v3 = this;
  v4 = (struct _RTL_CRITICAL_SECTION *)&this->m_lockFileLog.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockFileLog.DebugInfo);
  v5 = ZList<CLog::FILELOG>::AddTail(&v3->m_lFileLog);
  v5->uIdx = uIdx;
  ZXString<char>::operator=(&v5->sLog, &sLog);
  LeaveCriticalSection(v4);
  ZXString<char>::~ZXString<char>(&sLog);
}

//----- (0041CD09) --------------------------------------------------------
CLog::FILELOG *__thiscall ZList<CLog::FILELOG>::AddTail(ZList<CLog::FILELOG> *this)
{
  ZList<CLog::FILELOG> *v1; // esi@1
  CLog::FILELOG *result; // eax@1
  CLog::FILELOG *v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<CLog::FILELOG>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)&result[-2] : 0;
    (v3 != 0 ? &v3[-2].sLog : 4)->_m_pStr = (char *)v4;
    result = (CLog::FILELOG *)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (0041CD47) --------------------------------------------------------
CLog::FILELOG *__thiscall ZList<CLog::FILELOG>::_New(ZList<CLog::FILELOG> *this, void *pPrev, void *pNext)
{
  ZList<CLog::FILELOG> *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (CLog::FILELOG *)(v4 != 0 ? v4 + 16 : 0);
}

//----- (0041CD86) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<CLog::FILELOG> *v0; // ecx@1

  v0 = (ZRefCountedDummy<CLog::FILELOG> *)ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<CLog::FILELOG>::ZRefCountedDummy<CLog::FILELOG>(v0);
}

//----- (0041CDBB) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance,
    p);
}

//----- (0041CDCB) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0041CDF1) --------------------------------------------------------
void __thiscall ZRefCountedDummy<CLog::FILELOG>::ZRefCountedDummy<CLog::FILELOG>(ZRefCountedDummy<CLog::FILELOG> *this)
{
  ZRefCountedDummy<CLog::FILELOG> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>Vtbl *)&ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable';
  v1->t.sLog._m_pStr = 0;
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<CLog::FILELOG>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>Vtbl *)&ZRefCountedDummy<CLog::FILELOG>::`vftable'{for `ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4438E0: using guessed type void *ZRefCountedDummy<CLog::FILELOG>::`vftable'{for `ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>'};
// 4438E8: using guessed type int (__thiscall *ZRefCountedDummy<CLog::FILELOG>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 4438F0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);

//----- (0041CE23) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *__thiscall ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`scalar deleting destructor'(ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>Vtbl *)&ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance,
      this);
  return v2;
}
// 4438F0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);

//----- (0041CE45) --------------------------------------------------------
ZRefCountedDummy<CLog::FILELOG> *__thiscall ZRefCountedDummy<CLog::FILELOG>::`vector deleting destructor'(ZRefCountedDummy<CLog::FILELOG> *this, unsigned int __flags)
{
  ZRefCountedDummy<CLog::FILELOG> *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<CLog::FILELOG>::~ZRefCountedDummy<CLog::FILELOG>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance,
      v2);
  return v2;
}

//----- (0041CE66) --------------------------------------------------------
void __thiscall ZRefCountedDummy<CLog::FILELOG>::~ZRefCountedDummy<CLog::FILELOG>(ZRefCountedDummy<CLog::FILELOG> *this)
{
  ZRefCountedDummy<CLog::FILELOG> *v1; // esi@1

  v1 = this;
  ZXString<char>::~ZXString<char>(&this->t.sLog);
  *(_DWORD *)(v1 != 0 ? (unsigned int)&v1->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4438F0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);

//----- (0041CEAA) --------------------------------------------------------
void __thiscall ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::~ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this)
{
  this->vfptr = (ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>Vtbl *)&ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable';
}
// 4438F0: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::`vftable')(void *p, unsigned int __flags);

//----- (0041CEB1) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x18u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (0041CF0D) --------------------------------------------------------
CLog *__thiscall CLog::`scalar deleting destructor'(CLog *this, unsigned int __flags)
{
  CLog *v2; // esi@1

  v2 = this;
  CLog::~CLog(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0041CF2D) --------------------------------------------------------
int _E25_4()
{
  _E22_1();
  return _E24_5();
}

//----- (0041CF37) --------------------------------------------------------
void _E22_1()
{
  s_sPatchLocation._m_pStr = 0;
  ZXString<char>::Assign(&s_sPatchLocation, &sLog, -1);
  CLoginAcceptor::CLoginAcceptor(&g_loginAcceptor);
}

//----- (0041CF59) --------------------------------------------------------
int _E24_5()
{
  return atexit(_E23_3);
}

//----- (0041CF65) --------------------------------------------------------
void __cdecl _E23_3()
{
  CLoginAcceptor::~CLoginAcceptor(&g_loginAcceptor);
  ZXString<char>::~ZXString<char>(&s_sPatchLocation);
}

//----- (0041CF79) --------------------------------------------------------
void __thiscall CLoginAcceptor::CLoginAcceptor(CLoginAcceptor *this)
{
  CLoginAcceptor *v1; // esi@1
  int v2; // eax@1

  v1 = this;
  this->_m_pPort = 0;
  this->_m_sockListen._m_hSocket = -1;
  this->_m_aolAccepts.a = 0;
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&ZSocketAcceptor<CClientSocket>::`vftable';
  TSingleton<CLoginAcceptor>::ms_pInstance = (CLoginAcceptor *)(&this->m_bAcceptorClosed != 0 ? (unsigned int)this : 0);
  this->m_bAcceptorClosed = 0;
  ZPort::ZPort(&this->m_port);
  v1->m_uSerialNoCounter = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  v1->m_mSN2pSocket._m_apTable = 0;
  v1->m_mSN2pSocket._m_uCount = 0;
  v1->m_mSN2pSocket._m_uTableSize = 31;
  v1->m_mSN2pSocket.vfptr = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>Vtbl *)&ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable';
  v1->m_mSN2pSocket._m_uAutoGrowEvery128 = 100;
  v1->m_mSN2pSocket._m_uAutoGrowLimit = 24;
  v1->m_lpSocket._m_uCount = 0;
  v1->m_lpSocket._m_pHead = 0;
  v1->m_lpSocket._m_pTail = 0;
  v1->m_lpSocket.vfptr = (ZList<ZRef<CClientSocket> >Vtbl *)&ZList<ZRef<CClientSocket>>::`vftable';
  v1->m_posListIter = 0;
  v1->m_bIsLaunchingModeBeingChanged = 0;
  v1->m_bQuerySSNOnCreateNewCharacter = 0;
  v2 = (int)&v1->m_mIPCount;
  v1->m_bIgnoreSPW = 1;
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)(v2 + 12) = 0;
  *(_DWORD *)(v2 + 8) = 31;
  *(_DWORD *)(v2 + 20) = 24;
  *(_DWORD *)v2 = &ZMap<unsigned long,unsigned long,unsigned long>::`vftable';
  *(_DWORD *)(v2 + 16) = 100;
  v1->vfptr = (ZOverlapped::ZICallBackVtbl *)&CLoginAcceptor::`vftable';
}
// 4435D4: using guessed type int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable')(void *p, unsigned int __flags);
// 4438F8: using guessed type int (__cdecl *CLoginAcceptor::`vftable')(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr);
// 443910: using guessed type int (__thiscall *ZMap<unsigned long,unsigned long,unsigned long>::`vftable')(void *p, unsigned int __flags);
// 443918: using guessed type int (__thiscall *ZList<ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);
// 443920: using guessed type int (__cdecl *ZSocketAcceptor<CClientSocket>::`vftable')(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr);

//----- (0041D062) --------------------------------------------------------
CLoginAcceptor *__thiscall CLoginAcceptor::`vector deleting destructor'(CLoginAcceptor *this, unsigned int __flags)
{
  CLoginAcceptor *v2; // esi@1

  v2 = this;
  CLoginAcceptor::~CLoginAcceptor(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0041D082) --------------------------------------------------------
void __thiscall CLoginAcceptor::~CLoginAcceptor(CLoginAcceptor *this)
{
  CLoginAcceptor *v1; // esi@1

  v1 = this;
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&CLoginAcceptor::`vftable';
  CLoginAcceptor::Terminate(this);
  v1->m_mIPCount.vfptr = (ZMap<unsigned long,unsigned long,unsigned long>Vtbl *)&ZMap<unsigned long,unsigned long,unsigned long>::`vftable';
  ZMap<unsigned long,unsigned long,unsigned long>::RemoveAll(&v1->m_mIPCount);
  v1->m_lpSocket.vfptr = (ZList<ZRef<CClientSocket> >Vtbl *)&ZList<ZRef<CClientSocket>>::`vftable';
  ZList<ZRef<CClientSocket>>::RemoveAll(&v1->m_lpSocket);
  v1->m_mSN2pSocket.vfptr = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>Vtbl *)&ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable';
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveAll(&v1->m_mSN2pSocket);
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  ZPort::~ZPort(&v1->m_port);
  TSingleton<CLoginAcceptor>::ms_pInstance = 0;
  ZSocketAcceptor<CClientSocket>::~ZSocketAcceptor<CClientSocket>((ZSocketAcceptor<CClientSocket> *)&v1->vfptr);
}
// 4435D4: using guessed type int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable')(void *p, unsigned int __flags);
// 4438F8: using guessed type int (__cdecl *CLoginAcceptor::`vftable')(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr);
// 443910: using guessed type int (__thiscall *ZMap<unsigned long,unsigned long,unsigned long>::`vftable')(void *p, unsigned int __flags);
// 443918: using guessed type int (__thiscall *ZList<ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (0041D116) --------------------------------------------------------
BOOL __thiscall CLoginAcceptor::Begin(CLoginAcceptor *this, ZInetAddr *sockaddr)
{
  CLoginAcceptor *v2; // esi@1
  ZPort *v3; // edi@1

  v2 = this;
  v3 = &this->m_port;
  this->m_bIsWebDead = 1;
  return ZPort::BeginPort(&this->m_port, 0)
      && ZSocketAcceptor<CClientSocket>::BeginAcceptor(
           (ZSocketAcceptor<CClientSocket> *)&v2->vfptr,
           (sockaddr_in *)&sockaddr->sin_family,
           v3,
           10,
           0x7FFFFFFF);
}

//----- (0041D157) --------------------------------------------------------
void __thiscall CLoginAcceptor::Terminate(CLoginAcceptor *this)
{
  CLoginAcceptor *v1; // esi@1
  int v2; // edi@1
  CClientSocket *v3; // ecx@3
  int v4; // eax@3

  v1 = this;
  ZSocketAcceptor<CClientSocket>::CloseAcceptor((ZSocketAcceptor<CClientSocket> *)&this->vfptr);
  EnterCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  v1->m_bAcceptorClosed = 1;
  v2 = (int)v1->m_lpSocket._m_pHead;
  while ( v2 )
  {
    v3 = *(CClientSocket **)(v2 + 4);
    v4 = *(_DWORD *)(v2 != 0 ? v2 - 16 + 4 : 4);
    v2 = v4 != 0 ? v4 + 16 : 0;
    CClientSocket::PostClose(v3);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&v1->m_lock.DebugInfo);
  while ( v1->m_lpSocket._m_uCount )
    Sleep(0x64u);
  ZPort::ClosePort(&v1->m_port, 1);
}

//----- (0041D1EE) --------------------------------------------------------
void __thiscall CLoginAcceptor::OnAccept(CLoginAcceptor *this, unsigned int dwErr, CClientSocket *pSocket, sockaddr_in *pAddr)
{
  CClientSocket *v4; // edi@1
  CLoginAcceptor *v5; // ebx@1
  ZInetAddr *v6; // esi@3
  u_short v7; // ax@3
  int v8; // esi@3
  int v9; // esi@3
  bool v10; // zf@3
  char v11; // al@5
  signed int v12; // eax@10
  ZRef<CClientSocket> *v13; // esi@12
  CClientSocket *v14; // eax@12
  unsigned int v15; // esi@12
  char *v16; // ecx@12
  int v17; // esi@12
  CClientSocket *v18; // eax@12
  unsigned int v19; // esi@12
  CClientSocket *v20; // ecx@12
  ZSocketBuffer *v21; // eax@13
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *v22; // eax@15
  sockaddr_in *v23; // ecx@18
  sockaddr_in **v24; // eax@18
  unsigned int v25; // edx@19
  int v26; // ebx@24
  CClientSocket *v27; // ecx@26
  int v28; // ebx@42
  CClientSocket *v29; // eax@44
  char *v30; // [sp-8h] [bp-68h]@3
  ZRefCounted *v31; // [sp-4h] [bp-64h]@3
  int v32; // [sp+0h] [bp-60h]@1
  ZMap<unsigned long,unsigned long,unsigned long> v33; // [sp+Ch] [bp-54h]@18
  ZRef<CClientSocket> value; // [sp+24h] [bp-3Ch]@12
  ZRef<CClientSocket> v35; // [sp+2Ch] [bp-34h]@1
  ZRef<CClientSocket> v36; // [sp+38h] [bp-28h]@3
  LPCRITICAL_SECTION lpCriticalSection; // [sp+40h] [bp-20h]@3
  ZRef<CClientSocket> v38; // [sp+44h] [bp-1Ch]@1
  unsigned int v39; // [sp+4Ch] [bp-14h]@40
  int *v40; // [sp+50h] [bp-10h]@1
  int v41; // [sp+5Ch] [bp-4h]@1

  v4 = pSocket;
  v5 = this;
  v40 = &v32;
  v38.p = (CClientSocket *)this;
  v35.p = pSocket;
  ZRef<CClientSocket>::_AddRef(&v35);
  v41 = 0;
  if ( dwErr )
  {
    LogError(aAcceptError1U, dwErr);
LABEL_8:
    v41 = -1;
    ZRef<CClientSocket>::_Release(&v35);
    return;
  }
  v6 = (ZInetAddr *)pAddr;
  ZInetAddr::_InitN(&v4->m_addr, pAddr->sin_port, pAddr->sin_addr.S_un.S_addr);
  v7 = ntohs(v6->sin_port);
  dwErr = (unsigned int)&v4->m_sAddr;
  v31 = (ZRefCounted *)v7;
  v30 = ZInetAddr::GetAddr(v6);
  ZXString<char>::Format((ZXString<char> *)dwErr, sFormat, v30, v31);
  v8 = rand() << 16;
  v4->m_uSeqRcv = rand() | v8;
  v9 = rand() << 16;
  v4->m_uSeqSnd = rand() | v9;
  v36.p = (CClientSocket *)&v5->m_lock;
  lpCriticalSection = (LPCRITICAL_SECTION)&v5->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&v5->m_lock.DebugInfo);
  v10 = v5->m_bIsLaunchingModeBeingChanged == 0;
  LOBYTE(v41) = 1;
  if ( !v10 || v5->m_bAcceptorClosed )
  {
LABEL_7:
    LeaveCriticalSection((LPCRITICAL_SECTION)&v5->m_lock.DebugInfo);
    goto LABEL_8;
  }
  v11 = CIPFilter::IsBlocked(TSingleton<CIPFilter>::ms_pInstance, pAddr->sin_addr.S_un.S_addr);
  v4->m_bIPBlockType = v11;
  if ( v11 == 1 )
  {
    LogReport(aConnectionRefu, *(_DWORD *)dwErr);
    goto LABEL_7;
  }
  v10 = v5->m_uSerialNoCounter++ == -1;
  v12 = v5->m_uSerialNoCounter;
  LOBYTE(v41) = 2;
  if ( v10 )
  {
    v12 = 1;
    v5->m_uSerialNoCounter = 1;
  }
  v4->m_uLocalSocketSN = v12;
  value.p = v4;
  ZRef<CClientSocket>::_AddRef(&value);
  LOBYTE(v41) = 3;
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::Insert(&v5->m_mSN2pSocket, &v4->m_uLocalSocketSN, &value);
  LOBYTE(v41) = 2;
  ZRef<CClientSocket>::_Release(&value);
  value.p = v4;
  ZRef<CClientSocket>::_AddRef(&value);
  LOBYTE(v41) = 4;
  v13 = ZList<ZRef<CClientSocket>>::AddTail(&v5->m_lpSocket);
  ZRef<CClientSocket>::operator=(v13, &value);
  v4->m_posList = (__POSITION *)v13;
  LOBYTE(v41) = 2;
  ZRef<CClientSocket>::_Release(&value);
  ZSocketEx::AttachPort((ZSocketEx *)&v4->vfptr, &v5->m_port);
  v31 = (ZRefCounted *)((char *)&dwErr + 3);
  v41 = 1;
  LOBYTE(v41) = 6;
  ZSocketBuffer::Alloc(0x5B4u);
  value.p = v14;
  ZRef<ZSocketBuffer>::_AddRef((ZRef<ZSocketBuffer> *)&value);
  v15 = value.p->_m_hSocket;
  v38.p = (CClientSocket *)v15;
  v15 += 2;
  *(_WORD *)v15 = 1;
  v30 = v16;
  v36.p = (CClientSocket *)&v30;
  LOBYTE(v41) = 7;
  ZXString<char>::ZXString<char>((ZXString<char> *)&v30, &s_sPatchLocation);
  v17 = CIOBufferManipulator::EncodeStr((ZXString<char>)v30, (char *)(v15 + 2)) + v15 + 2;
  *(_DWORD *)v17 = v4->m_uSeqRcv;
  *(_DWORD *)(v17 + 4) = v4->m_uSeqSnd;
  v18 = v38.p;
  v17 += 8;
  *(_BYTE *)v17 = 5;
  LOWORD(v17) = v17 + 1 - (_WORD)v18 - 2;
  LOWORD(v18->vfptr) = v17;
  v38.p = value.p;
  v19 = (unsigned __int16)v17 + 2;
  v20 = (CClientSocket *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x1Cu);
  v36.p = v20;
  LOBYTE(v41) = 8;
  if ( v20 )
  {
    v31 = (ZRefCounted *)&v38.p->vfptr;
    ZSocketBuffer::ZSocketBuffer((ZSocketBuffer *)v20, v19, (char *)v38.p->_m_hSocket, (ZSocketBuffer *)v38.p);
  }
  else
  {
    v21 = 0;
  }
  LOBYTE(v41) = 7;
  ZSocketEx::SendPacket((ZSocketEx *)&v4->vfptr, v21);
  v38.p = (CClientSocket *)pAddr->sin_addr.S_un.S_addr;
  v22 = ZMap<unsigned long,unsigned long,unsigned long>::GetPos(&v5->m_mIPCount, (const unsigned int *)&v38.p);
  if ( !v22 )
  {
    pAddr = (sockaddr_in *)pAddr->sin_addr.S_un.S_addr;
    v38.p = (CClientSocket *)1;
    ZMap<unsigned long,unsigned long,unsigned long>::Insert(
      &v5->m_mIPCount,
      (const unsigned int *)&pAddr,
      (const unsigned int *)&v38.p);
    goto LABEL_17;
  }
  if ( ++v22->value <= 0x1E )
  {
LABEL_17:
    if ( (signed int)v5->m_lpSocket._m_uCount > 5000 )
    {
      LogError(aIpConnectionCo);
      v23 = 0;
      v33._m_apTable = 0;
      v33._m_uTableSize = 31;
      v33._m_uCount = 0;
      v33.vfptr = (ZMap<unsigned long,unsigned long,unsigned long>Vtbl *)&ZMap<unsigned long,unsigned long,unsigned long>::`vftable';
      v33._m_uAutoGrowEvery128 = 100;
      v33._m_uAutoGrowLimit = 24;
      v24 = (sockaddr_in **)v5->m_mIPCount._m_apTable;
      LOBYTE(v41) = 10;
      if ( v24 )
      {
        v25 = (unsigned int)&v24[v5->m_mIPCount._m_uTableSize];
        while ( (unsigned int)v24 < v25 )
        {
          v23 = *v24;
          if ( *v24 )
            goto LABEL_38;
          ++v24;
        }
        v23 = 0;
      }
LABEL_38:
      pAddr = v23;
      while ( pAddr )
      {
        v39 = 0;
        v38.p = 0;
        v38.p = *(CClientSocket **)ZMap<unsigned long,unsigned long,unsigned long>::GetNext(
                                     &v5->m_mIPCount,
                                     (__POSITION **)&pAddr,
                                     &v39);
        if ( v39 > 0xA )
        {
          v36.p = (CClientSocket *)1;
          ZMap<unsigned long,unsigned long,unsigned long>::Insert(
            &v33,
            (const unsigned int *)&v38.p,
            (const unsigned int *)&v36.p);
        }
      }
      v28 = (int)v5->m_lpSocket._m_pHead;
      while ( v28 )
      {
        v29 = *(CClientSocket **)(v28 + 4);
        v28 = *(_DWORD *)(v28 - 12) != 0 ? *(_DWORD *)(v28 - 12) + 16 : 0;
        v38.p = v29;
        if ( v29 )
        {
          InterlockedIncrement(&v29->_m_nRef);
          v29 = v38.p;
        }
        LOBYTE(v41) = 11;
        if ( v29 )
        {
          v36.p = (CClientSocket *)v29->m_addr.sin_addr.S_un.S_addr;
          if ( ZMap<unsigned long,unsigned long,unsigned long>::GetPos(&v33, (const unsigned int *)&v36.p) )
          {
            v31 = (ZRefCounted *)v38.p->m_sAddr._m_pStr;
            LogError(aIpConnection_2, v31);
            CClientSocket::PostClose(v38.p);
          }
          v29 = v38.p;
        }
        LOBYTE(v41) = 10;
        if ( v29 )
        {
          ZRef<CClientSocket>::_ReleaseRaw(&v38, 0);
          v38.p = 0;
        }
      }
      LOBYTE(v41) = 7;
      v33.vfptr = (ZMap<unsigned long,unsigned long,unsigned long>Vtbl *)&ZMap<unsigned long,unsigned long,unsigned long>::`vftable';
      ZMap<unsigned long,unsigned long,unsigned long>::RemoveAll(&v33);
    }
    LogReport(aConnectionAcce, v4->m_sAddr._m_pStr);
    LOBYTE(v41) = 6;
    if ( value.p )
      ZRef<ZSocketBuffer>::_ReleaseRaw((ZRef<ZSocketBuffer> *)&value, 0);
    LeaveCriticalSection(lpCriticalSection);
    v41 = -1;
    if ( v35.p )
    {
      v31 = 0;
      goto LABEL_57;
    }
    return;
  }
  v26 = (int)v5->m_lpSocket._m_pHead;
  while ( v26 )
  {
    v27 = *(CClientSocket **)(v26 + 4);
    v26 = *(_DWORD *)(v26 - 12) != 0 ? *(_DWORD *)(v26 - 12) + 16 : 0;
    v36.p = v27;
    if ( v27 )
    {
      InterlockedIncrement(&v27->_m_nRef);
      v27 = v36.p;
    }
    LOBYTE(v41) = 9;
    if ( v27 && v27->m_addr.sin_addr.S_un.S_addr == pAddr->sin_addr.S_un.S_addr )
    {
      CClientSocket::PostClose(v27);
      v27 = v36.p;
    }
    LOBYTE(v41) = 7;
    if ( v27 )
    {
      ZRef<CClientSocket>::_ReleaseRaw(&v36, 0);
      v36.p = 0;
    }
  }
  LogError(aIpConnection_1, v4->m_sAddr._m_pStr);
  LOBYTE(v41) = 6;
  if ( value.p )
  {
    ZRef<ZSocketBuffer>::_ReleaseRaw((ZRef<ZSocketBuffer> *)&value, 0);
    value.p = 0;
  }
  LeaveCriticalSection(lpCriticalSection);
  v41 = -1;
  if ( v35.p )
  {
    v31 = 0;
LABEL_57:
    ZRef<CClientSocket>::_ReleaseRaw(&v35, v31);
  }
}
// 443910: using guessed type int (__thiscall *ZMap<unsigned long,unsigned long,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (0041D6FC) --------------------------------------------------------
void *__usercall _L115640@<eax>(int a1@<ebp>)
{
  LogError(aAcceptError3U, **(_DWORD **)(a1 - 44));
  CClientSocket::PostClose(*(CClientSocket **)(a1 + 12));
  return &_L108827;
}

//----- (0041D71B) --------------------------------------------------------
void __userpurge _L115638(int a1@<ebp>, int a2, int a3, int a4)
{
  int v4; // esi@1
  __POSITION *v5; // eax@3
  _DWORD *v6; // esi@3
  _DWORD *v7; // eax@5
  int v8; // ST04_4@6

  v4 = *(_DWORD *)(a1 + 12);
  if ( *(_DWORD *)(v4 + 576) )
    ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveKey(
      (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *)(*(_DWORD *)(a1 - 24) + 108),
      (const unsigned int *)(v4 + 576));
  v5 = *(__POSITION **)(v4 + 580);
  v6 = (_DWORD *)(v4 + 580);
  if ( v5 )
    ZList<ZRef<CClientSocket>>::RemoveAt((ZList<ZRef<CClientSocket> > *)(*(_DWORD *)(a1 - 24) + 132), v5);
  v7 = *(_DWORD **)(a1 + 8);
  *v6 = 0;
  LogError(aAcceptError2U, *v7);
  v8 = *(_DWORD *)(a1 - 36);
  JUMPOUT(&loc_41D2FA);
}

//----- (0041D77A) --------------------------------------------------------
ZRef<CClientSocket> *__thiscall CLoginAcceptor::GetSocket(CLoginAcceptor *this, ZRef<CClientSocket> *result, unsigned int __$ReturnUdt)
{
  CLoginAcceptor *v3; // edi@1
  struct _RTL_CRITICAL_SECTION *v4; // esi@1
  CClientSocket *v5; // eax@1
  bool v6; // zf@1
  ZRef<CClientSocket> value; // [sp+Ch] [bp-1Ch]@1
  ZCriticalSectionEx<4000> *v9; // [sp+14h] [bp-14h]@1
  int v10; // [sp+18h] [bp-10h]@1
  int v11; // [sp+24h] [bp-4h]@1

  v10 = 0;
  value.p = 0;
  v3 = this;
  v4 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  v11 = 1;
  v9 = &this->m_lock;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  LOBYTE(v11) = 2;
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::GetAt(&v3->m_mSN2pSocket, &__$ReturnUdt, &value);
  LeaveCriticalSection(v4);
  v5 = value.p;
  v6 = value.p == 0;
  result->p = value.p;
  if ( !v6 )
  {
    InterlockedIncrement(&v5->_m_nRef);
    v5 = value.p;
  }
  v10 = 1;
  LOBYTE(v11) = 0;
  if ( v5 )
    ZRef<CClientSocket>::_ReleaseRaw(&value, 0);
  return result;
}

//----- (0041D804) --------------------------------------------------------
void __thiscall CLoginAcceptor::RemoveSocket(CLoginAcceptor *this, CClientSocket *pSocket)
{
  CLoginAcceptor *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // ebx@1
  CClientSocket *v4; // edi@1
  int v5; // eax@2
  ZMap<unsigned long,unsigned long,unsigned long> *v6; // esi@3
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *v7; // eax@3
  bool v8; // zf@4

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v4 = pSocket;
  if ( pSocket->m_posList == v2->m_posListIter )
  {
    v5 = *(_DWORD *)(v2->m_posListIter != 0 ? &v2->m_posListIter[-8] : 8);
    v2->m_posListIter = (__POSITION *)(v5 != 0 ? v5 + 16 : 0);
  }
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveKey(&v2->m_mSN2pSocket, &v4->m_uLocalSocketSN);
  ZList<ZRef<CClientSocket>>::RemoveAt(&v2->m_lpSocket, v4->m_posList);
  pSocket = (CClientSocket *)v4->m_addr.sin_addr.S_un.S_addr;
  v6 = &v2->m_mIPCount;
  v7 = ZMap<unsigned long,unsigned long,unsigned long>::GetPos(v6, (const unsigned int *)&pSocket);
  if ( v7 )
  {
    v8 = v7->value-- == 1;
    if ( v8 )
      ZMap<unsigned long,unsigned long,unsigned long>::RemoveKey(v6, &v7->key);
  }
  LeaveCriticalSection(v3);
}

//----- (0041D8CC) --------------------------------------------------------
void __thiscall ZSocketAcceptor<CClientSocket>::~ZSocketAcceptor<CClientSocket>(ZSocketAcceptor<CClientSocket> *this)
{
  ZSocketAcceptor<CClientSocket> *v1; // esi@1

  v1 = this;
  this->vfptr = (ZOverlapped::ZICallBackVtbl *)&ZSocketAcceptor<CClientSocket>::`vftable';
  ZSocketAcceptor<CClientSocket>::CloseAcceptor(this);
  ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::RemoveAll(&v1->_m_aolAccepts);
  if ( v1->_m_sockListen._m_hSocket != -1 )
  {
    closesocket(v1->_m_sockListen._m_hSocket);
    v1->_m_sockListen._m_hSocket = -1;
  }
}
// 443920: using guessed type int (__cdecl *ZSocketAcceptor<CClientSocket>::`vftable')(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *pOverlapped, int, struct sockaddr *RemoteSockaddr);

//----- (0041D91B) --------------------------------------------------------
void __stdcall ZSocketAcceptor<CClientSocket>::OnAccept(unsigned int dwErr, CClientSocket *pSocket, sockaddr_in *pAddr)
{
  ((void (*)(void))pSocket->vfptr[1].__vecDelDtor)();
}

//----- (0041D92A) --------------------------------------------------------
int ZSocketAcceptor<CClientSocket>::GetType()
{
  return -1;
}

//----- (0041D92E) --------------------------------------------------------
void TSingleton<CLoginAcceptor>::~TSingleton<CLoginAcceptor>()
{
  TSingleton<CLoginAcceptor>::ms_pInstance = 0;
}

//----- (0041D936) --------------------------------------------------------
void __thiscall ZList<ZRef<CClientSocket>>::~ZList<ZRef<CClientSocket>>(ZList<ZRef<CClientSocket> > *this)
{
  this->vfptr = (ZList<ZRef<CClientSocket> >Vtbl *)&ZList<ZRef<CClientSocket>>::`vftable';
  ZList<ZRef<CClientSocket>>::RemoveAll(this);
}
// 443918: using guessed type int (__thiscall *ZList<ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (0041D941) --------------------------------------------------------
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::~ZMap<unsigned long,unsigned long,unsigned long>(ZMap<unsigned long,unsigned long,unsigned long> *this)
{
  this->vfptr = (ZMap<unsigned long,unsigned long,unsigned long>Vtbl *)&ZMap<unsigned long,unsigned long,unsigned long>::`vftable';
  ZMap<unsigned long,unsigned long,unsigned long>::RemoveAll(this);
}
// 443910: using guessed type int (__thiscall *ZMap<unsigned long,unsigned long,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (0041D94C) --------------------------------------------------------
ZSocketAcceptor<CClientSocket> *__thiscall ZSocketAcceptor<CClientSocket>::`vector deleting destructor'(ZSocketAcceptor<CClientSocket> *this, unsigned int __flags)
{
  ZSocketAcceptor<CClientSocket> *v2; // esi@1

  v2 = this;
  ZSocketAcceptor<CClientSocket>::~ZSocketAcceptor<CClientSocket>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0041D96C) --------------------------------------------------------
ZList<ZRef<CClientSocket> > *__thiscall ZList<ZRef<CClientSocket>>::`scalar deleting destructor'(ZList<ZRef<CClientSocket> > *this, unsigned int __flags)
{
  ZList<ZRef<CClientSocket> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZList<ZRef<CClientSocket> >Vtbl *)&ZList<ZRef<CClientSocket>>::`vftable';
  ZList<ZRef<CClientSocket>>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 443918: using guessed type int (__thiscall *ZList<ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (0041D992) --------------------------------------------------------
ZMap<unsigned long,unsigned long,unsigned long> *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::`vector deleting destructor'(ZMap<unsigned long,unsigned long,unsigned long> *this, unsigned int __flags)
{
  ZMap<unsigned long,unsigned long,unsigned long> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZMap<unsigned long,unsigned long,unsigned long>Vtbl *)&ZMap<unsigned long,unsigned long,unsigned long>::`vftable';
  ZMap<unsigned long,unsigned long,unsigned long>::RemoveAll(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}
// 443910: using guessed type int (__thiscall *ZMap<unsigned long,unsigned long,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (0041D9B8) --------------------------------------------------------
void __thiscall ZRef<ZSocketBuffer>::_AddRef(ZRef<ZSocketBuffer> *this)
{
  ZSocketBuffer *v1; // eax@1

  v1 = this->p;
  if ( v1 )
    InterlockedIncrement(&v1->_m_nRef);
}

//----- (0041D9CA) --------------------------------------------------------
void __thiscall ZRef<CClientSocket>::_AddRef(ZRef<CClientSocket> *this)
{
  CClientSocket *v1; // eax@1

  v1 = this->p;
  if ( v1 )
    InterlockedIncrement(&v1->_m_nRef);
}

//----- (0041D9DC) --------------------------------------------------------
void __thiscall ZRef<CClientSocket>::_Release(ZRef<CClientSocket> *this)
{
  ZRef<CClientSocket> *v1; // esi@1

  v1 = this;
  if ( this->p )
  {
    ZRef<CClientSocket>::_ReleaseRaw(this, 0);
    v1->p = 0;
  }
}

//----- (0041D9F7) --------------------------------------------------------
ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::Insert(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, const unsigned int *key, ZRef<CClientSocket> *value)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *v3; // esi@1
  unsigned int v4; // eax@2
  unsigned __int32 v5; // edx@7
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **v6; // eax@7
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v7; // edi@7
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **v8; // ebx@7
  _DWORD **v9; // eax@10
  _DWORD **v10; // esi@11
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *result; // eax@14

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = _lrotr(*key, 5) % v3->_m_uTableSize;
  v6 = v3->_m_apTable;
  v7 = v6[v5];
  v8 = &v6[v5];
  if ( v7 )
  {
    while ( v7->key != *key )
    {
      v7 = v7->pNext;
      if ( !v7 )
        goto LABEL_10;
    }
    if ( value )
      ZRef<CClientSocket>::operator=(&v7->value, value);
    result = v7;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    v9 = ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance);
    if ( v9 )
    {
      v9[1] = *v8;
      *v9 = &ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable';
      v9[2] = (_DWORD *)*key;
      v9[4] = 0;
      *v9 = &ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::`vftable';
      v10 = v9;
    }
    else
    {
      v10 = 0;
    }
    if ( value )
      ZRef<CClientSocket>::operator=((ZRef<CClientSocket> *)(v10 + 3), value);
    *v8 = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *)v10;
    result = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *)v10;
  }
  return result;
}
// 443938: using guessed type int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 443940: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041DABF) --------------------------------------------------------
ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 443940: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041DAE1) --------------------------------------------------------
void __thiscall ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::RemoveAll(ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped> *this)
{
  ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped> *v1; // ebx@1
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v2; // esi@2
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *i; // edi@2

  v1 = this;
  if ( this->a )
  {
    v2 = &this->a[*(_DWORD *)&this->a[-1].acAcceptBuff[60]];
    for ( i = this->a; i < v2; ++i )
      ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped::~ZAcceptOverlapped(i);
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v1->a[-1].acAcceptBuff[60]);
    v1->a = 0;
  }
}

//----- (0041DB20) --------------------------------------------------------
int __thiscall ZSocketAcceptor<CClientSocket>::BeginAcceptor(ZSocketAcceptor<CClientSocket> *this, sockaddr_in *pAddr, ZPort *pPort, int nAccepts, int backlog)
{
  ZSocketAcceptor<CClientSocket> *v5; // edi@1
  char *v6; // ebx@1
  SOCKET *v7; // esi@1
  SOCKET v8; // eax@1
  void *v9; // ST08_4@5
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v10; // esi@5
  int i; // ebx@5
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v12; // ST08_4@7
  int v14; // [sp+0h] [bp-30h]@1
  ZSocketAcceptor<CClientSocket> *v15; // [sp+10h] [bp-20h]@1
  int v16; // [sp+14h] [bp-1Ch]@4
  int v17; // [sp+18h] [bp-18h]@2
  char v18; // [sp+1Fh] [bp-11h]@1
  int *v19; // [sp+20h] [bp-10h]@1
  int v20; // [sp+2Ch] [bp-4h]@1

  v20 = 0;
  v5 = this;
  v19 = &v14;
  v6 = (char *)&this->_m_aolAccepts;
  v15 = this;
  ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::_Alloc(
    &this->_m_aolAccepts,
    nAccepts,
    (ZAllocHelper *)&v18);
  v7 = &v5->_m_sockListen._m_hSocket;
  v8 = socket(2, 1, 0);
  v5->_m_sockListen._m_hSocket = v8;
  if ( v8 == -1 )
  {
    v17 = WSAGetLastError();
    _CxxThrowException(&v17, &_TI1_AVZException__);
  }
  if ( bind(*v7, (const struct sockaddr *)pAddr, 16) == -1 )
  {
    v16 = WSAGetLastError();
    _CxxThrowException(&v16, &_TI1_AVZException__);
  }
  ((void (__thiscall *)(ZSocketAcceptor<CClientSocket> *, int))v5->vfptr[2].OnComplete)(v5, (int)&v5->_m_sockListen);
  ZSocketBase::Listen(&v5->_m_sockListen, backlog);
  v9 = (void *)*v7;
  v5->_m_pPort = pPort;
  ZPort::Attach(pPort, v9);
  v10 = *(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped **)v6;
  for ( i = 0; i < nAccepts; ++i )
  {
    v12 = v10;
    ++v10;
    ZSocketAcceptor<CClientSocket>::_BeginAccept(v5, v12);
  }
  return 1;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041DC0E) --------------------------------------------------------
void __thiscall ZSocketAcceptor<CClientSocket>::CloseAcceptor(ZSocketAcceptor<CClientSocket> *this)
{
  ZSocketAcceptor<CClientSocket> *v1; // esi@1
  ZPort *v2; // eax@1

  v1 = this;
  v2 = this->_m_pPort;
  if ( v2 )
  {
    InterlockedDecrement(&v2->_m_nAttachedHandles);
    v1->_m_pPort = 0;
  }
  if ( v1->_m_sockListen._m_hSocket != -1 )
  {
    closesocket(v1->_m_sockListen._m_hSocket);
    v1->_m_sockListen._m_hSocket = -1;
  }
}

//----- (0041DC41) --------------------------------------------------------
void __cdecl ZSocketAcceptor<CClientSocket>::OnComplete(void *pUser, unsigned int key, unsigned int dwErr)
{
  ZSocketAcceptor<CClientSocket> *this; // ecx@0
  ZSocketAcceptor<CClientSocket> *v4; // edi@1
  bool v5; // zf@1
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v6; // esi@2
  ZOverlapped::ZICallBackVtbl *v7; // eax@2
  int v8; // ST18_4@2
  int v9; // ST18_4@4
  ZSocketEx *v10; // ecx@7
  int v11; // [sp+0h] [bp-30h]@1
  ZSocketAcceptor<CClientSocket> *v12; // [sp+Ch] [bp-24h]@1
  struct sockaddr *LocalSockaddr; // [sp+10h] [bp-20h]@2
  int LocalSockaddrLength; // [sp+14h] [bp-1Ch]@2
  int RemoteSockaddrLength; // [sp+18h] [bp-18h]@2
  int v16; // [sp+1Ch] [bp-14h]@1
  int *v17; // [sp+20h] [bp-10h]@1
  int v18; // [sp+2Ch] [bp-4h]@1

  v4 = this;
  v5 = this->_m_pPort == 0;
  v17 = &v11;
  v12 = this;
  v18 = 0;
  v16 = v5;
  if ( !dwErr )
  {
    v6 = (ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *)pUser;
    LocalSockaddrLength = 0;
    RemoteSockaddrLength = 0;
    LocalSockaddr = 0;
    dwErr = 0;
    GetAcceptExSockaddrs(
      (char *)pUser + 32,
      0,
      0x20u,
      0x20u,
      &LocalSockaddr,
      &LocalSockaddrLength,
      (struct sockaddr **)&dwErr,
      &RemoteSockaddrLength);
    ZSocketBase::UpdateAcceptContext((ZSocketBase *)(*((_DWORD *)pUser + 7) + 16), v4->_m_sockListen._m_hSocket);
    v7 = v4->vfptr;
    v8 = *((_DWORD *)pUser + 7);
LABEL_5:
    v7[1].GetType((ZOverlapped::ZICallBack *)v4);
    goto LABEL_7;
  }
  if ( !v16 )
  {
    v6 = (ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *)pUser;
    v7 = this->vfptr;
    v9 = *((_DWORD *)pUser + 7);
    goto LABEL_5;
  }
  v6 = (ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *)pUser;
LABEL_7:
  v10 = (ZSocketEx *)&v6->pSocket->vfptr;
  v18 = -1;
  ZSocketEx::_SockRelease(v10);
  v5 = v16 == 0;
  v6->pSocket = 0;
  if ( v5 )
  {
    v18 = 2;
    ZSocketAcceptor<CClientSocket>::_BeginAccept(v4, v6);
  }
}

//----- (0041DD10) --------------------------------------------------------
void *_L118578()
{
  return &_L110561;
}

//----- (0041DD16) --------------------------------------------------------
ZRef<CClientSocket> *__thiscall ZList<ZRef<CClientSocket>>::AddTail(ZList<ZRef<CClientSocket> > *this)
{
  ZList<ZRef<CClientSocket> > *v1; // esi@1
  ZRef<CClientSocket> *result; // eax@1
  ZRef<CClientSocket> *v3; // ecx@1
  unsigned int v4; // eax@3

  v1 = this;
  result = ZList<ZRef<CClientSocket>>::_New(this, this->_m_pTail, 0);
  v3 = v1->_m_pTail;
  if ( v3 )
  {
    v4 = result != 0 ? (unsigned int)&result[-2] : 0;
    *(v3 != 0 ? &v3[-2].p : 4) = (CClientSocket *)v4;
    result = (ZRef<CClientSocket> *)(v4 != 0 ? v4 + 16 : 0);
  }
  else
  {
    v1->_m_pHead = result;
  }
  v1->_m_pTail = result;
  return result;
}

//----- (0041DD54) --------------------------------------------------------
void __thiscall ZList<ZRef<CClientSocket>>::RemoveAt(ZList<ZRef<CClientSocket> > *this, __POSITION *pos)
{
  int v2; // edx@1
  int v3; // eax@2
  int v4; // eax@4
  int v5; // eax@5
  int v6; // eax@6
  int v7; // eax@7
  int v8; // edx@7
  int v9; // eax@7
  int v10; // edx@7

  v2 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8);
  if ( *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? v2 + 16 : 0 )
  {
    v5 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v5 + 16 : 0 )
    {
      v7 = v5 != 0 ? v5 + 16 : 0;
      v8 = v2 != 0 ? v2 + 16 : 0;
      *(_DWORD *)(v8 != 0 ? v8 - 16 + 4 : 4) = v7 != 0 ? v7 - 16 : 0;
      v9 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      v10 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v10 != 0 ? v10 - 16 + 8 : 8) = v9 != 0 ? v9 - 16 : 0;
    }
    else
    {
      this->_m_pTail = (ZRef<CClientSocket> *)(v2 != 0 ? v2 + 16 : 0);
      v6 = *(_DWORD *)(pos != 0 ? &pos[-8] : 8) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-8] : 8) + 16 : 0;
      *(_DWORD *)(v6 != 0 ? v6 - 16 + 4 : 4) = 0;
    }
  }
  else
  {
    v3 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4);
    if ( *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? v3 + 16 : 0 )
    {
      this->_m_pHead = (ZRef<CClientSocket> *)(v3 != 0 ? v3 + 16 : 0);
      v4 = *(_DWORD *)(pos != 0 ? &pos[-12] : 4) != 0 ? *(_DWORD *)(pos != 0 ? &pos[-12] : 4) + 16 : 0;
      *(_DWORD *)(v4 != 0 ? v4 - 16 + 8 : 8) = 0;
    }
    else
    {
      this->_m_pTail = 0;
      this->_m_pHead = 0;
    }
  }
  --this->_m_uCount;
  ZRefCountedAccessorBase::_Delete((ZRefCounted *)(pos != 0 ? (unsigned int)&pos[-16] : 0));
}

//----- (0041DE66) --------------------------------------------------------
void __thiscall ZList<ZRef<CClientSocket>>::RemoveAll(ZList<ZRef<CClientSocket> > *this)
{
  ZList<ZRef<CClientSocket> > *v1; // esi@1
  ZRef<CClientSocket> *i; // eax@1
  ZRefCounted *v3; // eax@2
  int v4; // edi@2

  v1 = this;
  for ( i = this->_m_pHead; i; i = (ZRef<CClientSocket> *)(v4 != 0 ? v4 + 16 : 0) )
  {
    v3 = (ZRefCounted *)(i != 0 ? (unsigned int)&i[-2] : 0);
    v4 = v3->_m_nRef;
    ZRefCountedAccessorBase::_Delete(v3);
  }
  v1->_m_pTail = 0;
  v1->_m_pHead = 0;
  v1->_m_uCount = 0;
}

//----- (0041DEA0) --------------------------------------------------------
__POSITION *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::Insert(ZMap<unsigned long,unsigned long,unsigned long> *this, const unsigned int *key, const unsigned int *value)
{
  ZMap<unsigned long,unsigned long,unsigned long> *v3; // esi@1
  unsigned int v4; // eax@2
  __POSITION **v5; // edi@7
  __POSITION *result; // eax@7
  __POSITION *v7; // ecx@11

  v3 = this;
  if ( this->_m_apTable )
  {
    if ( this->_m_uCount <= this->_m_uAutoGrowLimit )
      goto LABEL_7;
    v4 = 2 * this->_m_uTableSize + 1;
  }
  else
  {
    v4 = this->_m_uTableSize;
  }
  if ( v4 )
    ZMap<unsigned long,unsigned long,unsigned long>::ResizeHashTable(this, v4, 0);
LABEL_7:
  v5 = (__POSITION **)&v3->_m_apTable[_lrotr(*key, 5) % v3->_m_uTableSize];
  result = *v5;
  if ( *v5 )
  {
    while ( *(_DWORD *)&result[8] != *key )
    {
      result = *(__POSITION **)&result[4];
      if ( !result )
        goto LABEL_10;
    }
    if ( value )
      *(_DWORD *)&result[12] = *value;
  }
  else
  {
LABEL_10:
    ++v3->_m_uCount;
    result = (__POSITION *)ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance);
    if ( result )
    {
      v7 = *v5;
      *(_DWORD *)result = &ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable';
      *(_DWORD *)&result[4] = v7;
      *(_DWORD *)&result[8] = *key;
      *(_DWORD *)result = &ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::`vftable';
    }
    else
    {
      result = 0;
    }
    if ( value )
      *(_DWORD *)&result[12] = *value;
    *v5 = result;
  }
  return result;
}
// 443948: using guessed type int (__thiscall *ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::`vftable')(void *p, unsigned int __flags);
// 443950: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041DF4C) --------------------------------------------------------
ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *__thiscall ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vector deleting destructor'(ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this, unsigned int __flags)
{
  ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance,
      this);
  return v2;
}
// 443950: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041DF6E) --------------------------------------------------------
int __thiscall ZMap<unsigned long,unsigned long,unsigned long>::RemoveKey(ZMap<unsigned long,unsigned long,unsigned long> *this, const unsigned int *key)
{
  ZMap<unsigned long,unsigned long,unsigned long> *v2; // esi@1
  unsigned __int32 v3; // edx@2
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **v4; // eax@2
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *v5; // ecx@2
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **v6; // eax@2
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *i; // eax@5

  v2 = this;
  if ( !this->_m_apTable )
    return 0;
  v3 = _lrotr(*key, 5) % this->_m_uTableSize;
  v4 = v2->_m_apTable;
  v5 = v4[v3];
  v6 = &v4[v3];
  if ( !v5 )
    return 0;
  if ( v5->key != *key )
  {
    for ( i = v5->pNext; i; i = i->pNext )
    {
      if ( i->key == *key )
      {
        v5->pNext = i->pNext;
        v5 = i;
        goto found_3;
      }
      v5 = i;
    }
    return 0;
  }
  *v6 = v5->pNext;
found_3:
  if ( v5 )
    ((void (__stdcall *)(signed int))v5->vfptr->__vecDelDtor)(1);
  --v2->_m_uCount;
  return 1;
}

//----- (0041DFDC) --------------------------------------------------------
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::RemoveAll(ZMap<unsigned long,unsigned long,unsigned long> *this)
{
  ZMap<unsigned long,unsigned long,unsigned long> *v1; // edi@1
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **v2; // esi@1
  unsigned int v3; // ebp@2
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *v4; // ecx@3
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *v5; // ebx@4

  v1 = this;
  v2 = this->_m_apTable;
  if ( v2 )
  {
    v3 = (unsigned int)&v2[this->_m_uTableSize];
    while ( (unsigned int)v2 < v3 )
    {
      v4 = *v2;
      ++v2;
      if ( v4 )
      {
        do
        {
          v5 = v4->pNext;
          if ( v4 )
            ((void (__stdcall *)(_DWORD))v4->vfptr->__vecDelDtor)(1);
          v4 = v5;
        }
        while ( v5 );
      }
    }
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1->_m_apTable);
    v1->_m_apTable = 0;
    v1->_m_uCount = 0;
  }
}

//----- (0041E02D) --------------------------------------------------------
__POSITION *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::GetNext(ZMap<unsigned long,unsigned long,unsigned long> *this, __POSITION **pos, unsigned int *value)
{
  __POSITION *v3; // ebx@1
  ZMap<unsigned long,unsigned long,unsigned long> *v4; // edi@1
  __POSITION *v5; // ecx@1
  unsigned int v6; // esi@3
  unsigned __int32 v7; // edx@3
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **v8; // eax@3
  __POSITION **v9; // ecx@3
  unsigned int v10; // eax@3

  v3 = *pos;
  v4 = this;
  v5 = *(__POSITION **)&(*pos)[4];
  if ( v5 )
  {
    *pos = v5;
  }
  else
  {
    *pos = 0;
    v6 = v4->_m_uTableSize;
    v7 = _lrotr(*(_DWORD *)&v3[8], 5) % v6;
    v8 = v4->_m_apTable;
    v9 = (__POSITION **)&v8[v7 + 1];
    v10 = (unsigned int)&v8[v6];
    while ( (unsigned int)v9 < v10 )
    {
      if ( *v9 )
      {
        *pos = *v9;
        break;
      }
      ++v9;
    }
  }
  if ( value )
    *value = *(_DWORD *)&v3[12];
  return v3 + 8;
}

//----- (0041E090) --------------------------------------------------------
ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::GetPos(ZMap<unsigned long,unsigned long,unsigned long> *this, const unsigned int *key)
{
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *result; // eax@2

  if ( this->_m_apTable && (result = this->_m_apTable[_lrotr(*key, 5) % this->_m_uTableSize]) != 0 )
  {
    while ( result->key != *key )
    {
      result = result->pNext;
      if ( !result )
        goto LABEL_5;
    }
  }
  else
  {
LABEL_5:
    result = 0;
  }
  return result;
}

//----- (0041E0CE) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0041E0F4) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::raw_delete(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this, void *p)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0041E11A) --------------------------------------------------------
void _E41_3()
{
  _E34_6();
  _E35_7();
  _E36_7();
  _E37_6();
  _E38_3();
  _E39_5();
  _E40_3();
}

//----- (0041E13D) --------------------------------------------------------
void _E34_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0041E178) --------------------------------------------------------
void _E35_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (0041E1B3) --------------------------------------------------------
void _E36_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0041E1EE) --------------------------------------------------------
void _E37_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (0041E229) --------------------------------------------------------
void _E38_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0041E264) --------------------------------------------------------
void _E39_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (0041E29F) --------------------------------------------------------
void _E40_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0041E2DA) --------------------------------------------------------
ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::`vector deleting destructor'(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *this, unsigned int __flags)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (0041E2FB) --------------------------------------------------------
ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *__thiscall ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::`scalar deleting destructor'(ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *this, unsigned int __flags)
{
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *v2; // esi@1

  v2 = this;
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::~_PAIR(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::raw_delete(
      ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance,
      v2);
  return v2;
}

//----- (0041E31C) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR::~_PAIR(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *this)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v1; // edi@1
  char *v2; // esi@1

  v1 = this;
  v2 = this->value.gap0;
  if ( this->value.p )
  {
    ZRef<CClientSocket>::_ReleaseRaw(&this->value, 0);
    *((_DWORD *)v2 + 1) = 0;
  }
  v1->vfptr = (ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable';
}
// 443940: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041E35C) --------------------------------------------------------
void __thiscall ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::~ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this)
{
  this->vfptr = (ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable';
}
// 443940: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041E363) --------------------------------------------------------
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::_PAIR::~_PAIR(ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *this)
{
  this->vfptr = (ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>Vtbl *)&ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable';
}
// 443950: using guessed type int (__thiscall *ZRecyclable<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::`vftable')(void *p, unsigned int __flags);

//----- (0041E36A) --------------------------------------------------------
void __thiscall ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped::~ZAcceptOverlapped(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *this)
{
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v1; // esi@1
  CClientSocket *v2; // ecx@1

  v1 = this;
  v2 = this->pSocket;
  if ( v2 )
  {
    ZSocketEx::_SockRelease((ZSocketEx *)&v2->vfptr);
    ((void (*)(void))v1->pSocket->vfptr[1].__vecDelDtor)();
  }
}

//----- (0041E383) --------------------------------------------------------
void __thiscall ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::ResizeHashTable(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **v5; // edi@3
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **v6; // ebx@3
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                                            &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                                            4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (0041E42E) --------------------------------------------------------
ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *__thiscall ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::_Alloc(ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped> *v3; // ebx@1
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *result; // eax@2
  int v5; // eax@3
  unsigned int v6; // esi@3
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v7; // edi@3
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v8; // ST00_4@5

  v3 = this;
  ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 96 * u + 4) + 4;
    v3->a = (ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *)v5;
    *(_DWORD *)(v5 - 4) = u;
    v6 = (unsigned int)&v3->a[u].Internal;
    v7 = v3->a;
    while ( (unsigned int)v7 < v6 )
    {
      v8 = v7;
      ++v7;
      construct(v8);
    }
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041E480) --------------------------------------------------------
void __thiscall ZSocketAcceptor<CClientSocket>::_BeginAccept(ZSocketAcceptor<CClientSocket> *this, ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *pOverlapped)
{
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v2; // esi@1
  ZSocketAcceptor<CClientSocket> *v3; // ebx@1
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *v4; // eax@1
  CClientSocket *v5; // edi@1
  CClientSocket *v6; // eax@2
  SOCKET v7; // eax@3
  CClientSocket *v8; // eax@5
  SOCKET *v9; // eax@6
  int v10; // eax@9
  int v11; // [sp+Ch] [bp-14h]@10
  unsigned int dwBytesReceived; // [sp+10h] [bp-10h]@5
  int v13; // [sp+1Ch] [bp-4h]@1

  v2 = pOverlapped;
  v3 = this;
  pOverlapped->pCallBack = (ZOverlapped::ZICallBack *)this;
  v2->pUser = v2;
  v4 = (ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                              &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                              0x290u);
  pOverlapped = v4;
  v5 = 0;
  v13 = 0;
  if ( v4 )
  {
    CClientSocket::CClientSocket((CClientSocket *)v4);
    v5 = v6;
  }
  v13 = -1;
  v2->pSocket = v5;
  v7 = socket(2, 1, 0);
  v5->_m_hSocket = v7;
  if ( v7 == -1 )
  {
    pOverlapped = (ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *)WSAGetLastError();
    _CxxThrowException(&pOverlapped, &_TI1_AVZException__);
  }
  InterlockedIncrement(&v2->pSocket->_m_nRef);
  v8 = v2->pSocket;
  dwBytesReceived = 0;
  if ( v8 )
    v9 = &v8->_m_hSocket;
  else
    v9 = 0;
  if ( !AcceptEx(
          v3->_m_sockListen._m_hSocket,
          *v9,
          v2->acAcceptBuff,
          0,
          0x20u,
          0x20u,
          &dwBytesReceived,
          (LPOVERLAPPED)&v2->Internal) )
  {
    v10 = WSAGetLastError();
    if ( v10 != 997 )
    {
      v11 = v10;
      _CxxThrowException(&v11, &_TI1_AVZException__);
    }
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041E55D) --------------------------------------------------------
ZRef<CClientSocket> *__thiscall ZList<ZRef<CClientSocket>>::_New(ZList<ZRef<CClientSocket> > *this, void *pPrev, void *pNext)
{
  ZList<ZRef<CClientSocket> > *v3; // esi@1
  int v4; // eax@1

  v3 = this;
  ZRefCounted_Alloc();
  *(_DWORD *)(v4 + 8) = pPrev != 0 ? (char *)pPrev - 16 : 0;
  *(_DWORD *)(v4 + 4) = pNext != 0 ? (char *)pNext - 16 : 0;
  ++v3->_m_uCount;
  return (ZRef<CClientSocket> *)(v4 != 0 ? v4 + 16 : 0);
}

//----- (0041E59C) --------------------------------------------------------
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::ResizeHashTable(ZMap<unsigned long,unsigned long,unsigned long> *this, unsigned int uHashTableSize, unsigned int uAutoGrowEvery128)
{
  ZMap<unsigned long,unsigned long,unsigned long> *v3; // esi@1
  unsigned int v4; // eax@1
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **v5; // edi@3
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **v6; // ebx@3
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *v7; // esi@5
  unsigned __int32 v8; // eax@6
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR *v9; // ecx@6
  char *v10; // eax@6
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **apOldTable; // [sp+Ch] [bp-8h]@3
  ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **ppOldTableEnd; // [sp+10h] [bp-4h]@3

  v3 = this;
  v4 = this->_m_uTableSize;
  if ( v4 != uHashTableSize || !this->_m_apTable )
  {
    v5 = this->_m_apTable;
    apOldTable = this->_m_apTable;
    ppOldTableEnd = &v5[v4];
    this->_m_uTableSize = uHashTableSize;
    ZMap<unsigned long,unsigned long,unsigned long>::_CalcAutoGrow(this, uAutoGrowEvery128);
    v6 = (ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                                                      &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                                                      4 * uHashTableSize);
    v3->_m_apTable = v6;
    memset(v6, 0, 4 * uHashTableSize);
    if ( v5 )
    {
      while ( v5 < ppOldTableEnd )
      {
        v7 = *v5;
        ++v5;
        if ( v7 )
        {
          do
          {
            v8 = _lrotr(v7->key, 5);
            v9 = v7->pNext;
            v10 = (char *)&v6[v8 % uHashTableSize];
            v7->pNext = *(ZMap<unsigned long,unsigned long,unsigned long>::_PAIR **)v10;
            *(_DWORD *)v10 = v7;
            v7 = v9;
          }
          while ( v9 );
        }
      }
      ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, apOldTable);
    }
  }
}

//----- (0041E647) --------------------------------------------------------
void __thiscall ZMap<unsigned long,unsigned long,unsigned long>::_CalcAutoGrow(ZMap<unsigned long,unsigned long,unsigned long> *this, unsigned int uAutoGrowEvery128)
{
  unsigned int v2; // edx@3
  signed int v3; // eax@3

  if ( uAutoGrowEvery128 )
    this->_m_uAutoGrowEvery128 = uAutoGrowEvery128;
  v2 = this->_m_uAutoGrowEvery128;
  v3 = -1;
  if ( v2 != -1 )
    v3 = v2 * this->_m_uTableSize >> 7;
  this->_m_uAutoGrowLimit = v3;
}

//----- (0041E66B) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x14u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (0041E6BF) --------------------------------------------------------
void **__thiscall ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::raw_new(ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *this)
{
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  void **v3; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  if ( !v1->m_pAv )
    v1->m_pAv = ZAllocBase::_AllocRawBlocks(0x10u, 0x10u);
  v3 = (void **)v1->m_pAv;
  v1->m_pAv = *v3;
  LeaveCriticalSection(v2);
  return v3;
}

//----- (0041E714) --------------------------------------------------------
void _E60_1()
{
  _E52_2();
  _E53_3();
  _E54_3();
  _E55_3();
  _E56_3();
  _E57_2();
  _E58_2();
  _E59_1();
}

//----- (0041E73C) --------------------------------------------------------
void _E52_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0041E777) --------------------------------------------------------
void _E53_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0041E7B2) --------------------------------------------------------
void _E54_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0041E7ED) --------------------------------------------------------
void _E55_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0041E828) --------------------------------------------------------
void _E56_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0041E863) --------------------------------------------------------
void _E57_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0041E89E) --------------------------------------------------------
void _E58_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (0041E8D9) --------------------------------------------------------
void _E59_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0041E914) --------------------------------------------------------
void __cdecl ZRefCounted_Alloc()
{
  ZRefCountedDummy<ZRef<CClientSocket> > *v0; // ecx@1

  v0 = (ZRefCountedDummy<ZRef<CClientSocket> > *)ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance);
  if ( v0 )
    ZRefCountedDummy<ZRef<CClientSocket>>::ZRefCountedDummy<ZRef<CClientSocket>>(v0);
}

//----- (0041E949) --------------------------------------------------------
void __cdecl ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::operator delete(void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::raw_delete(
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance,
    p);
}

//----- (0041E959) --------------------------------------------------------
void __thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::raw_delete(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this, void *p)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // edi@1

  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  *(_DWORD *)p = v2->m_pAv;
  v2->m_pAv = p;
  LeaveCriticalSection(v3);
}

//----- (0041E97F) --------------------------------------------------------
ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *__cdecl construct(ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *p)
{
  ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped *result; // eax@2

  if ( p )
  {
    memset(p, 0, 0x1Cu);
    p->pSocket = 0;
    result = p;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0041E9A1) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZRef<CClientSocket>>::ZRefCountedDummy<ZRef<CClientSocket>>(ZRefCountedDummy<ZRef<CClientSocket> > *this)
{
  ZRefCountedDummy<ZRef<CClientSocket> > *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable';
  v1->t.p = 0;
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCountedDummy<ZRef<CClientSocket>>::`vftable'{for `ZRefCounted'};
  v1->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> >Vtbl *)&ZRefCountedDummy<ZRef<CClientSocket>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>'};
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443958: using guessed type void *ZRefCountedDummy<ZRef<CClientSocket>>::`vftable'{for `ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>'};
// 443960: using guessed type int (__thiscall *ZRefCountedDummy<ZRef<CClientSocket>>::`vftable'{for `ZRefCounted'})(void *p, unsigned int __flags);
// 443968: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (0041E9D3) --------------------------------------------------------
ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *__thiscall ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vector deleting destructor'(ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this, unsigned int __flags)
{
  ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v2; // esi@1

  v2 = this;
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable';
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance,
      this);
  return v2;
}
// 443968: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (0041E9F5) --------------------------------------------------------
ZRefCountedDummy<ZRef<CClientSocket> > *__thiscall ZRefCountedDummy<ZRef<CClientSocket>>::`vector deleting destructor'(ZRefCountedDummy<ZRef<CClientSocket> > *this, unsigned int __flags)
{
  ZRefCountedDummy<ZRef<CClientSocket> > *v2; // esi@1

  v2 = this;
  ZRefCountedDummy<ZRef<CClientSocket>>::~ZRefCountedDummy<ZRef<CClientSocket>>(this);
  if ( __flags & 1 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::raw_delete(
      ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance,
      v2);
  return v2;
}

//----- (0041EA16) --------------------------------------------------------
void __thiscall ZRefCountedDummy<ZRef<CClientSocket>>::~ZRefCountedDummy<ZRef<CClientSocket>>(ZRefCountedDummy<ZRef<CClientSocket> > *this)
{
  ZRefCountedDummy<ZRef<CClientSocket> > *v1; // edi@1
  char *v2; // esi@1

  v1 = this;
  v2 = this->t.gap0;
  if ( this->t.p )
  {
    ZRef<CClientSocket>::_ReleaseRaw(&this->t, 0);
    *((_DWORD *)v2 + 1) = 0;
  }
  *(_DWORD *)(v1 != 0 ? (unsigned int)&v1->vfptr : 0) = &ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable';
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 443968: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (0041EA6A) --------------------------------------------------------
void __thiscall ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::~ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this)
{
  this->vfptr = (ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> >Vtbl *)&ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable';
}
// 443968: using guessed type int (__thiscall *ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::`vftable')(void *p, unsigned int __flags);

//----- (0041EA71) --------------------------------------------------------
_DWORD **__thiscall ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::raw_new(ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *this)
{
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // esi@1
  struct _RTL_CRITICAL_SECTION *v2; // edi@1
  _DWORD **v3; // esi@1
  _DWORD **v4; // ebx@3

  v1 = this;
  v2 = (struct _RTL_CRITICAL_SECTION *)&this->m_l.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_l.DebugInfo);
  v3 = (_DWORD **)&v1->m_pAv;
  if ( !*v3 )
    *v3 = ZAllocBase::_AllocRawBlocks(0x18u, 0x10u);
  v4 = (_DWORD **)*v3;
  *v3 = (_DWORD *)**v3;
  LeaveCriticalSection(v2);
  return v4;
}

//----- (0041EACD) --------------------------------------------------------
void __thiscall ZSocketEx::SendPacket(ZSocketEx *this, ZSocketBuffer *pBuff)
{
  ZSocketEx *v2; // esi@1
  ZRef<ZSocketBuffer> *v3; // eax@5
  ZRef<ZSocketBuffer> r; // [sp+8h] [bp-18h]@3
  ZCriticalSectionEx<4000> *v5; // [sp+10h] [bp-10h]@3
  int v6; // [sp+1Ch] [bp-4h]@3

  v2 = this;
  if ( this->_m_dwErrSend )
  {
    pBuff = (ZSocketBuffer *)this->_m_dwErrSend;
    _CxxThrowException(&pBuff, &_TI1_AVZException__);
  }
  v5 = &this->_m_lockSend;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lockSend.DebugInfo);
  v6 = 0;
  r.p = pBuff;
  if ( pBuff )
    InterlockedIncrement(&pBuff->_m_nRef);
  LOBYTE(v6) = 1;
  v3 = ZList<ZRef<ZSocketBuffer>>::AddTail(&v2->_m_lToSend);
  ZRef<ZSocketBuffer>::operator=(v3, &r);
  LOBYTE(v6) = 0;
  if ( r.p )
    ZRef<ZSocketBuffer>::_ReleaseRaw(&r, 0);
  if ( !v2->_m_bSendOverlapped )
    ZSocketEx::NotifySend(v2);
  LeaveCriticalSection((LPCRITICAL_SECTION)&v2->_m_lockSend.DebugInfo);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041EB6C) --------------------------------------------------------
void __thiscall CLoginApp::CLoginApp(CLoginApp *this)
{
  CLoginApp *v1; // esi@1

  v1 = this;
  CServerApp::CServerApp((CServerApp *)&this->vfptr);
  v1->m_aCenter.a = 0;
  v1->m_asForbiddenName.a = 0;
  v1->m_aNewEquip.a = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&v1->m_lockMILog.DebugInfo);
  v1->m_pfsMILog.p = 0;
  v1->vfptr = (CServerAppVtbl *)&CLoginApp::`vftable';
}
// 44397C: using guessed type int (__thiscall *CLoginApp::`vftable')(void *p, unsigned int __flags);

//----- (0041EB98) --------------------------------------------------------
CLoginApp *__thiscall CLoginApp::`scalar deleting destructor'(CLoginApp *this, unsigned int __flags)
{
  CLoginApp *v2; // esi@1

  v2 = this;
  CLoginApp::~CLoginApp(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0041EBB8) --------------------------------------------------------
void __thiscall CLoginApp::~CLoginApp(CLoginApp *this)
{
  CLoginApp *v1; // esi@1
  char *v2; // edi@1

  v1 = this;
  this->vfptr = (CServerAppVtbl *)&CLoginApp::`vftable';
  v2 = this->m_pfsMILog.gap0;
  if ( this->m_pfsMILog.p )
  {
    ZRef<ZFileStream>::_ReleaseRaw(&this->m_pfsMILog, 0);
    *((_DWORD *)v2 + 1) = 0;
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lockMILog.DebugInfo);
  ZArray<CLoginApp::NEWEQUIP>::RemoveAll(&v1->m_aNewEquip);
  ZArray<ZXString<char>>::RemoveAll(&v1->m_asForbiddenName);
  ZArray<CCenter>::RemoveAll(&v1->m_aCenter);
  CServerApp::~CServerApp((CServerApp *)&v1->vfptr);
}
// 44397C: using guessed type int (__thiscall *CLoginApp::`vftable')(void *p, unsigned int __flags);

//----- (0041EC34) --------------------------------------------------------
int __thiscall CLoginApp::SetUp(CLoginApp *this)
{
  CLoginApp *v1; // esi@1
  CSecurityServer *v2; // eax@2
  int v3; // eax@3
  char *v4; // ecx@5
  ZXString<char> v5; // [sp-4h] [bp-60h]@5
  int v6; // [sp+0h] [bp-5Ch]@1
  CLog::INITPARAM a; // [sp+Ch] [bp-50h]@1
  int v8; // [sp+18h] [bp-44h]@1
  char *v9; // [sp+1Ch] [bp-40h]@1
  int v10; // [sp+20h] [bp-3Ch]@1
  int v11; // [sp+24h] [bp-38h]@1
  char *v12; // [sp+28h] [bp-34h]@1
  int v13; // [sp+2Ch] [bp-30h]@1
  int v14; // [sp+30h] [bp-2Ch]@1
  char *v15; // [sp+34h] [bp-28h]@1
  int v16; // [sp+38h] [bp-24h]@1
  ZXString<char> *v17; // [sp+44h] [bp-18h]@5
  ZXString<char> result; // [sp+48h] [bp-14h]@1
  int *v19; // [sp+4Ch] [bp-10h]@1
  int v20; // [sp+58h] [bp-4h]@1

  v20 = 0;
  v19 = &v6;
  v1 = this;
  get_cmdline_arg(&result, 1);
  a.bDailyReport = 0;
  a.sFileTitle = result._m_pStr;
  v13 = 8;
  v16 = 8;
  a.dwPrefixFlag = 4;
  LOBYTE(v20) = 1;
  v8 = 1;
  v9 = aElog;
  v10 = 2;
  v11 = 1;
  v12 = aGuard;
  v14 = 1;
  v15 = aIpblock;
  CLog::Init(TSingleton<CLog>::ms_pInstance, &a, 4u);
  if ( CServerApp::SetUp((CServerApp *)&v1->vfptr)
    && (TSingleton<CSecurityServer>::CreateInstance(), CSecurityServer::Init(v2)) )
  {
    CLoginApp::LoadNewCharInfo(v1);
    CLoginApp::LoadConfiguration();
    CLoginApp::InitializeDB();
    CLoginApp::CreateMainDialog();
    CLoginApp::InitializeCenter(v1);
    CLoginApp::CreateAcceptor(v1);
    CLoginApp::CreateAdminAcceptor(v1);
    CLoginApp::CreateTimerThread();
    v5._m_pStr = v4;
    v17 = &v5;
    get_cmdline_arg(&v5, 2);
    TSelfTestThread<CLoginAcceptor>::Create(v5);
    LOBYTE(v20) = 0;
    ZXString<char>::~ZXString<char>(&result);
    v3 = 1;
  }
  else
  {
    LOBYTE(v20) = 0;
    ZXString<char>::~ZXString<char>(&result);
    v3 = 0;
  }
  return v3;
}

//----- (0041ED41) --------------------------------------------------------
void *__usercall _L122490@<eax>(int a1@<ebp>)
{
  msgbox_ZException(*(ZException **)(a1 - 28));
  return &_L122495;
}

//----- (0041ED50) --------------------------------------------------------
void *__usercall _L122491@<eax>(int a1@<ebp>)
{
  msgbox_com_error(*(_com_error **)(a1 - 32));
  return &_L122495;
}

//----- (0041ED5F) --------------------------------------------------------
void __thiscall CLoginApp::CleanUp(CLoginApp *this)
{
  CLoginApp *v1; // esi@1
  unsigned int v2; // edi@4
  int i; // ebx@4
  CCenter *v4; // eax@5

  v1 = this;
  TSelfTestThread<CLoginAcceptor>::Destroy();
  if ( TSingleton<CTimerThread>::ms_pInstance )
  {
    CTimerThread::Terminate(TSingleton<CTimerThread>::ms_pInstance);
    if ( TSingleton<CTimerThread>::ms_pInstance )
      ((void (__stdcall *)(signed int))TSingleton<CTimerThread>::ms_pInstance->vfptr->__vecDelDtor)(1);
  }
  CLoginAcceptor::Terminate(TSingleton<CLoginAcceptor>::ms_pInstance);
  CAdminAcceptor::Terminate(TSingleton<CAdminAcceptor>::ms_pInstance);
  v2 = 0;
  for ( i = 0; ; ++i )
  {
    v4 = v1->m_aCenter.a;
    if ( !v4 || v2 >= v4[-1].m_mServerStatus._m_uAutoGrowLimit )
      break;
    CCenter::Disconnect(&v4[i]);
    ++v2;
  }
  _com_ptr_t<_com_IIID<IWvsUnifiedDB,&__s_GUID _GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38>>::operator=(&g_pDB, 0);
  if ( TSingleton<CServerDialog>::ms_pInstance )
    (**(void (__stdcall ***)(_DWORD))TSingleton<CServerDialog>::ms_pInstance)(1);
  CSecurityServer::Destroy(TSingleton<CSecurityServer>::ms_pInstance);
  TSingleton<CSecurityServer>::DestroyInstance();
  CServerApp::CleanUp((CServerApp *)&v1->vfptr);
}
// 4A428C: using guessed type int TSingleton<CServerDialog>::ms_pInstance;

//----- (0041EDF4) --------------------------------------------------------
void __thiscall CLoginApp::TryConnectCenter(CLoginApp *this)
{
  unsigned int v1; // edi@1
  CLoginApp *v2; // esi@1
  int i; // ebx@1
  CCenter *v4; // eax@2

  v1 = 0;
  v2 = this;
  for ( i = 0; ; ++i )
  {
    v4 = v2->m_aCenter.a;
    if ( !v4 || v1 >= v4[-1].m_mServerStatus._m_uAutoGrowLimit )
      break;
    CCenter::TryConnect(&v4[i]);
    ++v1;
  }
}

//----- (0041EE1C) --------------------------------------------------------
void __thiscall CLoginApp::CloseCenter(CLoginApp *this, int nIdx)
{
  CCenter::Disconnect(&this->m_aCenter.a[nIdx]);
}

//----- (0041EE30) --------------------------------------------------------
void CLoginApp::InitializeDB()
{
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *v1; // eax@1
  IWzProperty *v2; // eax@1
  Ztl_variant_t *v3; // eax@1
  int v4; // eax@1
  _bstr_t::Data_t *v5; // ecx@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *v6; // eax@3
  IWzProperty *v7; // eax@3
  Ztl_variant_t *v8; // eax@3
  int v9; // eax@3
  _bstr_t::Data_t *v10; // ecx@5
  _com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *v11; // eax@7
  IWvsUnifiedDB *v12; // eax@7
  Ztl_bstr_t v13; // [sp-8h] [bp-44h]@7
  _bstr_t::Data_t *v14; // [sp-4h] [bp-40h]@1
  Ztl_variant_t v15; // [sp+0h] [bp-3Ch]@3
  Ztl_variant_t result; // [sp+10h] [bp-2Ch]@1
  Ztl_bstr_t *v17; // [sp+20h] [bp-1Ch]@7
  _bstr_t::Data_t **v18; // [sp+24h] [bp-18h]@1
  Ztl_bstr_t __that; // [sp+28h] [bp-14h]@1
  Ztl_bstr_t sCatalogGlobalAccount; // [sp+2Ch] [bp-10h]@3
  int v21; // [sp+38h] [bp-4h]@1

  PcCreateObject(sUOL, &g_pDB, 0);
  v18 = &v14;
  _bstr_t::_bstr_t((_bstr_t *)&v14, aDbcataloggloba);
  v21 = -1;
  v1 = get_conf();
  v2 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(v1);
  v3 = IWzProperty::Getitem(v2, &result, (Ztl_bstr_t)v14);
  v21 = 1;
  DetachBSTR(&__that, (tagVARIANT *)&v3->0);
  LOBYTE(v21) = 3;
  v4 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v4 < 0 )
    _com_issue_error(v4);
  v14 = v5;
  v18 = &v14;
  _bstr_t::_bstr_t((_bstr_t *)&v14, aDbglobalaccoun);
  LOBYTE(v21) = 3;
  v6 = get_conf();
  v7 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(v6);
  v8 = IWzProperty::Getitem(v7, &v15, (Ztl_bstr_t)v14);
  LOBYTE(v21) = 5;
  DetachBSTR(&sCatalogGlobalAccount, (tagVARIANT *)&v8->0);
  LOBYTE(v21) = 7;
  v9 = ZComAPI::ZComVariantClear((tagVARIANT *)&v15.0);
  if ( v9 < 0 )
    _com_issue_error(v9);
  v10 = sCatalogGlobalAccount.m_Data;
  v14 = sCatalogGlobalAccount.m_Data;
  v18 = &v14;
  if ( sCatalogGlobalAccount.m_Data )
    InterlockedIncrement((volatile LONG *)&sCatalogGlobalAccount.m_Data->m_RefCount);
  v13.m_Data = v10;
  v17 = &v13;
  LOBYTE(v21) = 8;
  Ztl_bstr_t::Ztl_bstr_t(&v13, &__that);
  LOBYTE(v21) = 7;
  v11 = get_db();
  v12 = _com_ptr_t<_com_IIID<IWvsUnifiedDB,&__s_GUID _GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38>>::operator->(v11);
  IWvsUnifiedDB::InitGlobalAccount(v12, v13, (Ztl_bstr_t)v14);
  if ( sCatalogGlobalAccount.m_Data )
  {
    _bstr_t::Data_t::Release(sCatalogGlobalAccount.m_Data);
    sCatalogGlobalAccount.m_Data = 0;
  }
  if ( __that.m_Data )
    _bstr_t::Data_t::Release(__that.m_Data);
}

//----- (0041EF66) --------------------------------------------------------
void CLoginApp::CreateMainDialog()
{
  CLoginDialog *v1; // ecx@1
  CLoginDialog *v2; // [sp+0h] [bp-10h]@1

  v1 = (CLoginDialog *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x20u);
  v2 = v1;
  if ( v1 )
    CLoginDialog::CLoginDialog(v1);
  (*(void (__stdcall **)(signed int, signed int, signed int, CLoginDialog *))(*(_DWORD *)TSingleton<CServerDialog>::ms_pInstance
                                                                            + 4))(
    130,
    1001,
    1000,
    v2);
}
// 4A428C: using guessed type int TSingleton<CServerDialog>::ms_pInstance;

//----- (0041EFB9) --------------------------------------------------------
void __thiscall CLoginApp::InitializeCenter(CLoginApp *this)
{
  CLoginApp *v1; // esi@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *v2; // eax@1
  IWzProperty *v3; // eax@1
  Ztl_variant_t *v4; // eax@1
  int v5; // eax@2
  int v6; // eax@5
  signed int v7; // eax@9
  int v8; // edi@11
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *v9; // eax@13
  IUnknownVtbl *v10; // ecx@14
  IUnknownVtbl *v11; // ecx@18
  int *v12; // ecx@19
  IWzProperty *v13; // eax@19
  Ztl_variant_t *v14; // eax@19
  int v15; // eax@20
  int v16; // eax@23
  IUnknownVtbl *v17; // ecx@28
  CCenter *v18; // eax@29
  CCenter *v19; // esi@29
  unsigned __int16 *v20; // eax@29
  IUnknownVtbl *v21; // ecx@32
  _DWORD *i; // esi@36
  IUnknownVtbl *v23; // ecx@40
  int v24; // eax@41
  IUnknownVtbl *v25; // ecx@44
  CLoginApp *v26; // [sp-Ch] [bp-9Ch]@1
  void *v27; // [sp-8h] [bp-98h]@1
  int *v28; // [sp-4h] [bp-94h]@1
  int v29; // [sp+0h] [bp-90h]@1
  Ztl_variant_t v30; // [sp+Ch] [bp-84h]@19
  Ztl_variant_t result; // [sp+1Ch] [bp-74h]@1
  VARIANTARG pvarg; // [sp+2Ch] [bp-64h]@11
  _DWORD *v33; // [sp+3Ch] [bp-54h]@19
  CLoginApp **v34; // [sp+44h] [bp-4Ch]@1
  int v35; // [sp+48h] [bp-48h]@30
  int v36; // [sp+4Ch] [bp-44h]@26
  int v37; // [sp+50h] [bp-40h]@19
  int v38; // [sp+54h] [bp-3Ch]@15
  _com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > v39; // [sp+58h] [bp-38h]@13
  int v40; // [sp+5Ch] [bp-34h]@10
  int v41; // [sp+60h] [bp-30h]@8
  int v42; // [sp+64h] [bp-2Ch]@1
  ZArray<CCenter> *v43; // [sp+68h] [bp-28h]@11
  _com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > v44; // [sp+6Ch] [bp-24h]@13
  Ztl_bstr_t __that; // [sp+70h] [bp-20h]@19
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > pEntry; // [sp+74h] [bp-1Ch]@19
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v47; // [sp+78h] [bp-18h]@1
  char v48; // [sp+7Fh] [bp-11h]@11
  int *v49; // [sp+80h] [bp-10h]@1
  int v50; // [sp+8Ch] [bp-4h]@1

  v49 = &v29;
  v28 = 0;
  v1 = this;
  v27 = 0;
  v26 = this;
  v34 = &v26;
  v50 = 0;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v26, aCenter);
  LOBYTE(v50) = 1;
  v2 = get_conf();
  v3 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(v2);
  LOBYTE(v50) = 0;
  v4 = IWzProperty::Getitem(v3, &result, (Ztl_bstr_t)v26);
  LOBYTE(v50) = 2;
  v42 = (int)Ztl_variant_t::GetUnknown(v4, (char)v27, (char)v28);
  v47.m_pInterface = 0;
  if ( v42 )
  {
    v5 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
           &v47,
           (int)&v42);
    if ( v5 < 0 && v5 != -2147467262 )
      _com_issue_error(v5);
  }
  LOBYTE(v50) = 4;
  v6 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v6 < 0 )
    _com_issue_error(v6);
  if ( !v47.m_pInterface )
  {
    v41 = -2147467259;
    _CxxThrowException(&v41, &_TI1_AVZException__);
  }
  v7 = IWzProperty::Getcount(v47.m_pInterface);
  v34 = (CLoginApp **)v7;
  if ( v7 <= 0 )
  {
    v40 = -2147467259;
    _CxxThrowException(&v40, &_TI1_AVZException__);
  }
  v43 = &v1->m_aCenter;
  ZArray<CCenter>::_Alloc(&v1->m_aCenter, v7, (ZAllocHelper *)&v48);
  v8 = 0;
  VariantInit(&pvarg);
  LOBYTE(v50) = 5;
  if ( !v47.m_pInterface )
    _com_issue_error(-2147467261);
  v9 = IWzProperty::Get_NewEnum(v47.m_pInterface, &v39);
  LOBYTE(v50) = 6;
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>(
    &v44,
    v9);
  LOBYTE(v50) = 8;
  if ( v39.m_pInterface )
  {
    v10 = v39.m_pInterface->vfptr;
    v28 = (int *)v39.m_pInterface;
    v10->Release(v39.m_pInterface);
  }
  v38 = 0;
  while ( 1 )
  {
    if ( !v44.m_pInterface )
      _com_issue_error(-2147467261);
    v11 = v44.m_pInterface->vfptr;
    v28 = &v38;
    v27 = &pvarg;
    v26 = (CLoginApp *)1;
    if ( ((int (__stdcall *)(IEnumVARIANT *, signed int, VARIANTARG *, int *))v11[1].QueryInterface)(
           v44.m_pInterface,
           1,
           &pvarg,
           &v38) )
    {
      break;
    }
    DetachBSTR(&__that, &pvarg);
    v12 = v28;
    v28 = 0;
    v27 = 0;
    v26 = (CLoginApp *)v12;
    v33 = &v26;
    LOBYTE(v50) = 9;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v26, &__that);
    LOBYTE(v50) = 10;
    v13 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v47);
    LOBYTE(v50) = 9;
    v14 = IWzProperty::Getitem(v13, &v30, (Ztl_bstr_t)v26);
    LOBYTE(v50) = 11;
    v37 = (int)Ztl_variant_t::GetUnknown(v14, (char)v27, (char)v28);
    pEntry.m_pInterface = 0;
    if ( v37 )
    {
      v15 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &pEntry,
              (int)&v37);
      if ( v15 < 0 && v15 != -2147467262 )
        _com_issue_error(v15);
    }
    LOBYTE(v50) = 13;
    v16 = ZComAPI::ZComVariantClear((tagVARIANT *)&v30.0);
    if ( v16 < 0 )
      _com_issue_error(v16);
    if ( !pEntry.m_pInterface )
    {
      v36 = -2147467259;
      _CxxThrowException(&v36, &_TI1_AVZException__);
    }
    v28 = (int *)pEntry.m_pInterface;
    v33 = &v28;
    if ( pEntry.m_pInterface )
    {
      v17 = pEntry.m_pInterface->vfptr;
      v27 = pEntry.m_pInterface;
      v17->AddRef((IUnknown *)pEntry.m_pInterface);
    }
    LOBYTE(v50) = 14;
    v18 = ZArray<CCenter>::operator[](v43, v8);
    v27 = (void *)v8;
    v19 = v18;
    LOBYTE(v50) = 13;
    v20 = _bstr_t::operator unsigned short const *((_bstr_t *)&__that.m_Data);
    if ( !CCenter::Init(
            v19,
            v20,
            (int)v27,
            (_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> >)v28) )
    {
      v35 = -2147467259;
      _CxxThrowException(&v35, &_TI1_AVZException__);
    }
    LOBYTE(v50) = 9;
    if ( pEntry.m_pInterface )
    {
      v21 = pEntry.m_pInterface->vfptr;
      v28 = (int *)pEntry.m_pInterface;
      v21->Release((IUnknown *)pEntry.m_pInterface);
    }
    LOBYTE(v50) = 8;
    if ( __that.m_Data )
    {
      _bstr_t::Data_t::Release(__that.m_Data);
      __that.m_Data = 0;
    }
    ++v8;
  }
  LogReport(aConfigurationP);
  for ( i = 0; (signed int)i < (signed int)v34; i = (_DWORD *)((char *)i + 1) )
    CCenter::TryConnect(&v43->a[(_DWORD)i]);
  LOBYTE(v50) = 5;
  if ( v44.m_pInterface )
  {
    v23 = v44.m_pInterface->vfptr;
    v28 = (int *)v44.m_pInterface;
    v23->Release((IUnknown *)v44.m_pInterface);
  }
  LOBYTE(v50) = 4;
  v24 = ZComAPI::ZComVariantClear(&pvarg);
  if ( v24 < 0 )
    _com_issue_error(v24);
  LOBYTE(v50) = 0;
  if ( v47.m_pInterface )
  {
    v25 = v47.m_pInterface->vfptr;
    v28 = (int *)v47.m_pInterface;
    v25->Release((IUnknown *)v47.m_pInterface);
  }
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041F2A3) --------------------------------------------------------
void __usercall __noreturn _L123034(int a1@<ebp>)
{
  LogError(aInvalidConfigu);
  *(_DWORD *)(a1 - 80) = -2147467259;
  _CxxThrowException(a1 - 80, &_TI1_AVZException__);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041F2C4) --------------------------------------------------------
void CLoginApp::LoadConfiguration()
{
  TSingleton<CIPChecker>::CreateInstance();
  TSingleton<CIPFilter>::CreateInstance();
}

//----- (0041F2CE) --------------------------------------------------------
void __thiscall CLoginApp::CreateAcceptor(CLoginApp *this)
{
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *v1; // eax@1
  IWzProperty *v2; // eax@1
  Ztl_variant_t *v3; // eax@1
  int v4; // eax@1
  unsigned __int16 *v5; // eax@4
  unsigned __int16 v6; // ax@6
  _bstr_t::Data_t *v7; // ecx@6
  unsigned __int16 v8; // si@6
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *v9; // eax@6
  IWzProperty *v10; // eax@6
  Ztl_variant_t *v11; // eax@6
  const unsigned __int16 *v12; // eax@6
  int v13; // eax@6
  int v14; // eax@9
  Ztl_bstr_t v15; // [sp-4h] [bp-54h]@6
  unsigned __int16 *sDefault; // [sp+0h] [bp-50h]@1
  ZInetAddr sockaddr; // [sp+8h] [bp-48h]@12
  Ztl_variant_t v18; // [sp+18h] [bp-38h]@6
  Ztl_variant_t result; // [sp+28h] [bp-28h]@1
  unsigned __int16 **v20; // [sp+38h] [bp-18h]@1
  Ztl_bstr_t v21; // [sp+3Ch] [bp-14h]@1
  ZXString<char> v22; // [sp+40h] [bp-10h]@6
  int v23; // [sp+4Ch] [bp-4h]@1

  sDefault = (unsigned __int16 *)this;
  v20 = &sDefault;
  _bstr_t::_bstr_t((_bstr_t *)&sDefault, aPort);
  v23 = -1;
  v1 = get_conf();
  v2 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(v1);
  v3 = IWzProperty::Getitem(v2, &result, (Ztl_bstr_t)sDefault);
  v23 = 1;
  DetachBSTR(&v21, (tagVARIANT *)&v3->0);
  LOBYTE(v23) = 3;
  v4 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v4 < 0 )
    _com_issue_error(v4);
  if ( v21.m_Data )
    v5 = v21.m_Data->m_wstr;
  else
    v5 = 0;
  v6 = _wtoi(v5);
  sDefault = &::sDefault;
  v15.m_Data = v7;
  v20 = (unsigned __int16 **)&v15;
  v8 = v6;
  Ztl_bstr_t::Ztl_bstr_t(&v15, aPublicip);
  LOBYTE(v23) = 3;
  v9 = get_conf();
  v10 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(v9);
  v11 = IWzProperty::Getitem(v10, &v18, v15);
  LOBYTE(v23) = 5;
  v12 = get_string(v11, sDefault);
  v22._m_pStr = 0;
  ZXString<char>::Assign(&v22, (int)v12, -1);
  LOBYTE(v23) = 7;
  v13 = ZComAPI::ZComVariantClear((tagVARIANT *)&v18.0);
  if ( v13 < 0 )
    _com_issue_error(v13);
  if ( v22._m_pStr )
    v14 = *((_DWORD *)v22._m_pStr - 1);
  else
    v14 = 0;
  if ( !v14 )
  {
    LogError(aClientsocketip);
    v20 = (unsigned __int16 **)-2147467259;
    _CxxThrowException(&v20, &_TI1_AVZException__);
  }
  ZInetAddr::ZInetAddr(&sockaddr, v22._m_pStr, v8);
  LOBYTE(v23) = 8;
  if ( !CLoginAcceptor::Begin(TSingleton<CLoginAcceptor>::ms_pInstance, &sockaddr) )
  {
    LogError(aFailedInInitia);
    v20 = (unsigned __int16 **)-2147467259;
    _CxxThrowException(&v20, &_TI1_AVZException__);
  }
  LogReport(aSocketAcceptor);
  LOBYTE(v23) = 3;
  ZXString<char>::~ZXString<char>(&v22);
  if ( v21.m_Data )
    _bstr_t::Data_t::Release(v21.m_Data);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041F456) --------------------------------------------------------
void __thiscall CLoginApp::CreateAdminAcceptor(CLoginApp *this)
{
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *v1; // eax@1
  IWzProperty *v2; // eax@1
  Ztl_variant_t *v3; // eax@1
  int v4; // eax@1
  unsigned __int16 *v5; // eax@4
  unsigned __int16 v6; // ax@6
  CLoginApp *v7; // [sp-4h] [bp-3Ch]@1
  ZInetAddr sockaddr; // [sp+0h] [bp-38h]@6
  Ztl_variant_t result; // [sp+10h] [bp-28h]@1
  CLoginApp **v10; // [sp+20h] [bp-18h]@1
  DWORD v11; // [sp+24h] [bp-14h]@8
  Ztl_bstr_t v12; // [sp+28h] [bp-10h]@1
  int v13; // [sp+34h] [bp-4h]@1

  v7 = this;
  v10 = &v7;
  _bstr_t::_bstr_t((_bstr_t *)&v7, aAdminport);
  v13 = -1;
  v1 = get_conf();
  v2 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(v1);
  v3 = IWzProperty::Getitem(v2, &result, (Ztl_bstr_t)v7);
  v13 = 1;
  DetachBSTR(&v12, (tagVARIANT *)&v3->0);
  LOBYTE(v13) = 3;
  v4 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v4 < 0 )
    _com_issue_error(v4);
  if ( v12.m_Data )
    v5 = v12.m_Data->m_wstr;
  else
    v5 = 0;
  v6 = _wtoi(v5);
  ZInetAddr::_Init(&sockaddr, v6, 0);
  LOBYTE(v13) = 4;
  if ( !CAdminAcceptor::Begin(TSingleton<CAdminAcceptor>::ms_pInstance, &sockaddr) )
  {
    LogError(aFailedInCreati);
    v11 = GetLastError();
    _CxxThrowException(&v11, &_TI1_AVZException__);
  }
  LogReport(aAdminToolAccep);
  if ( v12.m_Data )
    _bstr_t::Data_t::Release(v12.m_Data);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041F537) --------------------------------------------------------
void CLoginApp::CreateTimerThread()
{
  CTimerThread *v1; // ecx@1
  CTimerThread *v2; // esi@3
  CTimerThread *v3; // [sp+10h] [bp-10h]@1
  int v4; // [sp+1Ch] [bp-4h]@1

  v1 = (CTimerThread *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x10u);
  v3 = v1;
  v4 = 0;
  if ( v1 )
    CTimerThread::CTimerThread(v1);
  v2 = TSingleton<CTimerThread>::ms_pInstance;
  v4 = -1;
  if ( !ZThread::BeginThread((ZThread *)&TSingleton<CTimerThread>::ms_pInstance->vfptr, 0, 0, 0, 0, 0) )
  {
    if ( v2 )
      v2->vfptr->__vecDelDtor((ZThread *)v2, 1u);
    LogError(aFailedInInit_1);
    v3 = (CTimerThread *)-2147467259;
    _CxxThrowException(&v3, &_TI1_AVZException__);
  }
  LogReport(aTimerThreadSta);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0041F5C3) --------------------------------------------------------
void __thiscall CLoginApp::LoadNewCharInfo(CLoginApp *this)
{
  _bstr_t::Data_t *v1; // ecx@1
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v2; // eax@1
  IWzResMan *v3; // eax@1
  Ztl_variant_t *v4; // eax@1
  int v5; // eax@2
  int v6; // eax@5
  int v7; // eax@7
  int v8; // eax@9
  unsigned int v9; // eax@12
  _DWORD *v10; // edi@12
  unsigned int i; // esi@12
  void *v12; // esp@16
  wchar_t *v13; // eax@16
  IWzProperty *v14; // eax@16
  Ztl_variant_t *v15; // eax@16
  bool v16; // zf@16
  unsigned __int16 *v17; // eax@17
  int v18; // eax@19
  _bstr_t::Data_t *v19; // ecx@22
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v20; // eax@22
  IWzResMan *v21; // eax@22
  Ztl_variant_t *v22; // eax@22
  int v23; // eax@23
  int v24; // eax@26
  int v25; // eax@28
  int v26; // eax@30
  unsigned int v27; // esi@37
  unsigned int v28; // eax@37
  _DWORD *v29; // edi@37
  unsigned int v30; // eax@40
  void *v31; // esp@41
  wchar_t *v32; // eax@41
  IWzProperty *v33; // eax@41
  Ztl_variant_t *v34; // eax@41
  unsigned __int16 *v35; // eax@42
  int v36; // eax@44
  char *v37; // esi@46
  char *v38; // eax@47
  int v39; // eax@48
  unsigned int v40; // eax@53
  ZXString<char> *v41; // esi@54
  unsigned int v42; // eax@56
  ZArray<CLoginApp::NEWEQUIP> *v43; // esi@61
  _variant_t *v44; // edi@61
  _bstr_t::Data_t *v45; // ecx@63
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v46; // eax@63
  IWzResMan *v47; // eax@63
  Ztl_variant_t *v48; // eax@63
  int v49; // eax@63
  int v50; // eax@66
  int v51; // eax@68
  tagVARIANT *v52; // eax@70
  _bstr_t::Data_t *v53; // ecx@71
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v54; // eax@71
  IWzResMan *v55; // eax@71
  Ztl_variant_t *v56; // eax@71
  int v57; // eax@71
  int v58; // eax@74
  int v59; // eax@76
  int v60; // eax@79
  void *v61; // esp@82
  wchar_t *v62; // eax@82
  IWzProperty *v63; // eax@82
  Ztl_variant_t *v64; // eax@82
  int v65; // eax@82
  int v66; // eax@85
  unsigned int v67; // eax@90
  int v68; // eax@92
  int v69; // eax@95
  int v70; // eax@98
  void *v71; // esp@100
  wchar_t *v72; // eax@100
  IWzProperty *v73; // eax@100
  Ztl_variant_t *v74; // eax@100
  int v75; // edi@100
  CLoginApp::NEWEQUIP *v76; // eax@100
  int v77; // eax@100
  IUnknownVtbl *v78; // ecx@106
  IUnknownVtbl *v79; // ecx@108
  IUnknownVtbl *v80; // ecx@110
  IUnknownVtbl *v81; // ecx@112
  Ztl_bstr_t v82; // [sp-48h] [bp-178h]@100
  int v83; // [sp-44h] [bp-174h]@100
  int v84; // [sp-40h] [bp-170h]@100
  Ztl_variant_t *v85; // [sp-30h] [bp-160h]@82
  IWzProperty *v86; // [sp-2Ch] [bp-15Ch]@82
  IWzProperty *v87; // [sp-28h] [bp-158h]@82
  void *v88; // [sp-24h] [bp-154h]@16
  int v89; // [sp-20h] [bp-150h]@16
  Ztl_variant_t *v90; // [sp-18h] [bp-148h]@22
  Ztl_bstr_t v91; // [sp-14h] [bp-144h]@1
  Ztl_variant_t *v92; // [sp-10h] [bp-140h]@1
  Ztl_variant_t *v93; // [sp-Ch] [bp-13Ch]@1
  int v94; // [sp-8h] [bp-138h]@1
  _variant_t *v95; // [sp-4h] [bp-134h]@1
  Ztl_variant_t v96; // [sp+Ch] [bp-124h]@100
  Ztl_variant_t v97; // [sp+1Ch] [bp-114h]@63
  Ztl_variant_t v98; // [sp+2Ch] [bp-104h]@82
  Ztl_variant_t v99; // [sp+3Ch] [bp-F4h]@22
  Ztl_variant_t v100; // [sp+4Ch] [bp-E4h]@71
  Ztl_variant_t result; // [sp+5Ch] [bp-D4h]@1
  _variant_t v102; // [sp+6Ch] [bp-C4h]@22
  _variant_t v103; // [sp+7Ch] [bp-B4h]@63
  _variant_t v104; // [sp+8Ch] [bp-A4h]@71
  _variant_t v105; // [sp+9Ch] [bp-94h]@22
  _variant_t v106; // [sp+ACh] [bp-84h]@63
  _variant_t v107; // [sp+BCh] [bp-74h]@1
  _variant_t v108; // [sp+CCh] [bp-64h]@1
  Ztl_bstr_t *v109; // [sp+DCh] [bp-54h]@100
  Ztl_variant_t vParam; // [sp+E0h] [bp-50h]@16
  int v111; // [sp+F0h] [bp-40h]@71
  int v112; // [sp+F4h] [bp-3Ch]@22
  int v113; // [sp+F8h] [bp-38h]@1
  ZXString<char> v114; // [sp+FCh] [bp-34h]@54
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v115; // [sp+100h] [bp-30h]@61
  int v116; // [sp+104h] [bp-2Ch]@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v117; // [sp+108h] [bp-28h]@61
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v118; // [sp+10Ch] [bp-24h]@22
  ZXString<char> s; // [sp+110h] [bp-20h]@37
  int v120; // [sp+114h] [bp-1Ch]@1
  int n; // [sp+118h] [bp-18h]@37
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v122; // [sp+11Ch] [bp-14h]@1
  char v123; // [sp+123h] [bp-Dh]@12
  int v124; // [sp+12Ch] [bp-4h]@1

  v120 = (int)this;
  _variant_t::_variant_t(&v107, &vtMissing);
  v124 = 0;
  _variant_t::_variant_t(&v108, &vtMissing);
  v95 = 0;
  v94 = 0;
  v93 = (Ztl_variant_t *)&v107;
  v92 = (Ztl_variant_t *)&v108;
  v91.m_Data = v1;
  v116 = (int)&v91;
  LOBYTE(v124) = 1;
  Ztl_bstr_t::Ztl_bstr_t(&v91, aEtcForbiddenna);
  LOBYTE(v124) = 1;
  v2 = get_rm();
  v3 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v2);
  v4 = IWzResMan::GetObjectA(v3, &result, v91, v92, v93);
  LOBYTE(v124) = 3;
  v113 = (int)Ztl_variant_t::GetUnknown(v4, v94, (char)v95);
  v122.m_pInterface = 0;
  if ( v113 )
  {
    v5 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
           &v122,
           (int)&v113);
    if ( v5 < 0 && v5 != -2147467262 )
      _com_issue_error(v5);
  }
  LOBYTE(v124) = 7;
  v6 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v6 < 0 )
    _com_issue_error(v6);
  LOBYTE(v124) = 6;
  v7 = ZComAPI::ZComVariantClear((tagVARIANT *)&v108.0);
  if ( v7 < 0 )
    _com_issue_error(v7);
  LOBYTE(v124) = 5;
  v8 = ZComAPI::ZComVariantClear((tagVARIANT *)&v107.0);
  if ( v8 < 0 )
    _com_issue_error(v8);
  if ( v122.m_pInterface )
  {
    v9 = IWzProperty::Getcount(v122.m_pInterface);
    v10 = (_DWORD *)(v120 + 20);
    ZArray<ZXString<char>>::_Alloc((ZArray<ZXString<char> > *)(v120 + 20), v9, (ZAllocHelper *)&v123);
    for ( i = 0; ; ++i )
    {
      if ( !v122.m_pInterface )
        _com_issue_error(-2147467261);
      if ( i >= IWzProperty::Getcount(v122.m_pInterface) )
        break;
      v12 = alloca(32);
      v13 = _Int2StrW(i, (unsigned __int16 *)&v89);
      v116 = (int)&v88;
      Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v88, v13);
      LOBYTE(v124) = 5;
      v14 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v122);
      v15 = IWzProperty::Getitem(v14, &vParam, (Ztl_bstr_t)v88);
      v16 = v15->vt == 8;
      LOBYTE(v124) = 9;
      if ( v16 )
        v17 = v15->bstrVal;
      else
        v17 = &sDefault;
      ZXString<char>::Assign((ZXString<char> *)(*v10 + 4 * i), (int)v17, -1);
      LOBYTE(v124) = 5;
      v18 = ZComAPI::ZComVariantClear((tagVARIANT *)&vParam.0);
      if ( v18 < 0 )
        _com_issue_error(v18);
    }
  }
  _variant_t::_variant_t(&v105, &vtMissing);
  LOBYTE(v124) = 10;
  _variant_t::_variant_t(&v102, &vtMissing);
  v95 = 0;
  v94 = 0;
  v93 = (Ztl_variant_t *)&v105;
  v92 = (Ztl_variant_t *)&v102;
  v91.m_Data = v19;
  v116 = (int)&v91;
  LOBYTE(v124) = 11;
  Ztl_bstr_t::Ztl_bstr_t(&v91, aEtcCurse_img);
  v90 = &v99;
  LOBYTE(v124) = 11;
  v20 = get_rm();
  v21 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v20);
  v22 = IWzResMan::GetObjectA(v21, v90, v91, v92, v93);
  LOBYTE(v124) = 13;
  v112 = (int)Ztl_variant_t::GetUnknown(v22, v94, (char)v95);
  v118.m_pInterface = 0;
  if ( v112 )
  {
    v23 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
            &v118,
            (int)&v112);
    if ( v23 < 0 && v23 != -2147467262 )
      _com_issue_error(v23);
  }
  LOBYTE(v124) = 17;
  v24 = ZComAPI::ZComVariantClear((tagVARIANT *)&v99.0);
  if ( v24 < 0 )
    _com_issue_error(v24);
  LOBYTE(v124) = 16;
  v25 = ZComAPI::ZComVariantClear((tagVARIANT *)&v102.0);
  if ( v25 < 0 )
    _com_issue_error(v25);
  LOBYTE(v124) = 15;
  v26 = ZComAPI::ZComVariantClear((tagVARIANT *)&v105.0);
  if ( v26 < 0 )
    _com_issue_error(v26);
  if ( v118.m_pInterface )
  {
    if ( !v122.m_pInterface )
      _com_issue_error(-2147467261);
    if ( !v118.m_pInterface )
      _com_issue_error(-2147467261);
    v27 = IWzProperty::Getcount(v118.m_pInterface);
    v28 = IWzProperty::Getcount(v122.m_pInterface);
    v29 = (_DWORD *)(v120 + 20);
    ZArray<ZXString<char>>::_Realloc((ZArray<ZXString<char> > *)(v120 + 20), v28 + v27, 0, (ZAllocHelper *)&v123);
    s._m_pStr = 0;
    LOBYTE(v124) = 18;
    for ( n = 0; ; ++n )
    {
      if ( !v118.m_pInterface )
        _com_issue_error(-2147467261);
      v30 = IWzProperty::Getcount(v118.m_pInterface);
      if ( n >= v30 )
        break;
      v31 = alloca(32);
      v32 = _Int2StrW(n, (unsigned __int16 *)&v89);
      v116 = (int)&v88;
      Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v88, v32);
      LOBYTE(v124) = 18;
      v33 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v118);
      v34 = IWzProperty::Getitem(v33, &vParam, (Ztl_bstr_t)v88);
      v16 = v34->vt == 8;
      LOBYTE(v124) = 20;
      if ( v16 )
        v35 = v34->bstrVal;
      else
        v35 = &sDefault;
      ZXString<char>::Assign(&s, (int)v35, -1);
      LOBYTE(v124) = 18;
      v36 = ZComAPI::ZComVariantClear((tagVARIANT *)&vParam.0);
      if ( v36 < 0 )
        _com_issue_error(v36);
      v37 = s._m_pStr;
      if ( s._m_pStr && ((v38 = strchr(s._m_pStr, 44)) == 0 ? (v39 = -1) : (v39 = v38 - v37), v39 >= 0) )
      {
        v41 = ZXString<char>::Mid(&s, &v114, 0, v39);
        LOBYTE(v124) = 21;
        if ( !v122.m_pInterface )
          _com_issue_error(-2147467261);
        v42 = IWzProperty::Getcount(v122.m_pInterface);
        ZXString<char>::operator=((ZXString<char> *)(*v29 + 4 * (n + v42)), v41);
        LOBYTE(v124) = 18;
        if ( v114._m_pStr )
          ZXString<char>::_Release((ZXString<char>::_ZXStringData *)v114._m_pStr - 1);
      }
      else
      {
        if ( !v122.m_pInterface )
          _com_issue_error(-2147467261);
        v40 = IWzProperty::Getcount(v122.m_pInterface);
        v88 = &s;
        ZXString<char>::operator=((ZXString<char> *)(*v29 + 4 * (n + v40)), &s);
      }
    }
    LOBYTE(v124) = 15;
    if ( s._m_pStr )
      ZXString<char>::_Release((ZXString<char>::_ZXStringData *)s._m_pStr - 1);
  }
  v43 = (ZArray<CLoginApp::NEWEQUIP> *)(v120 + 24);
  ZArray<CLoginApp::NEWEQUIP>::_Alloc((ZArray<CLoginApp::NEWEQUIP> *)(v120 + 24), 1u, (ZAllocHelper *)&v123);
  v115.m_pInterface = 0;
  v117.m_pInterface = 0;
  LOBYTE(v124) = 23;
  n = 0;
  v44 = &vtMissing;
  do
  {
    v95 = v44;
    if ( n )
    {
      _variant_t::_variant_t((_variant_t *)&vParam.0, v95);
      LOBYTE(v124) = 28;
      _variant_t::_variant_t(&v104, v44);
      v95 = 0;
      v94 = 0;
      v93 = &vParam;
      v92 = (Ztl_variant_t *)&v104;
      v91.m_Data = v53;
      v120 = (int)&v91;
      LOBYTE(v124) = 29;
      Ztl_bstr_t::Ztl_bstr_t(&v91, aEtcMakechari_1);
      v90 = &v100;
      LOBYTE(v124) = 29;
      v54 = get_rm();
      v55 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v54);
      v56 = IWzResMan::GetObjectA(v55, v90, v91, v92, v93);
      LOBYTE(v124) = 31;
      v111 = (int)Ztl_variant_t::GetUnknown(v56, v94, (char)v95);
      v57 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v115,
              (int)&v111);
      if ( v57 < 0 && v57 != -2147467262 )
        _com_issue_error(v57);
      LOBYTE(v124) = 29;
      v58 = ZComAPI::ZComVariantClear((tagVARIANT *)&v100.0);
      if ( v58 < 0 )
        _com_issue_error(v58);
      LOBYTE(v124) = 28;
      v59 = ZComAPI::ZComVariantClear((tagVARIANT *)&v104.0);
      if ( v59 < 0 )
        _com_issue_error(v59);
      LOBYTE(v124) = 23;
      v52 = (tagVARIANT *)&vParam;
    }
    else
    {
      _variant_t::_variant_t(&v106, v95);
      LOBYTE(v124) = 24;
      _variant_t::_variant_t(&v103, v44);
      v95 = 0;
      v94 = 0;
      v93 = (Ztl_variant_t *)&v106;
      v92 = (Ztl_variant_t *)&v103;
      v91.m_Data = v45;
      v120 = (int)&v91;
      LOBYTE(v124) = 25;
      Ztl_bstr_t::Ztl_bstr_t(&v91, aEtcMakecharinf);
      v90 = &v97;
      LOBYTE(v124) = 25;
      v46 = get_rm();
      v47 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v46);
      v48 = IWzResMan::GetObjectA(v47, v90, v91, v92, v93);
      LOBYTE(v124) = 27;
      v114._m_pStr = (char *)Ztl_variant_t::GetUnknown(v48, v94, (char)v95);
      v49 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v115,
              (int)&v114);
      if ( v49 < 0 && v49 != -2147467262 )
        _com_issue_error(v49);
      LOBYTE(v124) = 25;
      v50 = ZComAPI::ZComVariantClear((tagVARIANT *)&v97.0);
      if ( v50 < 0 )
        _com_issue_error(v50);
      LOBYTE(v124) = 24;
      v51 = ZComAPI::ZComVariantClear((tagVARIANT *)&v103.0);
      if ( v51 < 0 )
        _com_issue_error(v51);
      LOBYTE(v124) = 23;
      v52 = (tagVARIANT *)&v106;
    }
    v60 = ZComAPI::ZComVariantClear(v52);
    if ( v60 < 0 )
      _com_issue_error(v60);
    s._m_pStr = 0;
    do
    {
      v61 = alloca(32);
      v88 = 0;
      v87 = 0;
      v62 = _Int2StrW((int)s._m_pStr, (unsigned __int16 *)&v89);
      v120 = (int)&v86;
      Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v86, v62);
      v85 = &v98;
      LOBYTE(v124) = 23;
      v63 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v115);
      v64 = IWzProperty::Getitem(v63, v85, (Ztl_bstr_t)v86);
      LOBYTE(v124) = 33;
      v116 = (int)Ztl_variant_t::GetUnknown(v64, (char)v87, (char)v88);
      v65 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v117,
              (int)&v116);
      if ( v65 < 0 && v65 != -2147467262 )
        _com_issue_error(v65);
      LOBYTE(v124) = 23;
      v66 = ZComAPI::ZComVariantClear((tagVARIANT *)&v98.0);
      if ( v66 < 0 )
        _com_issue_error(v66);
      v120 = 0;
      while ( 1 )
      {
        if ( !v117.m_pInterface )
          _com_issue_error(-2147467261);
        v67 = IWzProperty::Getcount(v117.m_pInterface);
        if ( v120 >= v67 )
          break;
        if ( v43->a )
          v68 = v43->a[-1].nItemId;
        else
          v68 = 0;
        ZArray<CLoginApp::NEWEQUIP>::_Realloc(v43, v68 + 1, 0, (ZAllocHelper *)&v123);
        if ( v43->a )
          v69 = v43->a[-1].nItemId;
        else
          v69 = 0;
        v43->a[v69 - 1].nGender = n;
        if ( v43->a )
          v70 = v43->a[-1].nItemId;
        else
          v70 = 0;
        *((ZXString<char> *)&v43->a[v70] - 2) = s;
        v71 = alloca(32);
        v83 = 0;
        v72 = _Int2StrW(v120, (unsigned __int16 *)&v84);
        v109 = &v82;
        Ztl_bstr_t::Ztl_bstr_t(&v82, v72);
        LOBYTE(v124) = 23;
        v73 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v117);
        v74 = IWzProperty::Getitem(v73, &v96, v82);
        LOBYTE(v124) = 35;
        v75 = get_int32(v74, v83);
        v76 = ZArray<CLoginApp::NEWEQUIP>::GetCount(v43);
        ZArray<CLoginApp::NEWEQUIP>::operator[](v43, (unsigned int)&v76[-1].nItemId + 3)->nItemId = v75;
        LOBYTE(v124) = 23;
        v77 = ZComAPI::ZComVariantClear((tagVARIANT *)&v96.0);
        if ( v77 < 0 )
          _com_issue_error(v77);
        ++v120;
        v44 = &vtMissing;
      }
      ++s._m_pStr;
    }
    while ( (signed int)s._m_pStr < 8 );
    ++n;
  }
  while ( n < 2 );
  LOBYTE(v124) = 22;
  if ( v117.m_pInterface )
  {
    v78 = v117.m_pInterface->vfptr;
    v88 = v117.m_pInterface;
    ((void (__cdecl *)(IWzProperty *))v78->Release)(v117.m_pInterface);
  }
  LOBYTE(v124) = 15;
  if ( v115.m_pInterface )
  {
    v79 = v115.m_pInterface->vfptr;
    v87 = v115.m_pInterface;
    ((void (__cdecl *)(IWzProperty *, void *))v79->Release)(v115.m_pInterface, v88);
  }
  LOBYTE(v124) = 5;
  if ( v118.m_pInterface )
  {
    v80 = v118.m_pInterface->vfptr;
    v86 = v118.m_pInterface;
    ((void (__cdecl *)(IWzProperty *, IWzProperty *, void *))v80->Release)(v118.m_pInterface, v87, v88);
  }
  v124 = -1;
  if ( v122.m_pInterface )
  {
    v81 = v122.m_pInterface->vfptr;
    v85 = (Ztl_variant_t *)v122.m_pInterface;
    ((void (__cdecl *)(IWzProperty *, IWzProperty *, IWzProperty *, void *))v81->Release)(
      v122.m_pInterface,
      v86,
      v87,
      v88);
  }
}

//----- (0041FD96) --------------------------------------------------------
int __thiscall CLoginApp::CheckCharName(CLoginApp *this, ZXString<char> *sCharName, int bWordCheck)
{
  ZXString<char> *v3; // edi@1
  char *v4; // eax@1
  bool v5; // zf@1
  signed int v6; // ecx@2
  int result; // eax@5
  signed int v8; // eax@7
  char *v9; // eax@11
  int i; // edx@11
  int v11; // ecx@13
  char v12; // cl@16
  char v13; // cl@25
  char *j; // ebx@29
  ZXString<char> *v15; // ecx@30
  void *v16; // esp@32
  void *v17; // esp@32
  char *v18; // eax@32
  char *v19; // eax@36
  signed int v20; // ebx@36
  int k; // edx@36
  int v22; // ecx@38
  char v23; // cl@41
  int v24; // [sp+0h] [bp-24h]@32
  wchar_t *Str; // [sp+Ch] [bp-18h]@32
  wchar_t *SubStr; // [sp+10h] [bp-14h]@32
  CLoginApp *v27; // [sp+14h] [bp-10h]@1
  int v28; // [sp+20h] [bp-4h]@29

  v3 = sCharName;
  v4 = sCharName->_m_pStr;
  v5 = sCharName->_m_pStr == 0;
  v27 = this;
  if ( v5 )
    v6 = 0;
  else
    v6 = *((_DWORD *)v4 - 1);
  if ( v6 < 4
    || (!v4 ? (v8 = 0) : (v8 = *((_DWORD *)v4 - 1)), v8 > 12 || ZXString<char>::Find(sCharName, ::Str, 0, 0) != -1) )
  {
LABEL_5:
    result = 0;
  }
  else
  {
    v9 = sCharName->_m_pStr;
    for ( i = 0; ; ++i )
    {
      v11 = v9 ? *((_DWORD *)v9 - 1) : 0;
      if ( i >= v11 )
        break;
      v12 = v9[i];
      if ( (v12 < 97 || v12 > 122) && (v12 < 65 || v12 > 90) && (v12 < 48 || v12 > 57) )
      {
        if ( !(v12 & 0x80) )
          goto LABEL_5;
        if ( (unsigned __int8)v12 < 0xB0u )
          goto LABEL_5;
        if ( (unsigned __int8)v12 > 0xC8u )
          goto LABEL_5;
        v13 = v9[i++ + 1];
        if ( (unsigned __int8)v13 < 0xA1u || (unsigned __int8)v13 > 0xFEu )
          goto LABEL_5;
      }
    }
    if ( bWordCheck )
    {
      bWordCheck = 0;
      ZXString<char>::operator=((ZXString<char> *)&bWordCheck, sCharName);
      v28 = 0;
      ZXString<char>::MakeLower((ZXString<char> *)&bWordCheck);
      for ( j = 0; ; ++j )
      {
        v15 = v27->m_asForbiddenName.a;
        if ( !v15 || j >= v15[-1]._m_pStr )
          break;
        v16 = alloca(2 * dword_4A4778(0, 0, v15[(_DWORD)j]._m_pStr, -1, 0, 0));
        SubStr = (wchar_t *)&v24;
        v17 = alloca(2 * dword_4A4778(0, 0, bWordCheck, -1, 0, 0));
        v18 = v27->m_asForbiddenName.a[(_DWORD)j]._m_pStr;
        Str = (wchar_t *)&v24;
        dword_4A4778(0, 0, v18, -1, &v24, 0x3FFFFFFF);
        dword_4A4778(0, 0, bWordCheck, -1, Str, 0x3FFFFFFF);
        if ( wcsstr(Str, SubStr) )
        {
          v28 = -1;
          ZXString<char>::~ZXString<char>((ZXString<char> *)&bWordCheck);
          goto LABEL_5;
        }
      }
      v28 = -1;
      ZXString<char>::~ZXString<char>((ZXString<char> *)&bWordCheck);
      v3 = sCharName;
    }
    v19 = v3->_m_pStr;
    v20 = 0;
    for ( k = 0; ; ++k )
    {
      v22 = v19 ? *((_DWORD *)v19 - 1) : 0;
      if ( k >= v22 )
        break;
      v23 = v19[k];
      if ( v23 == 73 || v23 == 108 )
        ++v20;
    }
    result = v20 < 4;
  }
  return result;
}
// 4A4778: using guessed type int (__stdcall *dword_4A4778)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0041FF60) --------------------------------------------------------
int __thiscall CLoginApp::CheckCharEquip(CLoginApp *this, int nGender, int nType, int nItemId)
{
  unsigned int v4; // edx@1
  int i; // esi@1
  CLoginApp::NEWEQUIP *v6; // eax@2
  CLoginApp::NEWEQUIP *v7; // eax@4

  v4 = 0;
  for ( i = 0; ; ++i )
  {
    v6 = this->m_aNewEquip.a;
    if ( !v6 || v4 >= v6[-1].nItemId )
      break;
    v7 = &this->m_aNewEquip.a[i];
    if ( v7->nGender == nGender && v7->nType == nType && v7->nItemId == nItemId )
      return 1;
    ++v4;
  }
  return 0;
}

//----- (0041FFA3) --------------------------------------------------------
IWvsUnifiedDB *__thiscall _com_ptr_t<_com_IIID<IWvsUnifiedDB,&__s_GUID _GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38>>::operator->(_com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *this)
{
  if ( !this->m_pInterface )
    _com_issue_error(-2147467261);
  return this->m_pInterface;
}

//----- (0041FFB9) --------------------------------------------------------
ZXString<char> *__thiscall ZXString<char>::Mid(ZXString<char> *this, ZXString<char> *result, int __$ReturnUdt, int nFrom)
{
  ZXString<char>::Substring(this, result, __$ReturnUdt, nFrom);
  return result;
}

//----- (0041FFD6) --------------------------------------------------------
void __thiscall ZXString<char>::MakeLower(ZXString<char> *this)
{
  ZXString<char> *v1; // esi@1
  char *v2; // eax@3
  int v3; // eax@4

  v1 = this;
  if ( this->_m_pStr && *this->_m_pStr )
  {
    v2 = ZXString<char>::GetBuffer(this, 0, 1);
    _strlwr(v2);
    if ( v1->_m_pStr )
      v3 = *((_DWORD *)v1->_m_pStr - 1);
    else
      v3 = 0;
    ZXString<char>::ReleaseBuffer(v1, v3);
  }
}

//----- (00420010) --------------------------------------------------------
CIPChecker *__cdecl TSingleton<CIPChecker>::CreateInstance()
{
  CIPChecker *result; // eax@1
  CIPChecker *v1; // eax@2
  CIPChecker *v2; // esi@2

  result = TSingleton<CIPChecker>::ms_pInstance;
  if ( !TSingleton<CIPChecker>::ms_pInstance )
  {
    v1 = (CIPChecker *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 4u);
    v2 = v1;
    if ( v1 )
    {
      TSingleton<CIPChecker>::ms_pInstance = v1;
      v1->m_aIPList.a = 0;
      CIPChecker::LoadIPList(v1);
    }
    else
    {
      v2 = 0;
    }
    result = v2;
  }
  return result;
}

//----- (00420065) --------------------------------------------------------
void TSingleton<CIPChecker>::~TSingleton<CIPChecker>()
{
  TSingleton<CIPChecker>::ms_pInstance = 0;
}

//----- (00420072) --------------------------------------------------------
void __cdecl TSingleton<CSecurityServer>::CreateInstance()
{
  CSecurityServer *v0; // ecx@2

  if ( !TSingleton<CSecurityServer>::ms_pInstance )
  {
    v0 = (CSecurityServer *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x14u);
    if ( v0 )
      CSecurityServer::CSecurityServer(v0);
  }
}

//----- (004200B4) --------------------------------------------------------
void __thiscall CSecurityServer::CSecurityServer(CSecurityServer *this)
{
  CSecurityServer *v1; // esi@1

  v1 = this;
  TSingleton<CSecurityServer>::ms_pInstance = (CSecurityServer *)(&this->m_tLastGGAuthUpdateCheck != 0 ? (unsigned int)this : 0);
  this->m_tLastGGAuthUpdateCheck = timeGetTime();
  v1->m_bMemoryCheckEnabled = 0;
  v1->m_MemoryHashes.a = 0;
  v1->m_MemoryRegions.a = 0;
  v1->vfptr = (CSecurityServerVtbl *)&CSecurityServer::`vftable';
}
// 443984: using guessed type int (__thiscall *CSecurityServer::`vftable')(void *p, unsigned int __flags);

//----- (004200E9) --------------------------------------------------------
CSecurityServer *__thiscall CSecurityServer::`scalar deleting destructor'(CSecurityServer *this, unsigned int __flags)
{
  CSecurityServer *v2; // esi@1

  v2 = this;
  CSecurityServer::~CSecurityServer(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00420109) --------------------------------------------------------
void __thiscall CSecurityServer::~CSecurityServer(CSecurityServer *this)
{
  CSecurityServer *v1; // esi@1

  v1 = this;
  this->vfptr = (CSecurityServerVtbl *)&CSecurityServer::`vftable';
  ZArray<unsigned long>::RemoveAll(&this->m_MemoryRegions);
  ZArray<unsigned long>::RemoveAll(&v1->m_MemoryHashes);
  TSingleton<CSecurityServer>::ms_pInstance = 0;
}
// 443984: using guessed type int (__thiscall *CSecurityServer::`vftable')(void *p, unsigned int __flags);

//----- (00420154) --------------------------------------------------------
void TSingleton<CSecurityServer>::~TSingleton<CSecurityServer>()
{
  TSingleton<CSecurityServer>::ms_pInstance = 0;
}

//----- (0042015C) --------------------------------------------------------
int TSingleton<CSecurityServer>::DestroyInstance()
{
  int result; // eax@2

  if ( TSingleton<CSecurityServer>::ms_pInstance )
    result = ((int (__stdcall *)(_DWORD))TSingleton<CSecurityServer>::ms_pInstance->vfptr->__vecDelDtor)(1);
  return result;
}

//----- (00420177) --------------------------------------------------------
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::GetCount(ZArray<CLoginApp::NEWEQUIP> *this)
{
  CLoginApp::NEWEQUIP *result; // eax@1

  result = this->a;
  if ( this->a )
    result = (CLoginApp::NEWEQUIP *)result[-1].nItemId;
  return result;
}

//----- (00420182) --------------------------------------------------------
void __cdecl TSingleton<CIPFilter>::CreateInstance()
{
  CIPFilter *v0; // ecx@2

  if ( !TSingleton<CIPFilter>::ms_pInstance )
  {
    v0 = (CIPFilter *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x48u);
    if ( v0 )
      CIPFilter::CIPFilter(v0);
  }
}

//----- (004201C4) --------------------------------------------------------
void __cdecl TSelfTestThread<CLoginAcceptor>::Create(ZXString<char> sParam)
{
  TSelfTestThread<CLoginAcceptor> *v1; // ecx@5
  ZThread *v2; // esi@7
  TSelfTestThread<CLoginAcceptor> *v3; // [sp+8h] [bp-14h]@5
  int pParam; // [sp+Ch] [bp-10h]@3
  int v5; // [sp+18h] [bp-4h]@1

  v5 = 0;
  if ( sParam._m_pStr && *sParam._m_pStr )
    pParam = atoi(sParam._m_pStr);
  else
    pParam = 0;
  v1 = (TSelfTestThread<CLoginAcceptor> *)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                            &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                            0x18u);
  v3 = v1;
  LOBYTE(v5) = 1;
  if ( v1 )
    TSelfTestThread<CLoginAcceptor>::TSelfTestThread<CLoginAcceptor>(v1);
  v2 = TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance;
  LOBYTE(v5) = 0;
  if ( !ZThread::BeginThread(TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance, &pParam, 0, 0, 0, 0) )
  {
    LogError(aFailedInInit_2);
    if ( v2 )
      v2->vfptr->__vecDelDtor(v2, 1u);
    v3 = (TSelfTestThread<CLoginAcceptor> *)-2147467259;
    _CxxThrowException(&v3, &_TI1_AVZException__);
  }
  LogReport(aSelfTestThread, pParam);
  v5 = -1;
  ZXString<char>::~ZXString<char>(&sParam);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00420280) --------------------------------------------------------
void TSelfTestThread<CLoginAcceptor>::Destroy()
{
  if ( TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance )
  {
    TSelfTestThread<CLoginAcceptor>::Terminate((TSelfTestThread<CLoginAcceptor> *)TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance);
    if ( TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance )
      ((void (__stdcall *)(_DWORD))TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance->vfptr->__vecDelDtor)(1);
  }
}

//----- (004202CB) --------------------------------------------------------
void __thiscall TSelfTestThread<CLoginAcceptor>::TSelfTestThread<CLoginAcceptor>(TSelfTestThread<CLoginAcceptor> *this)
{
  TSelfTestThread<CLoginAcceptor> *v1; // eax@1
  char *v2; // ecx@1

  v1 = this;
  v2 = (char *)&this->m_hEventTerminate;
  v1->_m_dwThreadId = 0;
  v1->_m_hThread = 0;
  TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance = (ZThread *)(v2 != 0 ? (unsigned int)(v2 - 12) : 0);
  *(_DWORD *)v2 = 0;
  v1->m_hwndProcessManager = 0;
  v1->m_bDeadLockDetected = 0;
  v1->vfptr = (ZThreadVtbl *)&TSelfTestThread<CLoginAcceptor>::`vftable';
}
// 44398C: using guessed type int (__thiscall *TSelfTestThread<CLoginAcceptor>::`vftable')(void *p, unsigned int __flags);

//----- (004202FC) --------------------------------------------------------
int __userpurge TSelfTestThread<CLoginAcceptor>::Run@<eax>(TSelfTestThread<CLoginAcceptor> *this@<ecx>, int a2@<ebx>, void *pParam, ZThread::ZThreadResult *pResult)
{
  TSelfTestThread<CLoginAcceptor> *v4; // esi@1
  HANDLE v5; // eax@1
  DraggingProcessInfo *v6; // eax@6
  int v7; // ebx@8
  LPARAM dpi_4; // ST20_4@8
  int v9; // eax@11
  DraggingProcessInfo result; // [sp+10h] [bp-14h]@6
  int v11; // [sp+18h] [bp-Ch]@7
  int v12; // [sp+1Ch] [bp-8h]@7
  int tCur; // [sp+20h] [bp-4h]@4
  int tLastCheck; // [sp+2Ch] [bp+8h]@2
  unsigned int dwProcessID; // [sp+30h] [bp+Ch]@2

  v4 = this;
  v5 = CreateEventA(0, 0, 0, 0);
  v4->m_hEventTerminate = v5;
  if ( v5 )
  {
    v4->m_hwndProcessManager = *(HWND__ **)pParam;
    ZThread::ZThreadResult::Succeeded(pResult);
    tLastCheck = dword_4A49B4();
    dwProcessID = ((int (__cdecl *)(int))dword_4A4640)(a2);
    while ( WaitForSingleObject(v4->m_hEventTerminate, 0x64u) )
    {
      tCur = dword_4A49B4();
      if ( tCur - tLastCheck >= 5000 )
      {
        if ( TSingleton<CLoginAcceptor>::ms_pInstance )
        {
          ZPort::GetDraggingProcessInfo(&TSingleton<CLoginAcceptor>::ms_pInstance->m_port, &result);
          v6 = &result;
        }
        else
        {
          v11 = 0;
          v12 = -1;
          v6 = (DraggingProcessInfo *)&v11;
        }
        v7 = v6->tTime;
        dpi_4 = v6->nProtocol;
        PostMessageA(v4->m_hwndProcessManager, 0x410u, dwProcessID, v6->tTime / 1000);
        PostMessageA(v4->m_hwndProcessManager, 0x411u, dwProcessID, dpi_4);
        tLastCheck = tCur;
        if ( v7 >= 180000 && !v4->m_bDeadLockDetected )
        {
          v4->m_bDeadLockDetected = 1;
          WRITEMINIDUMPNOW(v7);
        }
      }
    }
    v9 = 0;
  }
  else
  {
    ZThread::ZThreadResult::Failed(pResult, 0x80004005);
    v9 = -1;
  }
  return v9;
}
// 4202FC: could not find valid save-restore pair for ebx
// 4A4640: using guessed type int (__cdecl *dword_4A4640)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A49B4: using guessed type int (*dword_4A49B4)(void);

//----- (00420409) --------------------------------------------------------
unsigned int __thiscall ZThread::ZThreadResult::Failed(ZThread::ZThreadResult *this, unsigned int dwErr)
{
  ZThread::ZThreadResult *v2; // esi@1
  unsigned int v3; // eax@1
  int v4; // ST00_4@3

  v2 = this;
  dword_4A4638(*(_DWORD *)&this[16]);
  v3 = -2147467259;
  if ( dwErr )
    v3 = dwErr;
  v4 = *(_DWORD *)&v2[12];
  *(_DWORD *)&v2[20] = v3;
  dword_4A4688(v4);
  return dwErr;
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);
// 4A4688: using guessed type int (__stdcall *dword_4A4688)(_DWORD);

//----- (00420438) --------------------------------------------------------
void __usercall WRITEMINIDUMPNOW(int a1@<ebx>)
{
  if ( ZExceptionHandler::InitDbgHelpFunctions(&_g_zeh) )
    ZExceptionHandler::GenerateMiniDump(&_g_zeh, a1, (int)&_g_zeh, 0);
}

//----- (00420454) --------------------------------------------------------
int __thiscall ZExceptionHandler::InitDbgHelpFunctions(ZExceptionHandler *this)
{
  ZExceptionHandler *v1; // ebx@1
  HINSTANCE__ *v2; // eax@1
  HMODULE v3; // edi@1
  int result; // eax@2
  FARPROC v5; // eax@3
  FARPROC v6; // eax@4
  FARPROC v7; // eax@5
  FARPROC v8; // eax@6
  FARPROC v9; // eax@7
  FARPROC v10; // eax@8
  int v11; // eax@10
  char *i; // eax@12
  FARPROC v13; // eax@18
  char v14; // [sp+Bh] [bp-19Dh]@12
  char sModule[260]; // [sp+Ch] [bp-19Ch]@12
  _OSVERSIONINFOA ovi; // [sp+110h] [bp-98h]@9
  HINSTANCE__ *hModDbgHelp; // [sp+1A4h] [bp-4h]@1

  v1 = this;
  v2 = LoadLibraryA(LibFileName);
  v3 = v2;
  hModDbgHelp = v2;
  if ( !v2 )
    goto LABEL_23;
  v5 = GetProcAddress(v2, ProcName);
  v1->_SymInitialize = (int (__stdcall *)(void *, char *, int))v5;
  if ( !v5 )
    goto LABEL_23;
  v6 = GetProcAddress(v3, aSymcleanup);
  v1->_SymCleanup = (int (__stdcall *)(void *))v6;
  if ( !v6 )
    goto LABEL_23;
  v7 = GetProcAddress(v3, aStackwalk);
  v1->_StackWalk = (int (__stdcall *)(unsigned int, void *, void *, _tagSTACKFRAME *, void *, int (__stdcall *)(void *, unsigned int, void *, unsigned int, unsigned int *), void *(__stdcall *)(void *, unsigned int), unsigned int (__stdcall *)(void *, unsigned int), unsigned int (__stdcall *)(void *, void *, _tagADDRESS *)))v7;
  if ( !v7 )
    goto LABEL_23;
  v8 = GetProcAddress(v3, aSymfunctiontab);
  v1->_SymFunctionTableAccess = (void *(__stdcall *)(void *, unsigned int))v8;
  if ( !v8 )
    goto LABEL_23;
  v9 = GetProcAddress(v3, aSymgetmoduleba);
  v1->_SymGetModuleBase = (unsigned int (__stdcall *)(void *, unsigned int))v9;
  if ( !v9 )
    goto LABEL_23;
  v10 = GetProcAddress(v3, aSymgetsymfroma);
  v1->_SymGetSymFromAddr = (int (__stdcall *)(void *, unsigned int, unsigned int *, _IMAGEHLP_SYMBOL *))v10;
  if ( !v10 )
    goto LABEL_23;
  v1->_SymGetLineFromAddr = (int (__stdcall *)(void *, unsigned int, unsigned int *, _IMAGEHLP_LINE *))GetProcAddress(v3, aSymgetlinefrom);
  v1->_MiniDumpWriteDump = (int (__stdcall *)(void *, unsigned int, void *, _MINIDUMP_TYPE, _MINIDUMP_EXCEPTION_INFORMATION *, _MINIDUMP_USER_STREAM_INFORMATION *, _MINIDUMP_CALLBACK_INFORMATION *))GetProcAddress(v3, aMinidumpwrited);
  ovi.dwOSVersionInfoSize = 148;
  memset(&ovi.dwMajorVersion, 0, 0x90u);
  GetVersionExA(&ovi);
  v11 = ovi.dwPlatformId == 2 ? ((int (__cdecl *)())dword_4A463C)() : ((int (__cdecl *)())dword_4A4640)();
  v1->m_hProcess = (void *)v11;
  sModule[0] = sLog;
  memset(&sModule[1], 0, 0x100u);
  *(_WORD *)&sModule[257] = 0;
  sModule[259] = 0;
  for ( i = &v14 + dword_4A4634(0, sModule, 260); i >= sModule && *i != 47 && *i != 92; --i )
    ;
  i[1] = 0;
  if ( v1->_SymInitialize(v1->m_hProcess, sModule, 1) )
  {
    v13 = GetProcAddress(hModDbgHelp, aSymsetoptions);
    if ( v13 )
      ((void (__stdcall *)(signed int))v13)(23);
    result = ovi.dwPlatformId == 2;
  }
  else
  {
LABEL_23:
    result = 0;
  }
  return result;
}
// 4A4634: using guessed type int (__stdcall *dword_4A4634)(_DWORD, _DWORD, _DWORD);
// 4A463C: using guessed type int (__cdecl *dword_4A463C)(_DWORD);
// 4A4640: using guessed type int (__cdecl *dword_4A4640)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (004205DF) --------------------------------------------------------
int __userpurge ZExceptionHandler::GenerateMiniDump@<eax>(ZExceptionHandler *this@<ecx>, int a2@<ebx>, int a3@<esi>, _EXCEPTION_POINTERS *pExceptionPointers)
{
  bool v4; // zf@1
  int result; // eax@3
  char *i; // esi@4
  char v7; // al@6
  int v8; // ebx@12
  int v9; // eax@14
  int v10; // eax@14
  int v11; // ST08_4@14
  int v12; // ST0C_4@14
  int v13; // ST10_4@14
  int v14; // ST14_4@14
  int v15; // [sp-8h] [bp-130h]@4
  char v16; // [sp+3h] [bp-125h]@4
  char sDumpFileName[260]; // [sp+4h] [bp-124h]@4
  _MINIDUMP_EXCEPTION_INFORMATION ExpParam; // [sp+108h] [bp-20h]@13
  _SYSTEMTIME st; // [sp+114h] [bp-14h]@10
  ZExceptionHandler *v20; // [sp+124h] [bp-4h]@1

  v4 = this->m_bNoMiniDump == 0;
  v20 = this;
  if ( v4 && this->_MiniDumpWriteDump )
  {
    v15 = a3;
    for ( i = &v16 + dword_4A4634(0, sDumpFileName, 260); i >= sDumpFileName; --i )
    {
      v7 = *i;
      if ( *i == 47 || v7 == 92 || v7 == 46 )
        break;
    }
    dword_4A4758(&st, v15, a2);
    if ( i < sDumpFileName )
      ++i;
    dword_4A47BC(i, aD02d02d02d02d0, st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond);
    v8 = dword_4A46FC(sDumpFileName, -1073741824, 3, 0, 2, 0, 0);
    if ( pExceptionPointers )
    {
      ExpParam.ThreadId = dword_4A465C();
      ExpParam.ExceptionPointers = pExceptionPointers;
      ExpParam.ClientPointers = 1;
    }
    v9 = dword_4A4640(v8, 0, pExceptionPointers != 0 ? (unsigned int)&ExpParam : 0, 0, 0);
    v10 = dword_4A463C(v9);
    ((void (__stdcall *)(int, int, int, int, int))v20->_MiniDumpWriteDump)(v10, v11, v12, v13, v14);
    dword_4A4638(v8);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 4205DF: could not find valid save-restore pair for ebx
// 4205DF: could not find valid save-restore pair for esi
// 4A4634: using guessed type int (__stdcall *dword_4A4634)(_DWORD, _DWORD, _DWORD);
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);
// 4A463C: using guessed type int (__cdecl *dword_4A463C)(_DWORD);
// 4A4640: using guessed type int (__cdecl *dword_4A4640)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A465C: using guessed type int (*dword_4A465C)(void);
// 4A46FC: using guessed type int (__stdcall *dword_4A46FC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A4758: using guessed type int (__stdcall *dword_4A4758)(_DWORD, _DWORD, _DWORD);
// 4A47BC: using guessed type int (*dword_4A47BC)(_DWORD, const char *, ...);

//----- (004206E9) --------------------------------------------------------
TSelfTestThread<CLoginAcceptor> *__thiscall TSelfTestThread<CLoginAcceptor>::`vector deleting destructor'(TSelfTestThread<CLoginAcceptor> *this, unsigned int __flags)
{
  TSelfTestThread<CLoginAcceptor> *v2; // esi@1

  v2 = this;
  TSelfTestThread<CLoginAcceptor>::~TSelfTestThread<CLoginAcceptor>(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00420709) --------------------------------------------------------
void __thiscall TSelfTestThread<CLoginAcceptor>::~TSelfTestThread<CLoginAcceptor>(TSelfTestThread<CLoginAcceptor> *this)
{
  TSelfTestThread<CLoginAcceptor> *v1; // esi@1
  void *v2; // eax@1

  v1 = this;
  this->vfptr = (ZThreadVtbl *)&TSelfTestThread<CLoginAcceptor>::`vftable';
  v2 = this->m_hEventTerminate;
  if ( v2 )
    dword_4A4638(v2);
  TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance = 0;
  v1->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  ZThread::CloseThread((ZThread *)&v1->vfptr);
}
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);
// 44398C: using guessed type int (__thiscall *TSelfTestThread<CLoginAcceptor>::`vftable')(void *p, unsigned int __flags);
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);

//----- (0042075A) --------------------------------------------------------
void __thiscall TSelfTestThread<CLoginAcceptor>::Terminate(TSelfTestThread<CLoginAcceptor> *this)
{
  TSelfTestThread<CLoginAcceptor> *v1; // esi@1

  v1 = this;
  if ( this->m_hEventTerminate )
  {
    dword_4A4688(this->m_hEventTerminate);
    ZThread::JoinThread((ZThread *)&v1->vfptr, 0xFFFFFFFF);
  }
}
// 4A4688: using guessed type int (__stdcall *dword_4A4688)(_DWORD);

//----- (00420776) --------------------------------------------------------
void TSingleton<TSelfTestThread<CLoginAcceptor>>::~TSingleton<TSelfTestThread<CLoginAcceptor>>()
{
  TSingleton<TSelfTestThread<CLoginAcceptor>>::ms_pInstance = 0;
}

//----- (0042077E) --------------------------------------------------------
int __thiscall ZXString<char>::Find(ZXString<char> *this, const char *s, int nStart, int bTreatAsMBChar)
{
  char *v4; // esi@1
  int result; // eax@4
  char *v6; // eax@8

  v4 = this->_m_pStr;
  if ( this->_m_pStr )
  {
    if ( s && *s )
    {
      v6 = ZStrUtil::Str(&v4[nStart], s, bTreatAsMBChar);
      if ( !v6 )
        return -1;
      result = v6 - v4;
    }
    else
    {
      result = *((_DWORD *)v4 - 1);
    }
  }
  else
  {
    if ( s && *s )
      return -1;
    result = 0;
  }
  return result;
}

//----- (004207C7) --------------------------------------------------------
char *__cdecl ZStrUtil::Str(const char *string, const char *pat, int bTreatAsMBChar)
{
  char *result; // eax@2
  BYTE *v4; // esi@3
  char v5; // al@7
  BYTE *v6; // edx@7
  const char *i; // ecx@7
  char v8; // bl@8

  if ( bTreatAsMBChar )
  {
    v4 = (BYTE *)string;
    if ( string && pat && *string && *pat )
    {
      while ( 1 )
      {
        v5 = *pat;
        v6 = v4;
        for ( i = pat; v5; v5 = (i++)[1] )
        {
          v8 = *v6++;
          if ( v8 != v5 )
            break;
        }
        if ( !*i )
          break;
        if ( IsDBCSLeadByte(*v4) )
          v4 += 2;
        else
          ++v4;
        if ( !*v4 )
          goto LABEL_15;
      }
      result = v4;
    }
    else
    {
LABEL_15:
      result = 0;
    }
  }
  else
  {
    result = strstr(string, pat);
  }
  return result;
}

//----- (0042083B) --------------------------------------------------------
void __thiscall ZArray<ZXString<char>>::RemoveAll(ZArray<ZXString<char> > *this)
{
  ZArray<ZXString<char> > *v1; // esi@1
  ZXString<char> *v2; // ebx@2
  ZXString<char> *i; // edi@2

  v1 = this;
  if ( this->a )
  {
    v2 = &this->a[(unsigned int)this->a[-1]._m_pStr];
    for ( i = this->a; i < v2; ++i )
      ZXString<char>::~ZXString<char>(i);
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v1->a[-1]);
    v1->a = 0;
  }
}

//----- (00420875) --------------------------------------------------------
ZXString<char> *__thiscall ZArray<ZXString<char>>::_Alloc(ZArray<ZXString<char> > *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<ZXString<char> > *v3; // edi@1
  ZXString<char> *result; // eax@2
  int v5; // eax@3
  unsigned int v6; // ebx@3
  ZXString<char> *v7; // esi@3
  ZXString<char> *v8; // ST00_4@5

  v3 = this;
  ZArray<ZXString<char>>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 4 * u + 4) + 4;
    v3->a = (ZXString<char> *)v5;
    *(_DWORD *)(v5 - 4) = u;
    v6 = (unsigned int)&v3->a[u];
    v7 = v3->a;
    while ( (unsigned int)v7 < v6 )
    {
      v8 = v7;
      ++v7;
      construct(v8);
    }
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (004208C6) --------------------------------------------------------
void __thiscall ZArray<CIPChecker::IPELEM>::RemoveAll(ZArray<CIPChecker::IPELEM> *this)
{
  ZArray<CIPChecker::IPELEM> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &this->a[-1].dwFlag);
    v1->a = 0;
  }
}

//----- (004208E8) --------------------------------------------------------
void __thiscall ZArray<CCenter>::RemoveAll(ZArray<CCenter> *this)
{
  ZArray<CCenter> *v1; // edi@1
  CCenter *v2; // esi@2
  CCenter *i; // ebx@2

  v1 = this;
  if ( this->a )
  {
    v2 = &this->a[this->a[-1].m_mServerStatus._m_uAutoGrowLimit];
    for ( i = this->a; i < v2; ++i )
      CCenter::~CCenter(i);
    ZAllocEx<ZAllocAnonSelector>::Free(
      &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
      &v1->a[-1].m_mServerStatus._m_uAutoGrowLimit);
    v1->a = 0;
  }
}

//----- (00420924) --------------------------------------------------------
CCenter *__thiscall ZArray<CCenter>::_Alloc(ZArray<CCenter> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<CCenter> *v3; // edi@1
  CCenter *result; // eax@2
  int v5; // eax@3
  unsigned int v6; // esi@3
  CCenter *v7; // ebx@3
  CCenter *v8; // ST00_4@5

  v3 = this;
  ZArray<CCenter>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 124 * u + 4) + 4;
    v3->a = (CCenter *)v5;
    *(_DWORD *)(v5 - 4) = u;
    v6 = (unsigned int)&v3->a[u];
    v7 = v3->a;
    while ( (unsigned int)v7 < v6 )
    {
      v8 = v7;
      ++v7;
      construct(v8);
    }
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00420975) --------------------------------------------------------
void __thiscall ZArray<CLoginApp::NEWEQUIP>::RemoveAll(ZArray<CLoginApp::NEWEQUIP> *this)
{
  ZArray<CLoginApp::NEWEQUIP> *v1; // esi@1

  v1 = this;
  if ( this->a )
  {
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &this->a[-1].nItemId);
    v1->a = 0;
  }
}

//----- (00420997) --------------------------------------------------------
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::_Alloc(ZArray<CLoginApp::NEWEQUIP> *this, unsigned int u, ZAllocHelper *_ALLOC)
{
  ZArray<CLoginApp::NEWEQUIP> *v3; // edi@1
  CLoginApp::NEWEQUIP *result; // eax@2
  int v5; // eax@3

  v3 = this;
  ZArray<CLoginApp::NEWEQUIP>::RemoveAll(this);
  if ( u )
  {
    v5 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 12 * u + 4) + 4;
    v3->a = (CLoginApp::NEWEQUIP *)v5;
    *(_DWORD *)(v5 - 4) = u;
    result = v3->a;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (004209D5) --------------------------------------------------------
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::_Realloc(ZArray<CLoginApp::NEWEQUIP> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<CLoginApp::NEWEQUIP> *v4; // esi@1
  unsigned int v5; // edi@2
  void *v6; // esi@8
  ZArray<CLoginApp::NEWEQUIP> *v8; // [sp+Ch] [bp-4h]@1
  int nModea; // [sp+1Ch] [bp+Ch]@7

  v4 = this;
  v8 = this;
  if ( this->a )
    v5 = this->a[-1].nItemId;
  else
    v5 = 0;
  if ( u > v5 )
  {
    if ( u > (unsigned int)ZArray<CLoginApp::NEWEQUIP>::GetCapacity(this) )
    {
      v6 = (void *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 12 * u + 4) + 4);
      if ( v8->a )
      {
        if ( !(nMode & 1) )
          memcpy(v6, v8->a, 12 * v5);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, &v8->a[-1].nItemId);
      }
      v8->a = (CLoginApp::NEWEQUIP *)v6;
      v4 = v8;
    }
    else if ( !(nMode & 2) )
    {
      nModea = (int)&v4->a[v5].nGender;
    }
  }
  if ( v4->a )
    v4->a[-1].nItemId = u;
  return v4->a;
}

//----- (00420A95) --------------------------------------------------------
CCenter *__thiscall ZArray<CCenter>::operator[](ZArray<CCenter> *this, int i)
{
  return &this->a[i];
}

//----- (00420AA1) --------------------------------------------------------
void __cdecl PcCreateObject(const unsigned __int16 *sUOL, _com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *pObj, IUnknown *pUnkOuter)
{
  int v3; // eax@4
  _com_error v4; // [sp+4h] [bp-10h]@6

  _com_ptr_t<_com_IIID<IWvsUnifiedDB,&__s_GUID _GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38>>::operator=(pObj, 0);
  if ( pObj->m_pInterface )
    pObj->m_pInterface->vfptr->Release((IUnknown *)pObj->m_pInterface);
  pObj->m_pInterface = 0;
  if ( !_g_apfnPCOMAPIs )
  {
    v3 = -2147221008;
LABEL_6:
    _com_error::_com_error(&v4, v3, 0, 0);
    _CxxThrowException(&v4, &_TI1_AV_com_error__);
  }
  v3 = _g_apfnPCOMAPIs(sUOL, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38, pObj, pUnkOuter);
  if ( v3 < 0 )
    goto LABEL_6;
}
// 4A4C54: invalid function type has been ignored
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4C54: using guessed type int (__cdecl *_g_apfnPCOMAPIs)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00420B06) --------------------------------------------------------
void __thiscall _com_error::_com_error(_com_error *this, _com_error *that)
{
  IErrorInfo *v2; // eax@1

  this->m_hresult = that->m_hresult;
  v2 = that->m_perrinfo;
  this->m_pszMsg = 0;
  this->m_perrinfo = v2;
  this->vfptr = (_com_errorVtbl *)&_com_error::`vftable';
  if ( v2 )
    v2->vfptr->AddRef((IUnknown *)v2);
}
// 4438D8: using guessed type int (__thiscall *_com_error::`vftable')(void *p, unsigned int __flags);

//----- (00420B33) --------------------------------------------------------
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::operator[](ZArray<CLoginApp::NEWEQUIP> *this, unsigned int i)
{
  return &this->a[i];
}

//----- (00420B42) --------------------------------------------------------
void _E62()
{
  _E48_1();
  _E49_3();
  _E50_2();
  _E51_2();
  _E52_3();
  _E53_4();
  _E54_4();
  _E55_4();
  _E56_4();
  _E57_3();
  _E58_3();
  _E59_2();
  _E60_2();
  _E61_1();
}

//----- (00420B88) --------------------------------------------------------
void _E48_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00420BC3) --------------------------------------------------------
void _E49_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00420BFE) --------------------------------------------------------
void _E50_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::s_pInstance = v3;
}

//----- (00420C39) --------------------------------------------------------
void _E51_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::s_pInstance = v3;
}

//----- (00420C74) --------------------------------------------------------
void _E52_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::s_pInstance = v3;
}

//----- (00420CAF) --------------------------------------------------------
void _E53_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::s_pInstance = v3;
}

//----- (00420CEA) --------------------------------------------------------
void _E54_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::s_pInstance = v3;
}

//----- (00420D25) --------------------------------------------------------
void _E55_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance = v3;
}

//----- (00420D60) --------------------------------------------------------
void _E56_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00420D9B) --------------------------------------------------------
void _E57_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (00420DD6) --------------------------------------------------------
void _E58_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00420E11) --------------------------------------------------------
void _E59_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (00420E4C) --------------------------------------------------------
void _E60_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00420E87) --------------------------------------------------------
void _E61_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00420EC2) --------------------------------------------------------
CLoginApp::NEWEQUIP *__thiscall ZArray<CLoginApp::NEWEQUIP>::GetCapacity(ZArray<CLoginApp::NEWEQUIP> *this)
{
  CLoginApp::NEWEQUIP *result; // eax@1
  int v2; // eax@2

  result = this->a;
  if ( this->a )
  {
    v2 = result[-1].nType;
    if ( v2 < 0 )
      v2 = ~v2;
    result = (CLoginApp::NEWEQUIP *)((v2 - 4) / 0xCu);
  }
  return result;
}

//----- (00420EDD) --------------------------------------------------------
DraggingProcessInfo *__thiscall ZPort::GetDraggingProcessInfo(ZPort *this, DraggingProcessInfo *result)
{
  ZPort *v2; // esi@1
  struct _RTL_CRITICAL_SECTION *v3; // ebx@1
  ZPort::ZPortThread **v4; // esi@1
  ZPort::ZPortThread *v5; // edi@2
  int v6; // eax@2
  int v7; // edx@2
  int v8; // eax@2
  DraggingProcessInfo *v9; // eax@7
  int v10; // [sp+8h] [bp-18h]@1
  int v11; // [sp+Ch] [bp-14h]@1

  v10 = 0;
  v11 = -1;
  v2 = this;
  v3 = (struct _RTL_CRITICAL_SECTION *)&this->_m_lockThreads.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->_m_lockThreads.DebugInfo);
  v4 = v2->_m_lpThreads._m_pHead;
  while ( v4 )
  {
    v5 = *v4;
    v6 = (int)*(v4 != 0 ? v4 - 3 : 4);
    v7 = v6 != 0 ? v6 + 16 : 0;
    v8 = 0;
    v4 = (ZPort::ZPortThread **)v7;
    if ( v5->m_bProcessing )
      v8 = dword_4A4754() - v5->m_tProcessStart;
    if ( v10 < v8 )
    {
      v10 = v8;
      v11 = ZPort::ZPortThread::GetCurProcessingProtocol(v5);
    }
  }
  LeaveCriticalSection(v3);
  v9 = result;
  result->tTime = v10;
  result->nProtocol = v11;
  return v9;
}
// 4A4754: using guessed type int (*dword_4A4754)(void);

//----- (00420F7C) --------------------------------------------------------
int __thiscall ZPort::ZPortThread::GetCurProcessingProtocol(ZPort::ZPortThread *this)
{
  int result; // eax@2

  if ( this->m_bProcessing )
    result = ((int (*)(void))this->m_pOverlapped->pCallBack->vfptr->GetType)();
  else
    result = -1;
  return result;
}

//----- (00420F92) --------------------------------------------------------
void __cdecl construct(CCenter *p)
{
  if ( p )
    CCenter::CCenter(p);
}

//----- (00420FBE) --------------------------------------------------------
void _E87()
{
  _E76_0();
  _E77_0();
  _E78_0();
  _E79_0();
  _E80_0();
  _E81();
  _E82();
  _E83();
  _E84();
  _E85();
  _E86();
}

//----- (00420FF5) --------------------------------------------------------
void _E76_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00421030) --------------------------------------------------------
void _E77_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0042106B) --------------------------------------------------------
void _E78_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (004210A6) --------------------------------------------------------
void _E79_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (004210E1) --------------------------------------------------------
void _E80_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0042111C) --------------------------------------------------------
void _E81()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00421157) --------------------------------------------------------
void _E82()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance = v3;
}

//----- (00421192) --------------------------------------------------------
void _E83()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance = v3;
}

//----- (004211CD) --------------------------------------------------------
void _E84()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance = v3;
}

//----- (00421208) --------------------------------------------------------
void _E85()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (00421243) --------------------------------------------------------
void _E86()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::s_pInstance = v3;
}

//----- (0042127E) --------------------------------------------------------
unsigned int __thiscall IWzProperty::Getcount(IWzProperty *this)
{
  IWzProperty *v1; // esi@1
  int v2; // eax@1
  unsigned int _result; // [sp+4h] [bp-4h]@1

  v1 = this;
  v2 = ((int (__stdcall *)(IWzProperty *, unsigned int *))this->vfptr[2].Release)(this, &_result);
  if ( v2 < 0 )
    _com_issue_errorex(v2, (IUnknown *)&v1->vfptr, &_GUID_986515d9_0a0b_4929_8b4f_718682177b92);
  return _result;
}

//----- (004212A5) --------------------------------------------------------
int __thiscall IWvsUnifiedDB::InitGlobalAccount(IWvsUnifiedDB *this, Ztl_bstr_t sCatalogGlobalAccount, Ztl_bstr_t sDBSourc)
{
  IWvsUnifiedDB *v3; // esi@1
  unsigned __int16 *v4; // ecx@2
  unsigned __int16 *v5; // eax@5
  int v6; // eax@7
  int v7; // edi@7

  v3 = this;
  if ( sDBSourc.m_Data )
    v4 = sDBSourc.m_Data->m_wstr;
  else
    v4 = 0;
  if ( sCatalogGlobalAccount.m_Data )
    v5 = sCatalogGlobalAccount.m_Data->m_wstr;
  else
    v5 = 0;
  v6 = v3->vfptr[1].QueryInterface((IUnknown *)v3, (_GUID *)v5, (void **)v4);
  v7 = v6;
  if ( v6 < 0 )
    _com_issue_errorex(v6, (IUnknown *)&v3->vfptr, &_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38);
  if ( sCatalogGlobalAccount.m_Data )
    _bstr_t::Data_t::Release(sCatalogGlobalAccount.m_Data);
  if ( sDBSourc.m_Data )
    _bstr_t::Data_t::Release(sDBSourc.m_Data);
  return v7;
}

//----- (00421319) --------------------------------------------------------
_com_ptr_t<_com_IIID<IWvsUnifiedDB,&_GUID_9708b7f7_0d66_47e6_b678_a3e04c6ffe38> > *__cdecl get_db()
{
  return &g_pDB;
}

//----- (0042131F) --------------------------------------------------------
wchar_t *__cdecl _Int2StrW(int n, unsigned __int16 *s)
{
  return _itow(n, s, 10);
}

//----- (00421332) --------------------------------------------------------
void __thiscall CLoginDialog::CLoginDialog(CLoginDialog *this)
{
  CLoginDialog *v1; // esi@1

  v1 = this;
  CServerDialog::CServerDialog((CServerDialog *)&this->vfptr);
  v1->vfptr = (CServerDialogVtbl *)&CLoginDialog::`vftable';
}
// 443998: using guessed type int (__thiscall *CLoginDialog::`vftable')(void *p, unsigned int __flags);

//----- (00421344) --------------------------------------------------------
CLoginDialog *__thiscall CLoginDialog::`scalar deleting destructor'(CLoginDialog *this, unsigned int __flags)
{
  CLoginDialog *v2; // esi@1

  v2 = this;
  CLoginDialog::~CLoginDialog(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00421364) --------------------------------------------------------
void __thiscall CLoginDialog::~CLoginDialog(CLoginDialog *this)
{
  this->vfptr = (CServerDialogVtbl *)&CLoginDialog::`vftable';
  CServerDialog::~CServerDialog((CServerDialog *)&this->vfptr);
}
// 443998: using guessed type int (__thiscall *CLoginDialog::`vftable')(void *p, unsigned int __flags);

//----- (0042136F) --------------------------------------------------------
void __thiscall CLoginDialog::UpdateConnection(CLoginDialog *this)
{
  CLoginDialog *v1; // esi@1
  int v2; // eax@2
  char buf[256]; // [sp+8h] [bp-100h]@1

  buf[1] = 0;
  v1 = this;
  buf[0] = 48;
  memset(&buf[2], 0, 0xFCu);
  *(_WORD *)&buf[254] = 0;
  if ( TSingleton<CLoginAcceptor>::ms_pInstance )
    v2 = TSingleton<CLoginAcceptor>::ms_pInstance->m_lpSocket._m_uCount;
  else
    v2 = 0;
  _itoa(v2, buf, 10);
  SetWindowTextA(v1->m_hEditConnection, buf);
}

//----- (004213D2) --------------------------------------------------------
void __thiscall CLoginDialog::OnTimer(CLoginDialog *this)
{
  CLoginDialog *v1; // edi@1

  v1 = this;
  if ( !(__S26__1__OnTimer_CLoginDialog__MAEXXZ_4EA & 1) )
  {
    __S26__1__OnTimer_CLoginDialog__MAEXXZ_4EA |= 1u;
    dword_4A44F4 = timeGetTime();
  }
  if ( timeGetTime() - dword_4A44F4 > 0x7530 )
  {
    CLoginApp::TryConnectCenter(TSingleton<CServerApp>::ms_pInstance);
    dword_4A44F4 = timeGetTime();
  }
  CServerDialog::OnTimer((CServerDialog *)&v1->vfptr);
}
// 4A44F4: using guessed type int dword_4A44F4;

//----- (0042141E) --------------------------------------------------------
int __stdcall CLoginDialog::OnWndMsg(HWND__ *hWnd, unsigned int message, unsigned int wParam, int lParam)
{
  int result; // eax@2

  if ( message == 1124 )
  {
    CLoginApp::CloseCenter(TSingleton<CServerApp>::ms_pInstance, wParam);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00421441) --------------------------------------------------------
void _E43_0()
{
  _E35_8();
  _E36_8();
  _E37_7();
  _E38_4();
  _E39_6();
  _E40_4();
  _E41_4();
  _E42_3();
}

//----- (00421469) --------------------------------------------------------
void _E35_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (004214A4) --------------------------------------------------------
void _E36_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (004214DF) --------------------------------------------------------
void _E37_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0042151A) --------------------------------------------------------
void _E38_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (00421555) --------------------------------------------------------
void _E39_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00421590) --------------------------------------------------------
void _E40_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (004215CB) --------------------------------------------------------
void _E41_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00421606) --------------------------------------------------------
void _E42_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance = v3;
}

//----- (00421641) --------------------------------------------------------
void _E62_0()
{
  _E54_5();
  _E55_5();
  _E56_5();
  _E57_4();
  _E58_4();
  _E59_3();
  _E60_3();
  _E61_2();
}

//----- (00421669) --------------------------------------------------------
void _E54_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004216A4) --------------------------------------------------------
void _E55_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004216DF) --------------------------------------------------------
void _E56_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0042171A) --------------------------------------------------------
void _E57_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00421755) --------------------------------------------------------
void _E58_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00421790) --------------------------------------------------------
void _E59_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004217CB) --------------------------------------------------------
void _E60_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (00421806) --------------------------------------------------------
void _E61_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00421841) --------------------------------------------------------
void __thiscall CMachineIDHelper::CMachineIDHelper(CMachineIDHelper *this)
{
  CMachineIDHelper *v1; // esi@1

  v1 = this;
  this->cbuffer = 0;
  this->hFile = (void *)-1;
  this->o_day = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lockMILog.DebugInfo);
  v1->vfptr = (CMachineIDHelperVtbl *)&CMachineIDHelper::`vftable';
  CreateDirectoryA(PathName, 0);
}
// 4439B8: using guessed type int (__thiscall *CMachineIDHelper::`vftable')(void *p, unsigned int __flags);

//----- (0042187D) --------------------------------------------------------
CMachineIDHelper *__thiscall CMachineIDHelper::`vector deleting destructor'(CMachineIDHelper *this, unsigned int __flags)
{
  CMachineIDHelper *v2; // esi@1

  v2 = this;
  CMachineIDHelper::~CMachineIDHelper(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (0042189D) --------------------------------------------------------
void __thiscall CMachineIDHelper::~CMachineIDHelper(CMachineIDHelper *this)
{
  CMachineIDHelper *v1; // esi@1
  HANDLE *v2; // edi@1

  v1 = this;
  this->vfptr = (CMachineIDHelperVtbl *)&CMachineIDHelper::`vftable';
  v2 = &this->hFile;
  if ( this->hFile != (void *)-1 )
  {
    CMachineIDHelper::FlushBuffer(this);
    CloseHandle(*v2);
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)&v1->m_lockMILog.DebugInfo);
}
// 4439B8: using guessed type int (__thiscall *CMachineIDHelper::`vftable')(void *p, unsigned int __flags);

//----- (004218F0) --------------------------------------------------------
void __thiscall CMachineIDHelper::WriteLog(CMachineIDHelper *this, CMass *mass)
{
  CMachineIDHelper *v2; // esi@1
  void *v3; // eax@1
  HANDLE v4; // eax@5
  struct _SYSTEMTIME SystemTime; // [sp+8h] [bp-28h]@5
  ZCriticalSectionEx<4000> *v6; // [sp+18h] [bp-18h]@1
  LPCRITICAL_SECTION lpCriticalSection; // [sp+1Ch] [bp-14h]@1
  ZXString<char> v8; // [sp+20h] [bp-10h]@5
  int v9; // [sp+2Ch] [bp-4h]@1

  v2 = this;
  lpCriticalSection = (LPCRITICAL_SECTION)&this->m_lockMILog.DebugInfo;
  v6 = &this->m_lockMILog;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lockMILog.DebugInfo);
  v3 = v2->hFile;
  v9 = 0;
  if ( v3 != (void *)-1 )
  {
    if ( v2->o_day == mass->day )
      goto LABEL_8;
    if ( v3 != (void *)-1 )
    {
      CMachineIDHelper::FlushBuffer(v2);
      CloseHandle(v2->hFile);
    }
  }
  v2->o_day = mass->day;
  GetLocalTime(&SystemTime);
  v8._m_pStr = 0;
  LOBYTE(v9) = 1;
  ZXString<char>::Format(&v8, aCMachineidMi04, SystemTime.wYear, SystemTime.wMonth, SystemTime.wDay);
  v4 = CreateFileA(v8._m_pStr, 0x40000000u, 1u, 0, 4u, 0x80u, 0);
  v2->hFile = v4;
  if ( v4 == (HANDLE)-1 )
  {
    mass = (CMass *)-2147467259;
    _CxxThrowException(&mass, &_TI1_AVZException__);
  }
  SetFilePointer(v4, 0, 0, 2u);
  v2->cbuffer = 0;
  LOBYTE(v9) = 0;
  ZXString<char>::~ZXString<char>(&v8);
LABEL_8:
  memcpy(&v2->buffer[v2->cbuffer], mass, 0x2Cu);
  if ( ++v2->cbuffer == 1024 )
    CMachineIDHelper::FlushBuffer(v2);
  LeaveCriticalSection(lpCriticalSection);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00421A2D) --------------------------------------------------------
void __thiscall CMachineIDHelper::FlushBuffer(CMachineIDHelper *this)
{
  CMachineIDHelper *v1; // esi@1
  unsigned int dwWritten; // [sp+4h] [bp-4h]@1

  v1 = this;
  WriteFile(this->hFile, this->buffer, 44 * this->cbuffer, &dwWritten, 0);
  v1->cbuffer = 0;
}

//----- (00421A5C) --------------------------------------------------------
void _E13_5()
{
  _E11_1();
  _E12_3();
}

//----- (00421A66) --------------------------------------------------------
void _E11_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00421AA1) --------------------------------------------------------
void _E12_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00421ADC) --------------------------------------------------------
void _E30_6()
{
  _E23_4();
  _E24_6();
  _E25_5();
  _E26_5();
  _E27_3();
  _E28_4();
  _E29_6();
}

//----- (00421AFF) --------------------------------------------------------
void _E23_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00421B3A) --------------------------------------------------------
void _E24_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00421B75) --------------------------------------------------------
void _E25_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00421BB0) --------------------------------------------------------
void _E26_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00421BEB) --------------------------------------------------------
void _E27_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00421C26) --------------------------------------------------------
void _E28_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00421C61) --------------------------------------------------------
void _E29_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00421C9C) --------------------------------------------------------
void __cdecl MD5Init(MD5_CTX *context)
{
  context->count[1] = 0;
  context->count[0] = 0;
  context->state[0] = 1732584193;
  context->state[1] = -271733879;
  context->state[2] = -1732584194;
  context->state[3] = 271733878;
}

//----- (00421CC4) --------------------------------------------------------
void __cdecl MD5Update(MD5_CTX *context, char *input, unsigned int inputLen)
{
  MD5_CTX *v3; // esi@1
  unsigned int v4; // ecx@1
  unsigned int v5; // eax@1
  int v6; // ebx@3
  unsigned int j; // ebx@4
  unsigned int i; // [sp+14h] [bp+8h]@4

  v3 = context;
  v4 = context->count[0] + 8 * inputLen;
  v5 = (context->count[0] >> 3) & 0x3F;
  context->count[0] = v4;
  if ( v4 < 8 * inputLen )
    ++context->count[1];
  context->count[1] += inputLen >> 29;
  v6 = 64 - v5;
  if ( inputLen < 64 - v5 )
  {
    i = 0;
  }
  else
  {
    MD5_memcpy(&context->buffer[v5], input, 64 - v5);
    MD5Transform(context->state, context->buffer);
    i = v6;
    for ( j = v6 + 63; j < inputLen; j += 64 )
    {
      MD5Transform(v3->state, &input[j - 63]);
      i += 64;
    }
    v5 = 0;
  }
  MD5_memcpy(&v3->buffer[v5], &input[i], inputLen - i);
}

//----- (00421D62) --------------------------------------------------------
void __usercall MD5Final(int a1@<ebx>, char *digest, MD5_CTX *context)
{
  unsigned int v3; // eax@1
  signed int v4; // ecx@1
  char bits[8]; // [sp+8h] [bp-8h]@1

  Encode(bits, context->count, 8u);
  v3 = (context->count[0] >> 3) & 0x3F;
  v4 = 56;
  if ( v3 >= 0x38 )
    v4 = 120;
  MD5Update(context, PADDING, v4 - v3);
  MD5Update(context, bits, 8u);
  Encode(digest, context->state, 0x10u);
  MD5_memset(a1, (char *)context, 0, 0x58u);
}

//----- (00421DC6) --------------------------------------------------------
void __cdecl MD5Transform(unsigned int *state, char *block)
{
  unsigned int *v2; // esi@1
  unsigned int v3; // ebx@1
  unsigned int v4; // edi@1
  unsigned int v5; // ecx@1
  int v6; // eax@1
  unsigned int v7; // edx@1
  int v8; // ecx@1
  unsigned int v9; // edx@1
  int v10; // edi@1
  unsigned int v11; // ebx@1
  int v12; // edx@1
  unsigned int v13; // eax@1
  unsigned int v14; // ecx@1
  int v15; // eax@1
  unsigned int v16; // edi@1
  int v17; // ecx@1
  unsigned int v18; // edx@1
  unsigned int v19; // edi@1
  unsigned int v20; // ebx@1
  int v21; // edx@1
  unsigned int v22; // eax@1
  int v23; // edi@1
  unsigned int v24; // ecx@1
  int v25; // ebx@1
  unsigned int v26; // ecx@1
  int v27; // eax@1
  unsigned int v28; // edx@1
  unsigned int v29; // edi@1
  int v30; // ecx@1
  unsigned int v31; // edi@1
  int v32; // edx@1
  unsigned int v33; // eax@1
  int v34; // edi@1
  signed __int64 v35; // kr00_8@1
  int v36; // ebx@1
  unsigned int v37; // ecx@1
  int v38; // eax@1
  unsigned int v39; // edx@1
  unsigned int v40; // edi@1
  int v41; // ecx@1
  unsigned int v42; // edx@1
  unsigned int v43; // eax@1
  int v44; // edx@1
  unsigned int v45; // edi@1
  int v46; // eax@1
  unsigned int v47; // ecx@1
  unsigned int v48; // edi@1
  signed __int64 v49; // rcx@1
  unsigned int v50; // edx@1
  int v51; // edi@1
  unsigned int v52; // eax@1
  int v53; // edx@1
  unsigned int v54; // eax@1
  unsigned int v55; // edi@1
  int v56; // eax@1
  unsigned int v57; // edx@1
  unsigned int v58; // edi@1
  int v59; // edx@1
  int v60; // edi@1
  unsigned int v61; // eax@1
  unsigned int v62; // edx@1
  int v63; // eax@1
  int v64; // edx@1
  int v65; // edi@1
  int v66; // eax@1
  unsigned int v67; // edx@1
  unsigned int v68; // edx@1
  int v69; // edi@1
  unsigned int v70; // edx@1
  int v71; // eax@1
  unsigned int v72; // edx@1
  int v73; // edx@1
  int v74; // edi@1
  unsigned int v75; // eax@1
  unsigned int v76; // eax@1
  unsigned int v77; // edx@1
  unsigned int v78; // edi@1
  int v79; // edx@1
  int v80; // edi@1
  int v81; // eax@1
  int v82; // edx@1
  int v83; // edi@1
  int v84; // eax@1
  int v85; // edx@1
  int v86; // edi@1
  int v87; // eax@1
  unsigned int v88; // edi@1
  unsigned int x[16]; // [sp+Ch] [bp-48h]@1
  unsigned int d; // [sp+4Ch] [bp-8h]@1
  unsigned int b; // [sp+50h] [bp-4h]@1
  unsigned int a; // [sp+5Ch] [bp+8h]@1
  unsigned int aa; // [sp+5Ch] [bp+8h]@1
  unsigned int ab; // [sp+5Ch] [bp+8h]@1
  unsigned int ac; // [sp+5Ch] [bp+8h]@1
  int c; // [sp+60h] [bp+Ch]@1
  unsigned int ca; // [sp+60h] [bp+Ch]@1
  unsigned int cb; // [sp+60h] [bp+Ch]@1

  v2 = state;
  v3 = state[2];
  v4 = state[1];
  a = *state;
  d = v2[3];
  b = v4;
  Decode(x, block, 0x40u);
  v5 = a + x[0] + (v4 & v3 | d & ~v4) - 680876936;
  v6 = v4 + ((v5 << 7) | (v5 >> 25));
  v7 = d + x[1] + (v6 & v4 | v3 & ~(v4 + ((v5 << 7) | (v5 >> 25)))) - 389564586;
  v8 = v6 + ((v7 << 12) | (v7 >> 20));
  v9 = v3 + x[2] + (v6 & v8 | v4 & ~(v6 + ((v7 << 12) | (v7 >> 20)))) + 606105819;
  v10 = v8 + ((v9 << 17) | (v9 >> 15));
  v11 = b + x[3] + (v10 & v8 | v6 & ~(v8 + ((v9 << 17) | (v9 >> 15)))) - 1044525330;
  v12 = v10 + ((v11 >> 10) | (v11 << 22));
  v13 = v6 + x[4] + (v12 & v10 | v8 & ~(v10 + ((v11 >> 10) | (v11 << 22)))) - 176418897;
  aa = v12 + ((v13 << 7) | (v13 >> 25));
  v14 = v8 + x[5] + (aa & v12 | v10 & ~aa) + 1200080426;
  v15 = aa + ((v14 << 12) | (v14 >> 20));
  v16 = v10 + x[6] + (aa & v15 | v12 & ~(aa + ((v14 << 12) | (v14 >> 20)))) - 1473231341;
  v17 = v15 + ((v16 << 17) | (v16 >> 15));
  v18 = v12 + x[7] + (v17 & v15 | aa & ~(v15 + ((v16 << 17) | (v16 >> 15)))) - 45705983;
  v19 = v17 + ((v18 >> 10) | (v18 << 22));
  v20 = aa + x[8] + (v19 & v17 | v15 & ~(v17 + ((v18 >> 10) | (v18 << 22)))) + 1770035416;
  v21 = v19 + ((v20 << 7) | (v20 >> 25));
  b = v19;
  v22 = v15 + x[9] + (v21 & v19 | v17 & ~v21) - 1958414417;
  v23 = v21 + ((v22 << 12) | (v22 >> 20));
  v24 = v17 + x[10] + (v21 & v23 | b & ~(v21 + ((v22 << 12) | (v22 >> 20)))) - 42063;
  v25 = v23 + ((v24 << 17) | (v24 >> 15));
  v26 = b + x[11] + (v25 & (v21 + ((v22 << 12) | (v22 >> 20))) | v21 & ~v25) - 1990404162;
  v27 = v25 + ((v26 >> 10) | (v26 << 22));
  v28 = v21 + x[12] + (v27 & v25 | v23 & ~v27) + 1804603682;
  ab = v27 + ((v28 << 7) | (v28 >> 25));
  v29 = v23 + x[13] + (ab & v27 | v25 & ~ab) - 40341101;
  v30 = ab + ((v29 << 12) | (v29 >> 20));
  v31 = v25 + x[14] + (~v30 & v27 | ab & v30) - 1502002290;
  v32 = v30 + ((v31 << 17) | (v31 >> 15));
  c = ~(v30 + ((v31 << 17) | (v31 >> 15)));
  v33 = v27 + x[15] + (v32 & v30 | ab & c) + 1236535329;
  v34 = v32 + ((v33 >> 10) | (v33 << 22));
  v35 = 32i64 * (ab + x[1] + (~v30 & v32 | v34 & v30) - 165796510);
  v36 = v34 + (v35 | HIDWORD(v35));
  d = v36 & v32;
  v37 = v30 + x[6] + (v36 & v32 | v34 & c) - 1069501632;
  v38 = v36 + ((v37 << 9) | (v37 >> 23));
  v39 = v32 + x[11] + (v34 & v38 | v36 & ~v34) + 643717713;
  ca = v38 + ((v39 << 14) | (v39 >> 18));
  v40 = v34 + x[0] + (v36 & ca | v38 & ~v36) - 373897302;
  v41 = ca + ((v40 >> 12) | (v40 << 20));
  v42 = v36 + x[5] + (v41 & v38 | ca & ~v38) - 701558691;
  ac = v41 + (32 * v42 | (v42 >> 27));
  v43 = v38 + x[10] + (ac & ca | v41 & ~ca) + 38016083;
  v44 = ac + ((v43 << 9) | (v43 >> 23));
  v45 = ca + x[15] + (v41 & v44 | ac & ~v41) - 660478335;
  v46 = v44 + ((v45 << 14) | (v45 >> 18));
  v47 = v41 + x[4] + (ac & v46 | v44 & ~ac) - 405537848;
  v48 = v46 + ((v47 >> 12) | (v47 << 20));
  HIDWORD(v49) = ac + x[9] + (v48 & v44 | v46 & ~v44) + 568446438;
  LODWORD(v49) = ac + x[9] + (v48 & v44 | v46 & ~v44) + 568446438;
  b = v48;
  LODWORD(v49) = v48 + (unsigned __int64)(v49 >> 27);
  v50 = v44 + x[14] + (v49 & v46 | v48 & ~v46) - 1019803690;
  v51 = v49 + ((v50 << 9) | (v50 >> 23));
  v52 = v46 + x[3] + (b & v51 | v49 & ~b) - 187363961;
  v53 = v51 + ((v52 << 14) | (v52 >> 18));
  v54 = b + x[8] + (v49 & v53 | v51 & ~(_DWORD)v49) + 1163531501;
  b = v53 + ((v54 >> 12) | (v54 << 20));
  LODWORD(v49) = v49 + x[13] + (b & v51 | v53 & ~v51) - 1444681467;
  HIDWORD(v49) = b + (32 * v49 | ((unsigned int)v49 >> 27));
  v55 = v51 + x[2] + (HIDWORD(v49) & v53 | b & ~v53) - 51403784;
  v56 = HIDWORD(v49) + ((v55 << 9) | (v55 >> 23));
  v57 = v53 + x[7] + (b & v56 | HIDWORD(v49) & ~b) + 1735328473;
  LODWORD(v49) = v56 + ((v57 << 14) | (v57 >> 18));
  v58 = b + x[12] + (HIDWORD(v49) & v49 | v56 & ~HIDWORD(v49)) - 1926607734;
  v59 = v49 + ((v58 >> 12) | (v58 << 20));
  HIDWORD(v49) = HIDWORD(v49) + x[5] + (v59 ^ v49 ^ v56) - 378558;
  v60 = v59 + (16 * HIDWORD(v49) | (HIDWORD(v49) >> 28));
  v61 = v56 + x[8] + (v60 ^ v59 ^ v49) - 2022574463;
  HIDWORD(v49) = v60 + ((v61 << 11) | (v61 >> 21));
  LODWORD(v49) = v49 + x[11] + (v60 ^ v59 ^ (v60 + ((v61 << 11) | (v61 >> 21)))) + 1839030562;
  cb = HIDWORD(v49) + (((_DWORD)v49 << 16) | ((unsigned int)v49 >> 16));
  v62 = v59 + x[14] + (v60 ^ cb ^ HIDWORD(v49)) - 35309556;
  v63 = cb + ((v62 >> 9) | (v62 << 23));
  LODWORD(v49) = v63
               + (16 * (v60 + x[1] + (v63 ^ cb ^ HIDWORD(v49)) - 1530992060) | ((v60
                                                                               + x[1]
                                                                               + (v63 ^ cb ^ HIDWORD(v49))
                                                                               - 1530992060) >> 28));
  HIDWORD(v49) += x[4] + (v49 ^ v63 ^ cb) + 1272893353;
  v64 = v49 + ((HIDWORD(v49) << 11) | (HIDWORD(v49) >> 21));
  HIDWORD(v49) = cb + x[7] + (v49 ^ v63 ^ (v49 + ((HIDWORD(v49) << 11) | (HIDWORD(v49) >> 21)))) - 155497632;
  v65 = v64 + ((HIDWORD(v49) << 16) | (HIDWORD(v49) >> 16));
  HIDWORD(v49) = v63 + x[10] + (v49 ^ v65 ^ v64) - 1094730640;
  v66 = v65 + ((HIDWORD(v49) >> 9) | (HIDWORD(v49) << 23));
  LODWORD(v49) = v49 + x[13] + (v66 ^ v65 ^ v64) + 681279174;
  HIDWORD(v49) = v49;
  LODWORD(v49) = v66 + (unsigned __int64)(v49 >> 28);
  v67 = v64 + x[0] + (v49 ^ v66 ^ v65) - 358537222;
  HIDWORD(v49) = v49 + ((v67 << 11) | (v67 >> 21));
  v68 = v65 + x[3] + (v49 ^ v66 ^ (v49 + ((v67 << 11) | (v67 >> 21)))) - 722521979;
  v69 = HIDWORD(v49) + ((v68 << 16) | (v68 >> 16));
  v70 = v66 + x[6] + (v49 ^ v69 ^ HIDWORD(v49)) + 76029189;
  v71 = v69 + ((v70 >> 9) | (v70 << 23));
  v72 = v49 + x[9] + (v71 ^ v69 ^ HIDWORD(v49)) - 640364487;
  LODWORD(v49) = v71 + (16 * v72 | (v72 >> 28));
  HIDWORD(v49) = HIDWORD(v49) + x[12] + (v49 ^ v71 ^ v69) - 421815835;
  v73 = v49 + ((HIDWORD(v49) << 11) | (HIDWORD(v49) >> 21));
  HIDWORD(v49) = v69 + x[15] + (v49 ^ v71 ^ (v49 + ((HIDWORD(v49) << 11) | (HIDWORD(v49) >> 21)))) + 530742520;
  v74 = v73 + ((HIDWORD(v49) << 16) | (HIDWORD(v49) >> 16));
  v75 = v71 + x[2] + (v49 ^ v74 ^ v73) - 995338651;
  HIDWORD(v49) = v74 + ((v75 >> 9) | (v75 << 23));
  LODWORD(v49) = v49 + x[0] + (v74 ^ (HIDWORD(v49) | ~v73)) - 198630844;
  v76 = HIDWORD(v49) + (((_DWORD)v49 << 6) | ((unsigned int)v49 >> 26));
  v77 = v73 + x[7] + (HIDWORD(v49) ^ (v76 | ~v74)) + 1126891415;
  LODWORD(v49) = v76 + ((v77 << 10) | (v77 >> 22));
  v78 = v74 + x[14] + (v76 ^ (v49 | ~HIDWORD(v49))) - 1416354905;
  v79 = v49 + ((v78 << 15) | (v78 >> 17));
  HIDWORD(v49) = HIDWORD(v49) + x[5] + (v49 ^ (v79 | ~v76)) - 57434055;
  v80 = v79 + ((HIDWORD(v49) >> 11) | (HIDWORD(v49) << 21));
  HIDWORD(v49) = v76 + x[12] + (v79 ^ (v80 | ~(_DWORD)v49)) + 1700485571;
  v81 = v80 + ((HIDWORD(v49) << 6) | (HIDWORD(v49) >> 26));
  LODWORD(v49) = v49 + x[3] + (v80 ^ (v81 | ~v79)) - 1894986606;
  HIDWORD(v49) = v49;
  LODWORD(v49) = v81 + (unsigned __int64)(v49 >> 22);
  HIDWORD(v49) = v79 + x[10] + (v81 ^ (v49 | ~v80)) - 1051523;
  v82 = v49 + ((HIDWORD(v49) << 15) | (HIDWORD(v49) >> 17));
  HIDWORD(v49) = v80 + x[1] + (v49 ^ (v82 | ~v81)) - 2054922799;
  v83 = v82 + ((HIDWORD(v49) >> 11) | (HIDWORD(v49) << 21));
  HIDWORD(v49) = v81 + x[8] + (v82 ^ (v83 | ~(_DWORD)v49)) + 1873313359;
  v84 = v83 + ((HIDWORD(v49) << 6) | (HIDWORD(v49) >> 26));
  LODWORD(v49) = v49 + x[15] + (v83 ^ (v84 | ~v82)) - 30611744;
  HIDWORD(v49) = v49;
  LODWORD(v49) = v84 + (unsigned __int64)(v49 >> 22);
  HIDWORD(v49) = v82 + x[6] + (v84 ^ (v49 | ~v83)) - 1560198380;
  v85 = v49 + ((HIDWORD(v49) << 15) | (HIDWORD(v49) >> 17));
  HIDWORD(v49) = v83 + x[13] + (v49 ^ (v85 | ~v84)) + 1309151649;
  v86 = v85 + ((HIDWORD(v49) >> 11) | (HIDWORD(v49) << 21));
  HIDWORD(v49) = v84 + x[4] + (v85 ^ (v86 | ~(_DWORD)v49)) - 145523070;
  v87 = v86 + ((HIDWORD(v49) << 6) | (HIDWORD(v49) >> 26));
  HIDWORD(v49) = x[11] + (v86 ^ (v87 | ~v85));
  *v2 += v87;
  HIDWORD(v49) = v87
               + ((((_DWORD)v49 + HIDWORD(v49) - 1120210379) << 10) | ((unsigned int)(v49 + HIDWORD(v49) - 1120210379) >> 22));
  LODWORD(v49) = x[2] + (v87 ^ (HIDWORD(v49) | ~v86));
  v2[3] += HIDWORD(v49);
  LODWORD(v49) = HIDWORD(v49)
               + (((v85 + (_DWORD)v49 + 718787259) << 15) | ((unsigned int)(v85 + v49 + 718787259) >> 17));
  v2[2] += v49;
  v88 = v86 + x[9] + (HIDWORD(v49) ^ (v49 | ~v87)) - 343485551;
  v2[1] += v49 + ((v88 >> 11) | (v88 << 21));
  MD5_memset(SHIDWORD(v49), (char *)x, 0, 0x40u);
}

//----- (00422671) --------------------------------------------------------
void __cdecl Encode(char *output, unsigned int *input, unsigned int len)
{
  unsigned int *v3; // ecx@2
  char *v4; // eax@2

  if ( len )
  {
    v3 = input;
    v4 = output + 1;
    do
    {
      *(v4 - 1) = *(_BYTE *)v3;
      *v4 = *(_WORD *)v3 >> 8;
      v4[1] = *v3 >> 16;
      v4[2] = *v3 >> 24;
      v4 += 4;
      ++v3;
    }
    while ( (unsigned int)&v4[-1 - (_DWORD)output] < len );
  }
}

//----- (004226B6) --------------------------------------------------------
void __cdecl Decode(unsigned int *output, char *input, unsigned int len)
{
  unsigned int *v3; // ecx@2
  char *v4; // eax@2
  int v5; // edi@3
  unsigned __int16 v6; // dx@3

  if ( len )
  {
    v3 = output;
    v4 = input + 2;
    do
    {
      v5 = (unsigned __int8)*(v4 - 1);
      HIBYTE(v6) = v4[1];
      LOBYTE(v6) = *v4;
      v4 += 4;
      *v3 = (unsigned __int8)*(v4 - 6) | ((v5 | (v6 << 8)) << 8);
      ++v3;
    }
    while ( (unsigned int)&v4[-2 - (_DWORD)input] < len );
  }
}

//----- (004226FC) --------------------------------------------------------
void __cdecl MD5_memcpy(char *output, char *input, unsigned int len)
{
  unsigned int v3; // esi@1
  char *v4; // ecx@2

  v3 = len;
  if ( len )
  {
    v4 = output;
    do
    {
      *v4 = v4[input - output];
      ++v4;
      --v3;
    }
    while ( v3 );
  }
}

//----- (0042271A) --------------------------------------------------------
void __usercall MD5_memset(int a1@<ebx>, char *output, int value, unsigned int len)
{
  int v4; // eax@2

  if ( len )
  {
    LOBYTE(a1) = value;
    BYTE1(a1) = value;
    v4 = a1 << 16;
    LOWORD(v4) = a1;
    memset32(output, v4, len >> 2);
    memset(&output[4 * (len >> 2)], value, len & 3);
  }
}

//----- (00422749) --------------------------------------------------------
ZXString<char> *__cdecl MD5_digest_string(ZXString<char> *result, ZXString<char> __$ReturnUdt)
{
  unsigned int v2; // eax@2
  unsigned int v3; // esi@4
  char *v4; // edx@4
  unsigned __int8 v5; // al@5
  unsigned __int8 v6; // cl@5
  unsigned __int8 v7; // al@5
  unsigned __int8 v8; // cl@5
  char v9; // al@6
  char v10; // al@9
  MD5_CTX context; // [sp+Ch] [bp-A0h]@1
  char v13; // [sp+64h] [bp-48h]@12
  char v14; // [sp+65h] [bp-47h]@4
  char digest[16]; // [sp+84h] [bp-28h]@4
  int v16; // [sp+94h] [bp-18h]@1
  ZXString<char> v17; // [sp+98h] [bp-14h]@1
  ZXString<char> v18; // [sp+9Ch] [bp-10h]@12
  int v19; // [sp+A8h] [bp-4h]@1

  v16 = 0;
  v19 = 1;
  v17._m_pStr = 0;
  ZXString<char>::Assign(&v17, __$ReturnUdt._m_pStr, -1);
  LOBYTE(v19) = 2;
  MD5Init(&context);
  if ( v17._m_pStr )
    v2 = *((_DWORD *)v17._m_pStr - 1);
  else
    v2 = 0;
  MD5Update(&context, v17._m_pStr, v2);
  MD5Final(0, digest, &context);
  v3 = 0;
  v4 = &v14;
  do
  {
    v5 = digest[v3];
    v6 = v5;
    v7 = v5 >> 4;
    v8 = v6 & 0xF;
    if ( v7 >= 0xAu )
      v9 = v7 + 87;
    else
      v9 = v7 + 48;
    *(v4 - 1) = v9;
    if ( v8 >= 0xAu )
      v10 = v8 + 87;
    else
      v10 = v8 + 48;
    *v4 = v10;
    ++v3;
    v4 += 2;
  }
  while ( v3 < 0x10 );
  v18._m_pStr = 0;
  ZXString<char>::Assign(&v18, &v13, 32);
  LOBYTE(v19) = 3;
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, &v18);
  v16 = 1;
  LOBYTE(v19) = 2;
  ZXString<char>::~ZXString<char>(&v18);
  LOBYTE(v19) = 1;
  ZXString<char>::~ZXString<char>(&v17);
  LOBYTE(v19) = 0;
  ZXString<char>::~ZXString<char>(&__$ReturnUdt);
  return result;
}
// 422749: using guessed type char digest[16];

//----- (0042285F) --------------------------------------------------------
void _E11_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0042289A) --------------------------------------------------------
void _E12_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (004228D5) --------------------------------------------------------
void _E30_7()
{
  _E23_5();
  _E24_7();
  _E25_6();
  _E26_6();
  _E27_4();
  _E28_5();
  _E29_7();
}

//----- (004228F8) --------------------------------------------------------
void _E23_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00422933) --------------------------------------------------------
void _E24_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0042296E) --------------------------------------------------------
void _E25_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (004229A9) --------------------------------------------------------
void _E26_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (004229E4) --------------------------------------------------------
void _E27_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00422A1F) --------------------------------------------------------
void _E28_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00422A5A) --------------------------------------------------------
void _E29_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00422A95) --------------------------------------------------------
void __thiscall CMxHelperServerManager::CMxHelperServerManager(CMxHelperServerManager *this)
{
  CMxHelperServerManager *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
  memset(this, 0, 0xCu);
  v1->m_bValid = 0;
  v1->m_pParam = 0;
  v1->vfptr = (ZRefCountedVtbl *)&CMxHelperServerManager::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4439CC: using guessed type int (__thiscall *CMxHelperServerManager::`vftable')(void *p, unsigned int __flags);

//----- (00422ABD) --------------------------------------------------------
CMxHelperServerManager *__thiscall CMxHelperServerManager::`scalar deleting destructor'(CMxHelperServerManager *this, unsigned int __flags)
{
  CMxHelperServerManager *v2; // esi@1

  v2 = this;
  CMxHelperServerManager::~CMxHelperServerManager(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00422ADD) --------------------------------------------------------
void __thiscall CMxHelperServerManager::~CMxHelperServerManager(CMxHelperServerManager *this)
{
  CMxHelperServerManager *v1; // esi@1

  v1 = this;
  this->vfptr = (ZRefCountedVtbl *)&CMxHelperServerManager::`vftable';
  CMxHelperServerManager::Unload(this);
  v1->vfptr = (ZRefCountedVtbl *)&ZRefCounted::`vftable';
}
// 4433A8: using guessed type int (__thiscall *ZRefCounted::`vftable')(void *p, unsigned int __flags);
// 4439CC: using guessed type int (__thiscall *CMxHelperServerManager::`vftable')(void *p, unsigned int __flags);

//----- (00422B10) --------------------------------------------------------
int __thiscall CMxHelperServerManager::Load(CMxHelperServerManager *this, const char *isToken)
{
  CMxHelperServerManager *v2; // esi@1
  NXParam *v3; // ecx@3
  NXParam *v4; // eax@4
  int result; // eax@7

  v2 = this;
  if ( !this->m_bValid && !this->m_pParam )
  {
    v3 = (NXParam *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x810u);
    if ( v3 )
      NXParam::NXParam(v3);
    else
      v4 = 0;
    v2->m_pParam = v4;
    if ( NXParam::SetTokenA(v4, isToken) )
    {
      result = 1;
      v2->m_bValid = 1;
      return result;
    }
    v2->m_bValid = 0;
    CMxHelperServerManager::Unload(v2);
  }
  return 0;
}

//----- (00422B88) --------------------------------------------------------
void __thiscall CMxHelperServerManager::Unload(CMxHelperServerManager *this)
{
  CMxHelperServerManager *v1; // esi@1
  NXParam *v2; // edi@1

  v1 = this;
  v2 = this->m_pParam;
  if ( v2 )
  {
    NXParam::~NXParam(this->m_pParam);
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
    v1->m_pParam = 0;
  }
  v1->m_bValid = 0;
}

//----- (00422BB0) --------------------------------------------------------
int __thiscall CMxHelperServerManager::IsLoggedIn(CMxHelperServerManager *this, int *pVal)
{
  NXParam *v2; // ecx@2
  int result; // eax@3

  if ( this->m_bValid && (v2 = this->m_pParam) != 0 )
  {
    *pVal = NXParam::GetParamValueA(v2, isName, 0, 0) != 0;
    result = 1;
  }
  else
  {
    *pVal = 0;
    result = 0;
  }
  return result;
}

//----- (00422BE6) --------------------------------------------------------
int __thiscall CMxHelperServerManager::GetAccountId(CMxHelperServerManager *this, unsigned int *pVal)
{
  NXParam *v2; // ecx@2
  int result; // eax@3

  if ( this->m_bValid && (v2 = this->m_pParam) != 0 )
  {
    NXParam::GetParamValueA(v2, aMd, pVal, 0);
    result = 1;
  }
  else
  {
    *pVal = 0;
    result = 0;
  }
  return result;
}

//----- (00422C13) --------------------------------------------------------
int __thiscall CMxHelperServerManager::GetWebKey(CMxHelperServerManager *this, int *pVal)
{
  NXParam *v2; // ecx@2
  int result; // eax@3

  if ( this->m_bValid && (v2 = this->m_pParam) != 0 )
  {
    NXParam::GetParamValueA(v2, aWy, pVal, 0);
    result = 1;
  }
  else
  {
    *pVal = 0;
    result = 0;
  }
  return result;
}

//----- (00422C40) --------------------------------------------------------
int __thiscall CMxHelperServerManager::GetLoggedInIP(CMxHelperServerManager *this, unsigned int *pVal)
{
  NXParam *v2; // ecx@2
  int result; // eax@3

  if ( this->m_bValid && (v2 = this->m_pParam) != 0 )
  {
    NXParam::GetParamValueA(v2, aLp, pVal, 0);
    result = 1;
  }
  else
  {
    *pVal = 0;
    result = 0;
  }
  return result;
}

//----- (00422C6D) --------------------------------------------------------
int __thiscall CMxHelperServerManager::GetLoggedInIP(CMxHelperServerManager *this, ZXString<char> *sIP)
{
  NXParam *v2; // ecx@2
  int result; // eax@5
  char s[16]; // [sp+0h] [bp-10h]@3

  if ( this->m_bValid && (v2 = this->m_pParam) != 0 )
  {
    s[0] = 0;
    NXParam::GetParamValueA(v2, aLp, s, 0);
    if ( strlen(s) )
      ZXString<char>::Assign(sIP, s, -1);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00422CBA) --------------------------------------------------------
int __thiscall CMxHelperServerManager::GetEmail(CMxHelperServerManager *this, ZXString<char> *sEmail)
{
  NXParam *v2; // ecx@2
  int result; // eax@5
  char s[65]; // [sp+0h] [bp-44h]@3

  if ( this->m_bValid && (v2 = this->m_pParam) != 0 )
  {
    s[0] = 0;
    NXParam::GetParamValueA(v2, aMl, s, 0);
    if ( strlen(s) )
      ZXString<char>::Assign(sEmail, s, -1);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00422D07) --------------------------------------------------------
void _E24_8()
{
  _E17_0();
  _E18_2();
  _E19_2();
  _E20_1();
  _E21_1();
  _E22_2();
  _E23_6();
}

//----- (00422D2A) --------------------------------------------------------
void _E17_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00422D65) --------------------------------------------------------
void _E18_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00422DA0) --------------------------------------------------------
void _E19_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,long,long>::_PAIR,16,ZMap<long,long,long>::_PAIR>::s_pInstance = v3;
}

//----- (00422DDB) --------------------------------------------------------
void _E20_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,unsigned short,long>::_PAIR,16,ZMap<long,unsigned short,long>::_PAIR>::s_pInstance = v3;
}

//----- (00422E16) --------------------------------------------------------
void _E21_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR,16,ZMap<unsigned short,_FILETIME,unsigned short>::_PAIR>::s_pInstance = v3;
}

//----- (00422E51) --------------------------------------------------------
void _E22_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::s_pInstance = v3;
}

//----- (00422E8C) --------------------------------------------------------
void _E23_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::s_pInstance = v3;
}

//----- (00422EC7) --------------------------------------------------------
void _E47_1()
{
  _E37_8();
  _E38_5();
  _E39_7();
  _E40_5();
  _E41_5();
  _E42_4();
  _E43_1();
  _E44_1();
  _E45_1();
  _E46_1();
}

//----- (00422EF9) --------------------------------------------------------
void _E37_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00422F34) --------------------------------------------------------
void _E38_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00422F6F) --------------------------------------------------------
void _E39_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00422FAA) --------------------------------------------------------
void _E40_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00422FE5) --------------------------------------------------------
void _E41_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00423020) --------------------------------------------------------
void _E42_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0042305B) --------------------------------------------------------
void _E43_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_CoupleRecord>,16,GW_CoupleRecord>::s_pInstance = v3;
}

//----- (00423096) --------------------------------------------------------
void _E44_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_FriendRecord>,16,GW_FriendRecord>::s_pInstance = v3;
}

//----- (004230D1) --------------------------------------------------------
void _E45_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<GW_MarriageRecord>,16,GW_MarriageRecord>::s_pInstance = v3;
}

//----- (0042310C) --------------------------------------------------------
void _E46_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00423147) --------------------------------------------------------
unsigned __int16 *__cdecl NXParam::AnsiToUnicode(const char *isAnsi)
{
  signed int v1; // esi@1
  unsigned __int16 *v2; // ebx@2
  unsigned __int16 *result; // eax@3

  v1 = MultiByteToWideChar(0, 0, isAnsi, -1, 0, 0);
  if ( v1 > 4096
    || (v2 = (unsigned __int16 *)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                   &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                   2 * v1 + 2),
        MultiByteToWideChar(0, 0, isAnsi, -1, v2, v1) != v1) )
  {
    result = 0;
  }
  else
  {
    v2[v1] = 0;
    result = v2;
  }
  return result;
}

//----- (00423199) --------------------------------------------------------
char *__cdecl NXParam::UnicodeToAnsi(const unsigned __int16 *isUnicode)
{
  signed int v1; // esi@1
  char *v2; // ebp@2
  char *result; // eax@3

  v1 = WideCharToMultiByte(0, 0, isUnicode, -1, 0, 0, 0, 0);
  if ( v1 > 4096
    || (v2 = (char *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v1 + 1),
        WideCharToMultiByte(0, 0, isUnicode, -1, v2, v1, 0, 0) != v1) )
  {
    result = 0;
  }
  else
  {
    v2[v1] = 0;
    result = v2;
  }
  return result;
}

//----- (004231EF) --------------------------------------------------------
void __thiscall NXParam::NXParam(NXParam *this)
{
  NXParam::Clear(this);
}

//----- (004231FC) --------------------------------------------------------
void __thiscall NXParam::Clear(NXParam *this)
{
  LODWORD(this->m_nHashValue) = 0;
  this->m_nBufferSize = 0;
  HIDWORD(this->m_nHashValue) = 0;
  memset(this, 0, 0x800u);
}

//----- (00423220) --------------------------------------------------------
char __thiscall NXParam::SetTokenA(NXParam *this, const char *isToken)
{
  NXParam *v2; // esi@1
  char result; // al@2

  v2 = this;
  if ( isToken )
  {
    NXParam::Clear(this);
    result = NXParam::Decrypt(v2, isToken);
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00423242) --------------------------------------------------------
char __thiscall NXParam::SetTokenW(NXParam *this, const unsigned __int16 *isToken)
{
  NXParam *v2; // edi@1
  const char *v3; // eax@1
  const char *v4; // esi@1
  char v5; // bl@2
  char result; // al@2

  v2 = this;
  v3 = NXParam::UnicodeToAnsi(isToken);
  v4 = v3;
  if ( v3 )
  {
    v5 = NXParam::SetTokenA(v2, v3);
    NXParam::DoneWithAnsi(v4);
    result = v5;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00423274) --------------------------------------------------------
signed int __thiscall NXParam::GetParamValueA(NXParam *this, const char *isName, void *osValue, unsigned int inLength)
{
  NXParam *v4; // esi@1
  int v5; // edi@2
  signed int result; // eax@3
  size_t v7; // eax@6
  unsigned int v8; // edx@6
  signed int v9; // ebx@6
  int v10; // edi@6
  int v11; // ebx@10
  unsigned __int16 *pTemp; // ST1C_4@10
  const char *v13; // edi@10
  signed int v14; // eax@10
  int v15; // esi@23
  __int16 v16; // ax@23
  int v17; // ecx@27
  unsigned __int16 v18; // ax@27
  int v19; // esi@27
  int v20; // eax@30
  int v21; // esi@30
  signed __int64 v22; // rax@30

  v4 = this;
  if ( isName && (v5 = NXParam::GetParamPtr(this, isName), v5 != -1) )
  {
    if ( osValue )
    {
      v7 = strlen(isName);
      v8 = v4->m_aBuffer[v5];
      v9 = -3 - v7 + (v4->m_aBuffer[v5 + 1] | 16 * (v8 & 0xF));
      v10 = v5 + v7 + 3;
      switch ( v8 >> 4 )
      {
        case 1u:
          if ( inLength && v9 >= (signed int)inLength )
            goto LABEL_26;
          strncpy((char *)osValue, (const char *)v4 + v10, v9);
          *((_BYTE *)osValue + v9) = 0;
          break;
        case 2u:
          v11 = v9 / 2;
          pTemp = (unsigned __int16 *)ZAllocEx<ZAllocAnonSelector>::Alloc(
                                        &ZAllocEx<ZAllocAnonSelector>::_s_alloc,
                                        2 * v11 + 2);
          memcpy(pTemp, (char *)v4 + v10, 2 * v11 + 2);
          pTemp[v11] = 0;
          v13 = NXParam::UnicodeToAnsi(pTemp);
          ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, pTemp);
          v14 = strlen(v13);
          v9 = v14;
          if ( inLength && v14 >= (signed int)inLength )
          {
            v9 = 0;
          }
          else
          {
            strncpy((char *)osValue, v13, v14);
            *((_BYTE *)osValue + v9) = 0;
          }
          NXParam::DoneWithAnsi(v13);
          break;
        case 3u:
          if ( inLength && v9 >= (signed int)inLength )
            goto LABEL_26;
          memcpy(osValue, (char *)v4 + v10, 2 * v9);
          break;
        case 4u:
        case 5u:
          if ( inLength && v9 != inLength )
            goto LABEL_26;
          *(_BYTE *)osValue = v4->m_aBuffer[v10];
          break;
        case 6u:
        case 7u:
          if ( inLength && v9 != inLength )
            goto LABEL_26;
          v15 = (int)v4 + v10;
          HIBYTE(v16) = *(_BYTE *)v15;
          LOBYTE(v16) = *(_BYTE *)(v15 + 1);
          *(_WORD *)osValue = v16;
          break;
        case 8u:
        case 9u:
          if ( inLength && v9 != inLength )
            goto LABEL_26;
          v17 = v4->m_aBuffer[v10 + 2];
          HIBYTE(v18) = v4->m_aBuffer[v10];
          v19 = (int)v4 + v10;
          LOBYTE(v18) = *(_BYTE *)(v19 + 1);
          *(_DWORD *)osValue = *(_BYTE *)(v19 + 3) | ((v17 | (v18 << 8)) << 8);
          break;
        case 0xAu:
        case 0xBu:
          if ( inLength && v9 != inLength )
          {
LABEL_26:
            v9 = 0;
          }
          else
          {
            v20 = v4->m_aBuffer[v10];
            v21 = (int)v4 + v10;
            v22 = (signed __int64)v20 << 8;
            LODWORD(v22) = v22 | *(_BYTE *)(v21 + 1);
            v22 <<= 8;
            LODWORD(v22) = v22 | *(_BYTE *)(v21 + 2);
            v22 <<= 8;
            LODWORD(v22) = v22 | *(_BYTE *)(v21 + 3);
            v22 <<= 8;
            LODWORD(v22) = v22 | *(_BYTE *)(v21 + 4);
            v22 <<= 8;
            LODWORD(v22) = v22 | *(_BYTE *)(v21 + 5);
            v22 <<= 8;
            LODWORD(v22) = v22 | *(_BYTE *)(v21 + 6);
            v22 <<= 8;
            *(_DWORD *)osValue = *(_BYTE *)(v21 + 7) | (unsigned int)v22;
            *((_DWORD *)osValue + 1) = HIDWORD(v22);
          }
          break;
        default:
          break;
      }
      result = v9;
    }
    else
    {
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00423552) --------------------------------------------------------
signed int __thiscall NXParam::GetParamValueW(NXParam *this, const unsigned __int16 *isName, void *osValue, unsigned int inLength)
{
  NXParam *v4; // esi@1
  char *v5; // eax@2
  const char *v6; // ebx@2
  int v7; // eax@3
  unsigned int v8; // eax@5
  signed int result; // eax@8
  const wchar_t *v10; // eax@10
  const wchar_t *v11; // ebx@10
  size_t v12; // eax@10
  size_t v13; // esi@10
  char sTemp[1024]; // [sp+Ch] [bp-404h]@9
  char *pAnsiName; // [sp+40Ch] [bp-4h]@2
  signed int nRet; // [sp+418h] [bp+8h]@3

  v4 = this;
  if ( isName && (v5 = NXParam::UnicodeToAnsi(isName), v6 = v5, (pAnsiName = v5) != 0) )
  {
    nRet = 0;
    v7 = NXParam::GetParamPtr(v4, v5);
    if ( v7 == -1 )
    {
LABEL_8:
      NXParam::DoneWithAnsi(pAnsiName);
      return nRet;
    }
    if ( osValue )
    {
      v8 = (unsigned int)v4->m_aBuffer[v7] >> 4;
      if ( v8 == 1 || v8 == 2 )
      {
        if ( NXParam::GetParamValueA(v4, v6, sTemp, 0x400u) )
        {
          v10 = NXParam::AnsiToUnicode(sTemp);
          v11 = v10;
          v12 = wcslen(v10);
          v13 = v12;
          if ( v11 )
          {
            if ( !inLength || 2 * v12 < inLength )
            {
              wcsncpy((wchar_t *)osValue, v11, v12);
              *((_WORD *)osValue + v13) = 0;
              nRet = 2 * v13;
            }
            NXParam::DoneWithUnicode(v11);
          }
        }
      }
      else
      {
        nRet = NXParam::GetParamValueA(v4, v6, osValue, inLength);
      }
      goto LABEL_8;
    }
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00423639) --------------------------------------------------------
char __thiscall NXParam::Decrypt(NXParam *this, const char *isToken)
{
  NXParam *v2; // esi@1
  void *v3; // eax@1
  void *v4; // edi@1
  size_t v5; // eax@1
  unsigned __int16 v6; // dx@3
  int v7; // ebx@3
  int v8; // eax@3
  int v9; // eax@8
  unsigned __int16 v10; // cx@8
  int v11; // ecx@8
  char *v12; // eax@10
  unsigned __int16 v13; // dx@10
  __int16 v14; // cx@10
  __int16 v15; // dx@10
  int v16; // ecx@10
  char v17; // bl@10
  int v18; // ecx@10
  unsigned __int16 v19; // ax@11
  int v20; // eax@11
  int v21; // edi@11
  __int64 v22; // rax@11
  __int64 v23; // rax@11
  __int64 v24; // rax@11
  __int64 v25; // rax@11
  __int64 v26; // rax@11
  __int64 v27; // rax@11
  __int64 v28; // rax@11
  int v29; // ST0C_4@11
  void *v30; // ebx@11
  char *v31; // edi@11
  int v32; // edx@11
  char result; // al@13
  int v34; // [sp+0h] [bp-34h]@1
  int v35; // [sp+Ch] [bp-28h]@3
  void *p; // [sp+10h] [bp-24h]@1
  int inSize; // [sp+14h] [bp-20h]@1
  int v38; // [sp+18h] [bp-1Ch]@1
  int v39; // [sp+1Ch] [bp-18h]@1
  int i; // [sp+20h] [bp-14h]@1
  int *v41; // [sp+24h] [bp-10h]@1
  int v42; // [sp+30h] [bp-4h]@1
  char *Str; // [sp+3Ch] [bp+8h]@10

  v41 = &v34;
  v2 = this;
  v3 = (void *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x800u);
  v42 = 0;
  v4 = v3;
  inSize = (int)v3;
  p = v3;
  NXParam::Clear(v2);
  v5 = strlen(isToken);
  v38 = 0;
  v39 = v5;
  memset(v4, 0, 0x800u);
  for ( i = 0; i < v39; ++i )
  {
    v6 = LOBYTE((&g_aTxtCodeReverse)[isToken[i]]);
    v7 = 8 - (v38 & 7);
    v35 = v38 & 7;
    v8 = v38 >> 3;
    if ( v7 > 6 )
      v7 = 6;
    inSize = 6 - v7;
    *((_BYTE *)v4 + v8) |= 4 * v6 >> v35;
    if ( inSize > 0 )
      *((_BYTE *)v4 + v8 + 1) |= (_BYTE)v6 << (8 - inSize);
    v38 += 6;
  }
  v9 = (v38 + 1) >> 3;
  HIBYTE(v10) = *(_BYTE *)v4;
  v39 = (v38 + 1) >> 3;
  LOBYTE(v10) = *((_BYTE *)v4 + 1);
  inSize = v10;
  v11 = 2;
  i = 2;
  while ( v11 < v9 )
  {
    v12 = (char *)v4 + v11;
    HIBYTE(v13) = *((_BYTE *)v4 + v11);
    LOBYTE(v13) = *((_BYTE *)v4 + v11 + 1);
    Str = (char *)v13;
    *v12 = byte_47912D[2 * v13];
    LOBYTE(v13) = *((_BYTE *)&g_aReverse16 + 2 * v13);
    *((_BYTE *)v4 + v11 + 1) = v13;
    HIBYTE(v14) = *((_BYTE *)v4 + v11);
    LOBYTE(v14) = v13;
    v15 = v14;
    v16 = (unsigned __int16)(inSize + 17);
    v17 = byte_45912D[2 * v16];
    v35 = 2 * v16 + 4559148;
    v18 = i;
    *v12 = HIBYTE(v15) ^ v17;
    *((_BYTE *)v4 + v18 + 1) = v15 ^ *(_BYTE *)v35;
    v11 = v18 + 2;
    inSize = (int)Str;
    v9 = v39;
    i = v11;
  }
  HIBYTE(v19) = *((_BYTE *)v4 + 2);
  LOBYTE(v19) = *((_BYTE *)v4 + 3);
  v39 = v19;
  v20 = 2 * ((v19 + 1) / 2);
  v21 = (int)v4 + v20;
  inSize = v20;
  v2->m_nHashValue = *(_BYTE *)(v21 + 4);
  v22 = v2->m_nHashValue << 8;
  LODWORD(v2->m_nHashValue) = v22 | *(_BYTE *)(v21 + 5);
  HIDWORD(v2->m_nHashValue) = HIDWORD(v22);
  v23 = v2->m_nHashValue << 8;
  LODWORD(v2->m_nHashValue) = v23 | *(_BYTE *)(v21 + 6);
  HIDWORD(v2->m_nHashValue) = HIDWORD(v23);
  v24 = v2->m_nHashValue << 8;
  LODWORD(v2->m_nHashValue) = v24 | *(_BYTE *)(v21 + 7);
  HIDWORD(v2->m_nHashValue) = HIDWORD(v24);
  v25 = v2->m_nHashValue << 8;
  LODWORD(v2->m_nHashValue) = v25 | *(_BYTE *)(v21 + 8);
  HIDWORD(v2->m_nHashValue) = HIDWORD(v25);
  v26 = v2->m_nHashValue << 8;
  LODWORD(v2->m_nHashValue) = v26 | *(_BYTE *)(v21 + 9);
  HIDWORD(v2->m_nHashValue) = HIDWORD(v26);
  v27 = v2->m_nHashValue << 8;
  LODWORD(v2->m_nHashValue) = v27 | *(_BYTE *)(v21 + 10);
  HIDWORD(v2->m_nHashValue) = HIDWORD(v27);
  v28 = v2->m_nHashValue << 8;
  v29 = inSize;
  LODWORD(v2->m_nHashValue) = v28 | *(_BYTE *)(v21 + 11);
  HIDWORD(v2->m_nHashValue) = HIDWORD(v28);
  v30 = p;
  v31 = (char *)p + 4;
  if ( LODWORD(v2->m_nHashValue) != NXParam::GetHashValue((char *)p + 4, v29) || HIDWORD(v2->m_nHashValue) != v32 )
  {
    v42 = -1;
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, p);
    result = 0;
  }
  else
  {
    memcpy(v2, v31, inSize);
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v30);
    v2->m_nBufferSize = v39;
    result = 1;
  }
  return result;
}
// 4570A4: using guessed type char *g_aTxtCodeReverse;

//----- (00423979) --------------------------------------------------------
int __thiscall NXParam::GetParamPtr(NXParam *this, const char *isName)
{
  const char *v2; // ebx@1
  NXParam *v3; // esi@1
  int v4; // edi@2
  int i; // eax@3
  char v6; // dl@4
  int result; // eax@10
  int nNameLen; // [sp+18h] [bp+8h]@2

  v2 = isName;
  v3 = this;
  if ( isName && (v4 = 0, nNameLen = strlen(isName), v3->m_nBufferSize > 0) )
  {
    while ( 1 )
    {
      for ( i = 0; i < nNameLen; ++i )
      {
        v6 = *(&v3->m_aBuffer[v4 + 2] + i);
        if ( !v6 )
          break;
        if ( v6 != v2[i] )
          break;
      }
      if ( i == nNameLen && !*(&v3->m_aBuffer[v4 + 2] + i) )
        break;
      v4 += v3->m_aBuffer[v4 + 1] | ((v3->m_aBuffer[v4] & 0xF) << 8);
      if ( v4 >= v3->m_nBufferSize )
        goto LABEL_10;
    }
    result = v4;
  }
  else
  {
LABEL_10:
    result = -1;
  }
  return result;
}

//----- (004239F6) --------------------------------------------------------
int __cdecl NXParam::GetHashValue(void *ipBuffer, int inSize)
{
  int v2; // edi@1
  char *v3; // esi@2
  unsigned __int16 v4; // ax@3
  __int64 v5; // rax@3
  unsigned int v6; // edi@3
  signed __int64 v7; // rax@3
  unsigned int nRetVal_4; // [sp+Ch] [bp-4h]@1

  v2 = 0;
  nRetVal_4 = 0;
  if ( inSize - 1 > 0 )
  {
    v3 = (char *)ipBuffer + 1;
    do
    {
      HIBYTE(v4) = *(v3 - 1);
      LOBYTE(v4) = *v3;
      v5 = *((_WORD *)&g_aScramble16 + v4);
      v6 = v5 ^ v2;
      v7 = (signed __int64)__PAIR__(HIDWORD(v5) ^ nRetVal_4, v6) >> 16;
      HIDWORD(v7) = (v6 << 16) | WORD2(v7);
      v2 = v7;
      v3 += 2;
      nRetVal_4 = HIDWORD(v7);
    }
    while ( (signed int)&v3[-1 - (_DWORD)ipBuffer] < inSize - 1 );
  }
  return v2;
}

//----- (00423A65) --------------------------------------------------------
void _E13_7()
{
  _E11_3();
  _E12_5();
}

//----- (00423A6F) --------------------------------------------------------
void _E11_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00423AAA) --------------------------------------------------------
void _E12_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00423AE5) --------------------------------------------------------
void _E30_8()
{
  _E23_7();
  _E24_9();
  _E25_7();
  _E26_7();
  _E27_5();
  _E28_6();
  _E29_8();
}

//----- (00423B08) --------------------------------------------------------
void _E23_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00423B43) --------------------------------------------------------
void _E24_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00423B7E) --------------------------------------------------------
void _E25_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00423BB9) --------------------------------------------------------
void _E26_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00423BF4) --------------------------------------------------------
void _E27_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00423C2F) --------------------------------------------------------
void _E28_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00423C6A) --------------------------------------------------------
void _E29_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00423CA5) --------------------------------------------------------
void __thiscall CInPacket::CInPacket(CInPacket *this, CInPacket *iPacket)
{
  CInPacket *v2; // edi@1
  ZArray<unsigned char> *v3; // ecx@1
  CInPacket *v4; // esi@1
  char *v5; // eax@1

  v2 = this;
  v3 = &this->m_aRecvBuff;
  v3->a = 0;
  v4 = iPacket;
  v2->m_bLoopback = iPacket->m_bLoopback;
  v2->m_nState = 2;
  v5 = ZArray<unsigned char>::_Alloc(v3, v4->m_uLength, (ZAllocHelper *)&iPacket + 3);
  memcpy(v5, v4->m_aRecvBuff.a, v4->m_uLength);
  v2->m_uLength = v4->m_uLength;
  v2->m_uRawSeq = v4->m_uRawSeq;
  v2->m_uDataLen = v4->m_uDataLen;
  v2->m_uOffset = v4->m_uOffset;
  v4->m_nState = 0;
  v4->m_uLength = 0;
  v4->m_uOffset = 0;
}

//----- (00423D2A) --------------------------------------------------------
int __thiscall CInPacket::AppendBuffer(CInPacket *this, ZRef<ZSocketBuffer> *pBuff, int *pnLastState, int bEnc)
{
  CInPacket *v4; // esi@1
  ZRef<ZSocketBuffer> *v5; // ebx@3
  ZSocketBuffer *v6; // eax@3
  char *v7; // ecx@3
  int *v8; // edi@3
  int v9; // edx@4
  unsigned __int16 v10; // ax@7
  bool v11; // zf@7
  unsigned __int16 v12; // ax@8
  int *v13; // eax@15
  unsigned int v14; // edi@19
  ZSocketBuffer *v15; // eax@20
  char *pSrc; // [sp+14h] [bp+8h]@3

  v4 = this;
  if ( pnLastState )
    *pnLastState = this->m_nState;
  v5 = pBuff;
  v6 = pBuff->p;
  v7 = v6->buf;
  v8 = (int *)v6->len;
  pSrc = v6->buf;
  if ( !v4->m_nState )
  {
    v9 = v4->m_uLength;
    pnLastState = (int *)v6->len;
    if ( (unsigned int)v8 >= 4 - v9 )
      pnLastState = (int *)(4 - v9);
    CInPacket::RawAppendBuffer(v4, v7, (unsigned int)pnLastState);
    if ( v4->m_uLength >= 4u )
    {
      v4->m_nState = 1;
      v10 = CInPacket::Decode2(v4);
      v11 = bEnc == 0;
      v4->m_uRawSeq = v10;
      if ( v11 )
        v12 = CInPacket::Decode2(v4);
      else
        v12 = v4->m_uRawSeq ^ CInPacket::Decode2(v4);
      v4->m_uDataLen = v12;
    }
    v8 = (int *)((int *)v8 - pnLastState);
    if ( !v8 )
    {
      if ( v5->p )
      {
        ZRef<ZSocketBuffer>::_ReleaseRaw(v5, 0);
        v5->p = 0;
      }
      return v4->m_nState;
    }
    pSrc = &pSrc[(_DWORD)pnLastState];
  }
  v13 = (int *)(v4->m_uDataLen - v4->m_uLength + 4);
  pnLastState = v8;
  if ( v8 >= v13 )
    pnLastState = v13;
  CInPacket::RawAppendBuffer(v4, pSrc, (unsigned int)pnLastState);
  if ( v4->m_uLength >= (unsigned int)v4->m_uDataLen + 4 )
    v4->m_nState = 2;
  v14 = (char *)v8 - (char *)pnLastState;
  if ( v14 )
    ZSocketBuffer::Sub(v5->p, v5->p->len - v14, v14, (ZAllocHelper *)&pnLastState + 3);
  else
    v15 = 0;
  ZRef<ZSocketBuffer>::operator=(v5, v15);
  return v4->m_nState;
}

//----- (00423E34) --------------------------------------------------------
void __thiscall CInPacket::RawAppendBuffer(CInPacket *this, const void *p, unsigned int uSize)
{
  CInPacket *v3; // esi@1
  char *v4; // eax@1
  ZArray<unsigned char> *v5; // edi@1
  unsigned int v6; // ebx@3
  unsigned int v7; // ecx@3
  unsigned int v8; // eax@4

  v3 = this;
  v4 = this->m_aRecvBuff.a;
  v5 = &this->m_aRecvBuff;
  if ( v4 )
    v4 = (char *)*((_DWORD *)v4 - 1);
  v6 = uSize;
  v7 = uSize + this->m_uLength;
  if ( v7 > (unsigned int)v4 )
  {
    v8 = (unsigned int)v5->a;
    if ( v5->a )
      v8 = *(_DWORD *)(v8 - 4);
    do
      v8 *= 2;
    while ( v7 > v8 );
    ZArray<unsigned char>::_Realloc(v5, v8, 0, (ZAllocHelper *)&uSize + 3);
  }
  memcpy(&v5->a[v3->m_uLength], p, v6);
  v3->m_uLength += v6;
}

//----- (00423E91) --------------------------------------------------------
int __userpurge CInPacket::DecryptData@<eax>(CInPacket *this@<ecx>, int a2@<ebp>, unsigned int dwKey)
{
  CInPacket *v3; // edi@1
  unsigned int v4; // ebx@1
  int result; // eax@4
  char *v6; // esi@5
  char *v7; // eax@9
  int v8; // ecx@43
  int v9; // ecx@13
  char v10; // of@10
  char v11; // dl@10
  unsigned __int8 v12; // of@11
  _BYTE *v13; // esi@11
  char v14; // al@36
  char v15; // dl@36
  char v16; // al@43
  int v17; // ecx@29
  unsigned __int8 v18; // of@36
  char v19; // bl@29
  char v20; // dl@43
  char v21; // dl@36
  char v22; // bl@43
  int v23; // [sp-4h] [bp-18h]@29

  v3 = this;
  v4 = this->m_uDataLen;
  *(_DWORD *)(a2 - 4) = v4;
  if ( v4 >= 0x5B0 )
    *(_DWORD *)(a2 - 4) = 1456;
  if ( v4 )
  {
    v6 = this->m_aRecvBuff.a + 4;
    while ( 1 )
    {
      CAESCipher::Decrypt(v6, v6, *(_DWORD *)(a2 - 4), (unsigned int *)(a2 + 8));
      v6 += *(_DWORD *)(a2 - 4);
      v4 -= *(_DWORD *)(a2 - 4);
      if ( !v4 )
        break;
      *(_DWORD *)(a2 - 4) = v4;
      if ( v4 >= 0x5B4 )
        *(_DWORD *)(a2 - 4) = 1460;
    }
    v7 = v3->m_aRecvBuff.a;
    *(_DWORD *)(a2 - 8) = v7 + 4;
    *(_DWORD *)(a2 - 4) = v3->m_uDataLen;
    while ( !__OFADD__(4, v7) && __OFADD__(4, v7) )
      ;
    while ( !__OFADD__(4, v7) && __OFADD__(4, v7) )
      ;
    v9 = 3;
    do
    {
      v23 = v9;
      v17 = *(_DWORD *)(a2 - 4);
      v13 = (_BYTE *)(v17 + *(_DWORD *)(a2 - 8));
      v19 = 0;
      do
      {
        v12 = __OFSUB__(v13--, 1);
        while ( !v12 && v12 )
          ;
        while ( !v12 && v12 )
          ;
        v21 = __ROL1__(*v13, 3);
        v21 ^= 0x13u;
        v14 = v21;
        v15 = __ROR1__((v19 ^ v21) - v17, 4);
        v19 = v14;
        *v13 = v15;
        v18 = __OFSUB__(v17--, 1);
        while ( !v18 && v18 )
          ;
        while ( !v18 && v18 )
          ;
      }
      while ( v17 );
      v8 = *(_DWORD *)(a2 - 4);
      v22 = 0;
      do
      {
        v11 = __ROL1__(~(*v13 - 72), v8);
        while ( !v10 && v10 )
          ;
        while ( !v10 && v10 )
          ;
        v16 = v11;
        v20 = __ROR1__((v22 ^ v11) - v8, 3);
        v22 = v16;
        *v13++ = v20;
        --v8;
      }
      while ( v8 );
      v9 = v23 - 1;
    }
    while ( v23 != 1 );
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (004240B7) --------------------------------------------------------
ZXString<char> *__thiscall CInPacket::DumpString(CInPacket *this, ZXString<char> *result)
{
  signed int v2; // edi@1
  CInPacket *v3; // esi@1
  bool v4; // zf@1
  char *v5; // ebx@1
  int v6; // ST08_4@2
  int v7; // eax@3
  ZXString<char> s; // [sp+10h] [bp-14h]@1
  ZXString<char> v10; // [sp+14h] [bp-10h]@2
  int v11; // [sp+20h] [bp-4h]@1

  v2 = 0;
  v3 = this;
  s._m_pStr = 0;
  v4 = this->m_uLength == 0;
  v5 = this->m_aRecvBuff.a;
  v11 = 1;
  if ( !v4 )
  {
    do
    {
      v10._m_pStr = 0;
      v6 = (unsigned __int8)v5[v2];
      LOBYTE(v11) = 2;
      ZXString<char>::Format(&v10, a02x, v6);
      if ( v10._m_pStr )
        v7 = *((_DWORD *)v10._m_pStr - 1);
      else
        v7 = 0;
      ZXString<char>::_Cat(&s, v10._m_pStr, v7);
      LOBYTE(v11) = 1;
      ZXString<char>::~ZXString<char>(&v10);
      ++v2;
    }
    while ( v2 < v3->m_uLength );
  }
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, &s);
  LOBYTE(v11) = 0;
  ZXString<char>::~ZXString<char>(&s);
  return result;
}

//----- (00424163) --------------------------------------------------------
void __thiscall COutPacket::COutPacket(COutPacket *this, int nType, int bLoopback)
{
  COutPacket *v3; // esi@1
  char v4; // [sp+Bh] [bp-Dh]@1
  int v5; // [sp+14h] [bp-4h]@1

  v3 = this;
  this->m_aSendBuff.a = 0;
  ZArray<unsigned char>::_Alloc(&this->m_aSendBuff, 0x100u, (ZAllocHelper *)&v4);
  v5 = 0;
  COutPacket::Init(v3, nType, bLoopback);
}

//----- (004241AC) --------------------------------------------------------
void __thiscall COutPacket::Init(COutPacket *this, int nType, int bLoopback)
{
  COutPacket *v3; // esi@1

  v3 = this;
  this->m_uOffset = 0;
  this->m_bLoopback = bLoopback;
  if ( nType != 0x7FFFFFFF )
    COutPacket::Encode2(this, nType);
  v3->m_bIsEncryptedByShanda = 0;
}

//----- (004241D4) --------------------------------------------------------
void __thiscall COutPacket::InitByte(COutPacket *this, int nType, int bLoopback)
{
  this->m_uOffset = 0;
  this->m_bLoopback = bLoopback;
  if ( nType != 0x7FFFFFFF )
    COutPacket::Encode1(this, nType);
}

//----- (004241F4) --------------------------------------------------------
void __userpurge COutPacket::MakeBufferList(COutPacket *this@<ecx>, int a2@<ebp>, ZList<ZRef<ZSocketBuffer> > *l, unsigned __int16 uSeqBase, unsigned int *puSeqKey, int bEnc, unsigned int dwKey)
{
  bool v7; // zf@1
  COutPacket *v8; // ebx@1
  unsigned int v9; // eax@1
  char v10; // dl@14
  int v11; // ecx@16
  _BYTE *v12; // esi@7
  int v13; // ecx@3
  char v14; // dl@7
  char v15; // dl@14
  char v16; // dl@7
  char v17; // dl@16
  char v18; // al@7
  char v19; // dl@4
  unsigned __int8 v20; // of@4
  char v21; // dl@4
  char v22; // al@14
  int v23; // ecx@14
  signed int v24; // edi@20
  int v25; // eax@22
  unsigned int *v26; // ecx@26
  _WORD *v27; // eax@26
  int v28; // esi@26
  int v29; // ecx@27
  _WORD *v30; // eax@29
  int v31; // ecx@30
  char *v32; // eax@32
  int v33; // esi@33
  ZList<ZRef<ZSocketBuffer> > *v34; // ecx@35
  ZSocketBuffer *v35; // eax@39
  char *v36; // eax@41
  signed int v37; // esi@42
  ZList<ZRef<ZSocketBuffer> > *v38; // ecx@44
  ZRef<ZSocketBuffer> *v39; // eax@44
  int v40; // [sp-4h] [bp-34h]@15

  v7 = *(_DWORD *)(a2 + 20) == 0;
  v8 = this;
  v9 = this->m_uOffset;
  *(_DWORD *)(a2 - 24) = v9 + 4;
  *(_DWORD *)(a2 - 20) = this->m_aSendBuff.a;
  if ( !v7 && !this->m_bIsEncryptedByShanda )
  {
    *(_DWORD *)(a2 - 28) = v9;
    v13 = 3;
    do
    {
      v40 = v13;
      v23 = *(_DWORD *)(a2 - 28);
      v12 = *(_BYTE **)(a2 - 20);
      v22 = 0;
      do
      {
        v19 = __ROL1__(*v12, 3);
        v20 = __OFADD__((_BYTE)v23, v19);
        v21 = v23 + v19;
        while ( !v20 && v20 )
          ;
        while ( !v20 && v20 )
          ;
        v15 = v22 ^ v21;
        v22 = v15;
        v10 = __ROR1__(v15, v23);
        *v12++ = ~v10 + 72;
        --v23;
      }
      while ( v23 );
      v11 = *(_DWORD *)(a2 - 28);
      v18 = 0;
      do
      {
        v14 = __ROL1__(*--v12, 4);
        v16 = v18 ^ (v11 + v14);
        v18 = v16;
        v17 = __ROR1__(v16 ^ 0x13, 3);
        *v12 = v17;
        --v11;
      }
      while ( v11 );
      v13 = v40 - 1;
    }
    while ( v40 != 1 );
    v8->m_bIsEncryptedByShanda = 1;
  }
  v24 = 1460;
  if ( *(_DWORD *)(a2 - 24) < 0x5B4u )
    v24 = *(_DWORD *)(a2 - 24);
  ZSocketBuffer::Alloc(v24);
  *(_DWORD *)(a2 - 32) = v25;
  if ( v25 )
  {
    InterlockedIncrement((volatile LONG *)(v25 + 4));
    v25 = *(_DWORD *)(a2 - 32);
  }
  *(_DWORD *)(a2 - 4) = 0;
  if ( v8->m_bLoopback )
  {
    *(_DWORD *)(v25 + 8) = v25;
    v25 = *(_DWORD *)(a2 - 32);
  }
  v26 = *(unsigned int **)(a2 + 16);
  v27 = *(_WORD **)(v25 + 16);
  v28 = (int)v27 + v24;
  if ( v26 )
    v29 = *(_DWORD *)(a2 + 12) ^ (*v26 >> 16);
  else
    v29 = *(_DWORD *)(a2 + 12);
  *v27 = v29;
  v30 = v27 + 1;
  if ( *(_DWORD *)(a2 + 20) )
    v31 = v8->m_uOffset ^ (unsigned __int16)v29;
  else
    v31 = v8->m_uOffset;
  *v30 = v31;
  v32 = (char *)(v30 + 1);
  if ( *(_DWORD *)(a2 + 20) )
  {
    v33 = v28 - (_DWORD)v32;
    CAESCipher::Encrypt(v32, *(char **)(a2 - 20), v33, (unsigned int *)(a2 + 24));
  }
  else
  {
    v33 = v28 - (_DWORD)v32;
    memcpy(v32, *(const void **)(a2 - 20), v33);
  }
  v34 = *(ZList<ZRef<ZSocketBuffer> > **)(a2 + 8);
  *(_DWORD *)(a2 - 20) += v33;
  ZList<ZRef<ZSocketBuffer>>::AddTail(v34, (ZRef<ZSocketBuffer> *)(a2 - 36));
  while ( 1 )
  {
    v7 = *(_DWORD *)(a2 - 24) == v24;
    *(_DWORD *)(a2 - 24) -= v24;
    if ( v7 )
      break;
    v24 = 1460;
    if ( *(_DWORD *)(a2 - 24) < 0x5B4u )
      v24 = *(_DWORD *)(a2 - 24);
    ZSocketBuffer::Alloc(v24);
    ZRef<ZSocketBuffer>::operator=((ZRef<ZSocketBuffer> *)(a2 - 36), v35);
    if ( v8->m_bLoopback )
      *(_DWORD *)(*(_DWORD *)(a2 - 32) + 8) = *(_DWORD *)(a2 - 32);
    v36 = *(char **)(*(_DWORD *)(a2 - 32) + 16);
    if ( *(_DWORD *)(a2 + 20) )
    {
      v37 = v24;
      CAESCipher::Encrypt(v36, *(char **)(a2 - 20), v24, (unsigned int *)(a2 + 24));
    }
    else
    {
      v37 = v24;
      memcpy(v36, *(const void **)(a2 - 20), v24);
    }
    v38 = *(ZList<ZRef<ZSocketBuffer> > **)(a2 + 8);
    *(_DWORD *)(a2 - 20) += v37;
    v39 = ZList<ZRef<ZSocketBuffer>>::AddTail(v38);
    ZRef<ZSocketBuffer>::operator=(v39, (ZRef<ZSocketBuffer> *)(a2 - 36));
  }
  *(_DWORD *)(a2 - 4) = -1;
  if ( *(_DWORD *)(a2 - 32) )
    ZRef<ZSocketBuffer>::_ReleaseRaw((ZRef<ZSocketBuffer> *)(a2 - 36), 0);
}

//----- (00424536) --------------------------------------------------------
ZXString<char> *__thiscall COutPacket::DumpString(COutPacket *this, ZXString<char> *result)
{
  unsigned int v2; // edi@1
  COutPacket *v3; // esi@1
  bool v4; // zf@1
  char *v5; // ebx@1
  int v6; // ST08_4@2
  int v7; // eax@3
  ZXString<char> s; // [sp+10h] [bp-14h]@1
  ZXString<char> v10; // [sp+14h] [bp-10h]@2
  int v11; // [sp+20h] [bp-4h]@1

  v2 = 0;
  v3 = this;
  s._m_pStr = 0;
  v4 = this->m_uOffset == 0;
  v5 = this->m_aSendBuff.a;
  v11 = 1;
  if ( !v4 )
  {
    do
    {
      v10._m_pStr = 0;
      v6 = (unsigned __int8)v5[v2];
      LOBYTE(v11) = 2;
      ZXString<char>::Format(&v10, a02x, v6);
      if ( v10._m_pStr )
        v7 = *((_DWORD *)v10._m_pStr - 1);
      else
        v7 = 0;
      ZXString<char>::_Cat(&s, v10._m_pStr, v7);
      LOBYTE(v11) = 1;
      ZXString<char>::~ZXString<char>(&v10);
      ++v2;
    }
    while ( v2 < v3->m_uOffset );
  }
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, &s);
  LOBYTE(v11) = 0;
  ZXString<char>::~ZXString<char>(&s);
  return result;
}

//----- (004245ED) --------------------------------------------------------
void _E17_1()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00424628) --------------------------------------------------------
void _E18_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00424663) --------------------------------------------------------
void _E36_9()
{
  _E29_9();
  _E30_9();
  _E31_7();
  _E32_5();
  _E33_5();
  _E34_7();
  _E35_9();
}

//----- (00424686) --------------------------------------------------------
void _E29_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004246C1) --------------------------------------------------------
void _E30_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004246FC) --------------------------------------------------------
void _E31_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00424737) --------------------------------------------------------
void _E32_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00424772) --------------------------------------------------------
void _E33_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004247AD) --------------------------------------------------------
void _E34_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004247E8) --------------------------------------------------------
void _E35_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0042482D) --------------------------------------------------------
void _E11_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00424868) --------------------------------------------------------
void _E12_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (004248A3) --------------------------------------------------------
void _E30_10()
{
  _E23_8();
  _E24_10();
  _E25_8();
  _E26_8();
  _E27_6();
  _E28_7();
  _E29_10();
}

//----- (004248C6) --------------------------------------------------------
void _E23_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00424901) --------------------------------------------------------
void _E24_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0042493C) --------------------------------------------------------
void _E25_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00424977) --------------------------------------------------------
void _E26_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (004249B2) --------------------------------------------------------
void _E27_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004249ED) --------------------------------------------------------
void _E28_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00424A28) --------------------------------------------------------
void _E29_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00424A77) --------------------------------------------------------
int _E11_5()
{
  return atexit(_E10);
}

//----- (00424A83) --------------------------------------------------------
void __cdecl _E10()
{
  CRand32::~CRand32(&g_rand);
}

//----- (00424A8D) --------------------------------------------------------
void __thiscall CRand32::~CRand32(CRand32 *this)
{
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
}

//----- (00424A98) --------------------------------------------------------
void _E18_4()
{
  _E16_0();
  _E17_2();
}

//----- (00424AA2) --------------------------------------------------------
void _E16_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00424ADD) --------------------------------------------------------
void _E17_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00424B18) --------------------------------------------------------
void _E35_10()
{
  _E28_8();
  _E29_11();
  _E30_11();
  _E31_8();
  _E32_6();
  _E33_6();
  _E34_8();
}

//----- (00424B3B) --------------------------------------------------------
void _E28_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00424B76) --------------------------------------------------------
void _E29_11()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00424BB1) --------------------------------------------------------
void _E30_11()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00424BEC) --------------------------------------------------------
void _E31_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00424C27) --------------------------------------------------------
void _E32_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00424C62) --------------------------------------------------------
void _E33_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00424C9D) --------------------------------------------------------
void _E34_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00424CD8) --------------------------------------------------------
void __thiscall CRand32::CRand32(CRand32 *this)
{
  CRand32 *v1; // esi@1
  int v2; // eax@1

  v1 = this;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v2 = dword_4A49B4();
  CRand32::Seed(v1, 1170746341 * v2 - 755606699, 1170746341 * v2 - 755606699, 1170746341 * v2 - 755606699);
}
// 4A49B4: using guessed type int (*dword_4A49B4)(void);

//----- (00424D21) --------------------------------------------------------
void __thiscall CRand32::Seed(CRand32 *this, unsigned int s1, unsigned int s2, unsigned int s3)
{
  CRand32 *v4; // esi@1
  struct _RTL_CRITICAL_SECTION *v5; // edi@1

  v4 = this;
  v5 = (struct _RTL_CRITICAL_SECTION *)&this->m_lock.DebugInfo;
  EnterCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  v4->m_s1 = s1 | 0x100000;
  v4->m_past_s1 = s1 | 0x100000;
  v4->m_s2 = s2 | 0x1000;
  v4->m_past_s2 = s2 | 0x1000;
  v4->m_s3 = s3 | 0x10;
  v4->m_past_s3 = s3 | 0x10;
  LeaveCriticalSection(v5);
}

//----- (00424D65) --------------------------------------------------------
void _E13_9()
{
  _E11_6();
  _E12_8();
}

//----- (00424D6F) --------------------------------------------------------
void _E11_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00424DAA) --------------------------------------------------------
void _E12_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00424DE5) --------------------------------------------------------
void _E30_12()
{
  _E23_9();
  _E24_11();
  _E25_9();
  _E26_9();
  _E27_7();
  _E28_9();
  _E29_12();
}

//----- (00424E08) --------------------------------------------------------
void _E23_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00424E43) --------------------------------------------------------
void _E24_11()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00424E7E) --------------------------------------------------------
void _E25_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00424EB9) --------------------------------------------------------
void _E26_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00424EF4) --------------------------------------------------------
void _E27_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00424F2F) --------------------------------------------------------
void _E28_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00424F6A) --------------------------------------------------------
void _E29_12()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00424FA5) --------------------------------------------------------
void __thiscall CServerApp::CServerApp(CServerApp *this)
{
  CServerApp *v1; // eax@1
  char *v2; // ecx@1

  v1 = this;
  v2 = (char *)&this->m_bPCOMInitialized;
  TSingleton<CServerApp>::ms_pInstance = (CLoginApp *)(v2 != 0 ? (unsigned int)(v2 - 4) : 0);
  *(_DWORD *)v2 = 0;
  v1->m_uTimerPeriod = 0;
  v1->vfptr = (CServerAppVtbl *)&CServerApp::`vftable';
}
// 4439D4: using guessed type int (__thiscall *CServerApp::`vftable')(void *p, unsigned int __flags);

//----- (00424FCB) --------------------------------------------------------
CServerApp *__thiscall CServerApp::`vector deleting destructor'(CServerApp *this, unsigned int __flags)
{
  CServerApp *v2; // esi@1

  v2 = this;
  CServerApp::~CServerApp(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00424FEB) --------------------------------------------------------
void __thiscall CServerApp::~CServerApp(CServerApp *this)
{
  this->vfptr = (CServerAppVtbl *)&CServerApp::`vftable';
  TSingleton<CServerApp>::ms_pInstance = 0;
}
// 4439D4: using guessed type int (__thiscall *CServerApp::`vftable')(void *p, unsigned int __flags);

//----- (00424FF9) --------------------------------------------------------
int __thiscall CServerApp::SetUp(CServerApp *this)
{
  CServerApp *v1; // esi@1
  unsigned int v2; // eax@1
  HRESULT v3; // eax@3
  int v5; // [sp+0h] [bp-28h]@1
  int v6; // [sp+14h] [bp-14h]@4
  int *v7; // [sp+18h] [bp-10h]@1
  int v8; // [sp+24h] [bp-4h]@1

  v8 = 0;
  v7 = &v5;
  v1 = this;
  v2 = dword_4A49B4();
  srand(v2);
  v1->m_dwMainThreadId = GetCurrentThreadId();
  do
    ++v1->m_uTimerPeriod;
  while ( timeBeginPeriod(v1->m_uTimerPeriod) );
  v3 = CoInitialize(0);
  if ( v3 < 0 )
  {
    v6 = v3;
    _CxxThrowException(&v6, &_TI1_AVZException__);
  }
  CServerApp::InitializePCOM(v1);
  CServerApp::InitializeResMan();
  return 1;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A49B4: using guessed type int (*dword_4A49B4)(void);

//----- (00425096) --------------------------------------------------------
void CServerApp::Run()
{
  tagMSG *i; // [sp-10h] [bp-34h]@1
  tagMSG msg; // [sp+8h] [bp-1Ch]@1

  for ( i = &msg; GetMessageA(i, 0, 0, 0); i = &msg )
  {
    TranslateMessage(&msg);
    DispatchMessageA(&msg);
  }
}

//----- (004250D4) --------------------------------------------------------
void __thiscall CServerApp::CleanUp(CServerApp *this)
{
  CServerApp *v1; // esi@1
  UINT v2; // esi@9

  v1 = this;
  if ( g_rm.m_pInterface )
    _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator=(&g_rm, 0);
  if ( g_pPropConf.m_pInterface )
    _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator=(&g_pPropConf, 0);
  if ( g_pRoot.m_pInterface )
    _com_ptr_t<_com_IIID<IWzNameSpace,&__s_GUID _GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d>>::operator=(&g_pRoot, 0);
  if ( v1->m_bPCOMInitialized )
  {
    PcUninitialize();
    v1->m_bPCOMInitialized = 0;
  }
  CoUninitialize();
  v2 = v1->m_uTimerPeriod;
  if ( v2 )
    timeEndPeriod(v2);
}

//----- (00425137) --------------------------------------------------------
void __thiscall CServerApp::InitializePCOM(CServerApp *this)
{
  CServerApp *v1; // esi@1
  int v2; // eax@1
  int v3; // [sp+4h] [bp-4h]@2

  v1 = this;
  v2 = PcInitialize(0);
  if ( v2 < 0 )
  {
    v3 = v2;
    _CxxThrowException(&v3, &_TI1_AVZException__);
  }
  v1->m_bPCOMInitialized = 1;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00425165) --------------------------------------------------------
void CServerApp::InitializeResMan()
{
  IWzResMan *v1; // esi@3
  int v2; // eax@3
  DWORD v3; // eax@5
  void *v4; // ecx@5
  IWzFileSystem *v5; // eax@7
  Ztl_variant_t *v6; // ecx@7
  _com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *v7; // eax@7
  IWzNameSpace *v8; // eax@7
  char *v9; // eax@9
  _bstr_t::Data_t *v10; // ecx@9
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v11; // eax@9
  IWzResMan *v12; // eax@9
  Ztl_variant_t *v13; // eax@9
  int v14; // eax@9
  int v15; // eax@12
  int v16; // eax@14
  int v17; // eax@16
  IUnknownVtbl *v18; // ecx@19
  Ztl_bstr_t v19; // [sp-14h] [bp-68h]@9
  Ztl_variant_t *v20; // [sp-10h] [bp-64h]@9
  Ztl_variant_t *v21; // [sp-Ch] [bp-60h]@7
  IWzFileSystem *v22; // [sp-8h] [bp-5Ch]@7
  void *v23; // [sp-4h] [bp-58h]@7
  Ztl_variant_t v24; // [sp+8h] [bp-4Ch]@9
  _variant_t v25; // [sp+18h] [bp-3Ch]@9
  _variant_t v26; // [sp+28h] [bp-2Ch]@9
  int v27; // [sp+38h] [bp-1Ch]@7
  ZXString<char> result; // [sp+3Ch] [bp-18h]@5
  ZXString<char> v29; // [sp+40h] [bp-14h]@7
  _com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > pObj; // [sp+44h] [bp-10h]@5
  int v31; // [sp+50h] [bp-4h]@5

  PcCreateObject(aResman, &g_rm, 0);
  if ( !g_rm.m_pInterface )
    _com_issue_error(-2147467261);
  v1 = g_rm.m_pInterface;
  v2 = ((int (__stdcall *)(IWzResMan *, signed int, signed int, signed int))g_rm.m_pInterface->vfptr[1].Release)(
         g_rm.m_pInterface,
         33,
         -1,
         -1);
  if ( v2 < 0 )
    _com_issue_errorex(v2, (IUnknown *)&v1->vfptr, &_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf);
  PcCreateObject(aNamespace, &g_pRoot, 0);
  result._m_pStr = (char *)g_pRoot.m_pInterface;
  dword_4A4C64(&result, 1);
  pObj.m_pInterface = 0;
  v31 = 0;
  PcCreateObject(aNamespaceFiles, &pObj, 0);
  v3 = GetFileAttributesA(FileName);
  if ( v3 == -1 || !(v3 & 0x10) )
  {
    ZtlSetErrorDescription(sDesc, 0);
    v27 = -2147467259;
    _CxxThrowException(&v27, &_TI1_AVZException__);
  }
  v23 = v4;
  v27 = (int)&v23;
  _bstr_t::_bstr_t((_bstr_t *)&v23, a__Datasvr_1);
  LOBYTE(v31) = 0;
  v5 = _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::operator->(&pObj);
  IWzFileSystem::Init(v5, (Ztl_bstr_t)v23);
  v23 = 0;
  v22 = _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::operator IWzFileSystem *(&pObj);
  v21 = v6;
  v27 = (int)&v21;
  Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v21, asc_499164);
  LOBYTE(v31) = 0;
  v7 = get_root();
  v8 = _com_ptr_t<_com_IIID<IWzNameSpace,&__s_GUID _GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d>>::operator->(v7);
  IWzNameSpace::Mount(v8, (Ztl_bstr_t)v21, (IWzNameSpace *)&v22->vfptr, (int)v23);
  v29._m_pStr = 0;
  LOBYTE(v31) = 3;
  v23 = get_cmdline_arg(&result, 1)->_m_pStr;
  LOBYTE(v31) = 4;
  ZXString<char>::Format(&v29, aS_img, v23);
  LOBYTE(v31) = 3;
  if ( result._m_pStr )
    ZXString<char>::_Release((ZXString<char>::_ZXStringData *)result._m_pStr - 1);
  _variant_t::_variant_t(&v25, &vtMissing);
  LOBYTE(v31) = 5;
  _variant_t::_variant_t(&v26, &vtMissing);
  v23 = 0;
  v22 = 0;
  v21 = (Ztl_variant_t *)&v25;
  v20 = (Ztl_variant_t *)&v26;
  LOBYTE(v31) = 6;
  v9 = ZXString<char>::operator char const *(&v29);
  v19.m_Data = v10;
  result._m_pStr = (char *)&v19;
  Ztl_bstr_t::Ztl_bstr_t(&v19, v9);
  LOBYTE(v31) = 6;
  v11 = get_rm();
  v12 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v11);
  v13 = IWzResMan::GetObjectA(v12, &v24, v19, v20, v21);
  LOBYTE(v31) = 8;
  v27 = (int)Ztl_variant_t::GetUnknown(v13, (char)v22, (char)v23);
  v14 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
          &g_pPropConf,
          (int)&v27);
  if ( v14 < 0 && v14 != -2147467262 )
    _com_issue_error(v14);
  LOBYTE(v31) = 6;
  v15 = ZComAPI::ZComVariantClear((tagVARIANT *)&v24.0);
  if ( v15 < 0 )
    _com_issue_error(v15);
  LOBYTE(v31) = 5;
  v16 = ZComAPI::ZComVariantClear((tagVARIANT *)&v26.0);
  if ( v16 < 0 )
    _com_issue_error(v16);
  LOBYTE(v31) = 3;
  v17 = ZComAPI::ZComVariantClear((tagVARIANT *)&v25.0);
  if ( v17 < 0 )
    _com_issue_error(v17);
  LOBYTE(v31) = 0;
  ZXString<char>::~ZXString<char>(&v29);
  v31 = -1;
  if ( pObj.m_pInterface )
  {
    v18 = pObj.m_pInterface->vfptr;
    v23 = pObj.m_pInterface;
    v18->Release((IUnknown *)pObj.m_pInterface);
  }
}
// 4A4C64: invalid function type has been ignored
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4C64: using guessed type int (__cdecl *dword_4A4C64)(_DWORD, _DWORD);

//----- (004253C0) --------------------------------------------------------
IWzNameSpace *__thiscall _com_ptr_t<_com_IIID<IWzNameSpace,&__s_GUID _GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d>>::operator->(_com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *this)
{
  if ( !this->m_pInterface )
    _com_issue_error(-2147467261);
  return this->m_pInterface;
}

//----- (004253D6) --------------------------------------------------------
_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *__thiscall _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator=(_com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *this, int null)
{
  if ( null )
    _com_issue_error(-2147467261);
  return _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator=(this, 0);
}

//----- (004253F7) --------------------------------------------------------
char *__thiscall ZXString<char>::operator char const *(ZXString<char> *this)
{
  return this->_m_pStr;
}

//----- (004253FA) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::~_com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>(_com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *this)
{
  if ( this->m_pInterface )
    this->m_pInterface->vfptr->Release((IUnknown *)this->m_pInterface);
}

//----- (00425407) --------------------------------------------------------
IWzFileSystem *__thiscall _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::operator IWzFileSystem *(_com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *this)
{
  return this->m_pInterface;
}

//----- (0042540A) --------------------------------------------------------
IWzFileSystem *__thiscall _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::operator->(_com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *this)
{
  if ( !this->m_pInterface )
    _com_issue_error(-2147467261);
  return this->m_pInterface;
}

//----- (00425476) --------------------------------------------------------
void __cdecl PcCreateObject(const unsigned __int16 *sUOL, _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *pObj, IUnknown *pUnkOuter)
{
  int v3; // eax@4
  _com_error v4; // [sp+4h] [bp-10h]@6

  _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator=(pObj, 0);
  if ( pObj->m_pInterface )
    pObj->m_pInterface->vfptr->Release((IUnknown *)pObj->m_pInterface);
  pObj->m_pInterface = 0;
  if ( !_g_apfnPCOMAPIs )
  {
    v3 = -2147221008;
LABEL_6:
    _com_error::_com_error(&v4, v3, 0, 0);
    _CxxThrowException(&v4, &_TI1_AV_com_error__);
  }
  v3 = _g_apfnPCOMAPIs(sUOL, &_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf, pObj, pUnkOuter);
  if ( v3 < 0 )
    goto LABEL_6;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4C54: using guessed type int (__cdecl *_g_apfnPCOMAPIs)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004254DB) --------------------------------------------------------
void __cdecl PcCreateObject(const unsigned __int16 *sUOL, _com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *pObj, IUnknown *pUnkOuter)
{
  int v3; // eax@4
  _com_error v4; // [sp+4h] [bp-10h]@6

  _com_ptr_t<_com_IIID<IWzNameSpace,&__s_GUID _GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d>>::operator=(pObj, 0);
  if ( pObj->m_pInterface )
    pObj->m_pInterface->vfptr->Release((IUnknown *)pObj->m_pInterface);
  pObj->m_pInterface = 0;
  if ( !_g_apfnPCOMAPIs )
  {
    v3 = -2147221008;
LABEL_6:
    _com_error::_com_error(&v4, v3, 0, 0);
    _CxxThrowException(&v4, &_TI1_AV_com_error__);
  }
  v3 = _g_apfnPCOMAPIs(sUOL, &_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d, pObj, pUnkOuter);
  if ( v3 < 0 )
    goto LABEL_6;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4C54: using guessed type int (__cdecl *_g_apfnPCOMAPIs)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00425540) --------------------------------------------------------
void __cdecl PcCreateObject(const unsigned __int16 *sUOL, _com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *pObj, IUnknown *pUnkOuter)
{
  int v3; // eax@4
  _com_error v4; // [sp+4h] [bp-10h]@6

  _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::operator=(pObj, 0);
  if ( pObj->m_pInterface )
    pObj->m_pInterface->vfptr->Release((IUnknown *)pObj->m_pInterface);
  pObj->m_pInterface = 0;
  if ( !_g_apfnPCOMAPIs )
  {
    v3 = -2147221008;
LABEL_6:
    _com_error::_com_error(&v4, v3, 0, 0);
    _CxxThrowException(&v4, &_TI1_AV_com_error__);
  }
  v3 = _g_apfnPCOMAPIs(sUOL, &_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5, pObj, pUnkOuter);
  if ( v3 < 0 )
    goto LABEL_6;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A4C54: using guessed type int (__cdecl *_g_apfnPCOMAPIs)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004255A5) --------------------------------------------------------
void _E14_4()
{
  _E12_9();
  _E13_10();
}

//----- (004255AF) --------------------------------------------------------
void _E12_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (004255EA) --------------------------------------------------------
void _E13_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00425650) --------------------------------------------------------
void _E31_9()
{
  _E24_12();
  _E25_10();
  _E26_10();
  _E27_8();
  _E28_10();
  _E29_13();
  _E30_13();
}

//----- (00425673) --------------------------------------------------------
void _E24_12()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004256AE) --------------------------------------------------------
void _E25_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004256E9) --------------------------------------------------------
void _E26_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00425724) --------------------------------------------------------
void _E27_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0042575F) --------------------------------------------------------
void _E28_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0042579A) --------------------------------------------------------
void _E29_13()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004257D5) --------------------------------------------------------
void _E30_13()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00425810) --------------------------------------------------------
int __cdecl ZtlSetErrorDescription(const unsigned __int16 *sDesc, _GUID *pIID)
{
  int result; // eax@1
  HRESULT v3; // esi@2
  IUnknownVtbl *v4; // ecx@5
  IUnknownVtbl **v5; // eax@6
  ICreateErrorInfo *v6; // [sp-4h] [bp-10h]@5
  IErrorInfo *pEI; // [sp+4h] [bp-8h]@5
  ICreateErrorInfo *pCEI; // [sp+8h] [bp-4h]@1

  pCEI = 0;
  result = CreateErrorInfo(&pCEI);
  if ( result >= 0 )
  {
    v3 = ((int (__stdcall *)(ICreateErrorInfo *, const unsigned __int16 *))pCEI->vfptr[1].Release)(pCEI, sDesc);
    if ( v3 < 0
      || pIID
      && (v3 = ((int (__stdcall *)(ICreateErrorInfo *, _GUID *))pCEI->vfptr[1].QueryInterface)(pCEI, pIID), v3 < 0) )
    {
      v5 = (IUnknownVtbl **)pCEI;
    }
    else
    {
      pEI = 0;
      v3 = pCEI->vfptr->QueryInterface((IUnknown *)pCEI, &_GUID_1cf2b120_547d_101b_8e65_08002b2bd119, (void **)&pEI);
      v4 = pCEI->vfptr;
      v6 = pCEI;
      if ( v3 < 0 )
      {
LABEL_9:
        v4->Release((IUnknown *)v6);
        return v3;
      }
      v4->Release((IUnknown *)pCEI);
      v3 = SetErrorInfo(0, pEI);
      v5 = (IUnknownVtbl **)pEI;
    }
    v4 = *v5;
    v6 = (ICreateErrorInfo *)v5;
    goto LABEL_9;
  }
  return result;
}

//----- (00425896) --------------------------------------------------------
void __thiscall Ztl_bstr_t::Ztl_bstr_t(Ztl_bstr_t *this, const char *s)
{
  _bstr_t::_bstr_t((_bstr_t *)&this->m_Data, s);
}

//----- (004258A8) --------------------------------------------------------
void __thiscall _bstr_t::_bstr_t(_bstr_t *this, const char *s)
{
  _bstr_t *v2; // esi@1
  _bstr_t::Data_t *v3; // ecx@1
  _bstr_t::Data_t *v4; // eax@2

  v2 = this;
  v3 = (_bstr_t::Data_t *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0xCu);
  if ( v3 )
    _bstr_t::Data_t::Data_t(v3, s);
  else
    v4 = 0;
  v2->m_Data = v4;
  if ( !v4 )
    _com_issue_error(-2147024882);
}

//----- (00425900) --------------------------------------------------------
void __thiscall _bstr_t::Data_t::Data_t(_bstr_t::Data_t *this, const char *s)
{
  _bstr_t::Data_t *v2; // esi@1
  unsigned __int16 *v3; // eax@1

  v2 = this;
  this->m_str = 0;
  this->m_RefCount = 1;
  v3 = _com_util::ZtlConvertStringToBSTR(s);
  v2->m_wstr = v3;
  if ( !v3 )
  {
    if ( s )
      _com_issue_error(-2147024882);
  }
}

//----- (00425933) --------------------------------------------------------
unsigned __int16 *__stdcall _com_util::ZtlConvertStringToBSTR(const char *pSrc)
{
  unsigned __int16 *result; // eax@2
  int v2; // eax@3
  unsigned __int16 *v3; // edi@3

  if ( pSrc )
  {
    v2 = dword_4A4778(0, 0, pSrc, -1, 0, 0);
    v3 = ZComAPI::ZComSysAllocStringLen(0, ((unsigned int)(2 * v2) >> 1) - 1);
    dword_4A4778(0, 0, pSrc, -1, v3, 0x3FFFFFFF);
    result = v3;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 4A4778: using guessed type int (__stdcall *dword_4A4778)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0042597A) --------------------------------------------------------
int __thiscall IWzNameSpace::Mount(IWzNameSpace *this, Ztl_bstr_t sPath, IWzNameSpace *pDown, int nPriority)
{
  IWzNameSpace *v4; // esi@1
  unsigned __int16 *v5; // eax@1
  int v6; // eax@3
  int v7; // edi@3

  v4 = this;
  v5 = 0;
  if ( sPath.m_Data )
    v5 = sPath.m_Data->m_wstr;
  v6 = ((int (__stdcall *)(IWzNameSpace *, unsigned __int16 *, IWzNameSpace *, int))this->vfptr[2].QueryInterface)(
         this,
         v5,
         pDown,
         nPriority);
  v7 = v6;
  if ( v6 < 0 )
    _com_issue_errorex(v6, (IUnknown *)&v4->vfptr, &_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d);
  if ( sPath.m_Data )
    _bstr_t::Data_t::Release(sPath.m_Data);
  return v7;
}

//----- (004259D4) --------------------------------------------------------
int __thiscall IWzFileSystem::Init(IWzFileSystem *this, Ztl_bstr_t sPath)
{
  IWzFileSystem *v2; // esi@1
  unsigned __int16 *v3; // eax@1
  int v4; // eax@3
  int v5; // edi@3

  v2 = this;
  v3 = 0;
  if ( sPath.m_Data )
    v3 = sPath.m_Data->m_wstr;
  v4 = ((int (__stdcall *)(IWzFileSystem *, unsigned __int16 *))this->vfptr[4].AddRef)(this, v3);
  v5 = v4;
  if ( v4 < 0 )
    _com_issue_errorex(v4, (IUnknown *)&v2->vfptr, &_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5);
  if ( sPath.m_Data )
    _bstr_t::Data_t::Release(sPath.m_Data);
  return v5;
}

//----- (00425A28) --------------------------------------------------------
_com_ptr_t<_com_IIID<IWzNameSpace,&_GUID_2aeeeb36_a4e1_4e2b_8f6f_2e7bdec5c53d> > *__cdecl get_root()
{
  return &g_pRoot;
}

//----- (00425A2E) --------------------------------------------------------
int _E17_3()
{
  _E13_11();
  return _E16_1();
}

//----- (00425A38) --------------------------------------------------------
void _E13_11()
{
  InitializeCriticalSection(&CServerDialog::ms_lockLog);
}

//----- (00425A44) --------------------------------------------------------
int _E16_1()
{
  return atexit(_E14_5);
}

//----- (00425A50) --------------------------------------------------------
void __cdecl _E14_5()
{
  if ( !(_S15_5 & 1) )
  {
    _S15_5 |= 1u;
    DeleteCriticalSection(&CServerDialog::ms_lockLog);
  }
}

//----- (00425A6C) --------------------------------------------------------
void __thiscall CServerDialog::CServerDialog(CServerDialog *this)
{
  CServerDialog *v1; // esi@1

  v1 = this;
  TSingleton<CServerDialog>::ms_pInstance = &this->m_hWnd != 0 ? (unsigned int)this : 0;
  this->m_hWnd = 0;
  this->m_hEditLog = 0;
  this->m_hEditConnection = 0;
  this->m_hIcon = 0;
  this->m_tLastTimeLog = dword_4A49B4();
  v1->vfptr = (CServerDialogVtbl *)&CServerDialog::`vftable';
}
// 4439DC: using guessed type int (__thiscall *CServerDialog::`vftable')(void *p, unsigned int __flags);
// 4A428C: using guessed type int TSingleton<CServerDialog>::ms_pInstance;
// 4A49B4: using guessed type int (*dword_4A49B4)(void);

//----- (00425AC0) --------------------------------------------------------
int __stdcall CServerDialog::OnWndMsg(HWND__ *hWnd, unsigned int message, unsigned int wParam, int lParam)
{
  return 0;
}

//----- (00425AC5) --------------------------------------------------------
int _E23_10()
{
  _E19_4();
  return _E22_3();
}

//----- (00425ACF) --------------------------------------------------------
void _E19_4()
{
  CServerDialog::ms_sLog._m_pStr = 0;
  ZXString<char>::Assign(&CServerDialog::ms_sLog, &sLog, -1);
}

//----- (00425AE8) --------------------------------------------------------
int _E22_3()
{
  return atexit(_E20_2);
}

//----- (00425B0F) --------------------------------------------------------
CServerDialog *__thiscall CServerDialog::`scalar deleting destructor'(CServerDialog *this, unsigned int __flags)
{
  CServerDialog *v2; // esi@1

  v2 = this;
  CServerDialog::~CServerDialog(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00425B2F) --------------------------------------------------------
void __thiscall CServerDialog::~CServerDialog(CServerDialog *this)
{
  CServerDialog *v1; // esi@1
  HWND__ *v2; // eax@1

  v1 = this;
  v2 = this->m_hWnd;
  this->vfptr = (CServerDialogVtbl *)&CServerDialog::`vftable';
  if ( v2 )
  {
    DestroyWindow(v2);
    v1->m_hWnd = 0;
  }
  if ( v1->m_hIcon )
  {
    DestroyIcon(v1->m_hIcon);
    v1->m_hIcon = 0;
  }
  TSingleton<CServerDialog>::ms_pInstance = 0;
}
// 4439DC: using guessed type int (__thiscall *CServerDialog::`vftable')(void *p, unsigned int __flags);
// 4A428C: using guessed type int TSingleton<CServerDialog>::ms_pInstance;

//----- (00425B65) --------------------------------------------------------
#error "425CCB: positive sp value has been found (funcsize=118)"

//----- (00425CCE) --------------------------------------------------------
#error "425D7D: positive sp value has been found (funcsize=62)"

//----- (00425D80) --------------------------------------------------------
void __thiscall CServerDialog::Destroy(CServerDialog *this)
{
  CServerDialog *v1; // esi@1

  v1 = this;
  if ( this->m_hWnd )
  {
    DestroyWindow(this->m_hWnd);
    v1->m_hWnd = 0;
  }
}

//----- (00425D97) --------------------------------------------------------
void __thiscall CServerDialog::OnTimer(CServerDialog *this)
{
  CServerDialog *v1; // esi@1
  _SYSTEMTIME st; // [sp+4h] [bp-10h]@2

  v1 = this;
  ((void (*)(void))this->vfptr->UpdateConnection)();
  if ( dword_4A49B4() - v1->m_tLastTimeLog > 0x927C0 )
  {
    GetLocalTime(&st);
    LogReport(aDDD02d02d02d, st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond);
    v1->m_tLastTimeLog = dword_4A49B4();
  }
}
// 4A49B4: using guessed type int (*dword_4A49B4)(void);

//----- (00425DF6) --------------------------------------------------------
void __cdecl CServerDialog::Log(const char *sLog)
{
  int v1; // eax@1
  int v2; // esi@2
  DWORD v3; // ebx@2
  DWORD v4; // eax@2
  HWND v5; // [sp-10h] [bp-28h]@2

  EnterCriticalSection(&CServerDialog::ms_lockLog);
  v1 = strlen(sLog);
  ZXString<char>::_Cat(&CServerDialog::ms_sLog, sLog, v1);
  LeaveCriticalSection(&CServerDialog::ms_lockLog);
  if ( TSingleton<CServerDialog>::ms_pInstance )
  {
    v2 = TSingleton<CServerDialog>::ms_pInstance;
    v3 = GetWindowThreadProcessId(*(HWND *)(TSingleton<CServerDialog>::ms_pInstance + 4), 0);
    v4 = GetCurrentThreadId();
    v5 = *(HWND *)(v2 + 8);
    if ( v4 == v3 )
      SendMessageA(v5, 0x4FFu, 0, 0);
    else
      PostMessageA(v5, 0x4FFu, 0, 0);
  }
}
// 4A428C: using guessed type int TSingleton<CServerDialog>::ms_pInstance;

//----- (00425E7F) --------------------------------------------------------
int __stdcall CServerDialog::DlgProc(HWND__ *hWnd, unsigned int message, unsigned int wParam, int lParam)
{
  int v4; // esi@1

  v4 = TSingleton<CServerDialog>::ms_pInstance;
  if ( message == 2 )
  {
    PostQuitMessage(0);
    return 1;
  }
  if ( message == 16 )
  {
    (*(void (__thiscall **)(int))(*(_DWORD *)TSingleton<CServerDialog>::ms_pInstance + 8))(TSingleton<CServerDialog>::ms_pInstance);
    return 1;
  }
  if ( message == 272 )
  {
    (*(void (__thiscall **)(int, HWND__ *))(*(_DWORD *)TSingleton<CServerDialog>::ms_pInstance + 12))(
      TSingleton<CServerDialog>::ms_pInstance,
      hWnd);
    return 1;
  }
  if ( message == 274 )
  {
    if ( wParam == 61536 && MessageBoxA(hWnd, Text, Caption, 0x134u) != 6 )
      return 1;
    return (*(int (__thiscall **)(int, HWND__ *, unsigned int, unsigned int, int))(*(_DWORD *)v4 + 24))(
             v4,
             hWnd,
             message,
             wParam,
             lParam);
  }
  if ( message != 275 )
    return (*(int (__thiscall **)(int, HWND__ *, unsigned int, unsigned int, int))(*(_DWORD *)v4 + 24))(
             v4,
             hWnd,
             message,
             wParam,
             lParam);
  (*(void (__thiscall **)(int))(*(_DWORD *)TSingleton<CServerDialog>::ms_pInstance + 20))(TSingleton<CServerDialog>::ms_pInstance);
  return 1;
}
// 4A428C: using guessed type int TSingleton<CServerDialog>::ms_pInstance;

//----- (00425F0C) --------------------------------------------------------
int __stdcall CServerDialog::LogEditProc(HWND__ *hWnd, unsigned int message, unsigned int wParam, int lParam)
{
  int result; // eax@2
  HWND__ *v5; // ebx@3
  int v6; // eax@3
  HWND hWnda; // [sp+14h] [bp+8h]@4
  unsigned int v8; // [sp+18h] [bp+Ch]@4

  if ( message == 1279 )
  {
    v5 = hWnd;
    v6 = GetWindowTextLengthA(hWnd);
    if ( v6 > 25000 )
    {
      v8 = (unsigned int)(v6 - 20905) >> 12;
      hWnda = (HWND)(-4096 * v8 + v6);
      do
      {
        SendMessageA(v5, 0xB1u, 0, 4096);
        SendMessageA(v5, 0xC2u, 0, (LPARAM)&sLog);
        --v8;
      }
      while ( v8 );
      v6 = (int)hWnda;
    }
    SendMessageA(v5, 0xB1u, v6, -1);
    EnterCriticalSection(&CServerDialog::ms_lockLog);
    SendMessageA(v5, 0xC2u, 0, (LPARAM)CServerDialog::ms_sLog._m_pStr);
    ZXString<char>::Assign(&CServerDialog::ms_sLog, &sLog, -1);
    LeaveCriticalSection(&CServerDialog::ms_lockLog);
    result = 0;
  }
  else
  {
    result = CServerDialog::ms_editProcOld(hWnd, message, wParam, lParam);
  }
  return result;
}
// 4A4558: using guessed type int (__stdcall *CServerDialog::ms_editProcOld)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00425FEE) --------------------------------------------------------
void TSingleton<CServerDialog>::~TSingleton<CServerDialog>()
{
  TSingleton<CServerDialog>::ms_pInstance = 0;
}
// 4A428C: using guessed type int TSingleton<CServerDialog>::ms_pInstance;

//----- (00425FF6) --------------------------------------------------------
void _E29_14()
{
  _E27_9();
  _E28_11();
}

//----- (00426000) --------------------------------------------------------
void _E27_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0042603B) --------------------------------------------------------
void _E28_11()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00426076) --------------------------------------------------------
void _E46_2()
{
  _E39_8();
  _E40_6();
  _E41_6();
  _E42_5();
  _E43_2();
  _E44_2();
  _E45_2();
}

//----- (00426099) --------------------------------------------------------
void _E39_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004260D4) --------------------------------------------------------
void _E40_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0042610F) --------------------------------------------------------
void _E41_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0042614A) --------------------------------------------------------
void _E42_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00426185) --------------------------------------------------------
void _E43_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004261C0) --------------------------------------------------------
void _E44_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004261FB) --------------------------------------------------------
void _E45_2()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00426236) --------------------------------------------------------
int __cdecl PcInitialize(const unsigned __int16 *sPCOMModule)
{
  const unsigned __int16 *v1; // ebx@1
  void *v2; // esp@3
  HMODULE v3; // eax@3
  HMODULE v4; // edi@3
  int (*v6)(void); // eax@7
  int v7; // ebx@8
  int v8; // [sp+0h] [bp-Ch]@3

  v1 = sPCOMModule;
  if ( !sPCOMModule )
    v1 = aPcom_dll;
  v2 = alloca(dword_4A477C(0, 0, v1, -1, 0, 0, 0, 0));
  dword_4A477C(0, 0, v1, -1, &v8, 0x3FFFFFFF, 0, 0);
  v3 = LoadLibraryA((LPCSTR)&v8);
  v4 = v3;
  if ( !v3 )
    return -2147221000;
  if ( !LoadProc(v3) )
  {
    PcUninitialize();
    return -2147220999;
  }
  v6 = (int (*)(void))GetProcAddress(v4, aPcinitmodule);
  if ( !v6 )
  {
    v7 = -2147220999;
LABEL_10:
    FreeLibrary(v4);
    return v7;
  }
  v7 = v6();
  if ( v7 < 0 )
    goto LABEL_10;
  InterlockedIncrement(&_g_nPCOMModuleRef);
  _g_hPCOMModule = v4;
  return 0;
}
// 49A30C: using guessed type wchar_t aPcom_dll[9];
// 4A477C: using guessed type int (__stdcall *dword_4A477C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (004262E9) --------------------------------------------------------
int __cdecl LoadProc(HINSTANCE__ *hLib)
{
  HMODULE *v1; // eax@1

  _g_apfnPCOMAPIs = (int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD))GetProcAddress(hLib, aPccreateobject);
  dword_4A4C58 = (int)GetProcAddress(hLib, aPcfreeunusedli);
  dword_4A4C5C = (int)GetProcAddress(hLib, aPcserializeobj);
  dword_4A4C60 = (int)GetProcAddress(hLib, aPcserializestr);
  dword_4A4C64 = (int (__cdecl *)(_DWORD, _DWORD))GetProcAddress(hLib, aPcrootnamespac);
  v1 = (HMODULE *)&_g_apfnPCOMAPIs;
  while ( *v1 )
  {
    ++v1;
    if ( v1 >= &_g_hPCOMModule )
      return 1;
  }
  return 0;
}
// 4A4C54: using guessed type int (__cdecl *_g_apfnPCOMAPIs)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4A4C58: using guessed type int dword_4A4C58;
// 4A4C5C: using guessed type int dword_4A4C5C;
// 4A4C60: using guessed type int dword_4A4C60;
// 4A4C64: using guessed type int (__cdecl *dword_4A4C64)(_DWORD, _DWORD);

//----- (00426353) --------------------------------------------------------
void __cdecl PcUninitialize()
{
  void (*v0)(void); // eax@2

  if ( !InterlockedDecrement(&_g_nPCOMModuleRef) )
  {
    v0 = (void (*)(void))GetProcAddress(_g_hPCOMModule, aPctermmodule);
    if ( v0 )
      v0();
    FreeLibrary(_g_hPCOMModule);
    _g_hPCOMModule = 0;
  }
}

//----- (0042638D) --------------------------------------------------------
int _E12_10()
{
  _E9_0();
  return _E11_7();
}

//----- (00426397) --------------------------------------------------------
void _E9_0()
{
  `anonymous namespace'::ZAPILoader::ZAPILoader(&`anonymous namespace'::_s_zapiloader);
}

//----- (004263A1) --------------------------------------------------------
void __thiscall `anonymous namespace'::ZAPILoader::ZAPILoader(ZAPILoader *this)
{
  ZAPILoader *v1; // esi@1

  v1 = this;
  `anonymous namespace'::ZAPILoader::MakeRawKey(0xBAADF00DBAADF00Dui64, &this->m_rawkey);
  LODWORD(v1->m_sr) = 0;
  HIDWORD(v1->m_sr) = 0;
  v1->m_uLastRemnant = 0;
  v1->m_uXorChain = 1;
  v1->m_uXorChainSize = 1;
  `anonymous namespace'::ZAPILoader::LoadLibraries(v1);
  `anonymous namespace'::ZAPILoader::LoadAPI(v1);
}

//----- (004263E9) --------------------------------------------------------
void __thiscall `anonymous namespace'::ZAPILoader::LoadLibraries(ZAPILoader *this)
{
  ZAPILoader *v1; // esi@1
  signed int v2; // edi@1
  signed int v3; // ebx@1

  v1 = this;
  v2 = (char *)`anonymous namespace'::s_asDllName - (char *)this;
  v3 = 9;
  do
  {
    v1->m_ahDll[0] = LoadLibraryA(*(LPCSTR *)((char *)v1->m_ahDll + v2));
    v1 = (ZAPILoader *)((char *)v1 + 4);
    --v3;
  }
  while ( v3 );
}
// 499284: using guessed type char *`anonymous namespace'::s_asDllName[9];

//----- (0042640D) --------------------------------------------------------
#error "42652C: positive sp value has been found (funcsize=89)"

//----- (0042652D) --------------------------------------------------------
int _E11_7()
{
  return atexit(_E10_0);
}

//----- (00426539) --------------------------------------------------------
void __cdecl _E10_0()
{
  unsigned int v0; // esi@1

  v0 = 0;
  do
  {
    FreeLibrary(`anonymous namespace'::_s_zapiloader.m_ahDll[v0]);
    ++v0;
  }
  while ( v0 < 9 );
}

//----- (00426552) --------------------------------------------------------
void __stdcall `anonymous namespace'::ZAPILoader::MakeRawKey(unsigned __int64 key, ZAPILoader::RAWKEY *rawkey)
{
  int v3; // eax@1
  int v4; // ebx@1
  int v5; // edx@1
  unsigned int v6; // eax@1
  unsigned int v7; // ebx@1
  unsigned int v8; // edx@1
  unsigned int v9; // ebx@1
  int v10; // edx@1
  unsigned int v11; // edx@1
  unsigned int v12; // ebx@2
  unsigned int v13; // edx@2
  unsigned int v14; // eax@3
  unsigned int v15; // edx@3
  unsigned int v16; // ecx@5
  int v17; // eax@5
  bool v18; // zf@5
  signed int v19; // [sp+18h] [bp-4h]@1
  ZAPILoader::RAWKEY *pdw; // [sp+28h] [bp+Ch]@1
  int ki; // [sp+2Ch] [bp+10h]@1

  v3 = key & 0xF0F0F0F ^ (HIDWORD(key) >> 4) & 0xF0F0F0F;
  v4 = v3 ^ key;
  v5 = 16 * v3 ^ HIDWORD(key);
  v6 = v5 & 0x1010101 ^ ((v3 ^ (unsigned int)key) >> 4) & 0x1010101;
  v7 = (16 * v6 ^ v4) & 0x550055 ^ ((16 * v6 ^ v4) >> 9) & 0x550055 ^ (((16 * v6 ^ v4) & 0x550055 ^ ((16 * v6 ^ v4) >> 9) & 0x550055) << 9) ^ 16 * v6 ^ v4;
  v8 = (v6 ^ v5) & 0x550055 ^ ((v6 ^ v5) >> 9) & 0x550055 ^ (((v6 ^ v5) & 0x550055 ^ ((v6 ^ v5) >> 9) & 0x550055) << 9) ^ v6 ^ v5;
  v9 = v7 & 0x3333 ^ (v7 >> 18) & 0x3333 ^ ((v7 & 0x3333 ^ (v7 >> 18) & 0x3333) << 18) ^ v7;
  v10 = v8 & 0x3333 ^ (v8 >> 18) & 0x3333 ^ ((v8 & 0x3333 ^ (v8 >> 18) & 0x3333) << 18) ^ v8;
  v19 = 16;
  v11 = (unsigned __int8)v10 ^ BYTE2(v10) ^ (((unsigned __int8)v10 ^ BYTE2(v10)) << 16) ^ v10;
  pdw = rawkey;
  ki = 1;
  do
  {
    v12 = v9 & 0xFFFFFFF;
    v13 = v11 & 0xFFFFFFF;
    if ( ki & 0x7EFC )
    {
      v9 = (v12 << 26) | (v12 >> 2);
      v14 = v13 << 26;
      v15 = v13 >> 2;
    }
    else
    {
      v9 = (v12 << 27) | (v12 >> 1);
      v14 = v13 << 27;
      v15 = v13 >> 1;
    }
    v11 = v14 | v15;
    v16 = ``anonymous namespace'::ZAPILoader::MakeRawKey'::`2'::s_aadwp2[v9 & 0x3F] | dword_443AF8[((unsigned int)BYTE1(v9) >> 1) & 0x3F] | dword_443BF8[(v9 >> 16) & 0x1D | (((v9 >> 16) & 0x40 | ((unsigned int)(unsigned __int8)(v9 >> 16) >> 5) & 4) >> 1)] | dword_443CF8[(v9 >> 24) & 0xE | ((((unsigned int)BYTE1(v9) >> 5) | v9 & 0xC0) >> 2)];
    v17 = dword_443FF8[(v11 >> 16) & 0x3F] | dword_443DF8[v11 & 0x3F] | dword_443EF8[BYTE1(v11) & 0x3D | ((unsigned int)BYTE1(v11) >> 6) & 2] | dword_4440F8[(v11 >> 24) & 0xD | (((v11 >> 16) & 0xC0 | ((unsigned int)(unsigned __int8)v11 >> 4) & 8) >> 2)];
    pdw->adw[0] = (unsigned __int16)v16 | (v17 << 16);
    ki *= 2;
    pdw->adw[1] = (v16 >> 16) | v17 & 0xFFFF0000;
    v18 = v19-- == 1;
    pdw = (ZAPILoader::RAWKEY *)((char *)pdw + 8);
  }
  while ( !v18 );
}
// 4439F8: using guessed type int ``anonymous namespace'::ZAPILoader::MakeRawKey'::`2'::s_aadwp2[];
// 443AF8: using guessed type int dword_443AF8[];
// 443BF8: using guessed type int dword_443BF8[];
// 443CF8: using guessed type int dword_443CF8[];
// 443DF8: using guessed type int dword_443DF8[];
// 443EF8: using guessed type int dword_443EF8[];
// 443FF8: using guessed type int dword_443FF8[];
// 4440F8: using guessed type int dword_4440F8[];

//----- (00426778) --------------------------------------------------------
unsigned int __thiscall `anonymous namespace'::ZAPILoader::DecodePackage(ZAPILoader *this, const void *raw_pSrc, unsigned int *pibot, void *raw_pDst)
{
  unsigned int *v4; // edi@1
  const char *v5; // ST04_4@1
  ZAPILoader *v6; // ebx@1
  int v7; // esi@1

  v4 = pibot;
  v5 = (char *)raw_pSrc + *pibot;
  v6 = this;
  v7 = (int)(v5 + 1);
  `anonymous namespace'::ZAPILoader::_Decode(this, (char *)&raw_pSrc + 3, v5, 1u);
  `anonymous namespace'::ZAPILoader::_Decode(v6, (char *)&pibot + 3, (const char *)v7, 1u);
  `anonymous namespace'::ZAPILoader::_Decode(v6, (char *)raw_pDst, (const char *)(v7 + 1), BYTE3(pibot));
  *v4 += BYTE3(pibot) + 2;
  return BYTE3(raw_pSrc);
}

//----- (004267CB) --------------------------------------------------------
void __thiscall `anonymous namespace'::ZAPILoader::_Decode(ZAPILoader *this, char *pDst, const char *pSrc, unsigned int uLen)
{
  ZAPILoader *v4; // edi@1
  unsigned int v5; // ecx@1
  unsigned __int64 *v6; // esi@1
  unsigned int v7; // ebx@2
  char *v8; // eax@5
  char v9; // cl@6
  char v10; // bl@6
  char *v11; // ecx@6
  bool v12; // zf@6
  int v13; // ecx@9
  int v14; // eax@9
  unsigned int v15; // eax@12
  int v16; // edx@12
  int v17; // ecx@12
  unsigned int v18; // ebx@12
  int v19; // edx@18
  int v20; // ecx@21
  unsigned int v21; // ecx@25
  int v22; // ecx@26
  unsigned int v23; // edx@26
  char v24; // al@27
  char v25; // bl@27
  char *v26; // eax@27
  unsigned int sr; // [sp+Ch] [bp-20h]@12
  unsigned __int64 v28; // [sp+1Ch] [bp-10h]@18
  unsigned int uLR; // [sp+24h] [bp-8h]@5
  unsigned int uLRa; // [sp+24h] [bp-8h]@12
  unsigned int uXorChain; // [sp+28h] [bp-4h]@5
  unsigned int uXorChaina; // [sp+28h] [bp-4h]@12

  v4 = this;
  v5 = this->m_uLastRemnant;
  v6 = &v4->m_sr;
  if ( !v5 )
    goto LABEL_32;
  v7 = 8 - v5;
  if ( 8 - v5 > uLen )
    v7 = uLen;
  if ( v7 )
  {
    v8 = (char *)v6 + v5;
    uXorChain = v7;
    uLR = v7 + v5;
    do
    {
      v9 = *pSrc++;
      v8[(char *)&v4->m_lastRemnant - (char *)v6] = v9;
      v10 = v9 ^ *v8;
      v11 = pDst++;
      --uLen;
      ++v8;
      v12 = uXorChain-- == 1;
      *v11 = v10;
    }
    while ( !v12 );
    v5 = uLR;
  }
  if ( v5 == 8 )
  {
    v13 = v4->m_lastRemnant;
    v4->m_uLastRemnant = 0;
    v14 = HIDWORD(v4->m_lastRemnant);
    *(_DWORD *)v6 = v13;
    HIDWORD(v4->m_sr) = v14;
  }
  else
  {
    v4->m_uLastRemnant = v5;
  }
  if ( uLen )
  {
LABEL_32:
    v15 = v4->m_uXorChainSize;
    uXorChaina = v4->m_uXorChain;
    v16 = 0;
    v17 = 0;
    sr = *(_DWORD *)v6;
    v18 = HIDWORD(v4->m_sr);
    uLRa = v4->m_uXorChainSize;
    if ( uLen )
    {
      while ( 1 )
      {
        if ( v15 != 1 )
        {
          if ( --uXorChaina )
          {
            v28 = (__PAIR__(v18, sr) << 7) | (v18 >> 25);
            goto LABEL_20;
          }
          uXorChaina = v15;
        }
        LODWORD(v28) = `anonymous namespace'::ZAPILoader::Decode(__PAIR__(v18, sr), &v4->m_rawkey);
        HIDWORD(v28) = v19;
LABEL_20:
        if ( uLen < 8
          || (v18 = *((_DWORD *)pSrc + 1),
              sr = *(_DWORD *)pSrc,
              v20 = v28 ^ *(_DWORD *)pSrc,
              pSrc += 8,
              *(_DWORD *)pDst = v20,
              *((_DWORD *)pDst + 1) = HIDWORD(v28) ^ v18,
              v12 = uLen == 8,
              uLen -= 8,
              pDst += 8,
              v12) )
        {
          v16 = HIDWORD(v28);
          v17 = v28;
          break;
        }
        v15 = uLRa;
      }
    }
    v4->m_uXorChain = uXorChaina;
    if ( uLen )
    {
      *(_DWORD *)v6 = v17;
      v21 = 0;
      HIDWORD(v4->m_sr) = v16;
      if ( uLen )
      {
        v22 = (char *)&v4->m_lastRemnant - (char *)v6;
        v23 = uLen;
        do
        {
          v24 = *pSrc++;
          *((_BYTE *)v6 + v22) = v24;
          v25 = v24 ^ *(_BYTE *)v6;
          v26 = pDst++;
          v6 = (unsigned __int64 *)((char *)v6 + 1);
          --v23;
          *v26 = v25;
        }
        while ( v23 );
        v21 = uLen;
      }
      v4->m_uLastRemnant = v21;
    }
    else
    {
      *(_DWORD *)v6 = sr;
      HIDWORD(v4->m_sr) = v18;
    }
  }
}

//----- (00426971) --------------------------------------------------------
int __stdcall `anonymous namespace'::ZAPILoader::Decode(unsigned __int64 b, ZAPILoader::RAWKEY *rawkey)
{
  ZAPILoader::RAWKEY *v3; // ebp@1
  unsigned __int32 v4; // eax@1
  int v5; // ecx@1
  int v6; // edi@1
  unsigned __int32 v7; // eax@1
  unsigned int v8; // ecx@1
  int v9; // edi@1
  unsigned __int32 v10; // eax@1
  int v11; // ecx@1
  int v12; // edi@1
  unsigned __int32 v13; // eax@1
  unsigned int v14; // ecx@1
  int v15; // edi@1
  unsigned __int32 v16; // eax@1
  int v17; // esi@1
  unsigned __int32 v18; // esi@1
  unsigned int v19; // ebx@2
  unsigned int *v20; // ebp@2
  unsigned __int32 v21; // eax@2
  int v22; // ecx@2
  int v23; // eax@2
  unsigned int v24; // ebx@2
  unsigned int v25; // ebx@2
  unsigned __int32 v26; // eax@2
  unsigned __int32 v27; // edi@3
  unsigned __int32 v28; // eax@3
  int v29; // ecx@3
  int v30; // edi@3
  unsigned __int32 v31; // eax@3
  unsigned int v32; // ecx@3
  int v33; // edi@3
  unsigned __int32 v34; // eax@3
  int v35; // ecx@3
  int v36; // edi@3
  unsigned __int32 v37; // eax@3
  unsigned int v38; // ecx@3
  int v39; // edi@3
  unsigned __int32 v40; // eax@3
  int v41; // esi@3
  signed int ba; // [sp+14h] [bp+4h]@1
  unsigned __int32 rawkeya; // [sp+1Ch] [bp+Ch]@1

  v3 = rawkey;
  v4 = _lrotr(HIDWORD(b), 4);
  v5 = (v4 ^ b) & 0xF0F0F0F;
  v6 = v5 ^ b;
  v7 = _lrotr(v4 ^ v5, 12);
  v8 = (v7 ^ v6) & 0xFFFF0000;
  v9 = v8 ^ v6;
  v10 = _lrotr(v7 ^ v8, 18);
  v11 = (v10 ^ v9) & 0x33333333;
  v12 = v11 ^ v9;
  v13 = _lrotr(v10 ^ v11, 22);
  v14 = (v13 ^ v12) & 0xFF00FF00;
  v15 = v14 ^ v12;
  v16 = _lrotr(v13 ^ v14, 9);
  v17 = (v16 ^ v15) & 0x55555555;
  rawkeya = _lrotl(v16 ^ v17, 2);
  v18 = _lrotl(v15 ^ v17, 1);
  ba = 8;
  do
  {
    v19 = (v18 ^ v3->adw[0]) & 0x3F3F3F3F;
    v20 = &v3->adw[1];
    v21 = *v20 ^ _lrotr(v18, 4);
    ++v20;
    v21 &= 0x3F3F3F3Fu;
    v22 = dword_4442F8[(unsigned __int8)v21] | dword_4443F8[BYTE1(v19)] | dword_4445F8[(unsigned __int8)(v19 >> 16)] | dword_4447F8[v19 >> 24] | dword_4444F8[BYTE1(v21)] | dword_4446F8[(unsigned __int8)(v21 >> 16)] | dword_4448F8[v21 >> 24];
    v23 = (unsigned __int8)v19;
    v24 = *v20;
    ++v20;
    rawkeya ^= ``anonymous namespace'::ZAPILoader::_GetS'::`2'::s_aadw[v23] | v22;
    v25 = (rawkeya ^ v24) & 0x3F3F3F3F;
    v26 = (*v20 ^ _lrotr(rawkeya, 4)) & 0x3F3F3F3F;
    v3 = (ZAPILoader::RAWKEY *)(v20 + 1);
    v18 ^= ``anonymous namespace'::ZAPILoader::_GetS'::`2'::s_aadw[(unsigned __int8)v25] | dword_4442F8[(unsigned __int8)v26] | dword_4443F8[BYTE1(v25)] | dword_4445F8[(unsigned __int8)(v25 >> 16)] | dword_4447F8[v25 >> 24] | dword_4444F8[BYTE1(v26)] | dword_4446F8[(unsigned __int8)(v26 >> 16)] | dword_4448F8[v26 >> 24];
    --ba;
  }
  while ( ba );
  v27 = _lrotr(rawkeya, 1);
  v28 = _lrotr(v18, 2);
  v29 = (v27 ^ v28) & 0x55555555;
  v30 = v29 ^ v27;
  v31 = _lrotl(v28 ^ v29, 9);
  v32 = (v30 ^ v31) & 0xFF00FF00;
  v33 = v32 ^ v30;
  v34 = _lrotl(v31 ^ v32, 22);
  v35 = (v33 ^ v34) & 0x33333333;
  v36 = v35 ^ v33;
  v37 = _lrotl(v34 ^ v35, 18);
  v38 = (v36 ^ v37) & 0xFFFF0000;
  v39 = v38 ^ v36;
  v40 = _lrotl(v37 ^ v38, 12);
  v41 = (v39 ^ v40) & 0xF0F0F0F;
  _lrotl(v40 ^ v41, 4);
  return v39 ^ v41;
}
// 4441F8: using guessed type int ``anonymous namespace'::ZAPILoader::_GetS'::`2'::s_aadw[];
// 4442F8: using guessed type int dword_4442F8[];
// 4443F8: using guessed type int dword_4443F8[];
// 4444F8: using guessed type int dword_4444F8[];
// 4445F8: using guessed type int dword_4445F8[];
// 4446F8: using guessed type int dword_4446F8[];
// 4447F8: using guessed type int dword_4447F8[];
// 4448F8: using guessed type int dword_4448F8[];

//----- (00426BCF) --------------------------------------------------------
int __cdecl _ZAPIInfo::GetModuleHandleCount()
{
  return 9;
}

//----- (00426BD3) --------------------------------------------------------
HINSTANCE__ **__cdecl _ZAPIInfo::GetModuleHandles()
{
  return (HINSTANCE__ **)&`anonymous namespace'::_s_zapiloader;
}

//----- (00426BD9) --------------------------------------------------------
int __cdecl _ZAPIInfo::GetAPIFunctionCount()
{
  return 255;
}

//----- (00426BDF) --------------------------------------------------------
int (__stdcall **__cdecl _ZAPIInfo::GetAPIFunctions())()
{
  return (int (__stdcall **)())&ZAPI;
}

//----- (00426BE5) --------------------------------------------------------
int _E18_5()
{
  _E14_6();
  return _E17_4();
}

//----- (00426BEF) --------------------------------------------------------
void _E14_6()
{
  ZAllocEx<ZAllocAnonSelector>::ZAllocEx<ZAllocAnonSelector>(&ZAllocEx<ZAllocAnonSelector>::_s_alloc);
}

//----- (00426BF9) --------------------------------------------------------
int _E17_4()
{
  return atexit(_E15_1);
}

//----- (00426C20) --------------------------------------------------------
int _E24_13()
{
  _E21_2();
  return _E23_11();
}

//----- (00426C2A) --------------------------------------------------------
void _E21_2()
{
  ZAllocEx<ZAllocStrSelector<char>>::ZAllocEx<ZAllocStrSelector<char>>(&ZAllocEx<ZAllocStrSelector<char>>::_s_alloc);
}

//----- (00426C34) --------------------------------------------------------
int _E23_11()
{
  return atexit(_E22_4);
}

//----- (00426C5B) --------------------------------------------------------
int _E31_10()
{
  _E28_12();
  return _E30_14();
}

//----- (00426C65) --------------------------------------------------------
void _E28_12()
{
  ZAllocEx<ZAllocStrSelector<unsigned short>>::ZAllocEx<ZAllocStrSelector<unsigned short>>(&ZAllocEx<ZAllocStrSelector<unsigned short>>::_s_alloc);
}

//----- (00426C6F) --------------------------------------------------------
int _E30_14()
{
  return atexit(_E29_15);
}

//----- (00426C96) --------------------------------------------------------
int _E36_10()
{
  _E33_7();
  return _E35_11();
}

//----- (00426CA0) --------------------------------------------------------
void _E33_7()
{
  ZRecyclableStatic::_s_sStatic.m_pHead = 0;
}

//----- (00426CA8) --------------------------------------------------------
int _E35_11()
{
  return atexit(_E34_9);
}

//----- (00426CCF) --------------------------------------------------------
int _E41_7()
{
  _E38_6();
  return _E40_7();
}

//----- (00426CD9) --------------------------------------------------------
void _E38_6()
{
  ZExceptionHandler::ZExceptionHandler(&_g_zeh);
}

//----- (00426CE3) --------------------------------------------------------
int _E40_7()
{
  return atexit(_E39_9);
}

//----- (00426CEF) --------------------------------------------------------
void __cdecl _E39_9()
{
  ZExceptionHandler::~ZExceptionHandler(&_g_zeh);
}

//----- (00426CF9) --------------------------------------------------------
int _E46_3()
{
  _E43_3();
  return _E45_3();
}

//----- (00426D03) --------------------------------------------------------
void _E43_3()
{
  Ztl_variant_t::Ztl_variant_t(&vtEmpty);
}

//----- (00426D0D) --------------------------------------------------------
int _E45_3()
{
  return atexit(_E44_3);
}

//----- (00426D19) --------------------------------------------------------
void __cdecl _E44_3()
{
  Ztl_variant_t::~Ztl_variant_t(&vtEmpty);
}

//----- (00426D23) --------------------------------------------------------
int _E51_3()
{
  _E48_2();
  return _E50_3();
}

//----- (00426D2D) --------------------------------------------------------
void _E48_2()
{
  ZSocketBase::_ZSocketInit::_ZSocketInit((ZSocketBase::_ZSocketInit *)&ZSocketBase::_s_init);
}

//----- (00426D37) --------------------------------------------------------
int _E50_3()
{
  return atexit(_E49_4);
}

//----- (00426D43) --------------------------------------------------------
void __cdecl _E49_4()
{
  if ( !(_S16_2 & 0x10) )
  {
    _S16_2 |= 0x10u;
    ZSocketBase::_ZSocketInit::~_ZSocketInit((ZSocketBase::_ZSocketInit *)&ZSocketBase::_s_init);
  }
}

//----- (00426D5E) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocAnonSelector>::ZAllocEx<ZAllocAnonSelector>(ZAllocEx<ZAllocAnonSelector> *this)
{
  ZAllocEx<ZAllocAnonSelector> *v1; // esi@1

  v1 = this;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  memset(v1->m_apBuff, 0, 0x10u);
  memset(v1->m_apBlockHead, 0, 0x10u);
}

//----- (00426D8C) --------------------------------------------------------
void __thiscall ZRecyclableStatic::~ZRecyclableStatic(ZRecyclableStatic *this)
{
  ZRecyclableStatic::CallBack *v1; // esi@1
  ZRecyclableStatic::CallBack *v2; // ecx@3
  bool v3; // zf@3

  v1 = this->m_pHead;
  while ( v1 )
  {
    v2 = v1;
    v3 = v1 == 0;
    v1 = v1->m_pNext;
    if ( !v3 )
      ((void (__stdcall *)(_DWORD))v2->vfptr->__vecDelDtor)(1);
  }
}

//----- (00426DA6) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocStrSelector<char>>::ZAllocEx<ZAllocStrSelector<char>>(ZAllocEx<ZAllocStrSelector<char> > *this)
{
  ZAllocEx<ZAllocStrSelector<char> > *v1; // esi@1

  v1 = this;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  memset(v1->m_apBuff, 0, 0x10u);
  memset(v1->m_apBlockHead, 0, 0x10u);
}

//----- (00426DD4) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocStrSelector<unsigned short>>::ZAllocEx<ZAllocStrSelector<unsigned short>>(ZAllocEx<ZAllocStrSelector<unsigned short> > *this)
{
  ZAllocEx<ZAllocStrSelector<unsigned short> > *v1; // esi@1

  v1 = this;
  InitializeCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
  memset(v1->m_apBuff, 0, 0x10u);
  memset(v1->m_apBlockHead, 0, 0x10u);
}

//----- (00426E02) --------------------------------------------------------
int __usercall ZFatalSection::_TryI@<eax>(void *p@<eax>, int a2@<ecx>)
{
  int v2; // esi@1
  char v4; // [sp+4h] [bp-24h]@1
  unsigned int v5; // [sp+18h] [bp-10h]@1

  v2 = a2;
  dword_4A4788(&v4);
  ZFatalSection::_s_pfnTry = (int (__thiscall *)(_DWORD))ZFatalSection::_TryM;
  if ( v5 <= 1 )
    ZFatalSection::_s_pfnTry = (int (__thiscall *)(_DWORD))ZFatalSection::_TryS;
  return ZFatalSection::_s_pfnTry(v2);
}
// 49A284: using guessed type int (__thiscall *ZFatalSection::_s_pfnTry)(_DWORD);
// 4A4788: using guessed type int (__stdcall *dword_4A4788)(_DWORD);

//----- (00426E3A) --------------------------------------------------------
void *__usercall ZFatalSection::_TryS@<eax>(void *__formal@<eax>, int _ECX@<ecx>)
{
  void *result; // eax@1

  result = 0;
  _EDX = __readfsdword(24);
  __asm { cmpxchg [ecx], edx }
  *(_DWORD *)(_ECX + 4) = 1;
  return result;
}

//----- (00426E5A) --------------------------------------------------------
void *__usercall ZFatalSection::_TryM@<eax>(void *__formal@<eax>, int a2@<ecx>)
{
  void *v2; // edx@1
  void *result; // eax@1

  v2 = (void *)__readfsdword(24);
  result = (void *)_InterlockedCompareExchange((volatile signed __int32 *)a2, (signed __int32)v2, 0);
  if ( result == v2 )
  {
    *(_DWORD *)(a2 + 4) = 1;
  }
  else if ( result == v2 )
  {
    ++*(_DWORD *)(a2 + 4);
    result = 0;
  }
  return result;
}

//----- (00426E7B) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocAnonSelector>::~ZAllocEx<ZAllocAnonSelector>(ZAllocEx<ZAllocAnonSelector> *this)
{
  signed int v1; // edi@1
  void *v2; // esi@2
  void *v3; // eax@3
  ZAllocEx<ZAllocAnonSelector> *v4; // [sp+Ch] [bp-10h]@1

  v4 = this;
  v1 = 0;
  do
  {
    v2 = this->m_apBlockHead[v1];
    if ( v2 )
    {
      do
      {
        v3 = v2;
        v2 = (void *)*((_DWORD *)v2 - 2);
        ZAllocBase::_FreeRawBlocks(v3);
      }
      while ( v2 );
      this = v4;
    }
    ++v1;
  }
  while ( v1 < 4 );
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
}

//----- (00426EF0) --------------------------------------------------------
void __cdecl ZAllocBase::_FreeRawBlocks(void *p)
{
  int v1; // eax@2

  if ( p != (void *)8 )
  {
    v1 = dword_4A46D4(0, (char *)p - 12);
    dword_4A46D0(v1);
  }
}
// 4A46D0: using guessed type int (__stdcall *dword_4A46D0)(_DWORD);
// 4A46D4: using guessed type int (__stdcall *dword_4A46D4)(_DWORD, _DWORD);

//----- (00426F0D) --------------------------------------------------------
#error "426FDA: positive sp value has been found (funcsize=64)"

//----- (00426FDB) --------------------------------------------------------
ZFatalSection *__cdecl construct(ZFatalSection *p)
{
  ZFatalSection *result; // eax@1

  result = p;
  if ( p )
    p->_m_pTIB = 0;
  else
    result = 0;
  return result;
}

//----- (00426FEA) --------------------------------------------------------
void __thiscall ZExceptionHandler::~ZExceptionHandler(ZExceptionHandler *this)
{
  SetUnhandledExceptionFilter(this->m_pPreviousFilter);
}

//----- (00426FF7) --------------------------------------------------------
int __stdcall ZExceptionHandler::RawUnhandledExceptionFilter(_EXCEPTION_POINTERS *pExceptionInfo)
{
  return ZExceptionHandler::UnhandledExceptionFilter(&_g_zeh, pExceptionInfo);
}

//----- (00427008) --------------------------------------------------------
int __thiscall ZExceptionHandler::UnhandledExceptionFilter(ZExceptionHandler *this, _EXCEPTION_POINTERS *pExceptionInfo)
{
  ZFatalSection *v2; // esi@1
  char *v3; // ebp@1
  void (__cdecl *v4)(_DWORD, int *); // eax@4
  int v5; // eax@6
  void (__cdecl *v6)(signed int, int *); // eax@10
  bool v7; // zf@12
  int (__stdcall *v8)(_EXCEPTION_POINTERS *); // ecx@16
  int result; // eax@16
  volatile LONG *i; // [sp+18h] [bp-18h]@1

  v2 = (ZFatalSection *)this;
  v3 = (char *)&this->m_bInFilter;
  for ( i = &this->m_bInFilter; InterlockedExchange(i, 1); i = (volatile LONG *)v3 )
    dword_4A469C(100);
  v4 = (void (__cdecl *)(_DWORD, int *))v2[36]._m_nRef;
  if ( v4 )
    v4(0, &v2[1]._m_nRef);
  ZFatalSection::Lock(v2);
  v5 = dword_4A46FC(&v2[1]._m_nRef, 0x40000000, 0, 0, v2[35]._m_pTIB != 0 ? 2 : 4, 2147483648, 0);
  v2[34]._m_nRef = v5;
  if ( v5 != -1 )
  {
    if ( !v2[35]._m_pTIB )
      dword_4A4710(v5, 0, 0, 2);
    ZExceptionHandler::GenerateExceptionReport((ZExceptionHandler *)v2, pExceptionInfo);
    dword_4A4638(v2[34]._m_nRef);
  }
  v6 = (void (__cdecl *)(signed int, int *))v2[36]._m_nRef;
  v2[34]._m_nRef = 0;
  if ( v6 )
    v6(1, &v2[1]._m_nRef);
  v7 = v2->_m_nRef-- == 1;
  if ( v7 )
    v2->_m_pTIB = 0;
  *(_DWORD *)v3 = 0;
  do
    dword_4A469C(1000);
  while ( *(_DWORD *)v3 );
  v8 = (int (__stdcall *)(_EXCEPTION_POINTERS *))v2[34]._m_pTIB;
  result = 0;
  if ( v8 )
    result = v8(pExceptionInfo);
  if ( v2[35]._m_nRef )
    result = 1;
  return result;
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);
// 4A469C: using guessed type int (__stdcall *dword_4A469C)(_DWORD);
// 4A46FC: using guessed type int (__stdcall *dword_4A46FC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A4710: using guessed type int (__stdcall *dword_4A4710)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004270FB) --------------------------------------------------------
void __thiscall ZFatalSection::Lock(ZFatalSection *this)
{
  ZFatalSection *v1; // esi@1

  v1 = this;
  if ( ZFatalSection::_s_pfnTry(this) )
  {
    while ( ZFatalSection::_s_pfnTry(v1) )
      dword_4A469C(0);
  }
}
// 49A284: using guessed type int (__thiscall *ZFatalSection::_s_pfnTry)(_DWORD);
// 4A469C: using guessed type int (__stdcall *dword_4A469C)(_DWORD);

//----- (00427120) --------------------------------------------------------
#error "427303: positive sp value has been found (funcsize=146)"

//----- (00427306) --------------------------------------------------------
char *__cdecl ZExceptionHandler::GetExceptionString(unsigned int dwCode)
{
  char *result; // eax@10
  int v2; // eax@41

  if ( dwCode <= 0xC000008D )
  {
    if ( dwCode == -1073741683 )
      return aFlt_denormal_o;
    if ( dwCode > 0xC0000006 )
    {
      if ( dwCode == -1073741816 )
        return aInvalid_handle;
      if ( dwCode == -1073741795 )
        return aIllegal_instru;
      if ( dwCode == -1073741787 )
        return aNoncontinuable;
      if ( dwCode == -1073741786 )
        return aInvalid_dispos;
      if ( dwCode == -1073741684 )
        return aArray_bounds_e;
    }
    else
    {
      if ( dwCode == -1073741818 )
        return aIn_page_error;
      if ( dwCode == -2147483647 )
        return aGuard_page;
      if ( dwCode == -2147483646 )
        return aDatatype_misal;
      if ( dwCode == -2147483645 )
        return aBreakpoint;
      if ( dwCode == -2147483644 )
        return aSingle_step;
      if ( dwCode == -1073741819 )
        return aAccess_violati;
    }
    goto LABEL_41;
  }
  if ( dwCode > 0xC00000FD )
  {
    if ( dwCode != -402653183 )
    {
LABEL_41:
      `ZExceptionHandler::GetExceptionString'::`4'::sBuffer = 0;
      v2 = dword_4A4630(aNtdll_dll, dwCode, 0, &`ZExceptionHandler::GetExceptionString'::`4'::sBuffer, 128, 0);
      dword_4A4798(2560, v2);
      return &`ZExceptionHandler::GetExceptionString'::`4'::sBuffer;
    }
    result = aZtl_deadlock;
  }
  else if ( dwCode == -1073741571 )
  {
    result = aStack_overflow;
  }
  else
  {
    switch ( dwCode )
    {
      case 0xC000008E:
        result = aFlt_divide_by_;
        break;
      case 0xC000008F:
        result = aFlt_inexact_re;
        break;
      case 0xC0000090:
        result = aFlt_invalid_op;
        break;
      case 0xC0000091:
        result = aFlt_overflow;
        break;
      case 0xC0000092:
        result = aFlt_stack_chec;
        break;
      case 0xC0000093:
        result = aFlt_underflow;
        break;
      case 0xC0000094:
        result = aInt_divide_by_;
        break;
      case 0xC0000095:
        result = aInt_overflow;
        break;
      case 0xC0000096:
        result = aPriv_instructi;
        break;
      default:
        goto LABEL_41;
    }
  }
  return result;
}
// 4A4630: using guessed type int (__stdcall *dword_4A4630)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A4798: using guessed type int (__stdcall *dword_4A4798)(_DWORD, _DWORD);
// 4A64C0: using guessed type char `ZExceptionHandler::GetExceptionString'::`4'::sBuffer;

//----- (0042747A) --------------------------------------------------------
int __cdecl ZExceptionHandler::GetLogicalAddress(void *pAddr, char *sModule, unsigned int len, unsigned int *dwSection, unsigned int *dwOffset)
{
  char *v5; // edi@2
  int v6; // eax@3
  unsigned int v7; // edx@3
  char *v8; // esi@3
  unsigned int v9; // ebx@3
  int v10; // eax@4
  unsigned int v11; // ecx@5
  unsigned int v12; // edi@5
  int result; // eax@10
  _MEMORY_BASIC_INFORMATION mbi; // [sp+Ch] [bp-1Ch]@1

  if ( dword_4A47A0(pAddr, &mbi, 28)
    && (v5 = (char *)mbi.AllocationBase, dword_4A4634(mbi.AllocationBase, sModule, len))
    && (v6 = *((_DWORD *)v5 + 15),
        v7 = *(_WORD *)&v5[v6 + 6],
        v8 = (char *)((_BYTE *)pAddr - v5),
        v9 = 0,
        *(_WORD *)&v5[v6 + 6]) )
  {
    v10 = (int)(&v5[*(_WORD *)&v5[v6 + 20] + 32] + v6);
    while ( 1 )
    {
      v11 = *(_DWORD *)(v10 + 4);
      v12 = *(_DWORD *)(v10 + 8);
      if ( *(_DWORD *)v10 >= v12 )
        v12 = *(_DWORD *)v10;
      if ( v11 <= (unsigned int)v8 && (unsigned int)v8 <= v11 + v12 )
        break;
      ++v9;
      v10 += 40;
      if ( v9 >= v7 )
        goto LABEL_10;
    }
    *dwSection = v9 + 1;
    *dwOffset = (unsigned int)&v8[-v11];
    result = 1;
  }
  else
  {
LABEL_10:
    result = 0;
  }
  return result;
}
// 4A4634: using guessed type int (__stdcall *dword_4A4634)(_DWORD, _DWORD, _DWORD);
// 4A47A0: using guessed type int (__stdcall *dword_4A47A0)(_DWORD, _DWORD, _DWORD);

//----- (00427507) --------------------------------------------------------
void __thiscall ZExceptionHandler::IntelStackWalk(ZExceptionHandler *this, _CONTEXT *pContext)
{
  void *v2; // esi@1
  unsigned int v3; // ebx@1
  unsigned int v4; // eax@2
  char sModule[260]; // [sp+Ch] [bp-110h]@1
  unsigned int pc; // [sp+110h] [bp-Ch]@2
  ZExceptionHandler *v7; // [sp+114h] [bp-8h]@1
  unsigned int dwSection; // [sp+118h] [bp-4h]@1

  v7 = this;
  ZExceptionHandler::Report(this, aCallStack);
  ZExceptionHandler::Report(v7, aAddressFrameLo);
  v2 = (void *)pContext->Eip;
  v3 = pContext->Ebp;
  sModule[0] = sLog;
  dwSection = 0;
  pContext = 0;
  memset(&sModule[1], 0, 0x100u);
  *(_WORD *)&sModule[257] = 0;
  sModule[259] = 0;
  ZExceptionHandler::GetLogicalAddress(v2, sModule, 0x104u, &dwSection, (unsigned int *)&pContext);
  ZExceptionHandler::Report(v7, a08x08x04x08xS, v2, v3, dwSection, pContext, sModule);
  while ( 1 )
  {
    pc = *(_DWORD *)(v3 + 4);
    v4 = v3;
    v3 = *(_DWORD *)v3;
    if ( v3 & 3 || v3 <= v4 || IsBadWritePtr((LPVOID)v3, 8u) )
      break;
    sModule[0] = sLog;
    dwSection = 0;
    pContext = 0;
    memset(&sModule[1], 0, 0x100u);
    *(_WORD *)&sModule[257] = 0;
    sModule[259] = 0;
    ZExceptionHandler::GetLogicalAddress((void *)pc, sModule, 0x104u, &dwSection, (unsigned int *)&pContext);
    ZExceptionHandler::Report(v7, a08x08x04x08xS, pc, v3, dwSection, pContext, sModule);
  }
}

//----- (0042761E) --------------------------------------------------------
void __thiscall ZExceptionHandler::DbgHelpStackWalk(ZExceptionHandler *this, _CONTEXT *pContext)
{
  ZExceptionHandler *v2; // esi@1
  _CONTEXT *v3; // ebx@1
  unsigned int v4; // ecx@1
  unsigned int v5; // ecx@1
  int v6; // eax@2
  int v7; // eax@2
  int v8; // ST14_4@2
  void *v9; // ST08_4@4
  int v10; // edi@4
  int (__stdcall *v11)(void *, unsigned int, unsigned int *, _IMAGEHLP_LINE *); // eax@5
  char abSymbolBuffer[536]; // [sp+Ch] [bp-3DCh]@4
  char sModule[260]; // [sp+224h] [bp-1C4h]@4
  void *pAddr; // [sp+328h] [bp-C0h]@1
  char v15; // [sp+32Ch] [bp-BCh]@1
  int v16; // [sp+330h] [bp-B8h]@1
  unsigned int v17; // [sp+340h] [bp-A8h]@1
  int v18; // [sp+348h] [bp-A0h]@1
  unsigned int v19; // [sp+34Ch] [bp-9Ch]@1
  int v20; // [sp+354h] [bp-94h]@1
  _IMAGEHLP_LINE il; // [sp+3CCh] [bp-1Ch]@4
  unsigned int dwSection; // [sp+3E0h] [bp-8h]@4
  unsigned int dwOffset; // [sp+3E4h] [bp-4h]@4

  v2 = this;
  ZExceptionHandler::Report(this, aCallStack);
  ZExceptionHandler::Report(v2, aAddressFrame);
  v3 = pContext;
  memset(&v15, 0, 0xA0u);
  v4 = pContext->Esp;
  pAddr = (void *)pContext->Eip;
  v19 = v4;
  v5 = pContext->Ebp;
  v16 = 3;
  v20 = 3;
  v17 = v5;
  v18 = 3;
  while ( 1 )
  {
    v6 = dword_4A4658(&pAddr, v3, 0, v2->_SymFunctionTableAccess, v2->_SymGetModuleBase, 0);
    v7 = dword_4A463C(v6);
    if ( !((int (__stdcall *)(signed int, int, int))v2->_StackWalk)(332, v7, v8) || !v17 )
      break;
    ZExceptionHandler::Report(v2, a08x08x, pAddr, v17);
    sModule[0] = sLog;
    memset(&sModule[1], 0, 0x100u);
    *(_WORD *)&sModule[257] = 0;
    sModule[259] = 0;
    pContext = 0;
    dwSection = 0;
    dwOffset = 0;
    il.SizeOfStruct = 20;
    il.Key = 0;
    il.FileName = 0;
    il.Address = 0;
    il.LineNumber = -1;
    *(_DWORD *)abSymbolBuffer = 24;
    v9 = v2->m_hProcess;
    *(_DWORD *)&abSymbolBuffer[16] = 512;
    v10 = v2->_SymGetSymFromAddr(v9, (unsigned int)pAddr, (unsigned int *)&pContext, (_IMAGEHLP_SYMBOL *)abSymbolBuffer);
    if ( v10 )
    {
      v11 = v2->_SymGetLineFromAddr;
      if ( v11 )
        v11(v2->m_hProcess, (unsigned int)pAddr, (unsigned int *)&pContext, &il);
    }
    ZExceptionHandler::GetLogicalAddress(pAddr, sModule, 0x104u, &dwSection, &dwOffset);
    if ( il.LineNumber == -1 )
    {
      if ( v10 )
        ZExceptionHandler::Report(v2, aHsXS, &abSymbolBuffer[20], pContext, sModule);
      else
        ZExceptionHandler::Report(v2, a04x08xS, dwSection, dwOffset, sModule);
    }
    else
    {
      ZExceptionHandler::Report(v2, aHsHsLuS, &abSymbolBuffer[20], il.FileName, il.LineNumber, sModule);
    }
  }
}
// 4A463C: using guessed type int (__cdecl *dword_4A463C)(_DWORD);
// 4A4658: using guessed type int (__stdcall *dword_4A4658)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0042780C) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocStrSelector<char>>::~ZAllocEx<ZAllocStrSelector<char>>(ZAllocEx<ZAllocStrSelector<char> > *this)
{
  signed int v1; // edi@1
  void *v2; // esi@2
  void *v3; // eax@3
  ZAllocEx<ZAllocStrSelector<char> > *v4; // [sp+Ch] [bp-10h]@1

  v4 = this;
  v1 = 0;
  do
  {
    v2 = this->m_apBlockHead[v1];
    if ( v2 )
    {
      do
      {
        v3 = v2;
        v2 = (void *)*((_DWORD *)v2 - 2);
        ZAllocBase::_FreeRawBlocks(v3);
      }
      while ( v2 );
      this = v4;
    }
    ++v1;
  }
  while ( v1 < 4 );
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
}

//----- (00427881) --------------------------------------------------------
void __thiscall ZAllocEx<ZAllocStrSelector<unsigned short>>::~ZAllocEx<ZAllocStrSelector<unsigned short>>(ZAllocEx<ZAllocStrSelector<unsigned short> > *this)
{
  signed int v1; // edi@1
  void *v2; // esi@2
  void *v3; // eax@3
  ZAllocEx<ZAllocStrSelector<unsigned short> > *v4; // [sp+Ch] [bp-10h]@1

  v4 = this;
  v1 = 0;
  do
  {
    v2 = this->m_apBlockHead[v1];
    if ( v2 )
    {
      do
      {
        v3 = v2;
        v2 = (void *)*((_DWORD *)v2 - 2);
        ZAllocBase::_FreeRawBlocks(v3);
      }
      while ( v2 );
      this = v4;
    }
    ++v1;
  }
  while ( v1 < 4 );
  DeleteCriticalSection((LPCRITICAL_SECTION)&this->m_lock.DebugInfo);
}

//----- (004278F6) --------------------------------------------------------
int ZExceptionHandler::Report(ZExceptionHandler *this, const char *sFormat, ...)
{
  int v2; // esi@1
  char sBuff[1024]; // [sp+4h] [bp-404h]@1
  unsigned int cbWritten; // [sp+404h] [bp-4h]@1
  va_list va; // [sp+418h] [bp+10h]@1

  va_start(va, sFormat);
  v2 = wvsprintfA(sBuff, sFormat, va);
  dword_4A4704(this->m_hReportFile, sBuff, v2, &cbWritten, 0);
  return v2;
}
// 4A4704: using guessed type int (__stdcall *dword_4A4704)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00427938) --------------------------------------------------------
void _E57_5()
{
  _E55_6();
  _E56_6();
}

//----- (00427942) --------------------------------------------------------
void _E55_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0042797D) --------------------------------------------------------
void _E56_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (004279B8) --------------------------------------------------------
void _E73_0()
{
  _E66();
  _E67_0();
  _E68_0();
  _E69_0();
  _E70_0();
  _E71_0();
  _E72_0();
}

//----- (004279DB) --------------------------------------------------------
void _E66()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00427A16) --------------------------------------------------------
void _E67_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00427A51) --------------------------------------------------------
void _E68_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00427A8C) --------------------------------------------------------
void _E69_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00427AC7) --------------------------------------------------------
void _E70_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00427B02) --------------------------------------------------------
void _E71_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00427B3D) --------------------------------------------------------
void _E72_0()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00427B78) --------------------------------------------------------
void __thiscall Ztl_variant_t::Ztl_variant_t(Ztl_variant_t *this)
{
  VariantInit((VARIANTARG *)&this->0);
}

//----- (00427B86) --------------------------------------------------------
void __thiscall ZSocketBase::_ZSocketInit::_ZSocketInit(ZSocketBase::_ZSocketInit *this)
{
  WSAData wsadata; // [sp+4h] [bp-190h]@1

  this->m_nRemained = 0;
  WSAStartup(2u, &wsadata);
}

//----- (00427BAC) --------------------------------------------------------
void __thiscall ZSocketBase::_ZSocketInit::~_ZSocketInit(ZSocketBase::_ZSocketInit *this)
{
  ZSocketBase::_ZSocketInit *v1; // esi@1
  signed int i; // edi@1

  v1 = this;
  for ( i = 0; v1->m_nRemained && i < 50; ++i )
    dword_4A469C(100);
  WSACleanup();
}
// 4A469C: using guessed type int (__stdcall *dword_4A469C)(_DWORD);

//----- (00427BD0) --------------------------------------------------------
void __thiscall CTimerThread::CTimerThread(CTimerThread *this)
{
  CTimerThread *v1; // eax@1
  char *v2; // ecx@1

  v1 = this;
  v2 = (char *)&this->m_hEventTerminate;
  v1->_m_dwThreadId = 0;
  v1->_m_hThread = 0;
  TSingleton<CTimerThread>::ms_pInstance = (CTimerThread *)(v2 != 0 ? (unsigned int)(v2 - 12) : 0);
  *(_DWORD *)v2 = 0;
  v1->vfptr = (ZThreadVtbl *)&CTimerThread::`vftable';
}
// 4449FC: using guessed type int (__thiscall *CTimerThread::`vftable')(void *p, unsigned int __flags);

//----- (00427BFB) --------------------------------------------------------
CTimerThread *__thiscall CTimerThread::`vector deleting destructor'(CTimerThread *this, unsigned int __flags)
{
  CTimerThread *v2; // esi@1

  v2 = this;
  CTimerThread::~CTimerThread(this);
  if ( __flags & 1 )
    ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v2);
  return v2;
}

//----- (00427C1B) --------------------------------------------------------
void __thiscall CTimerThread::~CTimerThread(CTimerThread *this)
{
  CTimerThread *v1; // esi@1
  void *v2; // eax@1

  v1 = this;
  v2 = this->m_hEventTerminate;
  this->vfptr = (ZThreadVtbl *)&CTimerThread::`vftable';
  if ( v2 )
    CloseHandle(v2);
  TSingleton<CTimerThread>::ms_pInstance = 0;
  v1->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  ZThread::CloseThread((ZThread *)&v1->vfptr);
}
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);
// 4449FC: using guessed type int (__thiscall *CTimerThread::`vftable')(void *p, unsigned int __flags);

//----- (00427C48) --------------------------------------------------------
int __thiscall CTimerThread::Run(CTimerThread *this, void *pParam, ZThread::ZThreadResult *pResult)
{
  CTimerThread *v3; // esi@1
  HANDLE v4; // eax@1
  int result; // eax@2
  CLoginAcceptor *v6; // esi@3
  signed int v7; // ebx@5
  __POSITION *v8; // eax@8
  CClientSocket *v9; // eax@9
  int v10; // eax@11
  __POSITION *v11; // eax@14
  int v12; // eax@14
  bool v13; // sf@14
  unsigned __int8 v14; // of@14
  ZThread::ZThreadResult *v15; // ebx@18
  unsigned __int8 v16; // cf@21
  double v17; // st7@22
  COutPacket oPacket; // [sp+1Ch] [bp-58h]@3
  __int64 v19; // [sp+2Ch] [bp-48h]@21
  __int64 v20; // [sp+34h] [bp-40h]@21
  __int64 v21; // [sp+3Ch] [bp-38h]@21
  ZRef<CClientSocket> v22; // [sp+44h] [bp-30h]@9
  struct _RTL_CRITICAL_SECTION *v23; // [sp+4Ch] [bp-28h]@5
  CTimerThread *v24; // [sp+50h] [bp-24h]@1
  DWORD v25; // [sp+54h] [bp-20h]@3
  DWORD v26; // [sp+58h] [bp-1Ch]@3
  double v27; // [sp+5Ch] [bp-18h]@3
  int v28; // [sp+64h] [bp-10h]@7
  int v29; // [sp+70h] [bp-4h]@3
  ZThread::ZThreadResult *v30; // [sp+80h] [bp+Ch]@5

  v3 = this;
  v24 = this;
  v4 = CreateEventA(0, 0, 0, 0);
  v3->m_hEventTerminate = v4;
  if ( v4 )
  {
    ZThread::ZThreadResult::Succeeded(pResult);
    HIDWORD(v27) = timeGetTime();
    v26 = timeGetTime();
    v25 = timeGetTime();
    timeGetTime();
    COutPacket::COutPacket(&oPacket, 13, 1);
    v6 = TSingleton<CLoginAcceptor>::ms_pInstance;
    v29 = 0;
    while ( WaitForSingleObject(v24->m_hEventTerminate, 0x64u) )
    {
      v30 = (ZThread::ZThreadResult *)timeGetTime();
      v7 = v6->m_lpSocket._m_uCount / 0x64 + 1;
      v23 = (struct _RTL_CRITICAL_SECTION *)&v6->m_lock.DebugInfo;
      EnterCriticalSection((LPCRITICAL_SECTION)&v6->m_lock.DebugInfo);
      if ( !v6->m_posListIter )
        v6->m_posListIter = (__POSITION *)v6->m_lpSocket._m_pTail;
      v28 = 0;
      if ( v7 > 0 )
      {
        do
        {
          v8 = v6->m_posListIter;
          if ( !v8 )
            break;
          v9 = *(CClientSocket **)&v8[4];
          v22.p = v9;
          if ( v9 )
          {
            InterlockedIncrement(&v9->_m_nRef);
            v9 = v22.p;
          }
          LOBYTE(v29) = 2;
          v10 = CClientSocket::PostUpdate(v9, (int)v30, &oPacket);
          LOBYTE(v29) = 1;
          if ( !v10 )
          {
            if ( v22.p )
            {
              ZRef<CClientSocket>::_ReleaseRaw(&v22, 0);
              v22.p = 0;
            }
            break;
          }
          if ( v22.p )
          {
            ZRef<CClientSocket>::_ReleaseRaw(&v22, 0);
            v22.p = 0;
          }
          v11 = v6->m_posListIter;
          ++v28;
          v12 = *(_DWORD *)(v11 != 0 ? &v11[-8] : 8);
          v14 = __OFSUB__(v28, v7);
          v13 = v28 - v7 < 0;
          v6->m_posListIter = (__POSITION *)(v12 != 0 ? v12 + 16 : 0);
        }
        while ( v13 ^ v14 );
      }
      LOBYTE(v29) = 0;
      LeaveCriticalSection((LPCRITICAL_SECTION)&v6->m_lock.DebugInfo);
      v15 = v30;
      if ( (signed int)&v30[-HIDWORD(v27)] > 600000 )
      {
        v23 = &CClientSocket::ms_lockStat;
        EnterCriticalSection(&CClientSocket::ms_lockStat);
        LOBYTE(v29) = 3;
        HIDWORD(v27) = CClientSocket::ms_tCheckPassword_SP;
        v28 = CClientSocket::ms_nCheckPassword;
        if ( CClientSocket::ms_nCheckPassword <= 1 )
          v28 = 1;
        LogReport(
          aCheckpasswordD,
          CClientSocket::ms_nCheckPassword,
          CClientSocket::ms_tCheckPassword_SP,
          (double)SHIDWORD(v27) / (double)v28);
        CClientSocket::ms_nCheckPassword = 0;
        CClientSocket::ms_tCheckPassword_SP = 0;
        v16 = __CFADD__(CClientSocket::ms_nGameLaunching, (_DWORD)CClientSocket::ms_nTotalGameLaunching);
        LODWORD(CClientSocket::ms_nTotalGameLaunching) = CClientSocket::ms_nGameLaunching
                                                       + CClientSocket::ms_nTotalGameLaunching;
        LODWORD(v21) = CClientSocket::ms_nTotalGameLaunching;
        dword_4A432C += ((unsigned __int64)CClientSocket::ms_nGameLaunching >> 32) + v16;
        HIDWORD(v21) = dword_4A432C;
        v16 = __CFADD__(CClientSocket::ms_nWebLaunching, (_DWORD)CClientSocket::ms_nTotalWebLaunching);
        LODWORD(CClientSocket::ms_nTotalWebLaunching) = CClientSocket::ms_nWebLaunching
                                                      + CClientSocket::ms_nTotalWebLaunching;
        LODWORD(v19) = CClientSocket::ms_nTotalWebLaunching;
        HIDWORD(CClientSocket::ms_nTotalWebLaunching) += ((unsigned __int64)CClientSocket::ms_nWebLaunching >> 32) + v16;
        HIDWORD(v19) = HIDWORD(CClientSocket::ms_nTotalWebLaunching);
        v20 = v21 + CClientSocket::ms_nTotalWebLaunching;
        if ( v21 + CClientSocket::ms_nTotalWebLaunching )
        {
          v27 = (double)v20;
          v17 = (double)v19 / v27;
          v27 = (double)v21 / v27;
        }
        else
        {
          v27 = 0.0;
          v17 = 0.0;
        }
        LogReport(
          aGamestartmodeW,
          CClientSocket::ms_nWebLaunching,
          CClientSocket::ms_nGameLaunching,
          LODWORD(v17),
          (_DWORD)(*(unsigned __int64 *)&v17 >> 32),
          v27);
        CClientSocket::ms_nGameLaunching = 0;
        CClientSocket::ms_nWebLaunching = 0;
        LOBYTE(v29) = 0;
        LeaveCriticalSection(&CClientSocket::ms_lockStat);
        HIDWORD(v27) = v30;
        v15 = v30;
      }
      if ( (signed int)&v15[-v26] > 0 )
      {
        v26 = (DWORD)&v15[1800000];
        CClientSocket::RefreshProcessList();
      }
      if ( (signed int)&v15[-v25] > 0 )
      {
        v25 = (DWORD)&v15[180000];
        CSecurityServer::CheckUpdateGameGuardAuth(TSingleton<CSecurityServer>::ms_pInstance);
      }
    }
    v29 = -1;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
    result = 0;
  }
  else
  {
    ZThread::ZThreadResult::Failed(pResult, 0x80004005);
    result = -1;
  }
  return result;
}
// 4A4318: using guessed type __int32 CClientSocket::ms_nCheckPassword;
// 4A431C: using guessed type __int32 CClientSocket::ms_tCheckPassword_SP;
// 4A4320: using guessed type __int32 CClientSocket::ms_nGameLaunching;
// 4A4324: using guessed type __int32 CClientSocket::ms_nWebLaunching;
// 4A4328: using guessed type __int64 CClientSocket::ms_nTotalGameLaunching;
// 4A432C: using guessed type int dword_4A432C;
// 4A4330: using guessed type __int64 CClientSocket::ms_nTotalWebLaunching;

//----- (00427F36) --------------------------------------------------------
void __thiscall CTimerThread::Terminate(CTimerThread *this)
{
  CTimerThread *v1; // esi@1

  v1 = this;
  if ( this->m_hEventTerminate )
  {
    SetEvent(this->m_hEventTerminate);
    ZThread::JoinThread((ZThread *)&v1->vfptr, 0xFFFFFFFF);
  }
}

//----- (00427F52) --------------------------------------------------------
void _E38_7()
{
  _E31_11();
  _E32_7();
  _E33_8();
  _E34_10();
  _E35_12();
  _E36_11();
  _E37_9();
}

//----- (00427F75) --------------------------------------------------------
void _E31_11()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00427FB0) --------------------------------------------------------
void _E32_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00427FEB) --------------------------------------------------------
void _E33_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00428026) --------------------------------------------------------
void _E34_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (00428061) --------------------------------------------------------
void _E35_12()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (0042809C) --------------------------------------------------------
void _E36_11()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::s_pInstance = v3;
}

//----- (004280D7) --------------------------------------------------------
void _E37_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<unsigned long,unsigned long,unsigned long>::_PAIR,16,ZMap<unsigned long,unsigned long,unsigned long>::_PAIR>::s_pInstance = v3;
}

//----- (00428112) --------------------------------------------------------
void _E57_6()
{
  _E49_5();
  _E50_4();
  _E51_4();
  _E52_4();
  _E53_5();
  _E54_6();
  _E55_7();
  _E56_7();
}

//----- (0042813A) --------------------------------------------------------
void _E49_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00428175) --------------------------------------------------------
void _E50_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004281B0) --------------------------------------------------------
void _E51_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (004281EB) --------------------------------------------------------
void _E52_4()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00428226) --------------------------------------------------------
void _E53_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00428261) --------------------------------------------------------
void _E54_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0042829C) --------------------------------------------------------
void _E55_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::s_pInstance = v3;
}

//----- (004282D7) --------------------------------------------------------
void _E56_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00428326) --------------------------------------------------------
void __thiscall SingleInstance::SingleInstance(SingleInstance *this)
{
  SingleInstance *v1; // edi@1
  HANDLE v2; // eax@1
  int v3; // [sp+0h] [bp-2Ch]@1
  SingleInstance *v4; // [sp+10h] [bp-1Ch]@1
  ZXString<char> result; // [sp+14h] [bp-18h]@1
  ZXString<char> v6; // [sp+18h] [bp-14h]@1
  int *v7; // [sp+1Ch] [bp-10h]@1
  int v8; // [sp+28h] [bp-4h]@1

  v1 = this;
  v7 = &v3;
  v4 = this;
  v6._m_pStr = 0;
  v8 = 0;
  LOBYTE(v8) = 1;
  get_cmdline_arg(&result, 1);
  LOBYTE(v8) = 2;
  ZXString<char>::Format(&v6, aWvsmutexS, result._m_pStr);
  v2 = CreateMutexA(0, 0, v6._m_pStr);
  v1->m_hMutex = v2;
  if ( v2 && dword_4A474C(v3) != 183 )
  {
    LOBYTE(v8) = 1;
    ZXString<char>::~ZXString<char>(&result);
  }
  else
  {
    msgbox_timer(sText, 0x30u, 5000);
    LOBYTE(v8) = 1;
    ZXString<char>::~ZXString<char>(&result);
    v8 = 0;
    dword_4A4648(0);
  }
  v8 = -1;
  ZXString<char>::~ZXString<char>(&v6);
}
// 4A4648: using guessed type int (__stdcall *dword_4A4648)(_DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (004283F6) --------------------------------------------------------
int _E11_8()
{
  return atexit(_E10_1);
}

//----- (00428402) --------------------------------------------------------
void __cdecl _E10_1()
{
  if ( _g_si.m_hMutex )
    dword_4A4638(_g_si.m_hMutex);
}
// 4A4638: using guessed type int (__stdcall *dword_4A4638)(_DWORD);

//----- (00428418) --------------------------------------------------------
void _E14_7()
{
  _g_zeh.m_pfnHandler = (void (__cdecl *)(int, const char *))FinalExceptionHandlerRegister::FinalExceptionHandler;
}

//----- (00428423) --------------------------------------------------------
void __cdecl FinalExceptionHandlerRegister::FinalExceptionHandler(int bReportGenerated)
{
  int v1; // eax@2
  int v2; // ST04_4@2

  if ( bReportGenerated )
  {
    v1 = dword_4A463C(-1);
    dword_4A464C(v1, v2);
  }
}
// 4A463C: using guessed type int (__cdecl *dword_4A463C)(_DWORD);
// 4A464C: using guessed type int (__stdcall *dword_4A464C)(_DWORD, _DWORD);

//----- (0042843A) --------------------------------------------------------
int _E20_3()
{
  _E17_5();
  return _E19_5();
}

//----- (00428444) --------------------------------------------------------
void _E17_5()
{
  g_rm.m_pInterface = 0;
}

//----- (0042844C) --------------------------------------------------------
int _E19_5()
{
  return atexit(_E18_6);
}

//----- (00428458) --------------------------------------------------------
void __cdecl _E18_6()
{
  if ( g_rm.m_pInterface )
    g_rm.m_pInterface->vfptr->Release((IUnknown *)g_rm.m_pInterface);
}

//----- (00428468) --------------------------------------------------------
int _E25_11()
{
  _E22_5();
  return _E24_14();
}

//----- (00428472) --------------------------------------------------------
void _E22_5()
{
  g_pPropConf.m_pInterface = 0;
}

//----- (0042847A) --------------------------------------------------------
int _E24_14()
{
  return atexit(_E23_12);
}

//----- (00428486) --------------------------------------------------------
void __cdecl _E23_12()
{
  if ( g_pPropConf.m_pInterface )
    g_pPropConf.m_pInterface->vfptr->Release((IUnknown *)g_pPropConf.m_pInterface);
}

//----- (00428496) --------------------------------------------------------
int _E30_15()
{
  _E27_10();
  return _E29_16();
}

//----- (004284A0) --------------------------------------------------------
void _E27_10()
{
  g_pRoot.m_pInterface = 0;
}

//----- (004284A8) --------------------------------------------------------
int _E29_16()
{
  return atexit(_E28_13);
}

//----- (004284B4) --------------------------------------------------------
void __cdecl _E28_13()
{
  if ( g_pRoot.m_pInterface )
    g_pRoot.m_pInterface->vfptr->Release((IUnknown *)g_pRoot.m_pInterface);
}

//----- (004284C4) --------------------------------------------------------
int _E35_13()
{
  _E32_8();
  return _E34_11();
}

//----- (004284CE) --------------------------------------------------------
void _E32_8()
{
  g_pDB.m_pInterface = 0;
}

//----- (004284D6) --------------------------------------------------------
int _E34_11()
{
  return atexit(_E33_9);
}

//----- (004284E2) --------------------------------------------------------
void __cdecl _E33_9()
{
  if ( g_pDB.m_pInterface )
    g_pDB.m_pInterface->vfptr->Release((IUnknown *)g_pDB.m_pInterface);
}

//----- (004284F2) --------------------------------------------------------
ZXString<char> *__cdecl get_cmdline_arg(ZXString<char> *result, int __$ReturnUdt)
{
  const unsigned __int16 *v2; // eax@1
  LPWSTR *v3; // esi@1
  int pNumArgs; // [sp+10h] [bp-14h]@1
  ZXString<char> s; // [sp+14h] [bp-10h]@1
  int v7; // [sp+20h] [bp-4h]@1

  s._m_pStr = 0;
  v7 = 1;
  pNumArgs = 0;
  v2 = GetCommandLineW();
  v3 = CommandLineToArgvW(v2, &pNumArgs);
  if ( !v3 )
  {
    __$ReturnUdt = ((int (__cdecl *)())dword_4A474C)();
    _CxxThrowException(&__$ReturnUdt, &_TI1_AVZException__);
  }
  if ( __$ReturnUdt < pNumArgs )
    ZXString<char>::Assign(&s, (int)v3[__$ReturnUdt], -1);
  GlobalFree(v3);
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, &s);
  LOBYTE(v7) = 0;
  ZXString<char>::~ZXString<char>(&s);
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);
// 4A474C: using guessed type int (__cdecl *dword_4A474C)(_DWORD);

//----- (0042858D) --------------------------------------------------------
#error "4285B6: call analysis failed (funcsize=29)"

//----- (004285D5) --------------------------------------------------------
void __cdecl msgbox_timer(const char *sText, unsigned int uType, int tExpire)
{
  UINT_PTR v3; // edi@1

  v3 = SetTimer(0, 0, tExpire, TimerProcMsgBox);
  MessageBoxA(0, sText, s_sMsgBoxCaption, uType);
  KillTimer(0, v3);
}

//----- (0042860C) --------------------------------------------------------
ZXString<char> *__cdecl format_com_error(ZXString<char> *result, _com_error *__$ReturnUdt)
{
  _com_error *v2; // esi@1
  const char *v3; // eax@1
  _bstr_t::Data_t *v4; // eax@2
  int v5; // eax@3
  _com_error *v6; // eax@8
  int v8; // [sp+10h] [bp-1Ch]@9
  ZXString<char> v9; // [sp+14h] [bp-18h]@1
  ZXString<char> v10; // [sp+18h] [bp-14h]@1
  ZXString<char> s; // [sp+1Ch] [bp-10h]@15
  int v12; // [sp+28h] [bp-4h]@1

  v2 = __$ReturnUdt;
  v3 = _com_error::ErrorMessage(__$ReturnUdt);
  v9._m_pStr = 0;
  ZXString<char>::Assign(&v9, v3, -1);
  v12 = 1;
  v10._m_pStr = 0;
  LOBYTE(v12) = 2;
  if ( _com_error::ErrorInfo(v2) )
  {
    v4 = _com_error::Description(v2, (_bstr_t *)&__$ReturnUdt)->m_Data;
    LOBYTE(v12) = 3;
    if ( v4 )
      v5 = (int)v4->m_wstr;
    else
      v5 = 0;
    ZXString<char>::Assign(&v10, v5, -1);
    if ( __$ReturnUdt )
      _bstr_t::Data_t::Release((_bstr_t::Data_t *)__$ReturnUdt);
    goto LABEL_15;
  }
  LOBYTE(v12) = 4;
  __$ReturnUdt = 0;
  if ( GetErrorInfo(0, (IErrorInfo **)&__$ReturnUdt) >= 0 )
  {
    v6 = __$ReturnUdt;
    if ( !__$ReturnUdt )
      goto LABEL_13;
    if ( ((int (__stdcall *)(_com_error *, int *))__$ReturnUdt->vfptr[5].__vecDelDtor)(__$ReturnUdt, &v8) >= 0 )
    {
      ZXString<char>::Assign(&v10, v8, -1);
      if ( v8 )
        dword_4A4900(v8 - 4);
    }
  }
  v6 = __$ReturnUdt;
LABEL_13:
  LOBYTE(v12) = 2;
  if ( v6 )
    ((void (__stdcall *)(_com_error *))v6->vfptr[2].__vecDelDtor)(v6);
LABEL_15:
  s._m_pStr = 0;
  LOBYTE(v12) = 5;
  if ( v10._m_pStr && *v10._m_pStr )
    ZXString<char>::Format(&s, aErrorCodeDSS, v2->m_hresult, v9._m_pStr, v10._m_pStr);
  else
    ZXString<char>::Format(&s, aErrorCodeDS, v2->m_hresult, v9._m_pStr);
  result->_m_pStr = 0;
  ZXString<char>::operator=(result, &s);
  LOBYTE(v12) = 2;
  ZXString<char>::~ZXString<char>(&s);
  LOBYTE(v12) = 1;
  ZXString<char>::~ZXString<char>(&v10);
  LOBYTE(v12) = 0;
  ZXString<char>::~ZXString<char>(&v9);
  return result;
}
// 4A4900: using guessed type int (__stdcall *dword_4A4900)(_DWORD);

//----- (0042876B) --------------------------------------------------------
void __cdecl msgbox_com_error(_com_error *e)
{
  ZXString<char> *v1; // eax@1

  v1 = format_com_error((ZXString<char> *)&e, e);
  msgbox_timer(v1->_m_pStr, 0x30u, 5000);
  ZXString<char>::~ZXString<char>((ZXString<char> *)&e);
}

//----- (00428795) --------------------------------------------------------
void __cdecl msgbox_ZException(ZException *e)
{
  _com_error *v1; // eax@1
  _com_error v2; // [sp+0h] [bp-1Ch]@1
  int v3; // [sp+18h] [bp-4h]@1

  _com_error::_com_error(&v2, e->m_hr, 0, 0);
  v3 = 0;
  msgbox_com_error(v1);
  _com_error::~_com_error(&v2);
}

//----- (004287D3) --------------------------------------------------------
Ztl_bstr_t *__cdecl DetachBSTR(Ztl_bstr_t *result, tagVARIANT *__$ReturnUdt)
{
  bool v2; // zf@1
  unsigned __int16 *v3; // ST08_4@2
  int v4; // eax@3
  unsigned __int16 *v5; // ST08_4@6
  int v6; // eax@6
  _com_error v8; // [sp+Ch] [bp-30h]@4
  VARIANTARG pvarg; // [sp+1Ch] [bp-20h]@3
  int v10; // [sp+2Ch] [bp-10h]@1
  int v11; // [sp+38h] [bp-4h]@3

  v2 = __$ReturnUdt->vt == 8;
  v10 = 0;
  if ( v2 )
  {
    v3 = __$ReturnUdt->bstrVal;
    __$ReturnUdt->decVal.Lo32 = 0;
    __$ReturnUdt->vt = 0;
    _bstr_t::_bstr_t((_bstr_t *)&result->m_Data, v3, 0);
  }
  else
  {
    VariantInit(&pvarg);
    v11 = 1;
    v4 = ZComAPI::ZComVariantChangeType(&pvarg, __$ReturnUdt, 0, 8u);
    if ( v4 < 0 )
    {
      _com_error::_com_error(&v8, v4, 0, 0);
      _CxxThrowException(&v8, &_TI1_AV_com_error__);
    }
    v5 = pvarg.bstrVal;
    pvarg.decVal.Lo32 = 0;
    pvarg.vt = 0;
    _bstr_t::_bstr_t((_bstr_t *)&result->m_Data, v5, 0);
    v10 = 1;
    LOBYTE(v11) = 0;
    v6 = ZComAPI::ZComVariantClear(&pvarg);
    if ( v6 < 0 )
      _com_issue_error(v6);
  }
  return result;
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (00428883) --------------------------------------------------------
bool __cdecl CheckAdult(int nSSN1, int nSSN2, int nCriticalYear)
{
  int v3; // eax@1
  int v4; // eax@5
  _SYSTEMTIME systemTime; // [sp+0h] [bp-10h]@1

  GetLocalTime(&systemTime);
  v3 = nSSN2 / 1000000;
  if ( nSSN2 / 1000000 == 1 || v3 == 2 || v3 == 5 || v3 == 6 )
    v4 = nSSN1 / 10000 + 1900;
  else
    v4 = nSSN1 / 10000 + 2000;
  return systemTime.wYear - v4 >= nCriticalYear;
}

//----- (004288E4) --------------------------------------------------------
ZXString<char> *__cdecl get_labeled_string(ZXString<char> *result, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > __$ReturnUdt, int pProp, const unsigned __int16 *nID)
{
  void *v4; // esp@1
  wchar_t *v5; // eax@1
  IWzProperty *v6; // eax@1
  Ztl_variant_t *v7; // eax@1
  int v8; // eax@2
  int v9; // eax@5
  ZXString<char> *v10; // edi@8
  IWzProperty *v11; // eax@9
  unsigned __int16 *v12; // eax@9
  int v13; // eax@11
  int v14; // ecx@14
  IUnknownVtbl *v15; // ecx@16
  Ztl_bstr_t v17; // [sp-2Ch] [bp-74h]@1
  Ztl_variant_t *v18; // [sp-28h] [bp-70h]@1
  ZXString<char> *v19; // [sp-24h] [bp-6Ch]@1
  int v20; // [sp-20h] [bp-68h]@1
  Ztl_variant_t resulta; // [sp+Ch] [bp-3Ch]@1
  Ztl_variant_t v22; // [sp+1Ch] [bp-2Ch]@9
  _DWORD *v23; // [sp+2Ch] [bp-1Ch]@1
  int v24; // [sp+30h] [bp-18h]@1
  int v25; // [sp+34h] [bp-14h]@1
  ZXString<char> s; // [sp+38h] [bp-10h]@1
  int v27; // [sp+44h] [bp-4h]@1

  v25 = 0;
  v27 = 1;
  s._m_pStr = 0;
  LOBYTE(v27) = 2;
  v4 = alloca(32);
  v19 = 0;
  v18 = 0;
  v5 = _Int2StrW(pProp, (unsigned __int16 *)&v20);
  v23 = &v17;
  Ztl_bstr_t::Ztl_bstr_t(&v17, v5);
  LOBYTE(v27) = 2;
  v6 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&__$ReturnUdt);
  v7 = IWzProperty::Getitem(v6, &resulta, v17);
  LOBYTE(v27) = 4;
  v24 = (int)Ztl_variant_t::GetUnknown(v7, (char)v18, (char)v19);
  pProp = 0;
  if ( v24 )
  {
    v8 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
           (_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)&pProp,
           (int)&v24);
    if ( v8 < 0 && v8 != -2147467262 )
      _com_issue_error(v8);
  }
  LOBYTE(v27) = 6;
  v9 = ZComAPI::ZComVariantClear((tagVARIANT *)&resulta.0);
  if ( v9 < 0 )
    _com_issue_error(v9);
  if ( pProp )
  {
    v23 = &v19;
    _bstr_t::_bstr_t((_bstr_t *)&v19, nID);
    v18 = &v22;
    LOBYTE(v27) = 6;
    v11 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)&pProp);
    IWzProperty::Getitem(v11, v18, (Ztl_bstr_t)v19);
    v12 = v22.bstrVal;
    LOBYTE(v27) = 8;
    if ( v22.vt != 8 )
      v12 = &sDefault;
    v10 = result;
    v19 = (ZXString<char> *)-1;
    v18 = (Ztl_variant_t *)v12;
    result->_m_pStr = 0;
    ZXString<char>::Assign(result, (int)v18, (int)v19);
    v25 = 1;
    LOBYTE(v27) = 6;
    v13 = ZComAPI::ZComVariantClear((tagVARIANT *)&v22.0);
    if ( v13 < 0 )
      _com_issue_error(v13);
  }
  else
  {
    v10 = result;
    v19 = &s;
    result->_m_pStr = 0;
    ZXString<char>::operator=(result, v19);
    v25 = 1;
  }
  LOBYTE(v27) = 2;
  if ( pProp )
  {
    v14 = *(_DWORD *)pProp;
    v19 = (ZXString<char> *)pProp;
    (*(void (__stdcall **)(int))(v14 + 8))(pProp);
  }
  LOBYTE(v27) = 1;
  ZXString<char>::~ZXString<char>(&s);
  LOBYTE(v27) = 0;
  if ( __$ReturnUdt.m_pInterface )
  {
    v15 = __$ReturnUdt.m_pInterface->vfptr;
    v19 = (ZXString<char> *)__$ReturnUdt.m_pInterface;
    v15->Release((IUnknown *)__$ReturnUdt.m_pInterface);
  }
  return v10;
}

//----- (00428A45) --------------------------------------------------------
ZXString<char> *__cdecl get_labeled_string(ZXString<char> *result, _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > __$ReturnUdt, ZXString<char> pProp, const unsigned __int16 *sID)
{
  void *v4; // esp@1
  char *v5; // eax@1
  const unsigned __int16 *v6; // eax@1
  IWzProperty *v7; // eax@1
  Ztl_variant_t *v8; // eax@1
  int v9; // eax@2
  int v10; // eax@5
  ZXString<char> *v11; // edi@8
  IWzProperty *v12; // eax@9
  unsigned __int16 *v13; // eax@9
  int v14; // eax@11
  IUnknownVtbl *v15; // ecx@14
  IUnknownVtbl *v16; // ecx@16
  Ztl_bstr_t v18; // [sp-Ch] [bp-58h]@1
  Ztl_variant_t *v19; // [sp-8h] [bp-54h]@1
  ZXString<char> *v20; // [sp-4h] [bp-50h]@1
  int v21; // [sp+0h] [bp-4Ch]@1
  Ztl_variant_t resulta; // [sp+Ch] [bp-40h]@1
  Ztl_variant_t v23; // [sp+1Ch] [bp-30h]@9
  _DWORD *v24; // [sp+2Ch] [bp-20h]@1
  int v25; // [sp+30h] [bp-1Ch]@1
  int v26; // [sp+34h] [bp-18h]@1
  ZXString<char> s; // [sp+38h] [bp-14h]@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v28; // [sp+3Ch] [bp-10h]@1
  int v29; // [sp+48h] [bp-4h]@1

  v26 = 0;
  v29 = 1;
  s._m_pStr = 0;
  LOBYTE(v29) = 3;
  v4 = alloca(2 * dword_4A4778(0, 0, pProp._m_pStr, -1, 0, 0));
  v20 = 0;
  v19 = 0;
  v5 = ZXString<char>::operator char const *(&pProp);
  v6 = ZStrUtil::_Conv(v5, (unsigned __int16 *)&v21, -1);
  v24 = &v18;
  Ztl_bstr_t::Ztl_bstr_t(&v18, v6);
  LOBYTE(v29) = 3;
  v7 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&__$ReturnUdt);
  v8 = IWzProperty::Getitem(v7, &resulta, v18);
  LOBYTE(v29) = 5;
  v25 = (int)Ztl_variant_t::GetUnknown(v8, (char)v19, (char)v20);
  v28.m_pInterface = 0;
  if ( v25 )
  {
    v9 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
           &v28,
           (int)&v25);
    if ( v9 < 0 && v9 != -2147467262 )
      _com_issue_error(v9);
  }
  LOBYTE(v29) = 7;
  v10 = ZComAPI::ZComVariantClear((tagVARIANT *)&resulta.0);
  if ( v10 < 0 )
    _com_issue_error(v10);
  if ( v28.m_pInterface )
  {
    v24 = &v20;
    _bstr_t::_bstr_t((_bstr_t *)&v20, sID);
    v19 = &v23;
    LOBYTE(v29) = 7;
    v12 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v28);
    IWzProperty::Getitem(v12, v19, (Ztl_bstr_t)v20);
    v13 = v23.bstrVal;
    LOBYTE(v29) = 9;
    if ( v23.vt != 8 )
      v13 = &sDefault;
    v11 = result;
    v20 = (ZXString<char> *)-1;
    v19 = (Ztl_variant_t *)v13;
    result->_m_pStr = 0;
    ZXString<char>::Assign(result, (int)v19, (int)v20);
    v26 = 1;
    LOBYTE(v29) = 7;
    v14 = ZComAPI::ZComVariantClear((tagVARIANT *)&v23.0);
    if ( v14 < 0 )
      _com_issue_error(v14);
  }
  else
  {
    v11 = result;
    v20 = &s;
    result->_m_pStr = 0;
    ZXString<char>::operator=(result, v20);
    v26 = 1;
  }
  LOBYTE(v29) = 3;
  if ( v28.m_pInterface )
  {
    v15 = v28.m_pInterface->vfptr;
    v20 = (ZXString<char> *)v28.m_pInterface;
    v15->Release((IUnknown *)v28.m_pInterface);
  }
  LOBYTE(v29) = 2;
  ZXString<char>::~ZXString<char>(&s);
  LOBYTE(v29) = 1;
  if ( __$ReturnUdt.m_pInterface )
  {
    v16 = __$ReturnUdt.m_pInterface->vfptr;
    v20 = (ZXString<char> *)__$ReturnUdt.m_pInterface;
    v16->Release((IUnknown *)__$ReturnUdt.m_pInterface);
  }
  LOBYTE(v29) = 0;
  ZXString<char>::~ZXString<char>(&pProp);
  return v11;
}
// 4A4778: using guessed type int (__stdcall *dword_4A4778)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00428BCF) --------------------------------------------------------
void __thiscall _com_ptr_t<_com_IIID<IErrorInfo,&__s_GUID _GUID_1cf2b120_547d_101b_8e65_08002b2bd119>>::~_com_ptr_t<_com_IIID<IErrorInfo,&__s_GUID _GUID_1cf2b120_547d_101b_8e65_08002b2bd119>>(_com_ptr_t<_com_IIID<IErrorInfo,&_GUID_1cf2b120_547d_101b_8e65_08002b2bd119> > *this)
{
  if ( this->m_pInterface )
    this->m_pInterface->vfptr->Release((IUnknown *)this->m_pInterface);
}

//----- (00428BDC) --------------------------------------------------------
unsigned __int16 *__cdecl ZStrUtil::_Conv(const char *m, unsigned __int16 *w, int nChars)
{
  dword_4A4778(0, 0, m, nChars, w, 0x3FFFFFFF);
  return w;
}
// 4A4778: using guessed type int (__stdcall *dword_4A4778)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00428BFC) --------------------------------------------------------
void _E41_8()
{
  _E39_10();
  _E40_8();
}

//----- (00428C06) --------------------------------------------------------
void _E39_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00428C41) --------------------------------------------------------
void _E40_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00428C7C) --------------------------------------------------------
void _E58_5()
{
  _E51_5();
  _E52_5();
  _E53_6();
  _E54_7();
  _E55_8();
  _E56_8();
  _E57_7();
}

//----- (00428C9F) --------------------------------------------------------
void _E51_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (00428CDA) --------------------------------------------------------
void _E52_5()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00428D15) --------------------------------------------------------
void _E53_6()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00428D50) --------------------------------------------------------
void _E54_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00428D8B) --------------------------------------------------------
void _E55_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (00428DC6) --------------------------------------------------------
void _E56_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00428E01) --------------------------------------------------------
void _E57_7()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00428E3C) --------------------------------------------------------
void __thiscall _bstr_t::_bstr_t(_bstr_t *this, unsigned __int16 *bstr, char fCopy)
{
  _bstr_t *v3; // esi@1
  _bstr_t::Data_t *v4; // ecx@1
  _bstr_t::Data_t *v5; // eax@2

  v3 = this;
  v4 = (_bstr_t::Data_t *)ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0xCu);
  if ( v4 )
    _bstr_t::Data_t::Data_t(v4, bstr, fCopy);
  else
    v5 = 0;
  v3->m_Data = v5;
  if ( !v5 )
    _com_issue_error(-2147024882);
}

//----- (00428E97) --------------------------------------------------------
void __thiscall _bstr_t::~_bstr_t(_bstr_t *this)
{
  _bstr_t *v1; // esi@1
  _bstr_t::Data_t *v2; // ecx@1

  v1 = this;
  v2 = this->m_Data;
  if ( v2 )
  {
    _bstr_t::Data_t::Release(v2);
    v1->m_Data = 0;
  }
}

//----- (00428EAA) --------------------------------------------------------
void __thiscall _bstr_t::Data_t::Data_t(_bstr_t::Data_t *this, unsigned __int16 *bstr, char fCopy)
{
  _bstr_t::Data_t *v3; // esi@1
  unsigned __int16 *v4; // eax@3

  v3 = this;
  this->m_str = 0;
  this->m_RefCount = 1;
  if ( fCopy && bstr )
  {
    v4 = ZComAPI::ZComSysAllocStringByteLen((const char *)bstr, *((_DWORD *)bstr - 1));
    v3->m_wstr = v4;
    if ( !v4 )
      _com_issue_error(-2147024882);
  }
  else
  {
    this->m_wstr = bstr;
  }
}

//----- (00428EEC) --------------------------------------------------------
unsigned __int16 *__cdecl ZComAPI::ZComSysAllocStringByteLen(const char *s, unsigned int bn)
{
  int v2; // ecx@0
  unsigned __int16 *result; // eax@1
  unsigned __int16 *v4; // edi@2

  result = (unsigned __int16 *)dword_4A48F8(v2, bn + 6);
  if ( result )
  {
    *(_DWORD *)result = bn;
    v4 = result + 2;
    if ( s )
      memcpy(v4, s, bn);
    v4[bn >> 1] = 0;
    result = v4;
  }
  return result;
}
// 4A48F8: using guessed type int (__thiscall *dword_4A48F8)(_DWORD, _DWORD);

//----- (00428F28) --------------------------------------------------------
IErrorInfo *__thiscall _com_error::ErrorInfo(_com_error *this)
{
  _com_error *v1; // esi@1
  IErrorInfo *v2; // eax@1

  v1 = this;
  v2 = this->m_perrinfo;
  if ( v2 )
    v2->vfptr->AddRef((IUnknown *)v2);
  return v1->m_perrinfo;
}

//----- (00428F3D) --------------------------------------------------------
_bstr_t *__thiscall _com_error::Description(_com_error *this, _bstr_t *result)
{
  IErrorInfo *v2; // eax@1
  unsigned __int16 *bstr; // [sp+0h] [bp-4h]@1

  bstr = 0;
  v2 = this->m_perrinfo;
  bstr = 0;
  if ( v2 )
    ((void (__stdcall *)(IErrorInfo *, unsigned __int16 **))v2->vfptr[1].Release)(v2, &bstr);
  _bstr_t::_bstr_t(result, bstr, 0);
  return result;
}

//----- (00428F6E) --------------------------------------------------------
const char *__thiscall _com_error::ErrorMessage(_com_error *this)
{
  _com_error *v1; // edi@1
  LPCSTR *v2; // esi@1
  int v3; // eax@3
  bool v4; // zf@5
  char *v5; // eax@5
  char *v6; // eax@7
  signed int v7; // edi@8
  unsigned __int16 v8; // cx@10

  v1 = this;
  v2 = (LPCSTR *)&this->m_pszMsg;
  if ( !this->m_pszMsg )
  {
    FormatMessageA(0x1100u, 0, this->m_hresult, 0x400u, (LPSTR)&this->m_pszMsg, 0, 0);
    if ( *v2 )
    {
      v3 = lstrlenA(*v2);
      if ( v3 > 1 && (*v2)[v3 - 1] == 10 )
      {
        (*v2)[v3 - 1] = 0;
        v4 = (*v2)[v3 - 2] == 13;
        v5 = (char *)&(*v2)[v3 - 2];
        if ( v4 )
          *v5 = 0;
      }
    }
    else
    {
      v6 = (char *)LocalAlloc(0, 0x20u);
      *v2 = v6;
      if ( v6 )
      {
        v7 = v1->m_hresult;
        if ( v7 < -2147220992 || v7 > -2147155969 )
          v8 = 0;
        else
          v8 = v7 - 512;
        if ( v8 )
          _wsprintfA(v6, aIdispatchError, v8);
        else
          _wsprintfA(v6, aUnknownError0x, v7);
      }
    }
  }
  return *v2;
}

//----- (0042901B) --------------------------------------------------------
void CVerboseObj::LogReport(CVerboseObj *this, const char *sFormat, ...)
{
  CLog *v2; // esi@1
  const char *v3; // eax@1
  va_list va; // [sp+10h] [bp+Ch]@1

  va_start(va, sFormat);
  v2 = TSingleton<CLog>::ms_pInstance;
  v3 = (const char *)((int (*)(void))this->vfptr->GetLogTail)();
  CLog::OutputLogV(v2, 0, 1u, v3, sFormat, va);
}

//----- (00429041) --------------------------------------------------------
void CVerboseObj::LogError(CVerboseObj *this, const char *sFormat, ...)
{
  CLog *v2; // esi@1
  const char *v3; // eax@1
  va_list va; // [sp+10h] [bp+Ch]@1

  va_start(va, sFormat);
  v2 = TSingleton<CLog>::ms_pInstance;
  v3 = (const char *)((int (*)(void))this->vfptr->GetLogTail)();
  CLog::OutputLogV(v2, 0, 2u, v3, sFormat, va);
}

//----- (00429067) --------------------------------------------------------
void __thiscall CVerboseObj::LogException(CVerboseObj *this, ZException *e)
{
  int v2; // eax@1
  CVerboseObj *v3; // esi@1
  _com_error *v4; // eax@6
  char *v5; // ST08_4@6
  _com_error v6; // [sp+4h] [bp-1Ch]@6
  int v7; // [sp+1Ch] [bp-4h]@6

  v2 = e->m_hr;
  v3 = this;
  if ( e->m_hr != -2147467259 && v2 != 64 && v2 != 121 && v2 != 10053 && v2 != 10054 )
  {
    _com_error::_com_error(&v6, v2, 0, 0);
    v7 = 0;
    v5 = format_com_error((ZXString<char> *)&e, v4)->_m_pStr;
    LOBYTE(v7) = 1;
    CVerboseObj::LogError(v3, v5);
    LOBYTE(v7) = 0;
    ZXString<char>::~ZXString<char>((ZXString<char> *)&e);
    _com_error::~_com_error(&v6);
  }
}

//----- (004290E9) --------------------------------------------------------
void __thiscall CVerboseObj::LogException(CVerboseObj *this, _com_error *e)
{
  CVerboseObj *v2; // esi@1
  ZXString<char> *v3; // eax@1

  v2 = this;
  v3 = format_com_error((ZXString<char> *)&e, e);
  CVerboseObj::LogError(v2, v3->_m_pStr);
  ZXString<char>::~ZXString<char>((ZXString<char> *)&e);
}

//----- (00429137) --------------------------------------------------------
void _E11_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00429172) --------------------------------------------------------
void _E12_12()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (004291AD) --------------------------------------------------------
void _E30_16()
{
  _E23_13();
  _E24_15();
  _E25_12();
  _E26_11();
  _E27_11();
  _E28_14();
  _E29_17();
}

//----- (004291D0) --------------------------------------------------------
void _E23_13()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0042920B) --------------------------------------------------------
void _E24_15()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (00429246) --------------------------------------------------------
void _E25_12()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00429281) --------------------------------------------------------
void _E26_11()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (004292BC) --------------------------------------------------------
void _E27_11()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004292F7) --------------------------------------------------------
void _E28_14()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00429332) --------------------------------------------------------
void _E29_17()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0042936D) --------------------------------------------------------
int __stdcall WinMain(HINSTANCE__ *hInstance, HINSTANCE__ *hPrevInstance, char *lpCmdLine, int nCmdShow)
{
  CLoginApp app; // [sp+0h] [bp-4Ch]@1

  CLoginApp::CLoginApp(&app);
  if ( CLoginApp::SetUp(&app) )
    CServerApp::Run();
  CLoginApp::CleanUp(&app);
  CLoginApp::~CLoginApp(&app);
  return 0;
}

//----- (004293A5) --------------------------------------------------------
void _E16_2()
{
  _E13_13();
  _E14_8();
  _E15_3();
}

//----- (004293B4) --------------------------------------------------------
void _E13_13()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (004293EF) --------------------------------------------------------
void _E14_8()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (0042942A) --------------------------------------------------------
void _E15_3()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<long,int,long>::_PAIR,16,ZMap<long,int,long>::_PAIR>::s_pInstance = v3;
}

//----- (00429465) --------------------------------------------------------
void _E33_10()
{
  _E26_12();
  _E27_12();
  _E28_15();
  _E29_18();
  _E30_17();
  _E31_12();
  _E32_9();
}

//----- (00429488) --------------------------------------------------------
void _E26_12()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004294C3) --------------------------------------------------------
void _E27_12()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (004294FE) --------------------------------------------------------
void _E28_15()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00429539) --------------------------------------------------------
void _E29_18()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (00429574) --------------------------------------------------------
void _E30_17()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004295AF) --------------------------------------------------------
void _E31_12()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (004295EA) --------------------------------------------------------
void _E32_9()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00429625) --------------------------------------------------------
unsigned int __cdecl CIGCipher::innoHash(char *pSrc, int nLen, unsigned int *pdwKey)
{
  unsigned int *v3; // edi@1
  int v4; // esi@1
  unsigned int dwDefaultKey; // [sp+8h] [bp-4h]@1

  v3 = pdwKey;
  v4 = 0;
  dwDefaultKey = -967814158;
  if ( !pdwKey )
    v3 = &dwDefaultKey;
  if ( nLen > 0 )
  {
    do
      CIGCipher::MorphKey(v3, pSrc[v4++]);
    while ( v4 < nLen );
  }
  return *v3;
}

//----- (00429660) --------------------------------------------------------
void __cdecl CIGCipher::MorphKey(unsigned int *pdwKey, char bData)
{
  unsigned int *v2; // eax@1
  unsigned __int8 v3; // cl@1
  unsigned __int8 v4; // cl@1
  int v5; // edx@1
  char v6; // cl@1

  v2 = pdwKey;
  v3 = *((_BYTE *)pdwKey + 1);
  *(_BYTE *)v2 += LOBYTE((&CIGCipher::bShuffle)[v3]) - bData;
  *((_BYTE *)v2 + 1) = v3 - (LOBYTE((&CIGCipher::bShuffle)[(unsigned __int8)bData]) ^ *((_BYTE *)v2 + 2));
  v4 = *((_BYTE *)pdwKey + 3);
  v5 = v4;
  v6 = v4 - *(_BYTE *)pdwKey;
  *((_BYTE *)v2 + 2) ^= bData + LOBYTE((&CIGCipher::bShuffle)[v5]);
  *((_BYTE *)pdwKey + 3) = LOBYTE((&CIGCipher::bShuffle)[(unsigned __int8)bData]) + v6;
  *pdwKey = 8 * *pdwKey | ((unsigned __int64)*pdwKey >> 29);
}
// 49A92C: using guessed type unsigned __int8 *CIGCipher::bShuffle;

//----- (004296BD) --------------------------------------------------------
void __cdecl CIGCipher::innoEncrypt(char *pDest, char *pSrc, int nLen, unsigned int *pdwKey)
{
  unsigned int *v4; // ebx@1
  char *v5; // esi@4
  unsigned int dwDefaultKey; // [sp+4h] [bp-4h]@1
  unsigned __int8 bSrc; // [sp+18h] [bp+10h]@5
  unsigned int *pdwKeya; // [sp+1Ch] [bp+14h]@4

  v4 = pdwKey;
  dwDefaultKey = -967814158;
  if ( !pdwKey )
    v4 = &dwDefaultKey;
  if ( nLen > 0 )
  {
    v5 = pDest;
    pdwKeya = (unsigned int *)nLen;
    do
    {
      bSrc = v5[pSrc - pDest];
      *v5 = LOBYTE((&CIGCipher::bShuffle)[*(_BYTE *)v4]) ^ (((unsigned __int8)(16 * bSrc | (bSrc >> 4)) >> 1) & 0x55 | 2 * ((16 * bSrc | (bSrc >> 4)) & 0xD5));
      CIGCipher::MorphKey(v4, bSrc);
      ++v5;
      pdwKeya = (unsigned int *)((char *)pdwKeya - 1);
    }
    while ( pdwKeya );
  }
}
// 49A92C: using guessed type unsigned __int8 *CIGCipher::bShuffle;

//----- (00429725) --------------------------------------------------------
void __cdecl CIGCipher::innoDecrypt(char *pDest, char *pSrc, int nLen, unsigned int *pdwKey)
{
  unsigned int *v4; // ebx@1
  char *v5; // esi@4
  unsigned __int8 v6; // al@5
  unsigned __int8 v7; // cl@5
  unsigned int dwDefaultKey; // [sp+4h] [bp-4h]@1
  unsigned int *pdwKeya; // [sp+1Ch] [bp+14h]@4

  v4 = pdwKey;
  dwDefaultKey = -967814158;
  if ( !pdwKey )
    v4 = &dwDefaultKey;
  if ( nLen > 0 )
  {
    v5 = pDest;
    pdwKeya = (unsigned int *)nLen;
    do
    {
      v6 = v5[pSrc - pDest] ^ LOBYTE((&CIGCipher::bShuffle)[*(_BYTE *)v4]);
      v7 = (v6 >> 1) & 0x55 | 2 * (v6 & 0xD5);
      *v5 = 16 * v7 | (v7 >> 4);
      CIGCipher::MorphKey(v4, 16 * v7 | (v7 >> 4));
      ++v5;
      pdwKeya = (unsigned int *)((char *)pdwKeya - 1);
    }
    while ( pdwKeya );
  }
}
// 49A92C: using guessed type unsigned __int8 *CIGCipher::bShuffle;

//----- (0042978D) --------------------------------------------------------
void __cdecl CIGCipher::innoEncryptStr(char *pDest, const char *pSrc)
{
  int nLen; // [sp+4h] [bp-8h]@1
  unsigned int dwKey; // [sp+8h] [bp-4h]@1

  nLen = strlen(pSrc);
  dwKey = -967814158;
  CIGCipher::innoEncrypt(pDest, (char *)&nLen, 4, &dwKey);
  CIGCipher::innoEncrypt(pDest + 4, (char *)pSrc, nLen, &dwKey);
}

//----- (004297D1) --------------------------------------------------------
char *__cdecl CIGCipher::innoDecryptStr(char *pDest, char *pSrc)
{
  char *v2; // esi@1
  unsigned int dwKey; // [sp+4h] [bp-4h]@1

  v2 = pSrc;
  dwKey = -967814158;
  CIGCipher::innoDecrypt((char *)&pSrc, pSrc, 4, &dwKey);
  CIGCipher::innoDecrypt(pDest, v2 + 4, (int)pSrc, &dwKey);
  pDest[(_DWORD)pSrc] = 0;
  return pDest;
}

//----- (00429813) --------------------------------------------------------
void _E14_9()
{
  _E12_13();
  _E13_14();
}

//----- (0042981D) --------------------------------------------------------
void _E12_13()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00429858) --------------------------------------------------------
void _E13_14()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00429893) --------------------------------------------------------
void _E31_13()
{
  _E24_16();
  _E25_13();
  _E26_13();
  _E27_13();
  _E28_16();
  _E29_19();
  _E30_18();
}

//----- (004298B6) --------------------------------------------------------
void _E24_16()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (004298F1) --------------------------------------------------------
void _E25_13()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0042992C) --------------------------------------------------------
void _E26_13()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (00429967) --------------------------------------------------------
void _E27_13()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (004299A2) --------------------------------------------------------
void _E28_16()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (004299DD) --------------------------------------------------------
void _E29_19()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (00429A18) --------------------------------------------------------
void _E30_18()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (00429A53) --------------------------------------------------------
int __thiscall CSecurityServer::Init(CSecurityServer *this)
{
  CSecurityServer *v1; // esi@1
  signed int v2; // eax@1
  int result; // eax@2
  ZXString<char> v4; // [sp+4h] [bp-10h]@2
  int v5; // [sp+10h] [bp-4h]@2

  v1 = this;
  v2 = InitGameguardAuth(&sLog, 50, 1, 3);
  if ( v2 )
  {
    v4._m_pStr = 0;
    v5 = 0;
    ZXString<char>::Format(&v4, aInitgameguarda, v2);
    msgbox_timer(v4._m_pStr, 0x30u, 5000);
    v5 = -1;
    ZXString<char>::~ZXString<char>(&v4);
    result = 0;
  }
  else
  {
    CSecurityServer::InitMemoryCheck(v1);
    result = 1;
  }
  return result;
}

//----- (00429AC8) --------------------------------------------------------
void __thiscall CSecurityServer::InitMemoryCheck(CSecurityServer *this)
{
  _bstr_t::Data_t *v1; // ecx@1
  _com_ptr_t<_com_IIID<IWzResMan,&_GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf> > *v2; // eax@1
  IWzResMan *v3; // eax@1
  Ztl_variant_t *v4; // eax@1
  int v5; // eax@1
  int v6; // eax@4
  int v7; // eax@6
  int v8; // eax@8
  Ztl_variant_t *v9; // ecx@8
  IWzProperty *v10; // eax@11
  bool v11; // zf@11
  IWzProperty *v12; // eax@12
  Ztl_variant_t *v13; // eax@12
  int v14; // eax@13
  int v15; // eax@16
  ZXString<unsigned short> *v16; // eax@19
  unsigned __int16 *v17; // eax@19
  _bstr_t::Data_t *v18; // ecx@19
  IWzProperty *v19; // eax@19
  Ztl_variant_t *v20; // eax@19
  signed int v21; // ebx@19
  int v22; // eax@19
  ZXString<unsigned short> *v23; // eax@21
  unsigned __int16 *v24; // eax@21
  _bstr_t::Data_t *v25; // ecx@21
  IWzProperty *v26; // eax@21
  Ztl_variant_t *v27; // eax@21
  unsigned int v28; // edi@21
  int v29; // eax@21
  ZArray<unsigned long> *v30; // esi@24
  unsigned int *v31; // eax@24
  Ztl_variant_t *v32; // ecx@25
  IWzProperty *v33; // eax@25
  Ztl_variant_t *v34; // eax@25
  int v35; // eax@26
  int v36; // eax@29
  int v37; // ebx@31
  ZArray<unsigned long> *v38; // edi@31
  void *v39; // esp@32
  wchar_t *v40; // eax@32
  IWzProperty *v41; // eax@32
  Ztl_variant_t *v42; // eax@32
  unsigned int v43; // esi@32
  int v44; // eax@32
  IUnknownVtbl *v45; // ecx@36
  IUnknownVtbl *v46; // ecx@38
  IWzProperty *v47; // [sp-28h] [bp-94h]@32
  IWzProperty *v48; // [sp-24h] [bp-90h]@32
  int v49; // [sp-20h] [bp-8Ch]@32
  Ztl_bstr_t v50; // [sp-14h] [bp-80h]@1
  Ztl_variant_t *v51; // [sp-10h] [bp-7Ch]@1
  Ztl_variant_t *v52; // [sp-Ch] [bp-78h]@1
  Ztl_bstr_t v53; // [sp-8h] [bp-74h]@1
  signed int v54; // [sp-4h] [bp-70h]@1
  int v55; // [sp+0h] [bp-6Ch]@1
  Ztl_variant_t result; // [sp+Ch] [bp-60h]@1
  _variant_t v57; // [sp+1Ch] [bp-50h]@1
  _variant_t v58; // [sp+2Ch] [bp-40h]@1
  _DWORD *v59; // [sp+3Ch] [bp-30h]@19
  int v60; // [sp+40h] [bp-2Ch]@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v61; // [sp+44h] [bp-28h]@25
  CSecurityServer *v62; // [sp+48h] [bp-24h]@1
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v63; // [sp+4Ch] [bp-20h]@12
  ZXString<unsigned short> v64; // [sp+50h] [bp-1Ch]@1
  _bstr_t::Data_t *i; // [sp+54h] [bp-18h]@18
  _com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > v66; // [sp+58h] [bp-14h]@1
  int *v67; // [sp+5Ch] [bp-10h]@1
  int v68; // [sp+68h] [bp-4h]@1

  v67 = &v55;
  v62 = this;
  v66.m_pInterface = 0;
  v68 = 0;
  LOBYTE(v68) = 1;
  _variant_t::_variant_t(&v57, &vtMissing);
  LOBYTE(v68) = 2;
  _variant_t::_variant_t(&v58, &vtMissing);
  v54 = 0;
  v53.m_Data = 0;
  v52 = (Ztl_variant_t *)&v57;
  v51 = (Ztl_variant_t *)&v58;
  v50.m_Data = v1;
  v60 = (int)&v50;
  LOBYTE(v68) = 3;
  Ztl_bstr_t::Ztl_bstr_t(&v50, aCmap_img);
  LOBYTE(v68) = 4;
  v2 = get_rm();
  v3 = _com_ptr_t<_com_IIID<IWzResMan,&__s_GUID _GUID_57dfe40b_3e20_4dbc_97e8_805a50f381bf>>::operator->(v2);
  LOBYTE(v68) = 3;
  v4 = IWzResMan::GetObjectA(v3, &result, v50, v51, v52);
  LOBYTE(v68) = 5;
  v64._m_pStr = (unsigned __int16 *)Ztl_variant_t::GetUnknown(v4, (char)v53.m_Data, v54);
  v5 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
         &v66,
         (int)&v64);
  if ( v5 < 0 && v5 != -2147467262 )
    _com_issue_error(v5);
  LOBYTE(v68) = 3;
  v6 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
  if ( v6 < 0 )
    _com_issue_error(v6);
  LOBYTE(v68) = 2;
  v7 = ZComAPI::ZComVariantClear((tagVARIANT *)&v58.0);
  if ( v7 < 0 )
    _com_issue_error(v7);
  LOBYTE(v68) = 1;
  v8 = ZComAPI::ZComVariantClear((tagVARIANT *)&v57.0);
  v9 = (Ztl_variant_t *)v54;
  if ( v8 < 0 )
    _com_issue_error(v8);
  v68 = 0;
  if ( v66.m_pInterface )
  {
    v54 = 0;
    v53.m_Data = 0;
    v52 = v9;
    v64._m_pStr = (unsigned __int16 *)&v52;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v52, aDiff);
    LOBYTE(v68) = 0;
    v51 = &result;
    v12 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v66);
    v13 = IWzProperty::Getitem(v12, v51, (Ztl_bstr_t)v52);
    LOBYTE(v68) = 8;
    v60 = (int)Ztl_variant_t::GetUnknown(v13, (char)v53.m_Data, v54);
    v63.m_pInterface = 0;
    if ( v60 )
    {
      v14 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v63,
              (int)&v60);
      if ( v14 < 0 && v14 != -2147467262 )
        _com_issue_error(v14);
    }
    LOBYTE(v68) = 10;
    v15 = ZComAPI::ZComVariantClear((tagVARIANT *)&result.0);
    if ( v15 < 0 )
      _com_issue_error(v15);
    for ( i = 0; ; i = (_bstr_t::Data_t *)((char *)i + 1) )
    {
      v64._m_pStr = 0;
      v54 = -1;
      v53.m_Data = i;
      LOBYTE(v68) = 11;
      v16 = ZXString<unsigned short>::Format(&v64, aPD, i);
      v17 = ZXString<unsigned short>::operator unsigned short const *(v16);
      v53.m_Data = v18;
      v59 = &v53;
      Ztl_bstr_t::Ztl_bstr_t(&v53, v17);
      v52 = (Ztl_variant_t *)&v57;
      LOBYTE(v68) = 11;
      v19 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v63);
      v20 = IWzProperty::Getitem(v19, v52, v53);
      LOBYTE(v68) = 13;
      v21 = get_int32(v20, v54);
      LOBYTE(v68) = 11;
      v22 = ZComAPI::ZComVariantClear((tagVARIANT *)&v57.0);
      if ( v22 < 0 )
        _com_issue_error(v22);
      v54 = 0;
      v53.m_Data = i;
      v23 = ZXString<unsigned short>::Format(&v64, aLD, i);
      v24 = ZXString<unsigned short>::operator unsigned short const *(v23);
      v53.m_Data = v25;
      v59 = &v53;
      Ztl_bstr_t::Ztl_bstr_t(&v53, v24);
      v52 = (Ztl_variant_t *)&v58;
      LOBYTE(v68) = 11;
      v26 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v63);
      v27 = IWzProperty::Getitem(v26, v52, v53);
      LOBYTE(v68) = 15;
      v28 = get_int32(v27, v54);
      LOBYTE(v68) = 11;
      v29 = ZComAPI::ZComVariantClear((tagVARIANT *)&v58.0);
      if ( v29 < 0 )
        _com_issue_error(v29);
      if ( v21 < 0 )
        break;
      v30 = &v62->m_MemoryRegions;
      v31 = ZArray<unsigned long>::InsertBefore(&v62->m_MemoryRegions, -1);
      v54 = -1;
      *v31 = v21;
      *ZArray<unsigned long>::InsertBefore(v30, v54) = v28;
      LOBYTE(v68) = 10;
      ZXString<unsigned short>::~ZXString<unsigned short>(&v64);
    }
    LOBYTE(v68) = 10;
    ZXString<unsigned short>::~ZXString<unsigned short>(&v64);
    v54 = 0;
    v53.m_Data = 0;
    v52 = v32;
    v59 = &v52;
    Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v52, aExe);
    v51 = (Ztl_variant_t *)&v57;
    LOBYTE(v68) = 10;
    v33 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v66);
    v34 = IWzProperty::Getitem(v33, v51, (Ztl_bstr_t)v52);
    LOBYTE(v68) = 17;
    v64._m_pStr = (unsigned __int16 *)Ztl_variant_t::GetUnknown(v34, (char)v53.m_Data, v54);
    v61.m_pInterface = 0;
    if ( v64._m_pStr )
    {
      v35 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::_QueryInterface(
              &v61,
              (int)&v64);
      if ( v35 < 0 && v35 != -2147467262 )
        _com_issue_error(v35);
    }
    LOBYTE(v68) = 19;
    v36 = ZComAPI::ZComVariantClear((tagVARIANT *)&v57.0);
    if ( v36 < 0 )
      _com_issue_error(v36);
    v37 = 0;
    v38 = &v62->m_MemoryHashes;
    do
    {
      v39 = alloca(32);
      v48 = 0;
      v40 = _Int2StrW(v37, (unsigned __int16 *)&v49);
      v59 = &v47;
      Ztl_bstr_t::Ztl_bstr_t((Ztl_bstr_t *)&v47, v40);
      LOBYTE(v68) = 19;
      v41 = _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::operator->(&v61);
      v42 = IWzProperty::Getitem(v41, (Ztl_variant_t *)&v58, (Ztl_bstr_t)v47);
      LOBYTE(v68) = 21;
      v43 = get_int32(v42, (int)v48);
      *ZArray<unsigned long>::InsertBefore(v38, -1) = v43;
      LOBYTE(v68) = 19;
      v44 = ZComAPI::ZComVariantClear((tagVARIANT *)&v58.0);
      if ( v44 < 0 )
        _com_issue_error(v44);
      ++v37;
    }
    while ( v37 < 2115 );
    v62->m_bMemoryCheckEnabled = 1;
    LOBYTE(v68) = 10;
    if ( v61.m_pInterface )
    {
      v45 = v61.m_pInterface->vfptr;
      v48 = v61.m_pInterface;
      ((void (__cdecl *)(IWzProperty *))v45->Release)(v61.m_pInterface);
    }
    LOBYTE(v68) = 0;
    if ( v63.m_pInterface )
    {
      v46 = v63.m_pInterface->vfptr;
      v47 = v63.m_pInterface;
      ((void (__cdecl *)(IWzProperty *, IWzProperty *))v46->Release)(v63.m_pInterface, v48);
    }
    v10 = v66.m_pInterface;
    v68 = -1;
    v11 = v66.m_pInterface == 0;
  }
  else
  {
    msgbox_timer(aNoCrcInfo, 0x30u, 5000);
    v10 = v66.m_pInterface;
    v68 = -1;
    v11 = v66.m_pInterface == 0;
  }
  if ( !v11 )
    ((void (__cdecl *)(IWzProperty *, IWzProperty *, IWzProperty *))v10->vfptr->Release)(v10, v47, v48);
}

//----- (00429EB5) --------------------------------------------------------
BOOL __thiscall CSecurityServer::IsCorrectMemoryHash(CSecurityServer *this, unsigned __int16 usSeq, unsigned int dwHash)
{
  return !this->m_bMemoryCheckEnabled || this->m_MemoryHashes.a[usSeq / 31] == dwHash;
}

//----- (00429EE3) --------------------------------------------------------
unsigned int *__thiscall ZArray<unsigned long>::InsertBefore(ZArray<unsigned long> *this, int nIndex)
{
  ZArray<unsigned long> *v2; // ebx@1
  int v3; // esi@4
  unsigned int c; // [sp+Ch] [bp-4h]@2

  v2 = this;
  if ( this->a )
    c = *(this->a - 1);
  else
    c = 0;
  v3 = nIndex;
  if ( nIndex == -1 )
    v3 = c;
  ZArray<unsigned long>::_Realloc(this, c + 1, 2, (ZAllocHelper *)&nIndex + 3);
  memmove(&v2->a[v3 + 1], &v2->a[v3], 4 * (c + 0x3FFFFFFF * v3));
  return &v2->a[v3];
}

//----- (00429F53) --------------------------------------------------------
void _E15_4()
{
  _E13_15();
  _E14_10();
}

//----- (00429F5D) --------------------------------------------------------
void _E13_15()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (00429F98) --------------------------------------------------------
void _E14_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (00429FD3) --------------------------------------------------------
unsigned int *__thiscall ZArray<unsigned long>::_Realloc(ZArray<unsigned long> *this, unsigned int u, int nMode, ZAllocHelper *_ALLOC)
{
  ZArray<unsigned long> *v4; // edi@1
  unsigned int v5; // ebx@2
  unsigned int v6; // esi@4
  void *v7; // esi@8
  int nModea; // [sp+1Ch] [bp+Ch]@7

  v4 = this;
  if ( this->a )
    v5 = *(this->a - 1);
  else
    v5 = 0;
  v6 = u;
  if ( u > v5 )
  {
    if ( u > (unsigned int)ZArray<unsigned long>::GetCapacity(this) )
    {
      v7 = (void *)(ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 4 * u + 4) + 4);
      if ( v4->a )
      {
        if ( !(nMode & 1) )
          memcpy(v7, v4->a, 4 * v5);
        ZAllocEx<ZAllocAnonSelector>::Free(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, v4->a - 1);
      }
      v4->a = (unsigned int *)v7;
      v6 = u;
    }
    else if ( !(nMode & 2) )
    {
      nModea = (int)&v4->a[v5];
    }
  }
  if ( v4->a )
    *(v4->a - 1) = v6;
  return v4->a;
}

//----- (0042A079) --------------------------------------------------------
void _E33_11()
{
  _E26_14();
  _E27_14();
  _E28_17();
  _E29_20();
  _E30_19();
  _E31_14();
  _E32_10();
}

//----- (0042A09C) --------------------------------------------------------
void _E26_14()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0042A0D7) --------------------------------------------------------
void _E27_14()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0042A112) --------------------------------------------------------
void _E28_17()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0042A14D) --------------------------------------------------------
void _E29_20()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0042A188) --------------------------------------------------------
void _E30_19()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0042A1C3) --------------------------------------------------------
void _E31_14()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0042A1FE) --------------------------------------------------------
void _E32_10()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0042A239) --------------------------------------------------------
unsigned int *__thiscall ZArray<unsigned long>::GetCapacity(ZArray<unsigned long> *this)
{
  unsigned int *result; // eax@1
  int v2; // eax@2

  result = this->a;
  if ( this->a )
  {
    v2 = *(result - 2);
    if ( v2 < 0 )
      v2 = ~v2;
    result = (unsigned int *)((unsigned int)(v2 - 4) >> 2);
  }
  return result;
}

//----- (0042A250) --------------------------------------------------------
int __thiscall CSecuritySession::PreProcessPacket(CSecuritySession *this, int nType, CInPacket *iPacket, unsigned __int16 usSeq)
{
  CSecuritySession *v4; // edi@1
  int v5; // esi@1
  int v6; // eax@2
  ZXString<char> *v7; // eax@6
  ZXString<char> *v8; // ecx@6
  int v9; // eax@7
  ZXString<char> *v10; // eax@15

  v4 = this;
  v5 = usSeq % 31 == 0;
  if ( nType == 17 )
  {
    v6 = (unsigned __int8)CInPacket::Decode1(iPacket);
    if ( !v5 || v6 == 1 )
    {
      v9 = v6 - 1;
      if ( v9 )
      {
        if ( v9 == 2 )
          CSecuritySession::OnGameGuardAuth(v4, iPacket);
        else
          CSecuritySessionHelper::CloseSocket(v4->m_pOwner);
      }
      else
      {
        CSecuritySession::OnMemoryHash(v4, usSeq, iPacket);
      }
      return 0;
    }
    if ( !CSecuritySessionHelper::IsSkipCrcIP(v4->m_pOwner) || !CSecuritySessionHelper::IsAdminClient(v4->m_pOwner) )
    {
      v7 = CSecuritySessionHelper::GetLogInfo((ZXString<char> *)&iPacket, v4->m_pOwner);
      LogError(aSecurityFailed, v7->_m_pStr);
      v8 = (ZXString<char> *)&iPacket;
LABEL_16:
      ZXString<char>::~ZXString<char>(v8);
      CSecuritySessionHelper::CloseSocket(v4->m_pOwner);
      return 0;
    }
  }
  else if ( usSeq % 31 == 0
         && (!CSecuritySessionHelper::IsSkipCrcIP(this->m_pOwner) || !CSecuritySessionHelper::IsAdminClient(v4->m_pOwner)) )
  {
    v10 = CSecuritySessionHelper::GetLogInfo((ZXString<char> *)&usSeq, v4->m_pOwner);
    LogError(aSecurityFailed, v10->_m_pStr);
    v8 = (ZXString<char> *)&usSeq;
    goto LABEL_16;
  }
  return 1;
}

//----- (0042A368) --------------------------------------------------------
void __thiscall CSecuritySession::SendMemoryRegion(CSecuritySession *this)
{
  CSecuritySession *v1; // ebx@1
  unsigned int *v2; // esi@1
  unsigned int v3; // eax@1
  _DWORD *v4; // esi@3
  int v5; // eax@4
  COutPacket oPacket; // [sp+8h] [bp-1Ch]@1
  int v7; // [sp+20h] [bp-4h]@1

  v1 = this;
  v2 = (unsigned int *)&TSingleton<CSecurityServer>::ms_pInstance->m_MemoryRegions.a;
  COutPacket::COutPacket(&oPacket, 16, 0);
  v7 = 0;
  COutPacket::Encode1(&oPacket, 0);
  v3 = *v2;
  if ( *v2 )
    v3 = *(_DWORD *)(v3 - 4);
  COutPacket::Encode2(&oPacket, v3 >> 1);
  v4 = (_DWORD *)*v2;
  if ( v4 )
    v5 = *(v4 - 1);
  else
    v5 = 0;
  COutPacket::EncodeBuffer(&oPacket, v4, 4 * v5);
  CSecuritySessionHelper::SendPacket(v1->m_pOwner, &oPacket);
  v7 = -1;
  ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
}

//----- (0042A3F1) --------------------------------------------------------
void __thiscall CSecuritySession::Init(CSecuritySession *this)
{
  CSecuritySession *v1; // esi@1

  v1 = this;
  CCSAuth2::Init(&this->m_Auth);
  v1->m_tNextAuth = 0;
  v1->m_nGGAuthReqPacketRecv = 0;
  v1->m_bCenterResultPacketCame = 0;
  COutPacket::Init(&v1->m_oPacket, 2, 1);
}

//----- (0042A415) --------------------------------------------------------
void __thiscall CSecuritySession::Update(CSecuritySession *this, int tCur)
{
  CSecuritySession *v2; // esi@1
  int v3; // eax@1
  ZXString<char> *v4; // eax@5

  v2 = this;
  v3 = this->m_tNextAuth;
  if ( v3
    && tCur - v3 > 0
    && (!CSecuritySessionHelper::IsSkipCrcIP(this->m_pOwner) || !CSecuritySessionHelper::IsAdminClient(v2->m_pOwner)) )
  {
    v4 = CSecuritySessionHelper::GetLogInfo((ZXString<char> *)&tCur, v2->m_pOwner);
    LogError(aSecurityFail_2, v4->_m_pStr);
    ZXString<char>::~ZXString<char>((ZXString<char> *)&tCur);
    CSecuritySessionHelper::CloseSocket(v2->m_pOwner);
  }
}

//----- (0042A493) --------------------------------------------------------
void __thiscall CSecuritySession::OnGameGuardAuth(CSecuritySession *this, CInPacket *iPacket)
{
  CSecuritySession *v2; // esi@1
  char *v3; // ST08_4@4
  ZXString<char> *v4; // ecx@4
  signed int v5; // eax@5
  signed int v6; // edi@5
  char *v7; // ST08_4@10
  COutPacket oPacket; // [sp+8h] [bp-20h]@6
  ZXString<char> v9; // [sp+18h] [bp-10h]@10
  int v10; // [sp+24h] [bp-4h]@4

  v2 = this;
  if ( this->m_nGGAuthReqPacketRecv < 2 )
  {
    CInPacket::DecodeBuffer(iPacket, &this->m_Auth.m_AuthAnswer, 0x10u);
    ++v2->m_nGGAuthReqPacketRecv;
    v5 = CCSAuth2::CheckAuthAnswer(&v2->m_Auth);
    v6 = v5;
    if ( v2->m_bForCheckGameGuardUpdate )
    {
      COutPacket::COutPacket(&oPacket, 21, 0);
      v10 = 1;
      COutPacket::Encode1(&oPacket, v6 == 0);
      CSecuritySessionHelper::SendPacket(v2->m_pOwner, &oPacket);
      v10 = -1;
      ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
      return;
    }
    if ( v5 )
    {
      if ( !CSecuritySessionHelper::IsSkipCrcIP(v2->m_pOwner) || !CSecuritySessionHelper::IsAdminClient(v2->m_pOwner) )
      {
        v7 = CSecuritySessionHelper::GetLogInfo(&v9, v2->m_pOwner)->_m_pStr;
        v10 = 2;
        LogError(aSecurityFail_1, v6, v7);
        v10 = -1;
        v4 = &v9;
        goto LABEL_11;
      }
    }
    else if ( v2->m_nGGAuthReqPacketRecv == 1 )
    {
      CSecuritySession::SendGGAuthReqPacket(v2, 0);
    }
    else if ( v2->m_bCenterResultPacketCame )
    {
      CSecuritySessionHelper::SendPacket(v2->m_pOwner, &v2->m_oPacket);
    }
  }
  else if ( !CSecuritySessionHelper::IsSkipCrcIP(this->m_pOwner) || !CSecuritySessionHelper::IsAdminClient(v2->m_pOwner) )
  {
    v3 = CSecuritySessionHelper::GetLogInfo((ZXString<char> *)&iPacket, v2->m_pOwner)->_m_pStr;
    LogError(aSecurityFail_3, v3);
    v10 = -1;
    v4 = (ZXString<char> *)&iPacket;
LABEL_11:
    ZXString<char>::~ZXString<char>(v4);
    CSecuritySessionHelper::CloseSocket(v2->m_pOwner);
    return;
  }
}

//----- (0042A5DF) --------------------------------------------------------
void __thiscall CSecuritySession::SendGGAuthReqPacket(CSecuritySession *this, int bForCheckGameGuardUpdate)
{
  CSecuritySession *v2; // esi@1
  signed int v3; // edi@1
  DWORD v4; // eax@2
  char *v5; // ST08_4@7
  COutPacket oPacket; // [sp+8h] [bp-1Ch]@2
  int v7; // [sp+20h] [bp-4h]@2

  v2 = this;
  this->m_bForCheckGameGuardUpdate = bForCheckGameGuardUpdate;
  v3 = CCSAuth2::GetAuthQuery(&this->m_Auth);
  if ( v3 )
  {
    if ( !CSecuritySessionHelper::IsSkipCrcIP(v2->m_pOwner) || !CSecuritySessionHelper::IsAdminClient(v2->m_pOwner) )
    {
      v5 = CSecuritySessionHelper::GetLogInfo((ZXString<char> *)&bForCheckGameGuardUpdate, v2->m_pOwner)->_m_pStr;
      LogError(aSecurityFail_4, v3, v5);
      v7 = -1;
      ZXString<char>::~ZXString<char>((ZXString<char> *)&bForCheckGameGuardUpdate);
      CSecuritySessionHelper::CloseSocket(v2->m_pOwner);
    }
  }
  else
  {
    COutPacket::COutPacket(&oPacket, 16, 0);
    v7 = 0;
    COutPacket::Encode1(&oPacket, 3);
    COutPacket::EncodeBuffer(&oPacket, &v2->m_Auth.m_AuthQuery, 0x10u);
    CSecuritySessionHelper::SendPacket(v2->m_pOwner, &oPacket);
    v4 = timeGetTime() + 120000;
    v2->m_tNextAuth = v4;
    if ( !v4 )
      v2->m_tNextAuth = 1;
    v7 = -1;
    ZArray<unsigned char>::RemoveAll(&oPacket.m_aSendBuff);
  }
}

//----- (0042A6C2) --------------------------------------------------------
void __cdecl NpLog(int mode, char *msg)
{
  CLog::OutputLog(TSingleton<CLog>::ms_pInstance, 2u, 8u, sTail, aS, msg);
}

//----- (0042A6E3) --------------------------------------------------------
void __cdecl GGAuthUpdateCallback(_GG_UPREPORT *report)
{
  char *v1; // ecx@1

  v1 = aGameguardVer;
  if ( report->nType != 1 )
    v1 = aProtocolNum;
  CLog::OutputLog(TSingleton<CLog>::ms_pInstance, 2u, 8u, sTail, aGgauthVersionU, v1, report->dwBefore, report->dwNext);
}

//----- (0042A71A) --------------------------------------------------------
void _E14_11()
{
  _E12_14();
  _E13_16();
}

//----- (0042A724) --------------------------------------------------------
void _E12_14()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>(v1);
  ZRecyclableAvBuffer<ZFixedArray<unsigned char,65536,0>::_ArrayData,1,ZFixedArray<unsigned char,65536,0>>::s_pInstance = v3;
}

//----- (0042A75F) --------------------------------------------------------
void _E13_16()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>(v1);
  ZRecyclableAvBuffer<ZMap<void *,ZSocket *,void *>::_PAIR,16,ZMap<void *,ZSocket *,void *>::_PAIR>::s_pInstance = v3;
}

//----- (0042A79A) --------------------------------------------------------
void _E31_15()
{
  _E24_17();
  _E25_14();
  _E26_15();
  _E27_15();
  _E28_18();
  _E29_21();
  _E30_20();
}

//----- (0042A7BD) --------------------------------------------------------
void _E24_17()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance = v3;
}
// 4A65A8: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<ZMemoryStream::CHUNK>,16,ZMemoryStream::CHUNK>::s_pInstance;

//----- (0042A7F8) --------------------------------------------------------
void _E25_14()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZSocketThread::REQ>,16,ZSocketThread::REQ>::s_pInstance = v3;
}

//----- (0042A833) --------------------------------------------------------
void _E26_15()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZPort::ZPortThread *>,16,ZPort::ZPortThread *>::s_pInstance = v3;
}

//----- (0042A86E) --------------------------------------------------------
void _E27_15()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::s_pInstance = v3;
}

//----- (0042A8A9) --------------------------------------------------------
void _E28_18()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *v1; // ecx@1
  int v2; // ST04_4@1
  int v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance = v3;
}
// 4A6598: using guessed type int ZRecyclableAvBuffer<ZRefCountedDummy<long>,16,long>::s_pInstance;

//----- (0042A8E4) --------------------------------------------------------
void _E29_21()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::s_pInstance = v3;
}

//----- (0042A91F) --------------------------------------------------------
void _E30_20()
{
  int v0; // eax@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v1; // ecx@1
  int v2; // ST04_4@1
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *v3; // eax@1

  v0 = ZAllocEx<ZAllocAnonSelector>::Alloc(&ZAllocEx<ZAllocAnonSelector>::_s_alloc, 0x28u);
  v1 = (ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)v0;
  v2 = v0;
  v3 = 0;
  if ( v2 )
    ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>(v1);
  ZRecyclableAvBuffer<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::s_pInstance = v3;
}

//----- (0042AB40) --------------------------------------------------------
signed int __cdecl InitGameguardAuth(const char *a1, int a2, int a3, int a4)
{
  int *v4; // eax@1
  int *v5; // eax@3
  FILE *v6; // edi@10
  signed int v8; // ebp@16
  int *v9; // esi@16
  int v10; // edi@27
  signed int v11; // eax@31
  signed int v12; // esi@35
  FILE *v13; // esi@37
  unsigned int v14; // [sp+10h] [bp-298h]@1
  FILE *File; // [sp+14h] [bp-294h]@10
  char Dest; // [sp+18h] [bp-290h]@10
  int v17; // [sp+118h] [bp-190h]@1
  char v18; // [sp+11Ch] [bp-18Ch]@1

  v17 = -1;
  memset(&v18, 0, 0x18Cu);
  dword_4A5EEC = a2;
  v14 = 0;
  ggGlobal = 0;
  Memory = 0;
  ::Dest = 0;
  dword_4A5FF8 = 2003010101;
  dword_4A604C = 2100010101;
  byte_4A6050 = 0;
  byte_4A60A4 = 0;
  dword_4A60A8 = 50;
  dword_4A60AC = 30;
  dword_4A60B0 = 0;
  dword_4A60B4 = 0;
  dword_4A60B8 = a3;
  dword_4A60BC = a4;
  v4 = dword_4A6000;
  do
  {
    *(v4 - 1) = 0;
    *v4 = 0;
    v4[1] = 0;
    v4[2] = 0;
    v4 += 4;
  }
  while ( (signed int)v4 < (signed int)&byte_4A6050 );
  v5 = dword_4A6058;
  do
  {
    *(v5 - 1) = 0;
    *v5 = 0;
    v5[1] = 0;
    v5[2] = 0;
    v5 += 4;
  }
  while ( (signed int)v5 < (signed int)&dword_4A60A8 );
  if ( a1 && *a1 )
  {
    if ( a1[strlen(a1) - 1] == 92 )
      strcpy(&::Dest, a1);
    else
      sprintf(&::Dest, aSC, a1, 92);
  }
  InitializeCriticalSection(&ggauth_lock);
  sprintf(&Dest, aSS_0, &::Dest, aCsauth2_cfg);
  v6 = fopen(&Dest, Mode);
  File = v6;
  if ( !v6 )
  {
    CleanupGameguardAuth();
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibFailLoada, &Dest);
      NpLog(2, msgBuf);
    }
    return 5;
  }
  if ( dword_4A60BC & 1 )
  {
    sprintf(msgBuf, aCSLibSuccessOp, &Dest);
    NpLog(1, msgBuf);
  }
  fseek(v6, 0, 0);
  v8 = 0;
  v9 = &v17;
  do
  {
    if ( fscanf(v6, aD, v9) == -1 )
      break;
    ++v8;
    ++v9;
  }
  while ( v8 < 100 );
  if ( v8 < 1 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibBeforeCle);
      NpLog(2, msgBuf);
    }
    CleanupGameguardAuth();
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibFailLoa_0, &Dest);
      NpLog(2, msgBuf);
    }
    fclose(v6);
    return 5;
  }
  if ( dword_4A60BC & 1 )
  {
    sprintf(msgBuf, aCSLibInitgameg, v8);
    NpLog(1, msgBuf);
  }
  v10 = 0;
  if ( v8 <= 0 )
  {
LABEL_37:
    fclose(File);
    sprintf(&Dest, aSS_0, &::Dest, aCsver_cfg);
    v13 = fopen(&Dest, Mode);
    if ( !v13 )
    {
      if ( dword_4A60BC & 2 )
      {
        sprintf(msgBuf, aCSLibFailToL_0, &Dest);
        NpLog(2, msgBuf);
      }
      goto LABEL_56;
    }
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibSuccessLo, &Dest);
      NpLog(1, msgBuf);
    }
    fseek(v13, 0, 0);
    if ( fscanf(v13, aD, &v14) == -1 )
    {
      if ( dword_4A60BC & 2 )
      {
        sprintf(msgBuf, aCSLibFailToLoa, &Dest);
LABEL_54:
        NpLog(2, msgBuf);
        goto LABEL_55;
      }
    }
    else if ( v14 && v14 >= 0x77638235 && v14 <= 0x7D2B9C75 )
    {
      dword_4A604C = v14;
    }
    else if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibInvalid_0, v14);
      goto LABEL_54;
    }
LABEL_55:
    fclose(v13);
LABEL_56:
    Blowfish_Init((struct BLOWFISH_CTX *)&ctx, a_sauT2Ky, 0xAu);
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibInitgam_0, &::Dest);
      NpLog(2, msgBuf);
    }
    return 0;
  }
  while ( 1 )
  {
    sprintf(&Dest, aSggauthD_dll, &::Dest, *(&v17 + v10));
    if ( v10 )
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibLoadAddit, &Dest);
        NpLog(1, msgBuf);
      }
      v11 = LoadAuthProtocol(&Dest, 0);
    }
    else
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibLoadDefau, &Dest);
        NpLog(1, msgBuf);
      }
      v11 = LoadAuthProtocol(&Dest, 1);
    }
    v12 = v11;
    if ( v11 )
      break;
    if ( ++v10 >= v8 )
      goto LABEL_37;
  }
  if ( dword_4A60BC & 2 )
  {
    sprintf(msgBuf, aCSLibFailLdLoa, v11, &Dest);
    NpLog(2, msgBuf);
  }
  CleanupGameguardAuth();
  fclose(File);
  return v12;
}
// 4A5EEC: using guessed type int dword_4A5EEC;
// 4A5FF8: using guessed type int dword_4A5FF8;
// 4A6000: using guessed type int dword_4A6000[];
// 4A604C: using guessed type int dword_4A604C;
// 4A6050: using guessed type char byte_4A6050;
// 4A6058: using guessed type int dword_4A6058[];
// 4A60A4: using guessed type char byte_4A60A4;
// 4A60A8: using guessed type int dword_4A60A8;
// 4A60AC: using guessed type int dword_4A60AC;
// 4A60B0: using guessed type int dword_4A60B0;
// 4A60B4: using guessed type int dword_4A60B4;
// 4A60B8: using guessed type int dword_4A60B8;
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042B050) --------------------------------------------------------
void CleanupGameguardAuth()
{
  _DWORD *i; // esi@1

  for ( i = Memory; Memory; i = Memory )
  {
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibCleanup_0, i, i[1], i[12], i[13]);
      NpLog(2, msgBuf);
    }
    Memory = (void *)i[12];
    if ( *i )
      FreeLibrary((HMODULE)*i);
    free(i);
  }
  DeleteCriticalSection(&ggauth_lock);
  if ( dword_4A60BC & 1 )
  {
    sprintf(msgBuf, aCSLibCleanupga);
    NpLog(2, msgBuf);
  }
}
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042B0F0) --------------------------------------------------------
int GGAuthUpdateTimer()
{
  struct tm *v0; // eax@1
  _DWORD *v1; // edi@1
  struct tm *v2; // esi@1
  time_t Time; // [sp+8h] [bp-4h]@1

  Time = time(0);
  v0 = localtime(&Time);
  v1 = Memory;
  v2 = v0;
  if ( Memory )
  {
    do
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(
          msgBuf,
          aCSLibUpdatetim,
          v1[1],
          v2->tm_year + 1900,
          v2->tm_mon + 1,
          v2->tm_mday,
          v2->tm_hour,
          v2->tm_min,
          v2->tm_sec);
        NpLog(1, msgBuf);
      }
      ((void (*)(void))v1[11])();
      v1 = (_DWORD *)v1[12];
    }
    while ( v1 );
  }
  return 0;
}
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042B170) --------------------------------------------------------
int __cdecl AddAuthProtocol(char *a1)
{
  signed int v1; // esi@1
  int result; // eax@4

  v1 = LoadAuthProtocol(a1, 0);
  if ( v1 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibFailLdLoa, v1, a1);
      NpLog(2, msgBuf);
    }
    result = v1;
  }
  else
  {
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibAddauthpr, a1);
      NpLog(1, msgBuf);
    }
    result = 0;
  }
  return result;
}
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042B1E0) --------------------------------------------------------
signed int __cdecl SetGGVerLimit(unsigned int a1)
{
  signed int result; // eax@6
  FILE *v2; // eax@7
  FILE *v3; // edi@7
  char Dest; // [sp+8h] [bp-100h]@7

  if ( !a1 || a1 < 0x77638235 || a1 > 0x7D2B9C75 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibInvalidGg, a1);
      NpLog(2, msgBuf);
    }
    return 101;
  }
  if ( a1 <= dword_4A5FF8 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibTooLowerV, a1, dword_4A5FF8);
      NpLog(2, msgBuf);
      return 101;
    }
    return 101;
  }
  sprintf(&Dest, aSS_0, &::Dest, aCsver_cfg);
  v2 = fopen(&Dest, aW);
  v3 = v2;
  if ( v2 )
  {
    fprintf(v2, aLd, a1);
    fclose(v3);
    dword_4A604C = a1;
    result = 0;
  }
  else
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibSFailToOp, &Dest);
      NpLog(2, msgBuf);
    }
    result = 5;
  }
  return result;
}
// 4A5FF8: using guessed type int dword_4A5FF8;
// 4A604C: using guessed type int dword_4A604C;
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042B320) --------------------------------------------------------
signed int __cdecl SetUpdateCondition(int a1, signed int a2)
{
  signed int result; // eax@4

  if ( a1 <= 0 || a2 <= 0 || a2 > 100 )
  {
    result = 10;
  }
  else
  {
    dword_4A60A8 = a2;
    dword_4A60AC = a1;
    result = 0;
  }
  return result;
}
// 4A60A8: using guessed type int dword_4A60A8;
// 4A60AC: using guessed type int dword_4A60AC;

//----- (0042B350) --------------------------------------------------------
signed int __cdecl LoadAuthProtocol(char *a1, int a2)
{
  void *v2; // esi@1
  signed int result; // eax@2
  HMODULE v4; // eax@3
  FARPROC v5; // ebx@7
  FARPROC v6; // eax@7
  HMODULE v7; // ST20_4@7
  FARPROC v8; // eax@7
  HMODULE v9; // ST20_4@7
  FARPROC v10; // eax@7
  HMODULE v11; // ST20_4@7
  FARPROC v12; // eax@7
  int v13; // ecx@14
  char v14; // bl@14
  _DWORD *v15; // eax@16
  int v16; // ecx@17
  _DWORD *v17; // esi@27
  char Dest; // [sp+10h] [bp-104h]@3

  v2 = malloc(0x38u);
  memset(v2, 0, 0x38u);
  if ( v2 )
  {
    sprintf(&Dest, aS, a1);
    v4 = LoadLibraryA(&Dest);
    *(_DWORD *)v2 = v4;
    if ( v4 )
    {
      v5 = GetProcAddress(v4, aPrtcgetversion);
      v6 = GetProcAddress(*(HMODULE *)v2, aPrtcgetauthque);
      v7 = *(HMODULE *)v2;
      *((_DWORD *)v2 + 7) = v6;
      *((_DWORD *)v2 + 8) = GetProcAddress(v7, aPrtccheckautha);
      v8 = GetProcAddress(*(HMODULE *)v2, aPrtcencryptque);
      v9 = *(HMODULE *)v2;
      *((_DWORD *)v2 + 9) = v8;
      v10 = GetProcAddress(v9, aPrtcdecryptans);
      v11 = *(HMODULE *)v2;
      *((_DWORD *)v2 + 10) = v10;
      v12 = GetProcAddress(v11, aPrtcupdatetime);
      *((_DWORD *)v2 + 11) = v12;
      if ( v5 && *((_DWORD *)v2 + 7) && *((_DWORD *)v2 + 8) && *((_DWORD *)v2 + 9) && *((_DWORD *)v2 + 10) && v12 )
      {
        *((_DWORD *)v2 + 1) = ((int (__cdecl *)(int))v5)(dword_4A60B8);
        *((_DWORD *)v2 + 2) = 0;
        *((_DWORD *)v2 + 3) = 0;
        *((_DWORD *)v2 + 4) = time(0);
        *((_DWORD *)v2 + 5) = 0;
        *((_DWORD *)v2 + 6) = 0;
        if ( a2 )
        {
          v13 = *((_DWORD *)v2 + 3);
          *((_DWORD *)v2 + 6) = 0;
          *((_DWORD *)v2 + 12) = 0;
          *((_DWORD *)v2 + 3) = v13 | 3;
          *((_DWORD *)v2 + 13) = 0;
          v14 = 1;
          Memory = v2;
          if ( dword_4A60BC & 1 )
          {
            sprintf(msgBuf, aCSLibGgglobal_, *((_DWORD *)v2 + 1));
            NpLog(1, msgBuf);
          }
        }
        else
        {
          v15 = Memory;
          if ( Memory )
          {
            while ( 1 )
            {
              v16 = v15[12];
              if ( !v16 )
                break;
              v15 = (_DWORD *)v15[12];
              if ( !v16 )
                goto LABEL_22;
            }
            if ( v15 )
            {
              v15[12] = v2;
              *((_DWORD *)v2 + 13) = v15;
            }
          }
LABEL_22:
          v14 = 1;
          if ( dword_4A60BC & 1 )
          {
            sprintf(msgBuf, aCSLibAddANewPr, *((_DWORD *)v2 + 1), v2, *((_DWORD *)v2 + 12), *((_DWORD *)v2 + 13));
            NpLog(1, msgBuf);
          }
        }
        EnterCriticalSection(&ggauth_lock);
        ++ggGlobal;
        LeaveCriticalSection(&ggauth_lock);
        if ( (unsigned __int8)v14 & (unsigned __int8)dword_4A60BC )
        {
          sprintf(msgBuf, aCSLibProtocolS);
          NpLog(1, msgBuf);
          if ( dword_4A60BC & 1 )
          {
            sprintf(msgBuf, aCSLibLoadauthp, &Dest);
            NpLog(1, msgBuf);
          }
        }
        v17 = Memory;
        if ( (unsigned __int8)dword_4A60BC & (unsigned __int8)v14 )
        {
          sprintf(
            msgBuf,
            aCSLibVer0xLxPt,
            *((_DWORD *)Memory + 1),
            Memory,
            *((_DWORD *)Memory + 12),
            *((_DWORD *)Memory + 13));
          NpLog(1, msgBuf);
        }
        while ( v17 )
        {
          v17 = (_DWORD *)v17[12];
          if ( !v17 )
            break;
          if ( (unsigned __int8)v14 & (unsigned __int8)dword_4A60BC )
          {
            sprintf(msgBuf, aCSLib_0);
            NpLog(1, msgBuf);
            if ( dword_4A60BC & 1 )
            {
              sprintf(msgBuf, aCSLibVer0xLxPt, v17[1], v17, v17[12], v17[13]);
              NpLog(1, msgBuf);
            }
          }
        }
        if ( (unsigned __int8)v14 & (unsigned __int8)dword_4A60BC )
        {
          sprintf(msgBuf, aCSLibTotalLoad, ggGlobal);
          NpLog(1, msgBuf);
          if ( dword_4A60BC & 1 )
          {
            sprintf(msgBuf, aCSLib);
            NpLog(1, msgBuf);
          }
        }
        result = 0;
      }
      else
      {
        if ( dword_4A60BC & 2 )
        {
          sprintf(
            msgBuf,
            aCSLibFailGetpr,
            *((_DWORD *)v2 + 7),
            *((_DWORD *)v2 + 8),
            *((_DWORD *)v2 + 9),
            *((_DWORD *)v2 + 10),
            v12,
            &Dest);
          NpLog(2, msgBuf);
        }
        FreeLibrary(*(HMODULE *)v2);
        free(v2);
        result = 3;
      }
    }
    else
    {
      if ( dword_4A60BC & 2 )
      {
        sprintf(msgBuf, aCSLibFailLoadl, &Dest);
        NpLog(2, msgBuf);
      }
      free(v2);
      result = 2;
    }
  }
  else
  {
    result = 1;
  }
  return result;
}
// 4A60B8: using guessed type int dword_4A60B8;
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042B720) --------------------------------------------------------
signed int __cdecl UnloadAuthProtocol(struct _GG_AUTH_PROTOCOL *Memory)
{
  _DWORD *v1; // edi@1
  int v2; // eax@1
  signed int result; // eax@5

  v1 = ::Memory;
  v2 = *((_DWORD *)::Memory + 12);
  if ( ggGlobal > 1u && v2 )
  {
    while ( (struct _GG_AUTH_PROTOCOL *)v2 != Memory )
    {
      v1 = (_DWORD *)v2;
      v2 = *(_DWORD *)(v2 + 48);
      if ( !v2 )
        goto LABEL_5;
    }
    EnterCriticalSection(&ggauth_lock);
    v1[12] = *((_DWORD *)Memory + 12);
    *(_DWORD *)(*((_DWORD *)Memory + 12) + 52) = v1;
    if ( *(_DWORD *)Memory )
      FreeLibrary(*(HMODULE *)Memory);
    free((void *)Memory);
    --ggGlobal;
    LeaveCriticalSection(&ggauth_lock);
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibUnloadaut, Memory);
      NpLog(1, msgBuf);
    }
    result = 0;
  }
  else
  {
LABEL_5:
    result = 10;
  }
  return result;
}
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042B7D0) --------------------------------------------------------
signed int __cdecl UpdateGGVersion(time_t Time2)
{
  time_t v1; // ebx@1
  unsigned int v2; // ebp@1
  time_t v4; // eax@12
  int v5; // edi@14
  int *v6; // esi@14
  int v7; // ecx@19
  int *v8; // eax@19
  int v9; // eax@23
  unsigned int v10; // ecx@23
  int *v11; // eax@26
  int v12; // esi@27
  int v13; // ebx@28
  int *v14; // esi@28
  unsigned int v15; // ecx@30
  time_t v16; // eax@33
  int v17; // edi@41
  int *v18; // esi@41
  unsigned int v19; // eax@48
  int *v20; // eax@53
  int v21; // eax@58
  signed int v22; // esi@60
  signed int v23; // ebp@60
  int *v24; // edi@60
  signed int v25; // ecx@66
  int *v26; // eax@66
  int v27; // eax@77
  int v28; // edi@84
  int *v29; // esi@84
  time_t v30; // [sp+8h] [bp-10h]@28
  _GG_UPREPORT report; // [sp+Ch] [bp-Ch]@48
  int Time2a; // [sp+1Ch] [bp+4h]@14
  time_t Time2b; // [sp+1Ch] [bp+4h]@28

  v1 = Time2;
  v2 = 0;
  if ( !Time2 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibUpdateg_4, 0);
LABEL_98:
      NpLog(2, msgBuf);
      return 0;
    }
    return 0;
  }
  if ( (unsigned int)Time2 < 0x77638235 || (unsigned int)Time2 > 0x7D2B9C75 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibUpdateg_4, Time2);
      goto LABEL_98;
    }
    return 0;
  }
  if ( Time2 > (unsigned int)dword_4A604C )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibUpdateg_3, Time2, dword_4A604C);
      NpLog(2, msgBuf);
      return 0;
    }
    return 0;
  }
  if ( dword_4A5FF8 <= (unsigned int)Time2 )
  {
    if ( dword_4A5FF8 < (unsigned int)Time2 && !byte_4A6050 )
    {
      byte_4A6050 = 1;
      v4 = time(0);
      dword_4A60B0 = v4;
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibUpdateg_9, Time2, v4);
        NpLog(1, msgBuf);
      }
    }
    Time2a = time(0);
    v5 = 0;
    v6 = dword_4A5FFC;
    while ( *v6 != v1 || !*v6 || abs((signed __int64)difftime(v6[2], Time2a)) >= 3600 )
    {
      v6 += 4;
      ++v5;
      if ( (signed int)v6 >= (signed int)&dword_4A604C )
      {
        v7 = 0;
        v8 = dword_4A5FFC;
        while ( *v8 )
        {
          v8 += 4;
          ++v7;
          if ( (signed int)v8 >= (signed int)&dword_4A604C )
            goto LABEL_59;
        }
        v21 = 4 * v7;
        dword_4A5FFC[v21] = v1;
        dword_4A6000[v21] = 1;
        dword_4A6004[v21] = Time2a;
        dword_4A6008[v21] = Time2a;
LABEL_59:
        if ( v7 == 5 )
        {
          v22 = -1;
          v23 = 0;
          v24 = dword_4A6000;
          do
          {
            if ( abs((signed __int64)difftime(v24[1], Time2a)) > 3600
              && dword_4A6000[4 * (v22 != -1 ? v22 : 0)] > (unsigned int)*v24 )
            {
              v22 = v23;
            }
            v24 += 4;
            ++v23;
          }
          while ( (signed int)v24 < (signed int)&byte_4A6050 );
          if ( v22 == -1 )
          {
            v25 = 0;
            v26 = dword_4A6004;
            do
            {
              if ( dword_4A6004[4 * (v22 != -1 ? v22 : 0)] > (unsigned int)*v26 )
                v22 = v25;
              v26 += 4;
              ++v25;
            }
            while ( (signed int)v26 < (signed int)dword_4A6054 );
            if ( v22 == -1 )
              v22 = 0;
            if ( dword_4A60BC & 1 )
            {
              sprintf(
                msgBuf,
                aCSLibUpdateg_2,
                v1,
                v22,
                dword_4A5FFC[4 * v22],
                dword_4A6000[4 * v22],
                dword_4A6004[4 * v22],
                dword_4A6008[4 * v22]);
              goto LABEL_76;
            }
          }
          else if ( dword_4A60BC & 1 )
          {
            sprintf(
              msgBuf,
              aCSLibUpdateg_6,
              v1,
              v22,
              dword_4A5FFC[4 * v22],
              dword_4A6000[4 * v22],
              dword_4A6004[4 * v22],
              dword_4A6008[4 * v22]);
LABEL_76:
            NpLog(1, msgBuf);
          }
          v27 = 4 * v22;
          dword_4A5FFC[v27] = v1;
          dword_4A6000[v27] = 1;
          dword_4A6004[v27] = Time2a;
          dword_4A6008[v27] = Time2a;
          if ( !(dword_4A60BC & 1) )
            goto LABEL_82;
          sprintf(msgBuf, aCSLibLdLdLdLdL, v22, dword_4A5FFC[v27], dword_4A6000[v27], dword_4A6004[v27], Time2a);
        }
        else
        {
          if ( !(dword_4A60BC & 1) )
            goto LABEL_84;
          sprintf(
            msgBuf,
            aCSLibUpdate_15,
            v7,
            dword_4A5FFC[4 * v7],
            dword_4A6000[4 * v7],
            dword_4A6004[4 * v7],
            dword_4A6008[4 * v7]);
        }
        NpLog(1, msgBuf);
        goto LABEL_82;
      }
    }
    v9 = 4 * v5;
    dword_4A6000[v9] = dword_4A6000[4 * v5] + 1;
    dword_4A6004[v9] = Time2a;
    v10 = dword_4A6000[4 * v5];
    if ( v10 < dword_4A5EEC
      || Time2a - dword_4A60B0 <= (unsigned int)(60 * dword_4A60AC)
      || dword_4A5FFC[v9] <= (unsigned int)dword_4A5FF8 )
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibUpdate_14, v1, v5, dword_4A5FFC[v9], v10, Time2a, dword_4A6008[v9]);
        NpLog(1, msgBuf);
      }
    }
    else
    {
      v11 = dword_4A6000;
      do
      {
        v12 = *v11;
        v11 += 4;
        v2 += v12;
      }
      while ( (signed int)v11 < (signed int)&byte_4A6050 );
      v13 = dword_4A60A8;
      v30 = 0;
      Time2b = -1;
      v14 = dword_4A5FFC;
      do
      {
        if ( *v14 > (unsigned int)dword_4A5FF8 )
        {
          v15 = v14[1];
          if ( v15 > v2 * v13 / 0x64 )
          {
            if ( dword_4A60BC & 1 )
            {
              sprintf(msgBuf, aCSLibUpdateg_1, *v14, v15, v2, 100 * v15 / v2, v13);
              NpLog(1, msgBuf);
              v13 = dword_4A60A8;
            }
            v16 = Time2b;
            if ( Time2b != -1 || (v16 = v30, Time2b = v30, (_UNKNOWN *)v14 != &unk_4A5FEC) )
            {
              if ( dword_4A5FFC[4 * v16] < (unsigned int)*v14 )
                Time2b = v30;
            }
          }
        }
        v14 += 4;
        ++v30;
      }
      while ( (signed int)v14 < (signed int)&dword_4A604C );
      if ( Time2b == -1 )
      {
        if ( dword_4A60BC & 1 )
        {
          sprintf(msgBuf, aCSLibUpdateggv);
          NpLog(1, msgBuf);
        }
      }
      else
      {
        if ( dword_4A60BC & 2 )
        {
          sprintf(msgBuf, aCSLibUpdateg_5);
          NpLog(2, msgBuf);
        }
        v17 = 0;
        v18 = dword_4A6000;
        do
        {
          if ( dword_4A60BC & 2 )
          {
            sprintf(msgBuf, aCSLibLdLdLdL_1, v17, *(v18 - 1), *v18, v18[1], v18[2], 100 * *v18 / v2);
            NpLog(2, msgBuf);
          }
          v18 += 4;
          ++v17;
        }
        while ( (signed int)v18 < (signed int)&byte_4A6050 );
        if ( dword_4A60BC & 2 )
        {
          sprintf(msgBuf, aCSLibCurrentVe, dword_4A5FF8);
          NpLog(2, msgBuf);
          if ( dword_4A60BC & 2 )
          {
            sprintf(msgBuf, aCSLibUpdateg_7);
            NpLog(2, msgBuf);
          }
        }
        report.dwBefore = dword_4A5FF8;
        v19 = dword_4A5FFC[4 * Time2b];
        dword_4A5FF8 = dword_4A5FFC[4 * Time2b];
        if ( dword_4A60BC & 2 )
        {
          sprintf(msgBuf, aCSLibUpdateg_0, v19);
          NpLog(2, msgBuf);
          v19 = dword_4A5FF8;
        }
        report.dwNext = v19;
        report.nType = 1;
        GGAuthUpdateCallback(&report);
      }
      v20 = dword_4A6000;
      do
      {
        *(v20 - 1) = 0;
        *v20 = 0;
        v20[1] = 0;
        v20[2] = 0;
        v20 += 4;
      }
      while ( (signed int)v20 < (signed int)&byte_4A6050 );
      byte_4A6050 = 0;
    }
LABEL_82:
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibUpdateg_5);
      NpLog(1, msgBuf);
    }
LABEL_84:
    v28 = 0;
    v29 = dword_4A6000;
    do
    {
      if ( *v29 && dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibLdLdLdL_0, v28, *(v29 - 1), *v29, v29[1], v29[2]);
        NpLog(1, msgBuf);
      }
      v29 += 4;
      ++v28;
    }
    while ( (signed int)v29 < (signed int)&byte_4A6050 );
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibCurrentVe, dword_4A5FF8);
      NpLog(1, msgBuf);
    }
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibUpdateg_7);
      NpLog(1, msgBuf);
      return 0;
    }
    return 0;
  }
  if ( dword_4A60BC & 2 )
  {
    sprintf(msgBuf, aCSLibUpdateg_8, Time2);
    NpLog(2, msgBuf);
  }
  return 12;
}
// 4A5EEC: using guessed type int dword_4A5EEC;
// 4A5FF8: using guessed type int dword_4A5FF8;
// 4A5FFC: using guessed type int dword_4A5FFC[];
// 4A6000: using guessed type int dword_4A6000[];
// 4A6004: using guessed type int dword_4A6004[];
// 4A6008: using guessed type int dword_4A6008[];
// 4A604C: using guessed type int dword_4A604C;
// 4A6050: using guessed type char byte_4A6050;
// 4A6054: using guessed type int dword_4A6054[];
// 4A60A8: using guessed type int dword_4A60A8;
// 4A60AC: using guessed type int dword_4A60AC;
// 4A60B0: using guessed type int dword_4A60B0;
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042BF30) --------------------------------------------------------
signed int __cdecl UpdateProtocol(struct _GG_AUTH_PROTOCOL *a1)
{
  unsigned int v1; // ebp@1
  unsigned int v2; // eax@4
  unsigned int v3; // ecx@7
  time_t v4; // eax@10
  int v5; // ebx@12
  int v6; // edi@12
  int *v7; // esi@12
  int v8; // ecx@17
  int *v9; // eax@17
  int v10; // eax@21
  unsigned int v11; // ecx@21
  int *v12; // eax@24
  int v13; // esi@25
  int v14; // ebx@26
  int *v15; // esi@26
  unsigned int v16; // ecx@28
  signed int v17; // eax@31
  int v18; // edi@39
  int *v19; // esi@39
  struct _GG_AUTH_PROTOCOL *v20; // esi@46
  int v21; // eax@46
  int v23; // eax@55
  int v24; // edx@55
  int *v25; // eax@62
  int v26; // eax@67
  signed int v27; // esi@69
  signed int v28; // ebp@69
  int *v29; // edi@69
  signed int v30; // ecx@75
  int *v31; // eax@75
  int v32; // eax@86
  int v33; // edi@93
  int *v34; // esi@93
  signed int v35; // [sp+10h] [bp-14h]@26
  signed int v36; // [sp+14h] [bp-10h]@26
  _GG_UPREPORT report; // [sp+18h] [bp-Ch]@55

  v1 = 0;
  if ( !a1 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibUpdate_11, 0);
LABEL_106:
      NpLog(2, msgBuf);
      return 0;
    }
    return 0;
  }
  v2 = *((_DWORD *)a1 + 1);
  if ( v2 < 0x10050 || v2 > 0x20000 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibUpdate_12, *((_DWORD *)a1 + 1));
      goto LABEL_106;
    }
    return 0;
  }
  if ( Memory )
  {
    v3 = *((_DWORD *)Memory + 1);
    if ( v3 <= v2 )
    {
      if ( v3 < v2 && !byte_4A60A4 )
      {
        byte_4A60A4 = 1;
        v4 = time(0);
        dword_4A60B4 = v4;
        if ( dword_4A60BC & 1 )
        {
          sprintf(msgBuf, aCSLibUpdatep_5, *((_DWORD *)a1 + 1), v4);
          NpLog(1, msgBuf);
        }
      }
      v5 = time(0);
      v6 = 0;
      v7 = dword_4A6054;
      while ( *v7 != *((_DWORD *)a1 + 1) || !*v7 || abs((signed __int64)difftime(v7[2], v5)) >= 3600 )
      {
        v7 += 4;
        ++v6;
        if ( (signed int)v7 >= (signed int)&byte_4A60A4 )
        {
          v8 = 0;
          v9 = dword_4A6054;
          while ( *v9 )
          {
            v9 += 4;
            ++v8;
            if ( (signed int)v9 >= (signed int)&byte_4A60A4 )
              goto LABEL_68;
          }
          v26 = 4 * v8;
          dword_4A6054[v26] = *((_DWORD *)a1 + 1);
          dword_4A6058[v26] = 1;
          dword_4A605C[v26] = v5;
          dword_4A6060[v26] = v5;
LABEL_68:
          if ( v8 == 5 )
          {
            v27 = -1;
            v28 = 0;
            v29 = dword_4A6058;
            do
            {
              if ( abs((signed __int64)difftime(v29[1], v5)) > 3600
                && dword_4A6058[4 * (v27 != -1 ? v27 : 0)] > (unsigned int)*v29 )
              {
                v27 = v28;
              }
              v29 += 4;
              ++v28;
            }
            while ( (signed int)v29 < (signed int)&dword_4A60A8 );
            if ( v27 == -1 )
            {
              v30 = 0;
              v31 = dword_4A605C;
              do
              {
                if ( dword_4A605C[4 * (v27 != -1 ? v27 : 0)] > (unsigned int)*v31 )
                  v27 = v30;
                v31 += 4;
                ++v30;
              }
              while ( (signed int)v31 < (signed int)&dword_4A60AC );
              if ( v27 == -1 )
                v27 = 0;
              if ( dword_4A60BC & 1 )
              {
                sprintf(
                  msgBuf,
                  aCSLibUpdatep_8,
                  *((_DWORD *)a1 + 1),
                  v27,
                  dword_4A6054[4 * v27],
                  dword_4A6058[4 * v27],
                  dword_4A605C[4 * v27],
                  dword_4A6060[4 * v27]);
                goto LABEL_85;
              }
            }
            else if ( dword_4A60BC & 1 )
            {
              sprintf(
                msgBuf,
                aCSLibUpdatep_6,
                *((_DWORD *)a1 + 1),
                v27,
                dword_4A6054[4 * v27],
                dword_4A6058[4 * v27],
                dword_4A605C[4 * v27],
                dword_4A6060[4 * v27]);
LABEL_85:
              NpLog(1, msgBuf);
            }
            v32 = 4 * v27;
            dword_4A6054[v32] = *((_DWORD *)a1 + 1);
            dword_4A6058[v32] = 1;
            dword_4A605C[v32] = v5;
            dword_4A6060[v32] = v5;
            if ( !(dword_4A60BC & 1) )
              goto LABEL_91;
            sprintf(msgBuf, aCSLibLdLxLdL_1, v27, dword_4A6054[v32], dword_4A6058[v32], dword_4A605C[v32], v5);
          }
          else
          {
            if ( !(dword_4A60BC & 1) )
              goto LABEL_93;
            sprintf(
              msgBuf,
              aCSLibUpdatep_0,
              v8,
              dword_4A6054[4 * v8],
              dword_4A6058[4 * v8],
              dword_4A605C[4 * v8],
              dword_4A6060[4 * v8]);
          }
          NpLog(1, msgBuf);
          goto LABEL_91;
        }
      }
      v10 = 4 * v6;
      dword_4A6058[v10] = dword_4A6058[4 * v6] + 1;
      dword_4A605C[v10] = v5;
      v11 = dword_4A6058[4 * v6];
      if ( v11 < dword_4A5EEC
        || v5 - dword_4A60B4 <= (unsigned int)(60 * dword_4A60AC)
        || (unsigned int)dword_4A6054[v10] <= *((_DWORD *)Memory + 1) )
      {
        if ( dword_4A60BC & 1 )
        {
          sprintf(msgBuf, aCSLibUpdate_16, *((_DWORD *)a1 + 1), v6, dword_4A6054[v10], v11, v5, dword_4A6060[v10]);
          NpLog(1, msgBuf);
        }
      }
      else
      {
        v12 = dword_4A6058;
        do
        {
          v13 = *v12;
          v12 += 4;
          v1 += v13;
        }
        while ( (signed int)v12 < (signed int)&dword_4A60A8 );
        v14 = dword_4A60A8;
        v36 = 0;
        v35 = -1;
        v15 = dword_4A6054;
        do
        {
          if ( (unsigned int)*v15 > *((_DWORD *)Memory + 1) )
          {
            v16 = v15[1];
            if ( v16 > v1 * v14 / 0x64 )
            {
              if ( dword_4A60BC & 1 )
              {
                sprintf(msgBuf, aCSLibUpdatep_2, *v15, v16, v1, 100 * v16 / v1, v14);
                NpLog(1, msgBuf);
                v14 = dword_4A60A8;
              }
              v17 = v35;
              if ( v35 != -1 || (v17 = v36, v35 = v36, (_UNKNOWN *)v15 != &unk_4A6044) )
              {
                if ( dword_4A6054[4 * v17] < (unsigned int)*v15 )
                  v35 = v36;
              }
            }
          }
          v15 += 4;
          ++v36;
        }
        while ( (signed int)v15 < (signed int)&byte_4A60A4 );
        if ( v35 == -1 )
        {
          if ( dword_4A60BC & 1 )
          {
            sprintf(msgBuf, aCSLibUpdatep_3);
            NpLog(1, msgBuf);
          }
        }
        else
        {
          if ( dword_4A60BC & 2 )
          {
            sprintf(msgBuf, aCSLibUpdatep_7);
            NpLog(2, msgBuf);
          }
          v18 = 0;
          v19 = dword_4A6058;
          do
          {
            if ( dword_4A60BC & 2 )
            {
              sprintf(msgBuf, aCSLibLdLxLdL_0, v18, *(v19 - 1), *v19, v19[1], v19[2], 100 * *v19 / v1);
              NpLog(2, msgBuf);
            }
            v19 += 4;
            ++v18;
          }
          while ( (signed int)v19 < (signed int)&dword_4A60A8 );
          if ( dword_4A60BC & 2 )
          {
            sprintf(msgBuf, aCSLibCurrentPr, *((_DWORD *)Memory + 1));
            NpLog(2, msgBuf);
            if ( dword_4A60BC & 2 )
            {
              sprintf(msgBuf, aCSLibUpdatep_1);
              NpLog(2, msgBuf);
            }
          }
          v20 = a1;
          v21 = dword_4A6054[4 * v35];
          if ( v21 != *((_DWORD *)a1 + 1) )
          {
            v20 = (struct _GG_AUTH_PROTOCOL *)Memory;
            if ( !Memory )
              goto LABEL_52;
            while ( *((_DWORD *)v20 + 1) != v21 )
            {
              v20 = (struct _GG_AUTH_PROTOCOL *)*((_DWORD *)v20 + 12);
              if ( !v20 )
                goto LABEL_52;
            }
            if ( !v20 )
            {
LABEL_52:
              if ( dword_4A60BC & 2 )
              {
                sprintf(msgBuf, aCSLibUpdate_10, v35, dword_4A6054[4 * v35]);
                NpLog(2, msgBuf);
              }
              return 12;
            }
          }
          report.dwBefore = *((_DWORD *)Memory + 1);
          v23 = *((_DWORD *)v20 + 12);
          v24 = *((_DWORD *)v20 + 13);
          if ( v23 )
          {
            *(_DWORD *)(v24 + 48) = v23;
            *(_DWORD *)(*((_DWORD *)v20 + 12) + 52) = *((_DWORD *)v20 + 13);
          }
          else
          {
            *(_DWORD *)(v24 + 48) = 0;
          }
          *((_DWORD *)Memory + 13) = v20;
          *((_DWORD *)Memory + 6) = 1;
          *((_DWORD *)v20 + 12) = Memory;
          *((_DWORD *)v20 + 13) = 0;
          Memory = (void *)v20;
          report.dwNext = *((_DWORD *)v20 + 1);
          report.nType = 2;
          GGAuthUpdateCallback(&report);
          if ( dword_4A60BC & 1 )
          {
            sprintf(msgBuf, aCSLibUpdatepro, *((_DWORD *)v20 + 1), *((_DWORD *)v20 + 2), *((_DWORD *)v20 + 4));
            NpLog(1, msgBuf);
          }
        }
        v25 = dword_4A6058;
        do
        {
          *(v25 - 1) = 0;
          *v25 = 0;
          v25[1] = 0;
          v25[2] = 0;
          v25 += 4;
        }
        while ( (signed int)v25 < (signed int)&dword_4A60A8 );
        byte_4A60A4 = 0;
      }
LABEL_91:
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibUpdate_13);
        NpLog(1, msgBuf);
      }
LABEL_93:
      v33 = 0;
      v34 = dword_4A6058;
      do
      {
        if ( *v34 && dword_4A60BC & 1 )
        {
          sprintf(msgBuf, aCSLibLdLxLdLdL, v33, *(v34 - 1), *v34, v34[1], v34[2]);
          NpLog(1, msgBuf);
        }
        v34 += 4;
        ++v33;
      }
      while ( (signed int)v34 < (signed int)&dword_4A60A8 );
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibCurrent_0, *((_DWORD *)Memory + 1));
        NpLog(1, msgBuf);
        if ( dword_4A60BC & 1 )
        {
          sprintf(msgBuf, aCSLibUpdatep_4);
          NpLog(1, msgBuf);
          return 0;
        }
      }
      return 0;
    }
  }
  if ( dword_4A60BC & 2 )
  {
    sprintf(msgBuf, aCSLibUpdatep_9, *((_DWORD *)a1 + 1));
    NpLog(2, msgBuf);
  }
  return 12;
}
// 4A5EEC: using guessed type int dword_4A5EEC;
// 4A6054: using guessed type int dword_4A6054[];
// 4A6058: using guessed type int dword_4A6058[];
// 4A605C: using guessed type int dword_4A605C[];
// 4A6060: using guessed type int dword_4A6060[];
// 4A60A4: using guessed type char byte_4A60A4;
// 4A60A8: using guessed type int dword_4A60A8;
// 4A60AC: using guessed type int dword_4A60AC;
// 4A60B4: using guessed type int dword_4A60B4;
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042C740) --------------------------------------------------------
CCSAuth2 *__thiscall CCSAuth2::CCSAuth2(CCSAuth2 *this)
{
  CCSAuth2 *v1; // esi@1

  v1 = this;
  CCSAuth2::Init(this);
  return v1;
}

//----- (0042C760) --------------------------------------------------------
void __thiscall CCSAuth2::Init(CCSAuth2 *this)
{
  char *v1; // eax@1
  char *v2; // eax@1
  char *v3; // eax@1
  char *v4; // eax@1
  unsigned int v5; // eax@1

  this->m_pProtocol = (struct _GG_AUTH_PROTOCOL *)Memory;
  v1 = (char *)&this->m_AuthQuery;
  this->m_AuthQuery.dwIndex = 0;
  *((_DWORD *)v1 + 1) = 0;
  *((_DWORD *)v1 + 2) = 0;
  *((_DWORD *)v1 + 3) = 0;
  v2 = (char *)&this->m_AuthAnswer;
  this->m_AuthAnswer.dwIndex = 0;
  *((_DWORD *)v2 + 1) = 0;
  *((_DWORD *)v2 + 2) = 0;
  *((_DWORD *)v2 + 3) = 0;
  v3 = (char *)&this->m_AuthQueryTmp;
  this->m_AuthQueryTmp.dwIndex = 0;
  *((_DWORD *)v3 + 1) = 0;
  *((_DWORD *)v3 + 2) = 0;
  *((_DWORD *)v3 + 3) = 0;
  this->m_bPrtcRef = 0;
  this->m_dwUserFlag = 0;
  v4 = (char *)&this->m_GGVer;
  this->m_GGVer.dwGGVer = 0;
  *((_DWORD *)v4 + 1) = 0;
  *((_DWORD *)v4 + 2) = 0;
  v5 = this->m_dwUserFlag;
  LOBYTE(v5) = v5 | 0x20;
  this->m_dwUserFlag = v5;
}

//----- (0042C7C0) --------------------------------------------------------
void __thiscall CCSAuth2::Close(CCSAuth2 *this)
{
  CCSAuth2 *v1; // esi@1
  unsigned int v2; // eax@1
  unsigned int v3; // eax@8

  v1 = this;
  v2 = this->m_dwUserFlag;
  if ( (this->m_dwUserFlag & 0x20) == 32 )
  {
    if ( this->m_bPrtcRef && v2 & 8 && dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibCloseDwre, *((_DWORD *)this->m_pProtocol + 2));
      NpLog(1, msgBuf);
    }
    v3 = v1->m_dwUserFlag;
    v1->m_bPrtcRef = 0;
    LOBYTE(v3) = v3 & 0xDF;
    v1->m_dwUserFlag = v3;
  }
  else if ( dword_4A60BC & 1 )
  {
    sprintf(msgBuf, aCSLibServerCcs);
    NpLog(1, msgBuf);
  }
}
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042C850) --------------------------------------------------------
signed int __thiscall CCSAuth2::GetAuthQuery(CCSAuth2 *this)
{
  CCSAuth2 *v1; // esi@1
  char *v2; // edx@1
  int v4; // eax@10
  unsigned __int16 v5; // ax@17
  unsigned __int16 v6; // ax@19
  unsigned __int16 v7; // ax@21
  unsigned __int16 v8; // ax@23
  char *v9; // ebp@26
  int v10; // edi@26
  char v11; // al@27
  unsigned int v12; // eax@29
  unsigned int v13; // ecx@29
  unsigned int v14; // edx@29

  v1 = this;
  v2 = (char *)&this->m_dwUserFlag;
  if ( (this->m_dwUserFlag & 0x20) != 32 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibGetauth_0);
LABEL_7:
      NpLog(2, msgBuf);
      return 4;
    }
    return 4;
  }
  if ( !this->m_pProtocol )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibGetauthqu);
      goto LABEL_7;
    }
    return 4;
  }
  if ( !this->m_bPrtcRef )
  {
    ++*((_DWORD *)this->m_pProtocol + 2);
    v4 = *((_DWORD *)Memory + 3);
    if ( !(v4 & 2) && *((_DWORD *)Memory + 2) > (unsigned int)dword_4A5EEC )
    {
      LOBYTE(v4) = v4 | 2;
      *((_DWORD *)Memory + 3) = v4;
    }
    this->m_bPrtcRef = 1;
  }
  if ( *v2 & 1 )
  {
    if ( !this->m_GGVer.dwGGVer )
      return 14;
    v5 = this->m_GGVer.wYear;
    if ( v5 < 0x7D3u )
      return 14;
    if ( v5 > 0x7DAu )
      return 14;
    v6 = this->m_GGVer.wMonth;
    if ( !v6 )
      return 14;
    if ( v6 > 0xCu )
      return 14;
    v7 = this->m_GGVer.wDay;
    if ( !v7 )
      return 14;
    if ( v7 > 0x1Fu )
      return 14;
    v8 = this->m_GGVer.wNum;
    if ( !v8 || v8 > 0x63u )
      return 14;
  }
  v9 = (char *)&this->m_AuthQuery;
  v10 = (*((int (__cdecl **)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))this->m_pProtocol + 7))(
          *((_DWORD *)this->m_pProtocol + 3),
          &this->m_GGVer,
          v2,
          &this->m_AuthQuery,
          &this->m_AuthAnswer);
  if ( v10 )
  {
    v11 = dword_4A60BC;
    if ( v10 == 11 )
    {
LABEL_33:
      if ( v11 & 1 )
      {
        sprintf(msgBuf, aCSLibPrtcget_0);
        NpLog(1, msgBuf);
        return v10;
      }
      return v10;
    }
LABEL_35:
    if ( v11 & 1 )
    {
      sprintf(msgBuf, aCSLibPrtcgetau, v10);
      NpLog(1, msgBuf);
    }
    return v10;
  }
  v12 = *(_DWORD *)v9;
  v13 = v1->m_AuthQuery.dwValue2;
  v1->m_AuthQueryTmp.dwValue1 = v1->m_AuthQuery.dwValue1;
  v14 = v1->m_AuthQuery.dwValue3;
  v1->m_AuthQueryTmp.dwIndex = v12;
  v1->m_AuthQueryTmp.dwValue2 = v13;
  v1->m_AuthQueryTmp.dwValue3 = v14;
  if ( v12 )
    v10 = (*((int (__cdecl **)(int))v1->m_pProtocol + 9))((int)&v1->m_AuthQuery);
  GGEncryptPacket(&v1->m_AuthQuery);
  if ( v10 )
  {
    v11 = dword_4A60BC;
    if ( v10 == 11 )
      goto LABEL_33;
    goto LABEL_35;
  }
  return 0;
}
// 4A5EEC: using guessed type int dword_4A5EEC;
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042CA00) --------------------------------------------------------
signed int __thiscall CCSAuth2::CheckAuthAnswer(CCSAuth2 *this)
{
  CCSAuth2 *v1; // edi@1
  unsigned int v3; // ecx@13
  unsigned int v4; // eax@13
  struct _GG_AUTH_PROTOCOL *v5; // esi@15
  int v6; // edx@16
  int v7; // eax@19
  int v8; // eax@20
  int v9; // ecx@25
  unsigned int v10; // ecx@39
  unsigned int v11; // esi@40
  unsigned int v12; // ebx@42
  unsigned int v13; // edx@44
  unsigned __int16 v14; // ax@56
  unsigned __int16 v15; // ax@58
  unsigned __int16 v16; // ax@60
  unsigned __int16 v17; // ax@62
  unsigned int *v18; // ebp@64
  int v19; // esi@64
  unsigned int v20; // ebx@73
  unsigned int v21; // eax@76
  unsigned int v22; // eax@78
  unsigned int v23; // eax@82
  struct _GG_AUTH_DATA v24; // [sp+10h] [bp-10h]@9

  v1 = this;
  if ( (this->m_dwUserFlag & 0x20) != 32 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibCheckau_8);
LABEL_7:
      NpLog(2, msgBuf);
      return 4;
    }
    return 4;
  }
  if ( !this->m_pProtocol )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibCheckau_7);
      goto LABEL_7;
    }
    return 4;
  }
  v24.dwIndex = this->m_AuthAnswer.dwIndex;
  v24.dwValue1 = this->m_AuthAnswer.dwValue1;
  v24.dwValue2 = this->m_AuthAnswer.dwValue2;
  v24.dwValue3 = this->m_AuthAnswer.dwValue3;
  GGDecryptPacket(&v24);
  if ( v1->m_AuthQueryTmp.dwIndex )
  {
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibCcsauth2C, v24.dwIndex, v24.dwValue1, v24.dwValue2, v24.dwValue3);
      NpLog(1, msgBuf);
    }
    (*((void (__cdecl **)(struct _GG_AUTH_DATA *))v1->m_pProtocol + 10))(&v24);
  }
  v3 = v24.dwIndex;
  v4 = *((_DWORD *)v1->m_pProtocol + 1);
  if ( v24.dwIndex <= v4 )
  {
    if ( v24.dwIndex < v4 )
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibCheckau_2, v24.dwIndex, *((_DWORD *)v1->m_pProtocol + 1));
        goto LABEL_36;
      }
      return 12;
    }
  }
  else
  {
    if ( v1->m_AuthQueryTmp.dwIndex )
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibCheckauth, v24.dwIndex, *((_DWORD *)v1->m_pProtocol + 1));
        goto LABEL_36;
      }
      return 12;
    }
    v1->m_dwUserFlag &= 0xFFFFFFF7;
    v5 = (struct _GG_AUTH_PROTOCOL *)Memory;
    if ( Memory )
    {
      while ( 1 )
      {
        v6 = *((_DWORD *)v5 + 1);
        if ( v6 == v3 && !*((_DWORD *)v5 + 6) )
          break;
        if ( dword_4A60BC & 1 )
        {
          v7 = *((_DWORD *)v5 + 12);
          if ( v7 )
            v8 = *(_DWORD *)(v7 + 4);
          else
            v8 = 0;
          sprintf(msgBuf, aCSLibCheckau_1, v3, v6, v8);
          NpLog(1, msgBuf);
          v3 = v24.dwIndex;
        }
        v5 = (struct _GG_AUTH_PROTOCOL *)*((_DWORD *)v5 + 12);
        if ( !v5 )
          goto LABEL_28;
      }
      --*((_DWORD *)v1->m_pProtocol + 2);
      v9 = v1->m_dwUserFlag | 8;
      v1->m_pProtocol = v5;
      v1->m_dwUserFlag = v9;
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibCheckau_5, v24.dwIndex, *((_DWORD *)v5 + 1));
        NpLog(1, msgBuf);
      }
      v3 = v24.dwIndex;
    }
LABEL_28:
    if ( (v1->m_dwUserFlag & 8) != 8 )
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibCheckau_4, v3, *((_DWORD *)v1->m_pProtocol + 1));
LABEL_36:
        NpLog(1, msgBuf);
        return 12;
      }
      return 12;
    }
  }
  if ( !v1->m_AuthQueryTmp.dwIndex )
  {
    v10 = v24.dwValue2;
    if ( !v24.dwValue2 )
      return 14;
    v11 = v24.dwValue2 / 0xF4240;
    if ( v24.dwValue2 / 0xF4240 < 0x7D3 )
      return 14;
    if ( v11 > 0x7DA )
      return 14;
    v12 = v24.dwValue2 / 0x2710 % 0x64;
    if ( !v12 )
      return 14;
    if ( v12 > 0xC )
      return 14;
    v13 = v24.dwValue2 / 0x64 % 0x64;
    if ( !v13 || v13 > 0x1F )
      return 14;
    if ( dword_4A5FF8 > v24.dwValue2 )
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibCheckau_0, dword_4A5FF8, v24.dwValue2);
LABEL_52:
        NpLog(1, msgBuf);
        return 14;
      }
      return 14;
    }
    if ( dword_4A604C < v24.dwValue2 )
    {
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibCheckau_6, dword_4A604C, v24.dwValue2);
        goto LABEL_52;
      }
      return 14;
    }
    v1->m_GGVer.dwGGVer = v24.dwValue2;
    v1->m_GGVer.wDay = v13;
    v1->m_GGVer.wYear = v11;
    v1->m_GGVer.wMonth = v12;
    v1->m_GGVer.wNum = v10 % 0x64;
  }
  if ( !v1->m_GGVer.dwGGVer )
    return 14;
  v14 = v1->m_GGVer.wYear;
  if ( v14 < 0x7D3u )
    return 14;
  if ( v14 > 0x7DAu )
    return 14;
  v15 = v1->m_GGVer.wMonth;
  if ( !v15 )
    return 14;
  if ( v15 > 0xCu )
    return 14;
  v16 = v1->m_GGVer.wDay;
  if ( !v16 )
    return 14;
  if ( v16 > 0x1Fu )
    return 14;
  v17 = v1->m_GGVer.wNum;
  if ( !v17 || v17 > 0x63u )
    return 14;
  v18 = &v1->m_dwUserFlag;
  v19 = (*((int (__cdecl **)(_DWORD, int, int, int, struct _GG_AUTH_DATA *))v1->m_pProtocol + 8))(
          *((_DWORD *)v1->m_pProtocol + 3),
          (int)&v1->m_GGVer,
          (int)&v1->m_dwUserFlag,
          (int)&v1->m_AuthQueryTmp,
          &v24);
  if ( !v19 )
  {
    if ( v1->m_AuthQueryTmp.dwIndex )
      goto LABEL_78;
    if ( !byte_4A6050 )
    {
      v20 = v1->m_GGVer.dwGGVer;
      if ( v20 <= dword_4A5FF8 )
        goto LABEL_77;
      if ( dword_4A60BC & 1 )
      {
        sprintf(msgBuf, aCSLibCheckau_3, v20);
        NpLog(1, msgBuf);
      }
    }
    v21 = *v18;
    LOBYTE(v21) = *v18 | 4;
    *v18 = v21;
LABEL_77:
    if ( !v1->m_AuthQueryTmp.dwIndex )
      return 0;
LABEL_78:
    v22 = *v18;
    if ( *v18 & 4 || v22 & 8 )
    {
      if ( *v18 & 4 )
      {
        LOBYTE(v22) = v22 & 0xFB;
        *v18 = v22;
        EnterCriticalSection(&ggauth_lock);
        UpdateGGVersion(v1->m_GGVer.dwGGVer);
        LeaveCriticalSection(&ggauth_lock);
      }
      v23 = *v18;
      if ( *v18 & 8 )
      {
        LOBYTE(v23) = v23 & 0xF7;
        *v18 = v23;
        EnterCriticalSection(&ggauth_lock);
        UpdateProtocol(v1->m_pProtocol);
        LeaveCriticalSection(&ggauth_lock);
      }
    }
    return 0;
  }
  if ( v19 == 13 )
  {
    if ( dword_4A60BC & 1 )
    {
      sprintf(msgBuf, aCSLibPrtccheck);
      NpLog(1, msgBuf);
      return 13;
    }
  }
  else if ( dword_4A60BC & 1 )
  {
    sprintf(msgBuf, aCSLibPrtcche_0, v19);
    NpLog(1, msgBuf);
  }
  return v19;
}
// 4A5FF8: using guessed type int dword_4A5FF8;
// 4A604C: using guessed type int dword_4A604C;
// 4A6050: using guessed type char byte_4A6050;
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042CE90) --------------------------------------------------------
unsigned __int32 __thiscall CCSAuth2::GetCSAuthState(CCSAuth2 *this, struct _GG_CSAUTH_STATE *a2)
{
  a2->m_PrtcVersion = 0;
  a2->m_GGVersion = 0;
  a2->m_UserFlag = 0;
  a2->m_PrtcVersion = *((_DWORD *)this->m_pProtocol + 1);
  a2->m_GGVersion = this->m_GGVer.dwGGVer;
  a2->m_UserFlag = this->m_dwUserFlag;
  return 0;
}

//----- (0042CEC0) --------------------------------------------------------
unsigned __int32 __thiscall CCSAuth2::SetCSAuthState(CCSAuth2 *this, struct _GG_CSAUTH_STATE *a2)
{
  struct _GG_AUTH_PROTOCOL *v2; // eax@5
  unsigned __int32 result; // eax@9

  if ( !a2 )
  {
    if ( dword_4A60BC & 2 )
    {
      sprintf(msgBuf, aCSLibSetcsauth);
LABEL_8:
      NpLog(2, msgBuf);
      return 20;
    }
    return 20;
  }
  if ( a2->m_GGVersion != *((_DWORD *)this->m_pProtocol + 1) )
  {
    v2 = (struct _GG_AUTH_PROTOCOL *)Memory;
    if ( !Memory )
    {
      if ( dword_4A60BC & 2 )
      {
        sprintf(msgBuf, aCSLibSetcsau_0);
        goto LABEL_8;
      }
      return 20;
    }
    while ( a2->m_PrtcVersion != *((_DWORD *)v2 + 1) )
    {
      v2 = (struct _GG_AUTH_PROTOCOL *)*((_DWORD *)v2 + 12);
      if ( !v2 )
        goto LABEL_14;
    }
    this->m_pProtocol = v2;
  }
LABEL_14:
  this->m_GGVer.dwGGVer = a2->m_GGVersion;
  this->m_GGVer.wYear = a2->m_GGVersion / 0xF4240;
  this->m_GGVer.wMonth = a2->m_GGVersion / 0x2710 % 0x64;
  this->m_GGVer.wDay = a2->m_GGVersion / 0x64 % 0x64;
  result = 0;
  this->m_GGVer.wNum = a2->m_GGVersion % 0x64;
  this->m_dwUserFlag = a2->m_UserFlag;
  return result;
}
// 4A60BC: using guessed type int dword_4A60BC;

//----- (0042CF90) --------------------------------------------------------
int __thiscall CCSAuth2::Info(CCSAuth2 *this, char *Dest, int a3)
{
  int result; // eax@2
  struct _GG_AUTH_PROTOCOL *v4; // eax@3
  char *v5; // ecx@4

  if ( a3 >= 100 )
  {
    memset(Dest, 0, a3);
    v4 = this->m_pProtocol;
    if ( (void *)this->m_pProtocol == Memory )
    {
      v5 = aActive;
    }
    else if ( *((_DWORD *)v4 + 6) || (v5 = aStandby, *((_DWORD *)v4 + 1) < *((_DWORD *)Memory + 1)) )
    {
      v5 = aDisuse;
    }
    sprintf(
      Dest,
      aPrtc0x08lxC0x0,
      *((_DWORD *)v4 + 1),
      *((_DWORD *)v4 + 8),
      *((_DWORD *)v4 + 7),
      *((_DWORD *)v4 + 9),
      *((_DWORD *)v4 + 10),
      *((_DWORD *)v4 + 11),
      v5);
    result = 0;
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (0042D020) --------------------------------------------------------
int __thiscall CCSAuth2::CheckUpdated(CCSAuth2 *this)
{
  unsigned int v1; // eax@1
  int result; // eax@2
  unsigned int v3; // eax@7
  unsigned int v4; // ecx@7

  v1 = this->m_GGVer.dwGGVer;
  if ( v1 )
  {
    if ( v1 >= dword_4A5FF8 )
    {
      if ( v1 <= dword_4A5FF8 )
      {
        v3 = *((_DWORD *)this->m_pProtocol + 1);
        v4 = *((_DWORD *)Memory + 1);
        if ( v4 <= v3 )
          result = v4 < v3 ? 2 : 0;
        else
          result = 3;
      }
      else
      {
        result = 2;
      }
    }
    else
    {
      result = 3;
    }
  }
  else
  {
    result = 1;
  }
  return result;
}
// 4A5FF8: using guessed type int dword_4A5FF8;

//----- (0042D070) --------------------------------------------------------
signed int __cdecl ModuleInfo(void *a1, signed int a2)
{
  signed int v2; // esi@1
  signed int v3; // ebp@1
  _DWORD *v5; // eax@3
  _DWORD *v6; // ebx@3
  char *v7; // eax@7
  unsigned int v8; // edx@9
  char Dest; // [sp+10h] [bp-80h]@11

  v2 = a2;
  v3 = 0;
  if ( a2 < 100 * ggGlobal )
    return 1;
  memset(a1, 0, a2);
  v5 = Memory;
  v6 = Memory;
  if ( Memory )
  {
    while ( 1 )
    {
      if ( v6 == v5 )
      {
        v7 = aActive;
      }
      else if ( v6[6] || (v8 = v5[1], v7 = aStandby, v6[1] < v8) )
      {
        v7 = aDisuse;
      }
      sprintf(&Dest, aPrtc0x08lxC0x0, v6[1], v6[8], v6[7], v6[9], v6[10], v6[11], v7);
      v3 += strlen(&Dest);
      if ( v3 > v2 )
        break;
      strcat((char *)a1, &Dest);
      v6 = (_DWORD *)v6[12];
      if ( !v6 )
        return 0;
      v5 = Memory;
      v2 = a2;
    }
    return 1;
  }
  return 0;
}

//----- (0042D190) --------------------------------------------------------
CCSAuth2 *GGAuthCreateUser()
{
  CCSAuth2 *v0; // eax@1
  CCSAuth2 *result; // eax@2

  v0 = (CCSAuth2 *)operator new(0x48u);
  if ( v0 )
    result = CCSAuth2::CCSAuth2(v0);
  else
    result = 0;
  return result;
}

//----- (0042D1B0) --------------------------------------------------------
int __cdecl GGAuthDeleteUser(void *p)
{
  if ( p )
  {
    CCSAuth2::~CCSAuth2((CCSAuth2 *)p);
    operator delete(p);
  }
  return 0;
}

//----- (0042D1D0) --------------------------------------------------------
int __cdecl GGAuthInitUser(CCSAuth2 *a1)
{
  int result; // eax@2

  if ( a1 )
  {
    CCSAuth2::Init(a1);
    result = 0;
  }
  else
  {
    result = 10;
  }
  return result;
}

//----- (0042D1F0) --------------------------------------------------------
int __cdecl GGAuthCloseUser(CCSAuth2 *a1)
{
  int result; // eax@2

  if ( a1 )
  {
    CCSAuth2::Close(a1);
    result = 0;
  }
  else
  {
    result = 10;
  }
  return result;
}

//----- (0042D210) --------------------------------------------------------
int __cdecl GGAuthGetQuery(CCSAuth2 *a1, int a2)
{
  int result; // eax@3

  if ( a1 && a2 )
  {
    result = CCSAuth2::GetAuthQuery(a1);
    *(_DWORD *)a2 = a1->m_AuthQuery.dwIndex;
    *(_DWORD *)(a2 + 4) = a1->m_AuthQuery.dwValue1;
    *(_DWORD *)(a2 + 8) = a1->m_AuthQuery.dwValue2;
    *(_DWORD *)(a2 + 12) = a1->m_AuthQuery.dwValue3;
  }
  else
  {
    result = 10;
  }
  return result;
}

//----- (0042D250) --------------------------------------------------------
signed int __cdecl GGAuthCheckAnswer(CCSAuth2 *a1, int a2)
{
  signed int result; // eax@3

  if ( a1 && a2 )
  {
    a1->m_AuthAnswer.dwIndex = *(_DWORD *)a2;
    a1->m_AuthAnswer.dwValue1 = *(_DWORD *)(a2 + 4);
    a1->m_AuthAnswer.dwValue2 = *(_DWORD *)(a2 + 8);
    a1->m_AuthAnswer.dwValue3 = *(_DWORD *)(a2 + 12);
    result = CCSAuth2::CheckAuthAnswer(a1);
  }
  else
  {
    result = 10;
  }
  return result;
}

//----- (0042D290) --------------------------------------------------------
signed int __cdecl GGAuthCheckUpdated(CCSAuth2 *a1)
{
  signed int result; // eax@2

  if ( a1 )
    result = CCSAuth2::CheckAuthAnswer(a1);
  else
    result = 10;
  return result;
}

//----- (0042D2B0) --------------------------------------------------------
int __cdecl GGAuthUserInfo(CCSAuth2 *a1, char *Dest, int a3)
{
  int result; // eax@3

  if ( a1 && Dest )
    result = CCSAuth2::Info(a1, Dest, a3);
  else
    result = 10;
  return result;
}

//----- (0042D2E0) --------------------------------------------------------
signed int __cdecl GGAuthGetUserValue(int a1, int a2)
{
  int v2; // eax@3
  signed int result; // eax@8

  if ( !a1 || a2 <= 0 )
    goto LABEL_18;
  v2 = a1 + 40;
  if ( !(a2 & 1) )
    v2 = a1;
  if ( a2 & 2 )
    v2 = a1 + 56;
  if ( a2 & 0x10 )
    return *(_DWORD *)v2;
  if ( a2 & 0x20 )
    return *(_DWORD *)(v2 + 4);
  if ( a2 & 0x40 )
    return *(_DWORD *)(v2 + 8);
  if ( a2 & 0x80 )
    result = *(_DWORD *)(v2 + 12);
  else
LABEL_18:
    result = -1;
  return result;
}

//----- (0042D330) --------------------------------------------------------
unsigned __int32 __cdecl GGAuthGetState(CCSAuth2 *a1, struct _GG_CSAUTH_STATE *a2)
{
  unsigned __int32 result; // eax@2

  if ( a1 )
    result = CCSAuth2::GetCSAuthState(a1, a2);
  else
    result = 10;
  return result;
}

//----- (0042D350) --------------------------------------------------------
unsigned __int32 __cdecl GGAuthSetState(CCSAuth2 *a1, struct _GG_CSAUTH_STATE *a2)
{
  unsigned __int32 result; // eax@3

  if ( a1 && a2 )
    result = CCSAuth2::SetCSAuthState(a1, a2);
  else
    result = 10;
  return result;
}

//----- (0042D370) --------------------------------------------------------
void __cdecl GGEncryptPacket(struct _GG_AUTH_DATA *a1)
{
  struct _GG_AUTH_DATA *v1; // esi@1
  unsigned int v2; // edx@1

  v1 = a1;
  v2 = a1->dwValue1;
  a1->dwIndex ^= 0xFD3A9Du;
  a1->dwValue1 = v2 ^ 0x9D2DB902;
  Blowfish_Encrypt((struct BLOWFISH_CTX *)&ctx, (unsigned __int32 *)&a1->dwIndex, (unsigned __int32 *)&a1->dwValue2);
  a1->dwValue2 ^= 0x64D84Au;
  v1->dwValue3 ^= 0xF0F4C802;
  Blowfish_Encrypt((struct BLOWFISH_CTX *)&ctx, (unsigned __int32 *)&v1->dwValue1, (unsigned __int32 *)&v1->dwValue3);
}

//----- (0042D3D0) --------------------------------------------------------
void __cdecl GGDecryptPacket(struct _GG_AUTH_DATA *a1)
{
  struct _GG_AUTH_DATA *v1; // esi@1
  unsigned int v2; // edx@1
  unsigned int v3; // eax@1

  v1 = a1;
  Blowfish_Decrypt((struct BLOWFISH_CTX *)&ctx, (unsigned __int32 *)&a1->dwValue1, (unsigned __int32 *)&a1->dwValue3);
  v2 = a1->dwValue3 ^ 0xF674C8B9;
  v1->dwValue2 ^= 0xB64D24Au;
  a1->dwValue3 = v2;
  Blowfish_Decrypt((struct BLOWFISH_CTX *)&ctx, (unsigned __int32 *)&v1->dwIndex, (unsigned __int32 *)&v1->dwValue2);
  v3 = a1->dwValue1 ^ 0x9D28B918;
  v1->dwIndex ^= 0xAFD349Du;
  a1->dwValue1 = v3;
}

//----- (0042D430) --------------------------------------------------------
void __cdecl Blowfish_Encrypt(struct BLOWFISH_CTX *a1, unsigned __int32 *a2, unsigned __int32 *a3)
{
  unsigned __int32 v3; // eax@1
  unsigned __int32 v4; // esi@1
  struct BLOWFISH_CTX *v5; // edi@1
  struct BLOWFISH_CTX *v6; // ebx@1
  int v7; // ebp@2
  bool v8; // zf@2
  int v9; // ecx@3
  struct BLOWFISH_CTX *v10; // [sp+14h] [bp+4h]@1

  v3 = *a2;
  v4 = *a3;
  v5 = a1;
  v10 = (struct BLOWFISH_CTX *)16;
  v6 = v5;
  do
  {
    v7 = *(_DWORD *)v6 ^ v3;
    v3 = v4 ^ sub_42D490((int)v5, v7);
    v6 = (struct BLOWFISH_CTX *)((char *)v6 + 4);
    v8 = v10 == (struct BLOWFISH_CTX *)1;
    v4 = v7;
    v10 = (struct BLOWFISH_CTX *)((char *)v10 - 1);
  }
  while ( !v8 );
  v9 = v3 ^ *((_DWORD *)v5 + 16);
  *a2 = v7 ^ *((_DWORD *)v5 + 17);
  *a3 = v9;
}

//----- (0042D490) --------------------------------------------------------
int __cdecl sub_42D490(int a1, unsigned int a2)
{
  return *(_DWORD *)(a1 + 4 * (unsigned __int8)a2 + 3144)
       + (*(_DWORD *)(a1 + 4 * BYTE1(a2) + 2120) ^ (*(_DWORD *)(a1 + 4 * ((a2 >> 16) & 0xFF) + 1096)
                                                  + *(_DWORD *)(a1 + 4 * (a2 >> 24) + 72)));
}

//----- (0042D500) --------------------------------------------------------
void __cdecl Blowfish_Decrypt(struct BLOWFISH_CTX *a1, unsigned __int32 *a2, unsigned __int32 *a3)
{
  unsigned __int32 v3; // eax@1
  unsigned __int32 v4; // esi@1
  struct BLOWFISH_CTX *v5; // edi@1
  struct BLOWFISH_CTX *v6; // ebx@1
  int v7; // ebp@2
  bool v8; // zf@2
  int v9; // ecx@3
  struct BLOWFISH_CTX *v10; // [sp+14h] [bp+4h]@1

  v3 = *a2;
  v4 = *a3;
  v5 = a1;
  v10 = (struct BLOWFISH_CTX *)16;
  v6 = (struct BLOWFISH_CTX *)((char *)v5 + 68);
  do
  {
    v7 = *(_DWORD *)v6 ^ v3;
    v3 = v4 ^ sub_42D490((int)v5, v7);
    v6 = (struct BLOWFISH_CTX *)((char *)v6 - 4);
    v8 = v10 == (struct BLOWFISH_CTX *)1;
    v4 = v7;
    v10 = (struct BLOWFISH_CTX *)((char *)v10 - 1);
  }
  while ( !v8 );
  v9 = v3 ^ *((_DWORD *)v5 + 1);
  *a2 = v7 ^ *(_DWORD *)v5;
  *a3 = v9;
}

//----- (0042D560) --------------------------------------------------------
void __cdecl Blowfish_Init(struct BLOWFISH_CTX *a1, unsigned __int8 *a2, unsigned __int32 a3)
{
  struct BLOWFISH_CTX *v3; // esi@1
  int *v4; // eax@1
  char *v5; // ecx@1
  signed int v6; // edx@2
  int v7; // edi@3
  signed __int32 v8; // ebp@5
  unsigned __int8 *v9; // edx@5
  signed __int32 v10; // eax@5
  int v11; // ecx@6
  int v12; // ebx@10
  struct BLOWFISH_CTX *v13; // esi@11
  signed int v14; // edi@11
  unsigned __int8 *v15; // eax@12
  char *v16; // esi@13
  signed int v17; // ebp@13
  signed int v18; // edi@14
  unsigned __int8 *v19; // ecx@15
  signed int v20; // [sp+10h] [bp-4h]@5

  v3 = a1;
  v4 = (int *)&unk_444A4C;
  v5 = (char *)a1 + 72;
  do
  {
    v6 = 256;
    do
    {
      v7 = *v4;
      ++v4;
      *(_DWORD *)v5 = v7;
      v5 += 4;
      --v6;
    }
    while ( v6 );
  }
  while ( (signed int)v4 < (signed int)&off_445A4C );
  v8 = a3;
  v9 = a2;
  v10 = 0;
  v20 = 18;
  do
  {
    v11 = 0;
    a3 = 4;
    do
    {
      v11 = v9[v10++] | (v11 << 8);
      if ( v10 >= v8 )
        v10 = 0;
      --a3;
    }
    while ( a3 );
    v12 = *(_DWORD *)((char *)v3 + &unk_444A04 - (_UNKNOWN *)a1);
    v3 = (struct BLOWFISH_CTX *)((char *)v3 + 4);
    *((_DWORD *)v3 - 1) = v11 ^ v12;
    --v20;
  }
  while ( v20 );
  a3 = 0;
  a2 = 0;
  v13 = a1;
  v14 = 9;
  do
  {
    Blowfish_Encrypt(a1, &a3, (unsigned __int32 *)&a2);
    v15 = a2;
    *(_DWORD *)v13 = a3;
    *((_DWORD *)v13 + 1) = v15;
    v13 = (struct BLOWFISH_CTX *)((char *)v13 + 8);
    --v14;
  }
  while ( v14 );
  v16 = (char *)a1 + 76;
  v17 = 4;
  do
  {
    v18 = 128;
    do
    {
      Blowfish_Encrypt(a1, &a3, (unsigned __int32 *)&a2);
      v19 = a2;
      *((_DWORD *)v16 - 1) = a3;
      *(_DWORD *)v16 = v19;
      v16 += 8;
      --v18;
    }
    while ( v18 );
    --v17;
  }
  while ( v17 );
}
// 445A4C: using guessed type void *off_445A4C;

//----- (0042D660) --------------------------------------------------------
void __stdcall __noreturn _com_issue_error(int hr)
{
  _com_raise_error(hr, 0);
}

//----- (0042D66E) --------------------------------------------------------
void __stdcall __noreturn _com_issue_errorex(int hr, IUnknown *punk, _GUID *riid)
{
  int v3; // esi@3
  IErrorInfo *perrinfo; // [sp+0h] [bp-4h]@1

  perrinfo = 0;
  if ( punk )
  {
    if ( punk->vfptr->QueryInterface(punk, &_GUID_df0b3d60_548f_101b_8e65_08002b2bd119, (void **)&punk) >= 0 )
    {
      v3 = ((int (__stdcall *)(_DWORD, _DWORD))punk->vfptr[1].QueryInterface)(punk, riid);
      punk->vfptr->Release(punk);
      if ( !v3 )
      {
        if ( GetErrorInfo(0, &perrinfo) )
          perrinfo = 0;
      }
    }
  }
  _com_raise_error(hr, perrinfo);
}

//----- (0042D6CF) --------------------------------------------------------
int _com_dispatch_raw_method(IDispatch *pDispatch, int dwDispID, int wFlags, unsigned __int16 vtRet, void *pvRet, const unsigned __int16 *pwParamInfo, ...)
{
  int v6; // esi@1
  va_list va; // [sp+24h] [bp+20h]@1

  va_start(va, pwParamInfo);
  v6 = com_invoke_helper(pDispatch, dwDispID, wFlags, vtRet, pvRet, pwParamInfo, va, (IErrorInfo **)&pvRet);
  if ( v6 < 0 )
    SetErrorInfo(0, (IErrorInfo *)pvRet);
  return v6;
}

//----- (0042D70B) --------------------------------------------------------
int __cdecl com_invoke_helper(IDispatch *pDispatch, int dwDispID, int wFlags, unsigned __int16 vtRet, void *pvRet, const unsigned __int16 *pwParamInfo, char *argList, IErrorInfo **pperrinfo)
{
  int result; // eax@2
  const unsigned __int16 *v9; // ebx@3
  unsigned int v10; // eax@4
  int v11; // eax@10
  unsigned int v12; // esi@10
  void *v13; // esp@10
  tagVARIANT *v14; // edx@10
  bool v15; // zf@10
  tagVARIANT *v16; // esi@10
  int v17; // ecx@11
  char *v18; // eax@11
  char *v19; // edx@11
  unsigned __int16 v20; // di@13
  int v21; // esi@16
  int v22; // esi@19
  int v23; // esi@19
  int v24; // esi@20
  __int16 v25; // si@22
  int v26; // esi@23
  tagVARIANT *v27; // edi@23
  int v28; // esi@24
  tagVARIANT *v29; // edi@24
  int v30; // esi@28
  unsigned int v31; // eax@31
  int v32; // edx@31
  const unsigned __int16 *v33; // ecx@31
  int v34; // esi@34
  unsigned int v35; // ecx@41
  tagVARIANT *v36; // ebx@42
  tagVARIANT *v37; // eax@42
  unsigned int *v38; // esi@43
  HRESULT v39; // ebx@45
  IErrorInfo **v40; // esi@56
  _DWORD *v41; // eax@75
  void *v42; // edi@77
  int v43; // [sp+0h] [bp-60h]@10
  tagEXCEPINFO excepInfo; // [sp+Ch] [bp-54h]@45
  tagDISPPARAMS dispparams; // [sp+2Ch] [bp-34h]@3
  tagVARIANT vaResult; // [sp+3Ch] [bp-24h]@45
  unsigned int nArgErr; // [sp+4Ch] [bp-14h]@45
  int dispidNamed; // [sp+50h] [bp-10h]@6
  tagVARIANT *rgvarg; // [sp+54h] [bp-Ch]@10
  const unsigned __int16 *pw; // [sp+58h] [bp-8h]@10
  tagVARIANT *pArg; // [sp+5Ch] [bp-4h]@10

  *pperrinfo = 0;
  if ( !pDispatch )
    return -2147467261;
  dispparams.rgvarg = 0;
  v9 = pwParamInfo;
  dispparams.rgdispidNamedArgs = 0;
  dispparams.cArgs = 0;
  dispparams.cNamedArgs = 0;
  if ( pwParamInfo )
  {
    v10 = lstrlenW(pwParamInfo);
    dispparams.cArgs = v10;
  }
  else
  {
    v10 = dispparams.cArgs;
  }
  dispidNamed = -3;
  if ( wFlags & 0xC )
  {
    if ( !v10 )
      return -2147024809;
    dispparams.cNamedArgs = 1;
    dispparams.rgdispidNamedArgs = &dispidNamed;
  }
  if ( v10 )
  {
    v11 = 16 * v10;
    v12 = v11;
    v11 += 3;
    LOBYTE(v11) = v11 & 0xFC;
    v13 = alloca(v11);
    v14 = (tagVARIANT *)&v43;
    memset(&v43, 0, v12);
    rgvarg = (tagVARIANT *)&v43;
    pw = v9;
    dispparams.rgvarg = (tagVARIANT *)&v43;
    v15 = *v9 == 0;
    v16 = (tagVARIANT *)(&v43 + 4 * dispparams.cArgs - 4);
    pArg = (tagVARIANT *)(&v43 + 4 * dispparams.cArgs - 4);
    if ( !v15 )
    {
      v17 = (int)&v16->lVal;
      v18 = argList - 4;
      v19 = argList - 8;
      while ( 1 )
      {
        v20 = *pw & 0xF7FF;
        v16->vt = v20;
        if ( (signed int)v20 > 16386 )
        {
          switch ( v20 )
          {
            default:
LABEL_27:
              if ( v20 & 0x2000 )
                break;
              return -2147024809;
            case 0x4003u:
            case 0x4004u:
            case 0x4005u:
            case 0x4006u:
            case 0x4007u:
            case 0x4008u:
            case 0x4009u:
            case 0x400Au:
            case 0x400Bu:
            case 0x400Cu:
            case 0x400Du:
            case 0x400Eu:
            case 0x4011u:
              break;
          }
        }
        else if ( v20 != 16386 )
        {
          switch ( v20 )
          {
            case 2u:
              LOWORD(v21) = *((_WORD *)v18 + 2);
              v19 += 4;
              v18 += 4;
              goto LABEL_17;
            case 4u:
              pArg->vt = 5;
              goto $L48617;
            case 5u:
            case 7u:
$L48617:
              v22 = *((_DWORD *)v19 + 2);
              v19 += 8;
              *(_DWORD *)v17 = v22;
              v18 += 8;
              v23 = *((_DWORD *)v19 + 1);
              goto LABEL_21;
            case 6u:
              v24 = *((_DWORD *)v18 + 1);
              v19 += 4;
              v18 += 4;
              *(_DWORD *)v17 = *(_DWORD *)v24;
              v23 = *(_DWORD *)(v24 + 4);
LABEL_21:
              *(_DWORD *)(v17 + 4) = v23;
              goto LABEL_29;
            case 0xBu:
              v25 = *((_WORD *)v18 + 2);
              v18 += 4;
              v19 += 4;
              v21 = -(v25 != 0);
LABEL_17:
              *(_WORD *)v17 = v21;
              goto LABEL_29;
            case 0xCu:
              v26 = *((_DWORD *)v18 + 1);
              v27 = pArg;
              v19 += 4;
              v18 += 4;
              *(_DWORD *)&pArg->vt = *(_DWORD *)v26;
              v26 += 4;
              v27 = (tagVARIANT *)((char *)v27 + 4);
              *(_DWORD *)&v27->vt = *(_DWORD *)v26;
              v26 += 4;
              v27 = (tagVARIANT *)((char *)v27 + 4);
              *(_DWORD *)&v27->vt = *(_DWORD *)v26;
              v27->decVal.Hi32 = *(_DWORD *)(v26 + 4);
              goto LABEL_29;
            case 0xEu:
              v28 = *((_DWORD *)v18 + 1);
              v29 = pArg;
              v19 += 4;
              v18 += 4;
              *(_DWORD *)&pArg->vt = *(_DWORD *)v28;
              v28 += 4;
              v29 = (tagVARIANT *)((char *)v29 + 4);
              *(_DWORD *)&v29->vt = *(_DWORD *)v28;
              v28 += 4;
              v29 = (tagVARIANT *)((char *)v29 + 4);
              *(_DWORD *)&v29->vt = *(_DWORD *)v28;
              v29->decVal.Hi32 = *(_DWORD *)(v28 + 4);
              pArg->vt = 14;
              goto LABEL_29;
            case 0x11u:
              v19 += 4;
              v18 += 4;
              *(_BYTE *)v17 = *v18;
              goto LABEL_29;
            default:
              goto LABEL_27;
            case 3u:
            case 8u:
            case 9u:
            case 0xAu:
            case 0xDu:
              break;
          }
        }
        v30 = *((_DWORD *)v18 + 1);
        v19 += 4;
        v18 += 4;
        *(_DWORD *)v17 = v30;
LABEL_29:
        ++pw;
        --pArg;
        v17 -= 16;
        if ( !*pw )
          break;
        v16 = pArg;
      }
      v14 = rgvarg;
      v9 = pwParamInfo;
    }
    v31 = (unsigned int)&v14[dispparams.cNamedArgs].vt;
    v32 = 0;
    v33 = &v9[dispparams.cArgs - dispparams.cNamedArgs - 1];
    if ( v33 >= v9 )
    {
      do
      {
        if ( (*v33 & 0xBFFF) != 2060 )
          break;
        v34 = *v33 & 0x4000 ? *(_DWORD *)(v31 + 8) : v31;
        if ( *(_WORD *)v34 != 10 )
          break;
        if ( *(_DWORD *)(v34 + 8) != -2147352572 )
          break;
        ++v32;
        v31 += 16;
        --v33;
      }
      while ( v33 >= v9 );
      if ( v32 )
      {
        v35 = 0;
        if ( dispparams.cNamedArgs )
        {
          v36 = rgvarg;
          v37 = &rgvarg[v32];
          do
          {
            *(_DWORD *)&v37->vt = *(_DWORD *)&v36->vt;
            v37->decVal.Hi32 = v36->decVal.Hi32;
            v37->decVal.Lo32 = v36->decVal.Lo32;
            v38 = &v36->decVal.Mid32;
            ++v35;
            ++v36;
            v37->decVal.Mid32 = *v38;
            ++v37;
          }
          while ( v35 < dispparams.cNamedArgs );
        }
        dispparams.cArgs -= v32;
        dispparams.rgvarg += v32;
      }
    }
  }
  VariantInit(&vaResult);
  nArgErr = -1;
  memset(&excepInfo, 0, sizeof(excepInfo));
  v39 = ((int (__stdcall *)(IDispatch *, int, GUID *, _DWORD, int, tagDISPPARAMS *, unsigned int, tagEXCEPINFO *, unsigned int *))pDispatch->vfptr[2].QueryInterface)(
          pDispatch,
          dwDispID,
          &_GUID_00000000_0000_0000_0000_000000000000,
          0,
          wFlags,
          &dispparams,
          vtRet != 0 ? (unsigned int)&vaResult : 0,
          &excepInfo,
          &nArgErr);
  if ( v39 >= 0 )
  {
    if ( vtRet )
    {
      if ( vtRet != 12 && vtRet != vaResult.vt && (v39 = VariantChangeType(&vaResult, &vaResult, 0, vtRet), v39 < 0) )
      {
LABEL_82:
        VariantClear(&vaResult);
      }
      else
      {
        switch ( vtRet )
        {
          case 5u:
          case 6u:
          case 7u:
            v41 = pvRet;
            *(_DWORD *)pvRet = vaResult.decVal.Lo32;
            v41[1] = vaResult.decVal.Mid32;
            break;
          case 2u:
          case 0xBu:
            *(_WORD *)pvRet = vaResult.iVal;
            break;
          case 0xCu:
          case 0xEu:
            v42 = pvRet;
            *(_DWORD *)pvRet = *(_DWORD *)&vaResult.vt;
            v42 = (char *)v42 + 4;
            *(_DWORD *)v42 = vaResult.decVal.Hi32;
            *(_QWORD *)((char *)v42 + 4) = vaResult.llVal;
            break;
          case 0x11u:
            *(_BYTE *)pvRet = vaResult.bVal;
            break;
          default:
            if ( (vtRet & 0x6000) == 0x2000 )
              goto $L48897;
            v39 = -2147024809;
            goto LABEL_82;
          case 3u:
          case 4u:
          case 8u:
          case 9u:
          case 0xAu:
          case 0xDu:
$L48897:
            *(_DWORD *)pvRet = vaResult.decVal.Lo32;
            break;
        }
      }
    }
    return v39;
  }
  VariantClear(&vaResult);
  if ( v39 != -2147352567 )
    return v39;
  if ( excepInfo.pfnDeferredFillIn )
    excepInfo.pfnDeferredFillIn(&excepInfo);
  pvRet = 0;
  if ( CreateErrorInfo((ICreateErrorInfo **)&pvRet) >= 0 )
  {
    (*(void (__stdcall **)(void *, GUID *))(*(_DWORD *)pvRet + 12))(pvRet, &_GUID_00020400_0000_0000_c000_000000000046);
    if ( excepInfo.bstrSource )
      (*(void (__stdcall **)(void *, unsigned __int16 *))(*(_DWORD *)pvRet + 16))(pvRet, excepInfo.bstrSource);
    if ( excepInfo.bstrDescription )
      (*(void (__stdcall **)(void *, unsigned __int16 *))(*(_DWORD *)pvRet + 20))(pvRet, excepInfo.bstrDescription);
    if ( excepInfo.bstrHelpFile )
      (*(void (__stdcall **)(void *, unsigned __int16 *))(*(_DWORD *)pvRet + 24))(pvRet, excepInfo.bstrHelpFile);
    (*(void (__stdcall **)(void *, unsigned int))(*(_DWORD *)pvRet + 28))(pvRet, excepInfo.dwHelpContext);
    v40 = pperrinfo;
    if ( (**(int (__stdcall ***)(void *, GUID *, IErrorInfo **))pvRet)(
           pvRet,
           &_GUID_1cf2b120_547d_101b_8e65_08002b2bd119,
           pperrinfo) < 0 )
      *v40 = 0;
    (*(void (__stdcall **)(void *))(*(_DWORD *)pvRet + 8))(pvRet);
  }
  if ( excepInfo.bstrSource )
    SysFreeString(excepInfo.bstrSource);
  if ( excepInfo.bstrDescription )
    SysFreeString(excepInfo.bstrDescription);
  if ( excepInfo.bstrHelpFile )
    SysFreeString(excepInfo.bstrHelpFile);
  if ( excepInfo.wCode )
  {
    if ( excepInfo.wCode < 0xFE00u )
      result = excepInfo.wCode - 2147220992;
    else
      result = -2147155969;
  }
  else
  {
    result = excepInfo.scode;
  }
  return result;
}

//----- (0042DBF0) --------------------------------------------------------
int _com_dispatch_method(IDispatch *pDispatch, int dwDispID, int wFlags, unsigned __int16 vtRet, void *pvRet, const unsigned __int16 *pwParamInfo, ...)
{
  int result; // eax@1
  va_list va; // [sp+24h] [bp+20h]@1

  va_start(va, pwParamInfo);
  result = com_invoke_helper(pDispatch, dwDispID, wFlags, vtRet, pvRet, pwParamInfo, va, (IErrorInfo **)&pvRet);
  if ( result < 0 )
    _com_raise_error(result, (IErrorInfo *)pvRet);
  return result;
}

//----- (0042DC2A) --------------------------------------------------------
int __stdcall _com_dispatch_raw_propget(IDispatch *pDispatch, int dwDispID, unsigned __int16 vtProp, void *pvProp)
{
  return _com_dispatch_raw_method(pDispatch, dwDispID, 2, vtProp, pvProp, 0);
}

//----- (0042DC49) --------------------------------------------------------
int __stdcall _com_dispatch_propget(IDispatch *pDispatch, int dwDispID, unsigned __int16 vtProp, void *pvProp)
{
  return _com_dispatch_method(pDispatch, dwDispID, 2, vtProp, pvProp, 0);
}

//----- (0042DC68) --------------------------------------------------------
int _com_dispatch_raw_propput(IDispatch *pDispatch, int dwDispID, unsigned __int16 vtProp, ...)
{
  int v3; // eax@3
  int v4; // esi@5
  unsigned __int16 rgwParams[2]; // [sp+0h] [bp-4h]@1
  va_list va; // [sp+18h] [bp+14h]@1

  va_start(va, vtProp);
  rgwParams[1] = 0;
  rgwParams[0] = vtProp;
  if ( vtProp == 9 || vtProp == 13 )
    v3 = com_invoke_helper(pDispatch, dwDispID, 8, 0, 0, rgwParams, va, (IErrorInfo **)&dwDispID);
  else
    v3 = com_invoke_helper(pDispatch, dwDispID, 4, 0, 0, rgwParams, va, (IErrorInfo **)&dwDispID);
  v4 = v3;
  if ( v3 < 0 )
    SetErrorInfo(0, (IErrorInfo *)dwDispID);
  return v4;
}

//----- (0042DCC1) --------------------------------------------------------
int _com_dispatch_propput(IDispatch *pDispatch, int dwDispID, unsigned __int16 vtProp, ...)
{
  int result; // eax@3
  unsigned __int16 rgwParams[2]; // [sp+0h] [bp-4h]@1
  va_list va; // [sp+18h] [bp+14h]@1

  va_start(va, vtProp);
  rgwParams[1] = 0;
  rgwParams[0] = vtProp;
  if ( vtProp == 9 || vtProp == 13 )
    result = com_invoke_helper(pDispatch, dwDispID, 8, 0, 0, rgwParams, va, (IErrorInfo **)&dwDispID);
  else
    result = com_invoke_helper(pDispatch, dwDispID, 4, 0, 0, rgwParams, va, (IErrorInfo **)&dwDispID);
  if ( result < 0 )
    _com_raise_error(result, (IErrorInfo *)dwDispID);
  return result;
}

//----- (0042DD18) --------------------------------------------------------
int _E4()
{
  _E1();
  return _E3();
}

//----- (0042DD22) --------------------------------------------------------
void _E1()
{
  _variant_t::_variant_t(&vtMissing, -2147352572, 0xAu);
}

//----- (0042DD34) --------------------------------------------------------
int _E3()
{
  return atexit(_E2);
}

//----- (0042DD40) --------------------------------------------------------
void __cdecl _E2()
{
  int v0; // eax@1

  v0 = VariantClear((VARIANTARG *)&vtMissing.0);
  if ( v0 < 0 )
    _com_issue_error(v0);
}

//----- (0042DD56) --------------------------------------------------------
unsigned __int16 *__stdcall _com_util::ConvertStringToBSTR(const char *pSrc)
{
  unsigned __int16 *result; // eax@2
  int v2; // eax@3
  int v3; // esi@3
  int v4; // eax@3
  void *v5; // esp@3
  int v6; // eax@5
  __int16 v7; // [sp+0h] [bp-8h]@3

  if ( pSrc )
  {
    v2 = lstrlenA(pSrc);
    v3 = v2 + 1;
    v4 = 2 * (v2 + 1) + 3;
    LOBYTE(v4) = v4 & 0xFC;
    v5 = alloca(v4);
    v7 = 0;
    if ( !MultiByteToWideChar(0, 0, pSrc, -1, (LPWSTR)&v7, v3) )
    {
      if ( GetLastError() )
        v6 = (unsigned __int16)GetLastError() | 0x80070000;
      else
        v6 = 0;
      _com_issue_error(v6);
    }
    result = SysAllocString((const OLECHAR *)&v7);
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0042DDCB) --------------------------------------------------------
char *__stdcall _com_util::ConvertBSTRToString(unsigned __int16 *pSrc)
{
  char *result; // eax@2
  size_t v2; // edi@3
  char *v3; // eax@3
  char *v4; // esi@3
  int v5; // eax@7

  if ( pSrc )
  {
    v2 = 2 * wcslen(pSrc) + 2;
    v3 = (char *)operator new(v2);
    v4 = v3;
    if ( !v3 )
      _com_issue_error(-2147024882);
    *v3 = 0;
    if ( !WideCharToMultiByte(0, 0, pSrc, -1, v3, v2, 0, 0) )
    {
      if ( GetLastError() )
        v5 = (unsigned __int16)GetLastError() | 0x80070000;
      else
        v5 = 0;
      _com_issue_error(v5);
    }
    result = v4;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0042DE3F) --------------------------------------------------------
void __thiscall _variant_t::_variant_t(_variant_t *this, int lSrc, unsigned __int16 vtSrc)
{
  if ( vtSrc != 3 )
  {
    if ( vtSrc == 10 )
    {
LABEL_6:
      this->vt = 10;
      goto LABEL_10;
    }
    if ( vtSrc != 11 )
      _com_issue_error(-2147024809);
  }
  if ( vtSrc == 10 )
    goto LABEL_6;
  if ( vtSrc == 11 )
  {
    this->vt = 11;
    this->iVal = -(lSrc != 0);
    return;
  }
  this->vt = 3;
LABEL_10:
  this->decVal.Lo32 = lSrc;
}

//----- (0042DE9B) --------------------------------------------------------
void __stdcall __noreturn _com_raise_error(int hr, IErrorInfo *perrinfo)
{
  _com_error v2; // [sp+0h] [bp-10h]@1

  _com_error::_com_error(&v2, hr, perrinfo, 0);
  _CxxThrowException(&v2, &_TI1_AV_com_error__);
}
// 42E4FF: using guessed type _DWORD __stdcall _CxxThrowException(_DWORD, _DWORD);

//----- (0042E0D4) --------------------------------------------------------
char *__thiscall type_info::raw_name(type_info *this)
{
  return (char *)this + 8;
}

//----- (0042E0E3) --------------------------------------------------------
void *__thiscall type_info::operator=(void *this, int a2)
{
  return this;
}

//----- (0042E123) --------------------------------------------------------
#error "42E124: positive sp value has been found (funcsize=0)"

//----- (0042E12A) --------------------------------------------------------
#error "42E12B: positive sp value has been found (funcsize=0)"

//----- (0042EA13) --------------------------------------------------------
void __stdcall __noreturn StartAddress(void *Memory)
{
  _DWORD *v1; // esi@1
  DWORD v2; // eax@8

  v1 = TlsGetValue(__tlsindex);
  if ( v1 )
  {
    v1[18] = *((_DWORD *)Memory + 18);
    v1[19] = *((_DWORD *)Memory + 19);
    _freeptd(Memory);
  }
  else
  {
    v1 = Memory;
  }
  if ( !TlsSetValue(__tlsindex, v1) )
    _amsg_exit(0x10u);
  *v1 = GetCurrentThreadId();
  if ( _FPmtinit )
    _FPmtinit();
  v2 = ((int (__cdecl *)(_DWORD))v1[18])(v1[19]);
  _endthreadex(v2);
}
// 49C66C: using guessed type int (*_FPmtinit)(void);

//----- (0042EBB8) --------------------------------------------------------
void __cdecl free(void *Memory)
{
  unsigned int v1; // eax@3
  bool v2; // zf@5
  _BYTE *v3; // eax@7
  int v4; // [sp+Ch] [bp-28h]@7
  _BYTE *v5; // [sp+10h] [bp-24h]@7
  int v6; // [sp+14h] [bp-20h]@7
  unsigned int v7; // [sp+18h] [bp-1Ch]@3
  CPPEH_RECORD ms_exc; // [sp+1Ch] [bp-18h]@3

  if ( Memory )
  {
    if ( __active_heap == 3 )
    {
      _lock(9);
      ms_exc.registration.TryLevel = 0;
      v1 = __sbh_find_block(Memory);
      v7 = v1;
      if ( v1 )
        __sbh_free_block(v1, (int)Memory);
      ms_exc.registration.TryLevel = -1;
      _unlock(9);
      v2 = v7 == 0;
    }
    else
    {
      if ( __active_heap != 2 )
      {
        HeapFree(_crtheap, 0, Memory);
        return;
      }
      _lock(9);
      ms_exc.registration.TryLevel = 1;
      v3 = (_BYTE *)__old_sbh_find_block((unsigned int)Memory, (void ***)&v4, (unsigned int *)&v6);
      v5 = v3;
      if ( v3 )
        __old_sbh_free_block(v4, v6, v3);
      ms_exc.registration.TryLevel = -1;
      _unlock(9);
      v2 = v5 == 0;
    }
    if ( v2 )
      HeapFree(_crtheap, 0, Memory);
  }
}
// 430ACB: using guessed type _DWORD __cdecl _lock(_DWORD);
// 430B2C: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 4327B4: using guessed type _DWORD __cdecl __sbh_find_block(_DWORD);
// 4A7950: using guessed type int __active_heap;

//----- (0042ECDF) --------------------------------------------------------
LPVOID __cdecl _heap_alloc(unsigned int a1)
{
  void *v1; // ST18_4@3
  LPVOID result; // eax@3
  unsigned int v3; // esi@7
  int v4; // ST18_4@10
  signed int v5; // eax@12
  SIZE_T v6; // eax@14

  if ( __active_heap == 3 )
  {
    if ( a1 <= __sbh_threshold )
    {
      _lock(9);
      v1 = (void *)__sbh_alloc_block(a1);
      _unlock(9);
      result = v1;
      if ( v1 )
        return result;
    }
    goto LABEL_12;
  }
  if ( __active_heap != 2 )
  {
LABEL_12:
    v5 = a1;
    if ( !a1 )
      v5 = 1;
    v6 = v5 + 15;
    LOBYTE(v6) = v6 & 0xF0;
    return HeapAlloc(_crtheap, 0, v6);
  }
  if ( a1 )
    v3 = (a1 + 15) & 0xFFFFFFF0;
  else
    v3 = 16;
  if ( v3 > __old_sbh_threshold
    || (_lock(9), v4 = __old_sbh_alloc_block(v3 >> 4), _unlock(9), (result = (LPVOID)v4) == 0) )
  {
    result = HeapAlloc(_crtheap, 0, v3);
  }
  return result;
}
// 430ACB: using guessed type _DWORD __cdecl _lock(_DWORD);
// 430B2C: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 432B08: using guessed type _DWORD __cdecl __sbh_alloc_block(_DWORD);
// 49E97C: using guessed type int __old_sbh_threshold;
// 4A7948: using guessed type int __sbh_threshold;
// 4A7950: using guessed type int __active_heap;

//----- (00430619) --------------------------------------------------------
void *__cdecl realloc(void *Memory, size_t NewSize)
{
  void *v2; // ebx@1
  void *result; // eax@2
  unsigned int v4; // esi@3
  unsigned int v5; // eax@7
  size_t v6; // eax@12
  size_t v7; // eax@19
  _BYTE *v8; // eax@36
  _BYTE *v9; // edi@36
  size_t v10; // eax@41
  size_t v11; // eax@47
  int v12; // [sp+Ch] [bp-38h]@36
  size_t v13; // [sp+10h] [bp-34h]@41
  _BYTE *v14; // [sp+14h] [bp-30h]@36
  int v15; // [sp+18h] [bp-2Ch]@36
  unsigned int v16; // [sp+1Ch] [bp-28h]@7
  void *Dst; // [sp+20h] [bp-24h]@6
  size_t v18; // [sp+24h] [bp-20h]@12
  CPPEH_RECORD ms_exc; // [sp+2Ch] [bp-18h]@7

  v2 = Memory;
  if ( Memory )
  {
    v4 = NewSize;
    if ( NewSize )
    {
      if ( __active_heap == 3 )
      {
        while ( 1 )
        {
          Dst = 0;
          if ( v4 <= 0xFFFFFFE0 )
          {
            _lock(9);
            ms_exc.registration.TryLevel = 0;
            v5 = __sbh_find_block(Memory);
            v16 = v5;
            if ( v5 )
            {
              if ( v4 <= __sbh_threshold )
              {
                if ( __sbh_resize_block(v5, Memory, v4) )
                {
                  Dst = Memory;
                }
                else
                {
                  Dst = (void *)__sbh_alloc_block(v4);
                  if ( Dst )
                  {
                    v6 = *((_DWORD *)Memory - 1) - 1;
                    v18 = v6;
                    if ( v6 >= v4 )
                      v6 = v4;
                    memcpy(Dst, Memory, v6);
                    v16 = __sbh_find_block(Memory);
                    __sbh_free_block(v16, (int)Memory);
                  }
                }
              }
              if ( !Dst )
              {
                if ( !v4 )
                  v4 = 1;
                v4 = (v4 + 15) & 0xFFFFFFF0;
                Dst = HeapAlloc(_crtheap, 0, v4);
                if ( Dst )
                {
                  v7 = *((_DWORD *)Memory - 1) - 1;
                  v18 = v7;
                  if ( v7 >= v4 )
                    v7 = v4;
                  memcpy(Dst, Memory, v7);
                  __sbh_free_block(v16, (int)Memory);
                }
              }
            }
            ms_exc.registration.TryLevel = -1;
            _unlock(9);
            if ( !v16 )
            {
              if ( !v4 )
                v4 = 1;
              v4 = (v4 + 15) & 0xFFFFFFF0;
              Dst = HeapReAlloc(_crtheap, 0, Memory, v4);
            }
          }
          result = Dst;
          if ( Dst || !_newmode )
            break;
          if ( !_callnewh(v4) )
            goto LABEL_63;
        }
      }
      else if ( __active_heap == 2 )
      {
        if ( NewSize <= 0xFFFFFFE0 )
        {
          if ( NewSize <= 0 )
            v4 = 16;
          else
            v4 = (NewSize + 15) & 0xFFFFFFF0;
        }
        while ( 1 )
        {
          Dst = 0;
          if ( v4 <= 0xFFFFFFE0 )
          {
            _lock(9);
            ms_exc.registration.TryLevel = 1;
            v8 = (_BYTE *)__old_sbh_find_block((unsigned int)v2, (void ***)&v12, (unsigned int *)&v15);
            v9 = v8;
            v14 = v8;
            if ( v8 )
            {
              if ( v4 < __old_sbh_threshold )
              {
                if ( __old_sbh_resize_block(v12, v15, v8, v4 >> 4) )
                {
                  Dst = Memory;
                }
                else
                {
                  Dst = (void *)__old_sbh_alloc_block(v4 >> 4);
                  if ( Dst )
                  {
                    v10 = 16 * *v9;
                    v13 = v10;
                    if ( v10 >= v4 )
                      v10 = v4;
                    memcpy(Dst, Memory, v10);
                    __old_sbh_free_block(v12, v15, v9);
                  }
                }
                v2 = Memory;
              }
              if ( !Dst )
              {
                Dst = HeapAlloc(_crtheap, 0, v4);
                if ( Dst )
                {
                  v11 = 16 * *v9;
                  v13 = v11;
                  if ( v11 >= v4 )
                    v11 = v4;
                  memcpy(Dst, v2, v11);
                  __old_sbh_free_block(v12, v15, v9);
                }
              }
            }
            else
            {
              Dst = HeapReAlloc(_crtheap, 0, v2, v4);
            }
            ms_exc.registration.TryLevel = -1;
            _unlock(9);
          }
          result = Dst;
          if ( Dst || !_newmode )
            break;
          if ( !_callnewh(v4) )
            goto LABEL_63;
        }
      }
      else
      {
        while ( 1 )
        {
          result = 0;
          if ( v4 <= 0xFFFFFFE0 )
          {
            if ( !v4 )
              v4 = 1;
            v4 = (v4 + 15) & 0xFFFFFFF0;
            result = HeapReAlloc(_crtheap, 0, Memory, v4);
          }
          if ( result || !_newmode )
            break;
          if ( !_callnewh(v4) )
            goto LABEL_63;
        }
      }
    }
    else
    {
      free(Memory);
LABEL_63:
      result = 0;
    }
  }
  else
  {
    result = malloc(NewSize);
  }
  return result;
}
// 430ACB: using guessed type _DWORD __cdecl _lock(_DWORD);
// 430B2C: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 4327B4: using guessed type _DWORD __cdecl __sbh_find_block(_DWORD);
// 432B08: using guessed type _DWORD __cdecl __sbh_alloc_block(_DWORD);
// 432FBD: using guessed type _DWORD __cdecl __sbh_resize_block(_DWORD, _DWORD, _DWORD);
// 433F2A: using guessed type _DWORD __cdecl _callnewh(_DWORD);
// 49E97C: using guessed type int __old_sbh_threshold;
// 4A61C0: using guessed type int _newmode;
// 4A7948: using guessed type int __sbh_threshold;
// 4A7950: using guessed type int __active_heap;

//----- (00430948) --------------------------------------------------------
size_t __cdecl _msize(void *Memory)
{
  size_t v1; // esi@3
  bool v2; // zf@5
  _BYTE *v3; // eax@7
  char v5; // [sp+Ch] [bp-2Ch]@7
  _BYTE *v6; // [sp+10h] [bp-28h]@7
  char v7; // [sp+14h] [bp-24h]@7
  size_t v8; // [sp+18h] [bp-20h]@3
  int v9; // [sp+1Ch] [bp-1Ch]@2
  CPPEH_RECORD ms_exc; // [sp+20h] [bp-18h]@2

  if ( __active_heap == 3 )
  {
    _lock(9);
    ms_exc.registration.TryLevel = 0;
    v9 = __sbh_find_block(Memory);
    if ( v9 )
    {
      v1 = *((_DWORD *)Memory - 1) - 9;
      v8 = *((_DWORD *)Memory - 1) - 9;
    }
    else
    {
      v1 = v8;
    }
    ms_exc.registration.TryLevel = -1;
    _unlock(9);
    v2 = v9 == 0;
  }
  else
  {
    if ( __active_heap != 2 )
      return HeapSize(_crtheap, 0, Memory);
    _lock(9);
    ms_exc.registration.TryLevel = 1;
    v3 = (_BYTE *)__old_sbh_find_block((unsigned int)Memory, (void ***)&v5, (unsigned int *)&v7);
    v6 = v3;
    if ( v3 )
    {
      v1 = 16 * *v3;
      v8 = 16 * *v3;
    }
    else
    {
      v1 = v8;
    }
    ms_exc.registration.TryLevel = -1;
    _unlock(9);
    v2 = v6 == 0;
  }
  if ( v2 )
    return HeapSize(_crtheap, 0, Memory);
  return v1;
}
// 430ACB: using guessed type _DWORD __cdecl _lock(_DWORD);
// 430B2C: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 4327B4: using guessed type _DWORD __cdecl __sbh_find_block(_DWORD);
// 4A7950: using guessed type int __active_heap;

//----- (00431669) --------------------------------------------------------
void __cdecl __CxxSetUnhandledExceptionFilter()
{
  lpfn = SetUnhandledExceptionFilter(__CxxUnhandledExceptionFilter);
}

//----- (0043167A) --------------------------------------------------------
void __cdecl __CxxRestoreUnhandledExceptionFilter()
{
  SetUnhandledExceptionFilter(lpfn);
}

//----- (0043179F) --------------------------------------------------------
int __cdecl _output(FILE *File, int a2, int a3)
{
  int v3; // ecx@1
  unsigned __int8 v4; // bl@1
  int v5; // esi@1
  bool v6; // zf@1
  int v7; // eax@7
  int v8; // eax@22
  int v9; // eax@23
  signed int v10; // esi@55
  int v11; // eax@57
  char *v12; // ecx@57
  char *i; // eax@60
  signed int v14; // edx@61
  char *v15; // edi@65
  wchar_t v16; // ax@70
  int v17; // eax@78
  int v18; // ecx@79
  int v19; // eax@81
  int v20; // eax@82
  void *v21; // eax@90
  char *j; // eax@105
  signed int v23; // edx@106
  _WORD *v24; // eax@116
  signed __int64 v25; // rax@123
  int v26; // eax@145
  signed int v27; // ebx@147
  _BYTE *v28; // eax@149
  char *v29; // eax@150
  char v30; // bl@156
  int v31; // esi@164
  wchar_t *v32; // ebx@171
  int v33; // edi@171
  wchar_t v34; // ax@172
  int v35; // eax@172
  int v36; // eax@173
  char MbCh; // [sp+Ch] [bp-24Ch]@65
  char v39; // [sp+20Bh] [bp-4Dh]@144
  int v40; // [sp+20Ch] [bp-4Ch]@93
  int v41; // [sp+210h] [bp-48h]@93
  char v42; // [sp+214h] [bp-44h]@172
  int v43; // [sp+218h] [bp-40h]@10
  int v44; // [sp+21Ch] [bp-3Ch]@3
  int v45; // [sp+220h] [bp-38h]@10
  int v46; // [sp+224h] [bp-34h]@101
  void *Memory; // [sp+228h] [bp-30h]@1
  int v48; // [sp+22Ch] [bp-2Ch]@10
  int v49; // [sp+230h] [bp-28h]@10
  int v50; // [sp+234h] [bp-24h]@10
  unsigned __int64 v51; // [sp+238h] [bp-20h]@134
  char v52[6]; // [sp+242h] [bp-16h]@1
  int v53; // [sp+248h] [bp-10h]@1
  int v54; // [sp+24Ch] [bp-Ch]@57
  int v55; // [sp+250h] [bp-8h]@10
  int v56; // [sp+254h] [bp-4h]@10
  char *v57; // [sp+264h] [bp+Ch]@1

  v3 = 0;
  v53 = 0;
  v4 = *(_BYTE *)a2;
  v5 = a2 + 1;
  v6 = *(_BYTE *)a2 == 0;
  *(_DWORD *)&v52[2] = 0;
  Memory = 0;
  v57 = (char *)(a2 + 1);
  if ( !v6 )
  {
    while ( 1 )
    {
      if ( *(_DWORD *)&v52[2] < 0 )
        return *(_DWORD *)&v52[2];
      if ( (char)v4 < 32 || (char)v4 > 120 )
        v7 = 0;
      else
        v7 = byte_445B80[(char)v4] & 0xF;
      v44 = *(&__lookuptable[8 * v7] + v3) >> 4;
      switch ( v44 )
      {
        case 1:
          v55 = -1;
          v43 = 0;
          v45 = 0;
          v49 = 0;
          v50 = 0;
          v56 = 0;
          v48 = 0;
          goto LABEL_180;
        case 2:
          switch ( v4 )
          {
            case 0x20u:
              v56 |= 2u;
              break;
            case 0x23u:
              LOBYTE(v56) = v56 | 0x80;
              break;
            case 0x2Bu:
              v56 |= 1u;
              break;
            case 0x2Du:
              v56 |= 4u;
              break;
            case 0x30u:
              v56 |= 8u;
              break;
          }
          goto LABEL_180;
        case 3:
          if ( v4 == 42 )
          {
            v8 = get_int_arg(&a3);
            v49 = v8;
            if ( v8 >= 0 )
              goto LABEL_180;
            v56 |= 4u;
            v9 = -v8;
          }
          else
          {
            v9 = (char)v4 + 10 * v49 - 48;
          }
          v49 = v9;
          goto LABEL_180;
        case 4:
          v55 = 0;
          goto LABEL_180;
        case 5:
          if ( v4 == 42 )
          {
            v55 = get_int_arg(&a3);
            if ( v55 < 0 )
              v55 = -1;
          }
          else
          {
            v55 = (char)v4 + 10 * v55 - 48;
          }
          goto LABEL_180;
        case 6:
          switch ( v4 )
          {
            case 0x49u:
              if ( *(_BYTE *)v5 != 54 || *(_BYTE *)(v5 + 1) != 52 )
              {
                v44 = 0;
LABEL_42:
                v48 = 0;
                if ( HIBYTE(_pctype[v4]) & 0x80 )
                {
                  write_char((char)v4, File, (int)&v52[2]);
                  v4 = *(_BYTE *)v5;
                  v57 = (char *)(v5 + 1);
                }
                write_char((char)v4, File, (int)&v52[2]);
              }
              else
              {
                BYTE1(v56) |= 0x80u;
                v57 = (char *)(v5 + 2);
              }
              break;
            case 0x68u:
              v56 |= 0x20u;
              break;
            case 0x6Cu:
              v56 |= 0x10u;
              break;
            case 0x77u:
              v56 |= 0x800u;
              break;
          }
          goto LABEL_180;
        case 0:
          goto LABEL_42;
        case 7:
          if ( (char)v4 > 103 )
          {
            if ( v4 == 105 )
              goto LABEL_120;
            if ( v4 == 110 )
            {
              v24 = (_WORD *)get_int_arg(&a3);
              if ( v56 & 0x20 )
                *v24 = *(_WORD *)&v52[2];
              else
                *(_DWORD *)v24 = *(_DWORD *)&v52[2];
              v45 = 1;
              goto LABEL_178;
            }
            if ( v4 == 111 )
            {
              v53 = 8;
              if ( v56 & 0x80 )
                v56 |= 0x200u;
            }
            else
            {
              if ( v4 == 112 )
              {
                v55 = 8;
LABEL_111:
                v46 = 7;
              }
              else
              {
                if ( v4 == 115 )
                  goto LABEL_55;
                if ( v4 == 117 )
                  goto LABEL_121;
                if ( v4 != 120 )
                  goto LABEL_155;
                v46 = 39;
              }
              v53 = 16;
              if ( v56 & 0x80 )
              {
                v52[0] = 48;
                v50 = 2;
                v52[1] = v46 + 81;
              }
            }
LABEL_122:
            if ( BYTE1(v56) & 0x80 )
            {
              LODWORD(v25) = get_int64_arg(&a3);
            }
            else
            {
              if ( v56 & 0x20 )
              {
                if ( v56 & 0x40 )
                  LODWORD(v25) = (signed __int16)get_int_arg(&a3);
                else
                  LODWORD(v25) = (unsigned __int16)get_int_arg(&a3);
              }
              else
              {
                if ( !(v56 & 0x40) )
                {
                  v25 = get_int_arg(&a3);
                  goto LABEL_132;
                }
                LODWORD(v25) = get_int_arg(&a3);
              }
              v25 = (signed int)v25;
            }
LABEL_132:
            if ( v56 & 0x40 && v25 < 0 )
            {
              LODWORD(v51) = v25;
              BYTE1(v56) |= 1u;
              HIDWORD(v51) = (unsigned __int64)-v25 >> 32;
            }
            else
            {
              v51 = v25;
            }
            if ( !(BYTE1(v56) & 0x80) )
              HIDWORD(v51) = 0;
            if ( v55 >= 0 )
            {
              v56 &= 0xFFFFFFF7;
              if ( v55 > 512 )
                v55 = 512;
            }
            else
            {
              v55 = 1;
            }
            if ( !v51 )
              v50 = 0;
            v54 = (int)&v39;
            while ( 1 )
            {
              v26 = v55--;
              if ( v26 <= 0 && !v51 )
                break;
              v27 = v51 % v53 + 48;
              v51 /= (unsigned __int64)v53;
              if ( v27 > 57 )
                LOBYTE(v27) = v46 + v27;
              v28 = (_BYTE *)v54--;
              *v28 = v27;
            }
            v29 = &v39 - v54++;
            v53 = (int)v29;
            if ( BYTE1(v56) & 2 && (*(_BYTE *)v54 != 48 || !v29) )
            {
              --v54;
              v20 = (int)(v29 + 1);
              *(_BYTE *)v54 = 48;
              goto LABEL_154;
            }
            goto LABEL_155;
          }
          if ( (char)v4 >= 101 )
            goto LABEL_65;
          if ( (char)v4 > 88 )
          {
            if ( v4 == 90 )
            {
              v17 = get_int_arg(&a3);
              if ( v17 && (v18 = *(_DWORD *)(v17 + 4)) != 0 )
              {
                if ( v56 & 0x800 )
                {
                  v19 = (unsigned int)*(_WORD *)v17 >> 1;
                  v54 = v18;
                  v53 = v19;
                  v48 = 1;
                  goto LABEL_155;
                }
                v48 = 0;
                v54 = v18;
                v20 = *(_WORD *)v17;
              }
              else
              {
                v54 = (int)__nullstring;
                v20 = strlen(__nullstring);
              }
              goto LABEL_154;
            }
            if ( v4 == 99 )
              goto LABEL_69;
            if ( v4 != 100 )
              goto LABEL_155;
LABEL_120:
            v56 |= 0x40u;
LABEL_121:
            v53 = 10;
            goto LABEL_122;
          }
          if ( v4 == 88 )
            goto LABEL_111;
          if ( v4 == 67 )
          {
            if ( !(v56 & 0x830) )
              v56 |= 0x800u;
LABEL_69:
            if ( v56 & 0x810 )
            {
              v16 = get_short_arg(&a3);
              v53 = wctomb(&MbCh, v16);
              if ( v53 < 0 )
                v45 = 1;
            }
            else
            {
              MbCh = get_int_arg(&a3);
              v53 = 1;
            }
            v54 = (int)&MbCh;
            goto LABEL_155;
          }
          if ( v4 == 69 || v4 == 71 )
          {
            v43 = 1;
            v4 += 32;
LABEL_65:
            v56 |= 0x40u;
            v15 = &MbCh;
            v54 = (int)&MbCh;
            if ( v55 >= 0 )
            {
              if ( v55 )
              {
                if ( v55 > 512 )
                  v55 = 512;
                if ( v55 > 163 )
                {
                  v21 = malloc(v55 + 349);
                  Memory = v21;
                  if ( v21 )
                  {
                    v15 = (char *)v21;
                    v54 = (int)v21;
                  }
                  else
                  {
                    v55 = 163;
                  }
                }
              }
              else if ( v4 == 103 )
              {
                v55 = 1;
              }
            }
            else
            {
              v55 = 6;
            }
            a3 += 8;
            v40 = *(_DWORD *)(a3 - 8);
            v41 = *(_DWORD *)(a3 - 4);
            _cfltcvt_tab(&v40, v15, (char)v4, v55, v43);
          }
          if ( v4 == 83 )
          {
            if ( !(v56 & 0x830) )
              v56 |= 0x800u;
LABEL_55:
            v10 = 0x7FFFFFFF;
            if ( v55 != -1 )
              v10 = v55;
            v11 = get_int_arg(&a3);
            v12 = (char *)v11;
            v54 = v11;
            if ( v56 & 0x810 )
            {
              if ( !v11 )
              {
                v12 = (char *)__wnullstring;
                v54 = (int)__wnullstring;
              }
              v48 = 1;
              for ( i = v12; ; i += 2 )
              {
                v14 = v10--;
                if ( !v14 || !*(_WORD *)i )
                  break;
              }
              v20 = (i - v12) >> 1;
            }
            else
            {
              if ( !v11 )
              {
                v12 = __nullstring;
                v54 = (int)__nullstring;
              }
              for ( j = v12; ; ++j )
              {
                v23 = v10--;
                if ( !v23 || !*j )
                  break;
              }
              v20 = j - v12;
            }
LABEL_154:
            v53 = v20;
          }
LABEL_155:
          if ( v45 )
            goto LABEL_178;
          v30 = v56;
          if ( !(v56 & 0x40) )
            goto LABEL_164;
          if ( BYTE1(v56) & 1 )
          {
            v52[0] = 45;
LABEL_163:
            v50 = 1;
            goto LABEL_164;
          }
          if ( v56 & 1 )
          {
            v52[0] = 43;
            goto LABEL_163;
          }
          if ( v56 & 2 )
          {
            v52[0] = 32;
            goto LABEL_163;
          }
LABEL_164:
          v31 = v49 - v50 - v53;
          if ( !(v56 & 0xC) )
            write_multi_char(32, v49 - v50 - v53, File, (int)&v52[2]);
          write_string((int)v52, v50, File, (int)&v52[2]);
          if ( v30 & 8 && !(v30 & 4) )
            write_multi_char(48, v31, File, (int)&v52[2]);
          if ( v48 && v53 > 0 )
          {
            v32 = (wchar_t *)v54;
            v33 = v53 - 1;
            do
            {
              v34 = *v32;
              ++v32;
              v35 = wctomb(&v42, v34);
              if ( v35 <= 0 )
                break;
              write_string((int)&v42, v35, File, (int)&v52[2]);
              v36 = v33--;
            }
            while ( v36 );
          }
          else
          {
            write_string(v54, v53, File, (int)&v52[2]);
          }
          if ( v56 & 4 )
            write_multi_char(32, v31, File, (int)&v52[2]);
LABEL_178:
          if ( Memory )
          {
            free(Memory);
            Memory = 0;
          }
LABEL_180:
          v4 = *v57;
          v5 = (int)(v57 + 1);
          v6 = *v57++ == 0;
          if ( v6 )
            return *(_DWORD *)&v52[2];
          v3 = v44;
          break;
        default:
          goto LABEL_180;
      }
    }
  }
  return *(_DWORD *)&v52[2];
}
// 431FDB: using guessed type _DWORD __cdecl get_int_arg(_DWORD);
// 431FE8: using guessed type _DWORD __cdecl get_int64_arg(_DWORD);
// 431FF8: using guessed type _DWORD __cdecl get_short_arg(_DWORD);
// 49C75C: using guessed type wchar_t *__wnullstring;
// 49E980: using guessed type int (__cdecl *_cfltcvt_tab)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00432006) --------------------------------------------------------
int *__cdecl _dosmaperr(unsigned __int32 a1)
{
  int v1; // esi@1
  _DWORD *v2; // eax@1
  int *result; // eax@6

  v1 = 0;
  *__doserrno() = a1;
  v2 = &unk_49C760;
  do
  {
    if ( a1 == *v2 )
    {
      result = _errno();
      *result = dword_49C764[2 * v1];
      return result;
    }
    v2 += 2;
    ++v1;
  }
  while ( (_UNKNOWN *)v2 < &_XcptActTab );
  if ( a1 < 0x13 || a1 > 0x24 )
  {
    if ( a1 < 0xBC || a1 > 0xCA )
    {
      result = _errno();
      *result = 22;
    }
    else
    {
      result = _errno();
      *result = 8;
    }
  }
  else
  {
    result = _errno();
    *result = 13;
  }
  return result;
}
// 49C764: using guessed type int dword_49C764[];

//----- (0043208B) --------------------------------------------------------
void *__cdecl calloc(size_t NumOfElements, size_t SizeOfElements)
{
  unsigned int v2; // esi@1
  void *result; // eax@19
  size_t v4; // [sp-4h] [bp-38h]@9
  void *Dst; // [sp+14h] [bp-20h]@5
  size_t v6; // [sp+18h] [bp-1Ch]@1

  v2 = SizeOfElements * NumOfElements;
  v6 = SizeOfElements * NumOfElements;
  if ( SizeOfElements * NumOfElements <= 0xFFFFFFE0 )
  {
    if ( !v2 )
      v2 = 1;
    v2 = (v2 + 15) & 0xFFFFFFF0;
  }
  while ( 1 )
  {
    Dst = 0;
    if ( v2 <= 0xFFFFFFE0 )
    {
      if ( __active_heap == 3 )
      {
        if ( v6 > __sbh_threshold )
          goto LABEL_15;
        _lock(9);
        Dst = (void *)__sbh_alloc_block(v6);
        _unlock(9);
        if ( Dst )
        {
          v4 = SizeOfElements * NumOfElements;
LABEL_14:
          memset(Dst, 0, v4);
          goto LABEL_15;
        }
      }
      else
      {
        if ( __active_heap != 2 || v2 > __old_sbh_threshold )
        {
LABEL_15:
          if ( Dst )
            return Dst;
          goto LABEL_16;
        }
        _lock(9);
        Dst = (void *)__old_sbh_alloc_block(v2 >> 4);
        _unlock(9);
        if ( Dst )
        {
          v4 = v2;
          goto LABEL_14;
        }
      }
LABEL_16:
      Dst = HeapAlloc(_crtheap, 8u, v2);
    }
    if ( Dst || !_newmode )
      return Dst;
    result = (void *)_callnewh(v2);
    if ( !result )
      return result;
  }
}
// 430ACB: using guessed type _DWORD __cdecl _lock(_DWORD);
// 430B2C: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 432B08: using guessed type _DWORD __cdecl __sbh_alloc_block(_DWORD);
// 433F2A: using guessed type _DWORD __cdecl _callnewh(_DWORD);
// 49E97C: using guessed type int __old_sbh_threshold;
// 4A61C0: using guessed type int _newmode;
// 4A7948: using guessed type int __sbh_threshold;
// 4A7950: using guessed type int __active_heap;

//----- (00432420) --------------------------------------------------------
char __cdecl _GetLinkerVersion(int a1)
{
  HMODULE v1; // eax@1
  int v2; // ecx@2

  *(_DWORD *)a1 = 0;
  v1 = GetModuleHandleA(0);
  if ( *(_WORD *)v1 == 23117 )
  {
    v2 = *((_DWORD *)v1 + 15);
    if ( v2 )
    {
      v1 = (HMODULE)((char *)v1 + v2);
      *(_BYTE *)a1 = *((_BYTE *)v1 + 26);
      LOBYTE(v1) = *((_BYTE *)v1 + 27);
      *(_BYTE *)(a1 + 1) = (_BYTE)v1;
    }
  }
  return (unsigned int)v1;
}

//----- (0043244D) --------------------------------------------------------
__int32 __heap_select()
{
  __int32 result; // eax@4
  char *v1; // ecx@6
  char v2; // al@7
  char *v3; // eax@12
  char *v4; // ecx@13
  char v5; // al@14
  char *v6; // eax@20
  const char *v7; // eax@21
  char *v8; // ecx@21
  char Buffer; // [sp+4h] [bp-122Ch]@5
  char Filename; // [sp+1094h] [bp-19Ch]@13
  struct _OSVERSIONINFOA VersionInformation; // [sp+1198h] [bp-98h]@1
  unsigned __int8 v12; // [sp+122Ch] [bp-4h]@29

  VersionInformation.dwOSVersionInfoSize = 148;
  if ( GetVersionExA(&VersionInformation)
    && VersionInformation.dwPlatformId == 2
    && VersionInformation.dwMajorVersion >= 5 )
  {
    result = 1;
  }
  else
  {
    if ( !GetEnvironmentVariableA("__MSVCRT_HEAP_SELECT", &Buffer, 0x1090u) )
      goto LABEL_32;
    v1 = &Buffer;
    if ( Buffer )
    {
      do
      {
        v2 = *v1;
        if ( *v1 >= 97 && v2 <= 122 )
          *v1 = v2 - 32;
        ++v1;
      }
      while ( *v1 );
    }
    if ( !strncmp("__GLOBAL_HEAP_SELECTED", &Buffer, 0x16u) )
    {
      v3 = &Buffer;
    }
    else
    {
      GetModuleFileNameA(0, &Filename, 0x104u);
      v4 = &Filename;
      if ( Filename )
      {
        do
        {
          v5 = *v4;
          if ( *v4 >= 97 && v5 <= 122 )
            *v4 = v5 - 32;
          ++v4;
        }
        while ( *v4 );
      }
      v3 = strstr(&Buffer, &Filename);
    }
    if ( !v3 )
      goto LABEL_32;
    v6 = strchr(v3, 44);
    if ( !v6 )
      goto LABEL_32;
    v7 = v6 + 1;
    v8 = (char *)v7;
    if ( *v7 )
    {
      do
      {
        if ( *v8 == 59 )
          *v8 = 0;
        else
          ++v8;
      }
      while ( *v8 );
    }
    result = strtol(v7, 0, 10);
    if ( result != 2 && result != 3 && result != 1 )
    {
LABEL_32:
      _GetLinkerVersion((int)&v12);
      result = 3 - (v12 < 6u);
    }
  }
  return result;
}

//----- (00432595) --------------------------------------------------------
signed int __cdecl _heap_init(int a1)
{
  __int32 v1; // eax@2
  void **v2; // eax@3

  _crtheap = HeapCreate(a1 == 0, 0x1000u, 0);
  if ( !_crtheap )
    return 0;
  v1 = __heap_select();
  __active_heap = v1;
  if ( v1 == 3 )
  {
    v2 = (void **)__sbh_heap_init(1016);
  }
  else
  {
    if ( v1 != 2 )
      return 1;
    v2 = __old_sbh_new_region();
  }
  if ( !v2 )
  {
    HeapDestroy(_crtheap);
    return 0;
  }
  return 1;
}
// 43276C: using guessed type _DWORD __cdecl __sbh_heap_init(_DWORD);
// 4A7950: using guessed type int __active_heap;

//----- (004325F2) --------------------------------------------------------
BOOL _heap_term()
{
  int v0; // ebx@2
  char *v1; // esi@3
  void **v2; // esi@7
  void *v3; // eax@8

  if ( __active_heap == 3 )
  {
    v0 = 0;
    if ( __sbh_cntHeaderList > 0 )
    {
      v1 = (char *)__sbh_pHeaderList + 12;
      do
      {
        VirtualFree(*(LPVOID *)v1, 0x100000u, 0x4000u);
        VirtualFree(*(LPVOID *)v1, 0, 0x8000u);
        HeapFree(_crtheap, 0, *((LPVOID *)v1 + 1));
        v1 += 20;
        ++v0;
      }
      while ( v0 < __sbh_cntHeaderList );
    }
    HeapFree(_crtheap, 0, __sbh_pHeaderList);
  }
  else if ( __active_heap == 2 )
  {
    v2 = &__old_small_block_heap;
    do
    {
      v3 = v2[4];
      if ( v3 )
        VirtualFree(v3, 0, 0x8000u);
      v2 = (void **)*v2;
    }
    while ( v2 != &__old_small_block_heap );
  }
  return HeapDestroy(_crtheap);
}
// 49C958: using guessed type void *__old_small_block_heap;
// 4A7940: using guessed type int __sbh_cntHeaderList;
// 4A7950: using guessed type int __active_heap;

//----- (0043269A) --------------------------------------------------------
size_t __cdecl _get_sbh_threshold()
{
  size_t result; // eax@2

  if ( __active_heap == 3 )
    result = __sbh_threshold;
  else
    result = __active_heap == 2 ? __old_sbh_threshold : 0;
  return result;
}
// 49E97C: using guessed type int __old_sbh_threshold;
// 4A7948: using guessed type int __sbh_threshold;
// 4A7950: using guessed type int __active_heap;

//----- (004326B9) --------------------------------------------------------
int __cdecl _set_sbh_threshold(size_t NewValue)
{
  size_t v1; // eax@5
  size_t v2; // esi@8
  unsigned int v3; // esi@13

  switch ( __active_heap )
  {
    case 3:
      if ( NewValue <= 0x3F8 )
      {
        __sbh_threshold = NewValue;
        return 1;
      }
      break;
    case 2:
      v1 = NewValue + 15;
      LOBYTE(v1) = (NewValue + 15) & 0xF0;
      if ( v1 <= 0x780 )
      {
        __old_sbh_threshold = v1;
        return 1;
      }
      break;
    case 1:
      v2 = NewValue;
      if ( NewValue )
      {
        _GetLinkerVersion((int)&NewValue);
        if ( (unsigned __int8)NewValue < 6u )
        {
          v3 = (v2 + 15) & 0xFFFFFFF0;
          if ( v3 <= 0x780 && __old_sbh_new_region() )
          {
            __old_sbh_threshold = v3;
            __active_heap = 2;
            return 1;
          }
        }
        else if ( v2 <= 0x3F8 && __sbh_heap_init(v2) )
        {
          __sbh_threshold = v2;
          __active_heap = 3;
          return 1;
        }
      }
      break;
  }
  return 0;
}
// 43276C: using guessed type _DWORD __cdecl __sbh_heap_init(_DWORD);
// 49E97C: using guessed type int __old_sbh_threshold;
// 4A7948: using guessed type int __sbh_threshold;
// 4A7950: using guessed type int __active_heap;

//----- (004327DF) --------------------------------------------------------
char *__cdecl __sbh_free_block(unsigned int a1, int a2)
{
  char *result; // eax@1
  int v3; // esi@1
  unsigned int v4; // edi@1
  signed int v5; // ecx@1
  int v6; // ebx@2
  unsigned int v7; // edx@3
  char *v8; // ecx@7
  unsigned int v9; // ebx@7
  bool v10; // zf@7
  char *v11; // ecx@9
  unsigned int v12; // ebx@9
  int v13; // ecx@11
  unsigned int v14; // edx@14
  unsigned int v15; // ebx@17
  unsigned int v16; // esi@24
  unsigned int v17; // esi@26
  int v18; // ecx@33
  void *v19; // eax@43
  char *v20; // [sp+Ch] [bp-10h]@1
  signed int v21; // [sp+10h] [bp-Ch]@2
  signed int v22; // [sp+14h] [bp-8h]@2
  int v23; // [sp+18h] [bp-4h]@1
  int v24; // [sp+28h] [bp+Ch]@2
  int v25; // [sp+28h] [bp+Ch]@17
  char v26; // [sp+2Bh] [bp+Fh]@34

  result = *(char **)(a1 + 16);
  v3 = a2 - 4;
  v4 = (unsigned int)(a2 - *(_DWORD *)(a1 + 12)) >> 15;
  v20 = &result[516 * v4 + 324];
  v5 = *(_DWORD *)(a2 - 4) - 1;
  v23 = *(_DWORD *)(a2 - 4) - 1;
  if ( !(v5 & 1) )
  {
    v6 = v5 + v3;
    v21 = *(_DWORD *)(v5 + v3);
    v22 = *(_DWORD *)(a2 - 8);
    v24 = v5 + v3;
    if ( !(v21 & 1) )
    {
      v7 = (v21 >> 4) - 1;
      if ( v7 > 0x3F )
        v7 = 63;
      if ( *(_DWORD *)(v6 + 4) == *(_DWORD *)(v6 + 8) )
      {
        if ( v7 >= 0x20 )
        {
          v11 = &result[v7 + 4];
          v12 = ~(0x80000000 >> (v7 - 32));
          *(_DWORD *)&result[4 * v4 + 196] &= v12;
          v10 = (*v11)-- == 1;
          if ( v10 )
            *(_DWORD *)(a1 + 4) &= v12;
        }
        else
        {
          v8 = &result[v7 + 4];
          v9 = ~(0x80000000 >> v7);
          *(_DWORD *)&result[4 * v4 + 68] &= v9;
          v10 = (*v8)-- == 1;
          if ( v10 )
            *(_DWORD *)a1 &= v9;
        }
        v13 = v23;
        v6 = v24;
      }
      else
      {
        v13 = v23;
      }
      v5 = v21 + v13;
      *(_DWORD *)(*(_DWORD *)(v6 + 8) + 4) = *(_DWORD *)(v6 + 4);
      v23 = v5;
      *(_DWORD *)(*(_DWORD *)(v24 + 4) + 8) = *(_DWORD *)(v24 + 8);
    }
    v14 = (v5 >> 4) - 1;
    if ( v14 > 0x3F )
      v14 = 63;
    if ( v22 & 1 )
    {
      v15 = a1;
    }
    else
    {
      v25 = v3 - v22;
      v15 = (v22 >> 4) - 1;
      if ( v15 > 0x3F )
        v15 = 63;
      v23 = v22 + v5;
      v14 = ((v22 + v5) >> 4) - 1;
      if ( v14 > 0x3F )
        v14 = 63;
      if ( v15 != v14 )
      {
        if ( *(_DWORD *)(v25 + 4) == *(_DWORD *)(v25 + 8) )
        {
          if ( v15 >= 0x20 )
          {
            v17 = ~(0x80000000 >> (v15 - 32));
            *(_DWORD *)&result[4 * v4 + 196] &= v17;
            v10 = result[v15 + 4]-- == 1;
            if ( v10 )
              *(_DWORD *)(a1 + 4) &= v17;
          }
          else
          {
            v16 = ~(0x80000000 >> v15);
            *(_DWORD *)&result[4 * v4 + 68] &= v16;
            v10 = result[v15 + 4]-- == 1;
            if ( v10 )
              *(_DWORD *)a1 &= v16;
          }
        }
        *(_DWORD *)(*(_DWORD *)(v25 + 8) + 4) = *(_DWORD *)(v25 + 4);
        *(_DWORD *)(*(_DWORD *)(v25 + 4) + 8) = *(_DWORD *)(v25 + 8);
      }
      v3 = v25;
    }
    if ( v22 & 1 || v15 != v14 )
    {
      v18 = (int)&v20[8 * v14];
      *(_DWORD *)(v3 + 4) = *(_DWORD *)&v20[8 * v14 + 4];
      *(_DWORD *)(v3 + 8) = v18;
      *(_DWORD *)(v18 + 4) = v3;
      *(_DWORD *)(*(_DWORD *)(v3 + 4) + 8) = v3;
      if ( *(_DWORD *)(v3 + 4) == *(_DWORD *)(v3 + 8) )
      {
        v26 = result[v14 + 4];
        result[v14 + 4] = v26 + 1;
        if ( v14 >= 0x20 )
        {
          if ( !v26 )
            *(_DWORD *)(a1 + 4) |= 0x80000000 >> (v14 - 32);
          *(_DWORD *)&result[4 * v4 + 196] |= 0x80000000 >> (v14 - 32);
        }
        else
        {
          if ( !v26 )
            *(_DWORD *)a1 |= 0x80000000 >> v14;
          *(_DWORD *)&result[4 * v4 + 68] |= 0x80000000 >> v14;
        }
      }
    }
    *(_DWORD *)v3 = v23;
    *(_DWORD *)(v23 + v3 - 4) = v23;
    result += 516 * v4 + 324;
    v10 = *(_DWORD *)v20 == 1;
    --*(_DWORD *)result;
    if ( v10 )
    {
      if ( __sbh_pHeaderDefer )
      {
        VirtualFree((LPVOID)(*((_DWORD *)__sbh_pHeaderDefer + 3) + (__sbh_indGroupDefer << 15)), 0x8000u, 0x4000u);
        *((_DWORD *)__sbh_pHeaderDefer + 2) |= 0x80000000 >> __sbh_indGroupDefer;
        *(_DWORD *)(*((_DWORD *)__sbh_pHeaderDefer + 4) + 4 * __sbh_indGroupDefer + 196) = 0;
        --*(_BYTE *)(*((_DWORD *)__sbh_pHeaderDefer + 4) + 67);
        v19 = __sbh_pHeaderDefer;
        if ( !*(_BYTE *)(*((_DWORD *)__sbh_pHeaderDefer + 4) + 67) )
        {
          *((_DWORD *)__sbh_pHeaderDefer + 1) &= 0xFFFFFFFE;
          v19 = __sbh_pHeaderDefer;
        }
        if ( *((_DWORD *)v19 + 2) == -1 )
        {
          VirtualFree(*((LPVOID *)v19 + 3), 0, 0x8000u);
          HeapFree(_crtheap, 0, *((LPVOID *)__sbh_pHeaderDefer + 4));
          memmove(
            __sbh_pHeaderDefer,
            (char *)__sbh_pHeaderDefer + 20,
            (size_t)__sbh_pHeaderList + 20 * __sbh_cntHeaderList - (_DWORD)__sbh_pHeaderDefer - 20);
          --__sbh_cntHeaderList;
          if ( a1 > (unsigned int)__sbh_pHeaderDefer )
            a1 -= 20;
          __sbh_pHeaderScan = (int)__sbh_pHeaderList;
        }
      }
      result = (char *)a1;
      __sbh_indGroupDefer = v4;
      __sbh_pHeaderDefer = (void *)a1;
    }
  }
  return result;
}
// 4A7930: using guessed type int __sbh_indGroupDefer;
// 4A7934: using guessed type int __sbh_pHeaderScan;
// 4A7940: using guessed type int __sbh_cntHeaderList;

//----- (004336B3) --------------------------------------------------------
int _get_old_sbh_threshold()
{
  return __old_sbh_threshold;
}
// 49E97C: using guessed type int __old_sbh_threshold;

//----- (004336B9) --------------------------------------------------------
signed int __cdecl _set_old_sbh_threshold(int a1)
{
  unsigned int v1; // eax@1
  signed int result; // eax@2

  v1 = a1 + 15;
  LOBYTE(v1) = (a1 + 15) & 0xF0;
  if ( v1 > 0x780 )
  {
    result = 0;
  }
  else
  {
    __old_sbh_threshold = v1;
    result = 1;
  }
  return result;
}
// 49E97C: using guessed type int __old_sbh_threshold;

//----- (004336D5) --------------------------------------------------------
void **__old_sbh_new_region()
{
  void **v0; // esi@2
  void *v1; // eax@4
  unsigned int v2; // edi@4
  int v3; // eax@12
  signed int v4; // ebp@12
  int v5; // edx@13

  if ( dword_49C968 == -1 )
  {
    v0 = &__old_small_block_heap;
  }
  else
  {
    v0 = (void **)HeapAlloc(_crtheap, 0, 0x2020u);
    if ( !v0 )
      return 0;
  }
  v1 = VirtualAlloc(0, 0x400000u, 0x2000u, 4u);
  v2 = (unsigned int)v1;
  if ( !v1 )
  {
LABEL_19:
    if ( v0 != &__old_small_block_heap )
      HeapFree(_crtheap, 0, v0);
    return 0;
  }
  if ( !VirtualAlloc(v1, 0x10000u, 0x1000u, 4u) )
  {
    VirtualFree((LPVOID)v2, 0, 0x8000u);
    goto LABEL_19;
  }
  if ( v0 == &__old_small_block_heap )
  {
    if ( !__old_small_block_heap )
      __old_small_block_heap = &__old_small_block_heap;
    if ( !lpMem )
      lpMem = &__old_small_block_heap;
  }
  else
  {
    *v0 = &__old_small_block_heap;
    v0[1] = lpMem;
    lpMem = v0;
    *(_DWORD *)v0[1] = v0;
  }
  v0[5] = (void *)(v2 + 0x400000);
  v3 = (int)(v0 + 6);
  v0[3] = v0 + 38;
  v0[4] = (void *)v2;
  v0[2] = v0 + 6;
  v4 = 0;
  do
  {
    v5 = v4++ >= 16;
    *(_DWORD *)v3 = ((v5 - 1) & 0xF1) - 1;
    *(_DWORD *)(v3 + 4) = 241;
    v3 += 8;
  }
  while ( v4 < 1024 );
  memset((void *)v2, 0, 0x10000u);
  while ( v2 < (unsigned int)v0[4] + 0x10000 )
  {
    *(_BYTE *)(v2 + 248) = -1;
    *(_DWORD *)v2 = v2 + 8;
    *(_DWORD *)(v2 + 4) = 240;
    v2 += 4096;
  }
  return v0;
}
// 49C958: using guessed type void *__old_small_block_heap;
// 49C968: using guessed type int dword_49C968;

//----- (00433819) --------------------------------------------------------
int __cdecl __old_sbh_release_region(LPVOID lpMem)
{
  int result; // eax@1

  result = VirtualFree(*((LPVOID *)lpMem + 4), 0, 0x8000u);
  if ( off_49E978 == lpMem )
  {
    result = *((_DWORD *)lpMem + 1);
    off_49E978 = (void **)*((_DWORD *)lpMem + 1);
  }
  if ( lpMem == &__old_small_block_heap )
  {
    dword_49C968 = -1;
  }
  else
  {
    **((_DWORD **)lpMem + 1) = *(_DWORD *)lpMem;
    *(_DWORD *)(*(_DWORD *)lpMem + 4) = *((_DWORD *)lpMem + 1);
    result = HeapFree(_crtheap, 0, lpMem);
  }
  return result;
}
// 49C958: using guessed type void *__old_small_block_heap;
// 49C968: using guessed type int dword_49C968;
// 49E978: using guessed type void **off_49E978;

//----- (0043386F) --------------------------------------------------------
void __cdecl __old_sbh_decommit_pages(int a1)
{
  LPVOID v1; // esi@1
  _DWORD *v2; // edi@3
  signed int v3; // ebx@3
  unsigned int v4; // eax@6
  LPVOID v5; // ecx@11
  _DWORD *v6; // eax@13
  signed int v7; // edx@13
  int v8; // [sp+Ch] [bp-4h]@3

  v1 = lpMem;
  do
  {
    if ( *((_DWORD *)v1 + 4) != -1 )
    {
      v8 = 0;
      v2 = (char *)v1 + 8208;
      v3 = 4190208;
      do
      {
        if ( *v2 == 240 && VirtualFree((LPVOID)(*((_DWORD *)v1 + 4) + v3), 0x1000u, 0x4000u) )
        {
          *v2 = -1;
          --dword_4A61BC;
          v4 = *((_DWORD *)v1 + 3);
          if ( !v4 || v4 > (unsigned int)v2 )
            *((_DWORD *)v1 + 3) = v2;
          ++v8;
          if ( !--a1 )
            break;
        }
        v3 -= 4096;
        v2 -= 2;
      }
      while ( v3 >= 0 );
      v5 = v1;
      v1 = (LPVOID)*((_DWORD *)v1 + 1);
      if ( v8 && *((_DWORD *)v5 + 6) == -1 )
      {
        v6 = (char *)v5 + 32;
        v7 = 1;
        do
        {
          if ( *v6 != -1 )
            break;
          ++v7;
          v6 += 2;
        }
        while ( v7 < 1024 );
        if ( v7 == 1024 )
          __old_sbh_release_region(v5);
      }
    }
  }
  while ( v1 != lpMem && a1 > 0 );
}
// 4A61BC: using guessed type int dword_4A61BC;

//----- (00433931) --------------------------------------------------------
unsigned int __cdecl __old_sbh_find_block(unsigned int a1, void ***a2, unsigned int *a3)
{
  void **v3; // ecx@1

  v3 = &__old_small_block_heap;
  while ( a1 <= (unsigned int)v3[4] || a1 >= (unsigned int)v3[5] )
  {
    v3 = (void **)*v3;
    if ( v3 == &__old_small_block_heap )
      return 0;
  }
  if ( !(a1 & 0xF) && (a1 & 0xFFF) >= 0x100 )
  {
    *a2 = v3;
    *a3 = a1 & 0xFFFFF000;
    return ((signed int)(a1 - (a1 & 0xFFFFF000) - 256) >> 4) + (a1 & 0xFFFFF000) + 8;
  }
  return 0;
}
// 49C958: using guessed type void *__old_small_block_heap;

//----- (00433988) --------------------------------------------------------
void __cdecl __old_sbh_free_block(int a1, int a2, _BYTE *a3)
{
  int v3; // eax@1
  bool v4; // zf@1

  v3 = a1 + 8 * ((a2 - *(_DWORD *)(a1 + 16)) >> 12) + 24;
  *(_DWORD *)v3 += *a3;
  *a3 = 0;
  v4 = *(_DWORD *)v3 == 240;
  *(_DWORD *)(v3 + 4) = 241;
  if ( v4 && ++dword_4A61BC == 32 )
    __old_sbh_decommit_pages(16);
}
// 4A61BC: using guessed type int dword_4A61BC;

//----- (004339CD) --------------------------------------------------------
int __cdecl __old_sbh_alloc_block(unsigned int a1)
{
  void **v1; // esi@1
  char *v2; // edx@2
  unsigned int v3; // edi@3
  int v4; // eax@3
  unsigned int v5; // ebx@4
  int result; // eax@6
  void **v7; // edi@22
  _DWORD *v8; // ebx@27
  _DWORD *v9; // eax@27
  int i; // esi@27
  _DWORD *v11; // ecx@31
  int v12; // eax@32
  unsigned int v13; // eax@34
  bool v14; // cf@35
  void **v15; // eax@40
  _BYTE *v16; // ecx@41
  unsigned int Val; // [sp+Ch] [bp-8h]@11
  int v18; // [sp+10h] [bp-4h]@3
  int v19; // [sp+10h] [bp-4h]@11
  signed int v20; // [sp+10h] [bp-4h]@27

  v1 = off_49E978;
  do
  {
    v2 = (char *)v1[4];
    if ( v2 == (char *)-1 )
    {
      v5 = a1;
    }
    else
    {
      v3 = (unsigned int)v1[2];
      v4 = (int)&v2[4096 * (((_BYTE *)v1[2] - (_BYTE *)v1 - 24) >> 3)];
      v18 = (int)&v2[4096 * (((_BYTE *)v1[2] - (_BYTE *)v1 - 24) >> 3)];
      if ( v3 < (unsigned int)(v1 + 2054) )
      {
        while ( 1 )
        {
          v5 = a1;
          if ( *(_DWORD *)v3 >= (signed int)a1 && *(_DWORD *)(v3 + 4) > a1 )
          {
            result = __old_sbh_alloc_block_from_page(v4, *(_DWORD *)v3, a1);
            if ( result )
            {
LABEL_21:
              off_49E978 = v1;
              *(_DWORD *)v3 -= v5;
              v1[2] = (void *)v3;
              return result;
            }
            v4 = v18;
            *(_DWORD *)(v3 + 4) = a1;
          }
          v3 += 8;
          v4 += 4096;
          v18 = v4;
          if ( v3 >= (unsigned int)(v1 + 2054) )
            goto LABEL_11;
        }
      }
      v5 = a1;
LABEL_11:
      v3 = (unsigned int)(v1 + 6);
      Val = (unsigned int)v1[2];
      v19 = (int)v1[4];
      if ( (unsigned int)(v1 + 6) < Val )
      {
        do
        {
          if ( *(_DWORD *)v3 >= (signed int)v5 && *(_DWORD *)(v3 + 4) > v5 )
          {
            result = __old_sbh_alloc_block_from_page(v19, *(_DWORD *)v3, v5);
            if ( result )
              goto LABEL_21;
            *(_DWORD *)(v3 + 4) = v5;
          }
          v19 += 4096;
          v3 += 8;
        }
        while ( v3 < Val );
      }
    }
    v1 = (void **)*v1;
  }
  while ( v1 != off_49E978 );
  v7 = &__old_small_block_heap;
  while ( v7[4] == (void *)-1 || !v7[3] )
  {
    v7 = (void **)*v7;
    if ( v7 == &__old_small_block_heap )
    {
      v15 = __old_sbh_new_region();
      if ( v15 )
      {
        v16 = v15[4];
        v16[8] = v5;
        off_49E978 = v15;
        *(_DWORD *)v16 = &v16[v5 + 8];
        *((_DWORD *)v16 + 1) = 240 - v5;
        v15[6] = (char *)v15[6] - (unsigned __int8)v5;
        return (int)(v16 + 256);
      }
      return 0;
    }
  }
  v8 = v7[3];
  v20 = 0;
  v9 = v8;
  for ( i = (int)v7[4] + 4096 * (((char *)v8 - (char *)v7 - 24) >> 3); *v9 == -1; ++v20 )
  {
    if ( v20 >= 16 )
      break;
    v9 += 2;
  }
  if ( VirtualAlloc((LPVOID)i, v20 << 12, 0x1000u, 4u) != (LPVOID)i )
    return 0;
  v11 = v8;
  if ( v20 > 0 )
  {
    v12 = i + 4;
    do
    {
      *(_BYTE *)(v12 + 244) = -1;
      *(_DWORD *)(v12 - 4) = v12 + 4;
      *(_DWORD *)v12 = 240;
      *v11 = 240;
      v11[1] = 241;
      v12 += 4096;
      v11 += 2;
      --v20;
    }
    while ( v20 );
  }
  off_49E978 = v7;
  v13 = (unsigned int)(v7 + 2054);
  while ( 1 )
  {
    v14 = (unsigned int)v11 < v13;
    if ( (unsigned int)v11 >= v13 )
      break;
    if ( *v11 == -1 )
    {
      v14 = (unsigned int)v11 < v13;
      break;
    }
    v11 += 2;
  }
  v7[3] = (void *)(v14 ? (unsigned int)v11 : 0);
  *(_BYTE *)(i + 8) = a1;
  v7[2] = v8;
  *v8 -= a1;
  *(_DWORD *)(i + 4) -= a1;
  result = i + 256;
  *(_DWORD *)i = i + a1 + 8;
  return result;
}
// 49C958: using guessed type void *__old_small_block_heap;
// 49E978: using guessed type void **off_49E978;

//----- (00433BD5) --------------------------------------------------------
int __cdecl __old_sbh_alloc_block_from_page(int a1, unsigned int a2, unsigned int a3)
{
  int v3; // ecx@1
  unsigned int v4; // esi@1
  _BYTE *v5; // edi@1
  unsigned int v6; // ebx@1
  _BYTE *v7; // eax@1
  int v8; // eax@5
  _BYTE *v9; // esi@6
  _BYTE *v10; // ebx@10
  unsigned int v11; // esi@10
  _BYTE *v12; // esi@20
  _BYTE *v13; // ebx@24
  unsigned int v14; // eax@24
  _BYTE *v16; // [sp+Ch] [bp-4h]@1
  unsigned int v17; // [sp+18h] [bp+8h]@1

  v3 = a1;
  v4 = *(_DWORD *)(a1 + 4);
  v5 = *(_BYTE **)a1;
  v6 = a1 + 248;
  v16 = *(_BYTE **)a1;
  v7 = *(_BYTE **)a1;
  v17 = a1 + 248;
  if ( v4 >= a3 )
  {
    *v5 = a3;
    if ( (unsigned int)&v5[a3] >= v6 )
    {
      *(_DWORD *)(v3 + 4) = 0;
      *(_DWORD *)v3 = v3 + 8;
    }
    else
    {
      *(_DWORD *)v3 += a3;
      *(_DWORD *)(v3 + 4) -= a3;
    }
    v8 = (int)(v5 + 8);
    return 16 * v8 - 15 * v3;
  }
  v9 = &v5[v4];
  if ( *v9 )
    v7 = v9;
  if ( (unsigned int)&v7[a3] >= v6 )
  {
LABEL_20:
    v12 = (_BYTE *)(v3 + 8);
    while ( v12 < v5 && (unsigned int)&v12[a3] < v17 )
    {
      if ( *v12 )
      {
        v12 += *v12;
      }
      else
      {
        v13 = v12 + 1;
        v14 = 1;
        while ( !*v13 )
        {
          ++v13;
          ++v14;
        }
        if ( v14 >= a3 )
        {
          if ( (unsigned int)&v12[a3] >= v17 )
          {
            *(_DWORD *)(v3 + 4) = 0;
            *(_DWORD *)v3 = v3 + 8;
          }
          else
          {
            *(_DWORD *)v3 = &v12[a3];
            *(_DWORD *)(v3 + 4) = v14 - a3;
          }
          *v12 = a3;
          v8 = (int)(v12 + 8);
          return 16 * v8 - 15 * v3;
        }
        a2 -= v14;
        if ( a2 < a3 )
          return 0;
        v12 = v13;
      }
    }
    return 0;
  }
  while ( *v7 )
  {
    v7 += *v7;
LABEL_19:
    if ( (unsigned int)&v7[a3] >= v17 )
      goto LABEL_20;
  }
  v10 = v7 + 1;
  v11 = 1;
  while ( !*v10 )
  {
    ++v10;
    ++v11;
  }
  if ( v11 < a3 )
  {
    if ( v7 == v16 )
    {
      *(_DWORD *)(v3 + 4) = v11;
    }
    else
    {
      a2 -= v11;
      if ( a2 < a3 )
        return 0;
    }
    v5 = v16;
    v7 = v10;
    goto LABEL_19;
  }
  if ( (unsigned int)&v7[a3] >= v17 )
  {
    *(_DWORD *)(v3 + 4) = 0;
    *(_DWORD *)v3 = v3 + 8;
  }
  else
  {
    *(_DWORD *)v3 = &v7[a3];
    *(_DWORD *)(v3 + 4) = v11 - a3;
  }
  *v7 = a3;
  v8 = (int)(v7 + 8);
  return 16 * v8 - 15 * v3;
}

//----- (00433CF9) --------------------------------------------------------
signed int __cdecl __old_sbh_resize_block(int a1, int a2, _BYTE *a3, unsigned int a4)
{
  unsigned int v4; // ecx@1
  int v5; // edi@1
  _BYTE *v6; // esi@4
  _BYTE *i; // eax@5
  bool v8; // zf@6
  int v9; // eax@14
  int v11; // [sp+Ch] [bp-4h]@1

  v4 = *a3;
  v11 = 0;
  v5 = a1 + 8 * ((a2 - *(_DWORD *)(a1 + 16)) >> 12) + 24;
  if ( v4 > a4 )
  {
    *a3 = a4;
    *(_DWORD *)v5 += v4 - a4;
    *(_DWORD *)(v5 + 4) = 241;
    return 1;
  }
  if ( v4 < a4 )
  {
    v6 = &a3[a4];
    if ( (unsigned int)&a3[a4] <= a2 + 248 )
    {
      for ( i = &a3[v4]; ; ++i )
      {
        v8 = i == v6;
        if ( i >= v6 )
          break;
        if ( *i )
        {
          v8 = i == v6;
          break;
        }
      }
      if ( v8 )
      {
        *a3 = a4;
        if ( (unsigned int)a3 <= *(_DWORD *)a2 && (unsigned int)v6 > *(_DWORD *)a2 )
        {
          if ( (unsigned int)v6 >= a2 + 248 )
          {
            *(_DWORD *)(a2 + 4) = 0;
            *(_DWORD *)a2 = a2 + 8;
          }
          else
          {
            v9 = 0;
            *(_DWORD *)a2 = v6;
            if ( !*v6 )
            {
              do
                ++v9;
              while ( !v6[v9] );
            }
            *(_DWORD *)(a2 + 4) = v9;
          }
        }
        *(_DWORD *)v5 += v4 - a4;
        return 1;
      }
    }
  }
  return v11;
}

//----- (00433DA2) --------------------------------------------------------
signed int __old_sbh_heap_check()
{
  void **v0; // edx@1
  char *v1; // ecx@4
  _DWORD *v2; // ebx@5
  int v3; // eax@5
  int v4; // edi@5
  signed int v5; // ecx@12
  _BYTE *v6; // esi@13
  int v7; // edx@21
  int v8; // esi@21
  signed int v10; // [sp-4h] [bp-30h]@33
  void **v11; // [sp+Ch] [bp-20h]@1
  int v12; // [sp+10h] [bp-1Ch]@1
  signed int v13; // [sp+14h] [bp-18h]@5
  int v14; // [sp+18h] [bp-14h]@5
  int v15; // [sp+1Ch] [bp-10h]@12
  int v16; // [sp+20h] [bp-Ch]@5
  signed int v17; // [sp+24h] [bp-8h]@12
  int v18; // [sp+28h] [bp-4h]@12

  v12 = 0;
  v0 = &__old_small_block_heap;
  v11 = &__old_small_block_heap;
  while ( 1 )
  {
    if ( off_49E978 == v0 )
      ++v12;
    v1 = (char *)v0[4];
    if ( v1 != (char *)-1 )
      break;
LABEL_30:
    v0 = (void **)*v0;
    v11 = v0;
    if ( v0 == &__old_small_block_heap )
      return v12 != 0 ? 0 : -9;
  }
  v13 = 0;
  v16 = 0;
  v2 = v0[4];
  v3 = (int)(v0 + 6);
  v14 = (int)(v0 + 6);
  v4 = (int)(v1 + 8);
  while ( *(_DWORD *)v3 == -1 )
  {
    if ( !v16 && v0[3] != (void *)v3 )
      return -1;
    ++v16;
LABEL_29:
    ++v13;
    v3 += 8;
    v2 += 1024;
    v4 += 4096;
    v14 = v3;
    if ( v13 >= 1024 )
      goto LABEL_30;
  }
  if ( *v2 >= (unsigned int)(v4 + 240) )
  {
    v10 = -2;
  }
  else if ( *(_BYTE *)(v4 + 240) == -1 )
  {
    v5 = 0;
    v17 = 0;
    v15 = 0;
    v18 = 0;
    while ( 1 )
    {
      v6 = (_BYTE *)(v4 + v5);
      if ( v4 + v5 == *v2 )
      {
        ++v17;
        v3 = v14;
      }
      if ( *v6 )
        break;
      ++v15;
      ++v18;
      ++v5;
LABEL_26:
      if ( v5 >= 240 )
      {
        if ( v15 == *(_DWORD *)v3 )
        {
          if ( v17 )
            goto LABEL_29;
          v10 = -8;
        }
        else
        {
          v10 = -7;
        }
        return v10;
      }
    }
    if ( v18 >= *(_DWORD *)(v3 + 4) )
      return -4;
    if ( v17 == 1 )
    {
      if ( v18 < *(_DWORD *)(v4 - 4) )
        return -5;
      v3 = v14;
      v17 = 2;
    }
    v18 = 0;
    v7 = v5 + 1;
    v8 = *v6;
    while ( 1 )
    {
      if ( v7 >= v5 + v8 )
      {
        v5 = v7;
        v0 = v11;
        goto LABEL_26;
      }
      if ( *(_BYTE *)(v4 + v7) )
        break;
      v8 = *((_BYTE *)v2 + v5 + 8);
      ++v7;
    }
    v10 = -6;
  }
  else
  {
    v10 = -3;
  }
  return v10;
}
// 49C958: using guessed type void *__old_small_block_heap;
// 49E978: using guessed type void **off_49E978;

//----- (00433F24) --------------------------------------------------------
int (__cdecl *__cdecl _query_new_handler())(unsigned int)
{
  return _pnhHeap;
}
// 4A61C4: using guessed type int (__cdecl *_pnhHeap)(unsigned int);

//----- (00434C61) --------------------------------------------------------
int __init_dummy()
{
  return 0;
}

//----- (00434E54) --------------------------------------------------------
int __cdecl _woutput(char MbCh, int a2, int a3)
{
  wchar_t *v3; // eax@1
  int v4; // ecx@1
  wchar_t v5; // bx@1
  bool v6; // zf@1
  int v7; // eax@7
  int v8; // eax@22
  int v9; // eax@23
  int v10; // edi@51
  char *v11; // eax@53
  char *v12; // ecx@53
  wchar_t *v13; // edi@63
  unsigned int v14; // eax@67
  int v15; // eax@76
  char *v16; // ecx@77
  int v17; // eax@79
  int v18; // eax@80
  void *v19; // eax@88
  char *i; // eax@102
  int v21; // edx@103
  _WORD *v22; // eax@113
  signed __int64 v23; // rax@120
  int v24; // eax@142
  signed int v25; // ebx@144
  char *v26; // eax@146
  int v27; // eax@147
  char v28; // bl@153
  int v29; // esi@161
  char *v30; // ebx@168
  int v31; // edi@168
  int v32; // eax@170
  wchar_t DstCh; // [sp+Ch] [bp-454h]@63
  char v35; // [sp+20Bh] [bp-255h]@141
  int v36; // [sp+40Ch] [bp-54h]@91
  int v37; // [sp+410h] [bp-50h]@91
  int v38; // [sp+414h] [bp-4Ch]@169
  wchar_t WCh[2]; // [sp+418h] [bp-48h]@67
  int v40; // [sp+41Ch] [bp-44h]@3
  int v41; // [sp+420h] [bp-40h]@10
  int v42; // [sp+424h] [bp-3Ch]@10
  int v43; // [sp+428h] [bp-38h]@99
  void *Memory; // [sp+42Ch] [bp-34h]@1
  char SrcCh; // [sp+432h] [bp-2Eh]@68
  char v46; // [sp+433h] [bp-2Dh]@68
  int v47; // [sp+434h] [bp-2Ch]@10
  int v48; // [sp+438h] [bp-28h]@110
  int v49; // [sp+43Ch] [bp-24h]@10
  int v50; // [sp+440h] [bp-20h]@10
  unsigned __int64 v51; // [sp+444h] [bp-1Ch]@131
  int v52; // [sp+44Ch] [bp-14h]@1
  int j; // [sp+450h] [bp-10h]@1
  char *v54; // [sp+454h] [bp-Ch]@53
  int v55; // [sp+458h] [bp-8h]@10
  int v56; // [sp+45Ch] [bp-4h]@10
  int v57; // [sp+46Ch] [bp+Ch]@1

  v3 = (wchar_t *)a2;
  v57 = a2 + 2;
  v4 = 0;
  v5 = *v3;
  v6 = *v3 == 0;
  j = 0;
  v52 = 0;
  Memory = 0;
  if ( !v6 )
  {
    while ( 1 )
    {
      if ( v52 < 0 )
        return v52;
      if ( v5 < 0x20u || v5 > 0x78u )
        v7 = 0;
      else
        v7 = byte_445B80[v5] & 0xF;
      v40 = *(&__lookuptable[8 * v7] + v4) >> 4;
      switch ( v40 )
      {
        case 1:
          v55 = -1;
          v41 = 0;
          v42 = 0;
          v47 = 0;
          v50 = 0;
          v56 = 0;
          v49 = 0;
          goto LABEL_177;
        case 2:
          switch ( v5 )
          {
            case 0x20u:
              v56 |= 2u;
              break;
            case 0x23u:
              LOBYTE(v56) = v56 | 0x80;
              break;
            case 0x2Bu:
              v56 |= 1u;
              break;
            case 0x2Du:
              v56 |= 4u;
              break;
            case 0x30u:
              v56 |= 8u;
              break;
          }
          goto LABEL_177;
        case 3:
          if ( v5 == 42 )
          {
            v8 = get_int_arg_0(&a3);
            v47 = v8;
            if ( v8 >= 0 )
              goto LABEL_177;
            v56 |= 4u;
            v9 = -v8;
          }
          else
          {
            v9 = v5 + 10 * v47 - 48;
          }
          v47 = v9;
          goto LABEL_177;
        case 4:
          v55 = 0;
          goto LABEL_177;
        case 5:
          if ( v5 == 42 )
          {
            v55 = get_int_arg_0(&a3);
            if ( v55 < 0 )
              v55 = -1;
          }
          else
          {
            v55 = v5 + 10 * v55 - 48;
          }
          goto LABEL_177;
        case 6:
          switch ( v5 )
          {
            case 0x49u:
              if ( *(_WORD *)v57 != 54 || *(_WORD *)(v57 + 2) != 52 )
              {
                v40 = 0;
LABEL_40:
                v49 = 1;
                write_char_0(v5, MbCh, (int)&v52);
              }
              else
              {
                v57 += 4;
                BYTE1(v56) |= 0x80u;
              }
              break;
            case 0x68u:
              v56 |= 0x20u;
              break;
            case 0x77u:
              BYTE1(v56) |= 8u;
              break;
          }
          goto LABEL_177;
        case 0:
          goto LABEL_40;
        case 7:
          if ( (signed int)v5 > 103 )
          {
            if ( v5 == 105 )
              goto LABEL_117;
            if ( v5 == 110 )
            {
              v22 = (_WORD *)get_int_arg_0(&a3);
              if ( v56 & 0x20 )
                *v22 = v52;
              else
                *(_DWORD *)v22 = v52;
              v42 = 1;
              goto LABEL_175;
            }
            if ( v5 == 111 )
            {
              j = 8;
              if ( v56 & 0x80 )
                BYTE1(v56) |= 2u;
            }
            else
            {
              if ( v5 == 112 )
              {
                v55 = 8;
LABEL_108:
                v43 = 7;
              }
              else
              {
                if ( v5 == 115 )
                  goto LABEL_51;
                if ( v5 == 117 )
                  goto LABEL_118;
                if ( v5 != 120 )
                  goto LABEL_152;
                v43 = 39;
              }
              j = 16;
              if ( v56 & 0x80 )
              {
                LOWORD(v48) = 48;
                v50 = 2;
                HIWORD(v48) = v43 + 81;
              }
            }
LABEL_119:
            if ( BYTE1(v56) & 0x80 )
            {
              LODWORD(v23) = get_int64_arg_0(&a3);
            }
            else
            {
              if ( v56 & 0x20 )
              {
                if ( v56 & 0x40 )
                  LODWORD(v23) = (signed __int16)get_int_arg_0(&a3);
                else
                  LODWORD(v23) = (unsigned __int16)get_int_arg_0(&a3);
              }
              else
              {
                if ( !(v56 & 0x40) )
                {
                  v23 = get_int_arg_0(&a3);
                  goto LABEL_129;
                }
                LODWORD(v23) = get_int_arg_0(&a3);
              }
              v23 = (signed int)v23;
            }
LABEL_129:
            if ( v56 & 0x40 && v23 < 0 )
            {
              LODWORD(v51) = v23;
              BYTE1(v56) |= 1u;
              HIDWORD(v51) = (unsigned __int64)-v23 >> 32;
            }
            else
            {
              v51 = v23;
            }
            if ( !(BYTE1(v56) & 0x80) )
              HIDWORD(v51) = 0;
            if ( v55 >= 0 )
            {
              v56 &= 0xFFFFFFF7;
              if ( v55 > 512 )
                v55 = 512;
            }
            else
            {
              v55 = 1;
            }
            if ( !v51 )
              v50 = 0;
            v54 = &v35;
            while ( 1 )
            {
              v24 = v55--;
              if ( v24 <= 0 && !v51 )
                break;
              v25 = v51 % j + 48;
              v51 /= (unsigned __int64)j;
              if ( v25 > 57 )
                LOBYTE(v25) = v43 + v25;
              v26 = v54--;
              *v26 = v25;
            }
            v27 = &v35 - v54++;
            j = v27;
            if ( BYTE1(v56) & 2 && (*v54 != 48 || !v27) )
            {
              --v54;
              v18 = v27 + 1;
              *v54 = 48;
LABEL_151:
              j = v18;
              goto LABEL_152;
            }
            goto LABEL_152;
          }
          if ( (signed int)v5 >= 101 )
            goto LABEL_63;
          if ( (signed int)v5 > 88 )
          {
            if ( v5 == 90 )
            {
              v15 = get_int_arg_0(&a3);
              if ( v15 && (v16 = *(char **)(v15 + 4)) != 0 )
              {
                if ( BYTE1(v56) & 8 )
                {
                  v17 = (unsigned int)*(_WORD *)v15 >> 1;
                  v54 = v16;
                  j = v17;
                  v49 = 1;
                  goto LABEL_152;
                }
                v49 = 0;
                v54 = v16;
                v18 = *(_WORD *)v15;
              }
              else
              {
                v54 = __nullstring;
                v18 = strlen(__nullstring);
              }
              goto LABEL_151;
            }
            if ( v5 == 99 )
              goto LABEL_67;
            if ( v5 != 100 )
              goto LABEL_152;
LABEL_117:
            v56 |= 0x40u;
LABEL_118:
            j = 10;
            goto LABEL_119;
          }
          if ( v5 == 88 )
            goto LABEL_108;
          if ( v5 == 67 )
          {
            if ( !(v56 & 0x830) )
              v56 |= 0x20u;
LABEL_67:
            v49 = 1;
            v14 = get_int_arg_0(&a3);
            *(_DWORD *)WCh = v14;
            if ( v56 & 0x20 )
            {
              v46 = 0;
              SrcCh = v14;
              if ( mbtowc(&DstCh, &SrcCh, __mb_cur_max) < 0 )
                v42 = 1;
            }
            else
            {
              DstCh = v14;
            }
            j = 1;
            v54 = (char *)&DstCh;
            goto LABEL_152;
          }
          if ( v5 == 69 || v5 == 71 )
          {
            v41 = 1;
            v5 += 32;
LABEL_63:
            v56 |= 0x40u;
            v13 = &DstCh;
            v54 = (char *)&DstCh;
            if ( v55 >= 0 )
            {
              if ( v55 )
              {
                if ( v55 > 512 )
                  v55 = 512;
                if ( v55 > 163 )
                {
                  v19 = malloc(v55 + 349);
                  Memory = v19;
                  if ( v19 )
                  {
                    v13 = (wchar_t *)v19;
                    v54 = (char *)v19;
                  }
                  else
                  {
                    v55 = 163;
                  }
                }
              }
              else if ( v5 == 103 )
              {
                v55 = 1;
              }
            }
            else
            {
              v55 = 6;
            }
            a3 += 8;
            v36 = *(_DWORD *)(a3 - 8);
            v37 = *(_DWORD *)(a3 - 4);
            _cfltcvt_tab(&v36, v13, (char)v5, v55, v41);
          }
          if ( v5 == 83 )
          {
            if ( !(v56 & 0x830) )
              v56 |= 0x20u;
LABEL_51:
            v10 = 0x7FFFFFFF;
            if ( v55 != -1 )
              v10 = v55;
            v11 = (char *)get_int_arg_0(&a3);
            v12 = v11;
            v54 = v11;
            if ( !(v56 & 0x20) )
            {
              if ( !v11 )
              {
                v12 = (char *)__wnullstring;
                v54 = (char *)__wnullstring;
              }
              v49 = 1;
              for ( i = v12; ; i += 2 )
              {
                v21 = v10--;
                if ( !v21 || !*(_WORD *)i )
                  break;
              }
              v18 = (i - v12) >> 1;
              goto LABEL_151;
            }
            if ( !v11 )
            {
              v12 = __nullstring;
              v54 = __nullstring;
            }
            for ( j = 0; j < v10; ++j )
            {
              if ( !*v12 )
                break;
              if ( HIBYTE(_pctype[(unsigned __int8)*v12]) & 0x80 )
                ++v12;
              ++v12;
            }
          }
LABEL_152:
          if ( v42 )
            goto LABEL_175;
          v28 = v56;
          if ( !(v56 & 0x40) )
            goto LABEL_161;
          if ( BYTE1(v56) & 1 )
          {
            LOWORD(v48) = 45;
LABEL_160:
            v50 = 1;
            goto LABEL_161;
          }
          if ( v56 & 1 )
          {
            LOWORD(v48) = 43;
            goto LABEL_160;
          }
          if ( v56 & 2 )
          {
            LOWORD(v48) = 32;
            goto LABEL_160;
          }
LABEL_161:
          v29 = v47 - v50 - j;
          if ( !(v56 & 0xC) )
            write_multi_char_0(0x20u, v47 - v50 - j, MbCh, (int)&v52);
          write_string_0((int)&v48, v50, MbCh, (int)&v52);
          if ( v28 & 8 && !(v28 & 4) )
            write_multi_char_0(0x30u, v29, MbCh, (int)&v52);
          if ( v49 || j <= 0 )
          {
            write_string_0((int)v54, j, MbCh, (int)&v52);
          }
          else
          {
            v30 = v54;
            v31 = j - 1;
            do
            {
              v38 = mbtowc(WCh, v30, __mb_cur_max);
              if ( v38 <= 0 )
                break;
              write_char_0(WCh[0], MbCh, (int)&v52);
              v30 += v38;
              v32 = v31--;
            }
            while ( v32 > 0 );
          }
          if ( v56 & 4 )
            write_multi_char_0(0x20u, v29, MbCh, (int)&v52);
LABEL_175:
          if ( Memory )
          {
            free(Memory);
            Memory = 0;
          }
LABEL_177:
          v5 = *(_WORD *)v57;
          v57 += 2;
          if ( !v5 )
            return v52;
          v4 = v40;
          break;
        default:
          goto LABEL_177;
      }
    }
  }
  return v52;
}
// 435673: using guessed type _DWORD __cdecl get_int_arg_0(_DWORD);
// 435680: using guessed type _DWORD __cdecl get_int64_arg_0(_DWORD);
// 49C75C: using guessed type wchar_t *__wnullstring;
// 49E980: using guessed type int (__cdecl *_cfltcvt_tab)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00435E4E) --------------------------------------------------------
int *__cdecl _NMSG_WRITE(unsigned int NumberOfBytesWritten)
{
  int v1; // ecx@1
  int *result; // eax@1
  int v3; // esi@4
  char *v4; // edi@11
  const char **v5; // esi@14
  HANDLE v6; // eax@14
  char *v7; // [sp-28h] [bp-1CCh]@13
  const char *v8; // [sp-24h] [bp-1C8h]@13
  char *v9; // [sp-18h] [bp-1BCh]@13
  const char *v10; // [sp-14h] [bp-1B8h]@13
  DWORD v11; // [sp-10h] [bp-1B4h]@14
  unsigned int *v12; // [sp-Ch] [bp-1B0h]@14
  int v13; // [sp-8h] [bp-1ACh]@14
  char Filename; // [sp+0h] [bp-1A4h]@9
  char Dest; // [sp+104h] [bp-A0h]@13
  int savedregs; // [sp+1A4h] [bp+0h]@12

  v1 = 0;
  result = dword_49ED38;
  do
  {
    if ( NumberOfBytesWritten == *result )
      break;
    result += 2;
    ++v1;
  }
  while ( result < (int *)_iob );
  v3 = 8 * v1;
  if ( NumberOfBytesWritten == dword_49ED38[2 * v1] )
  {
    result = (int *)__error_mode;
    if ( __error_mode != 1 && (__error_mode || __app_type != 1) )
    {
      if ( NumberOfBytesWritten != 252 )
      {
        if ( !GetModuleFileNameA(0, &Filename, 0x104u) )
          strcpy(&Filename, "<program name unknown>");
        v4 = &Filename;
        if ( strlen(&Filename) + 1 > 0x3C )
        {
          v4 = (char *)&savedregs + strlen(&Filename) - 479;
          strncpy(v4, "...", 3u);
        }
        strcpy(&Dest, "Runtime Error!\n\nProgram: ");
        v10 = v4;
        v9 = &Dest;
        strcat(&Dest, v4);
        strcat(&Dest, "\n\n");
        v8 = *(const char **)&off_49ED3C[v3];
        v7 = &Dest;
        strcat(&Dest, v8);
        result = (int *)__crtMessageBoxA(&Dest, "Microsoft Visual C++ Runtime Library", 73744);
      }
    }
    else
    {
      v5 = (const char **)&off_49ED3C[v3];
      v13 = 0;
      v12 = &NumberOfBytesWritten;
      v11 = strlen(*v5);
      v10 = *v5;
      v6 = GetStdHandle(0xFFFFFFF4);
      result = (int *)WriteFile(v6, v10, v11, &NumberOfBytesWritten, 0);
    }
  }
  return result;
}
// 43A8A5: using guessed type _DWORD __cdecl __crtMessageBoxA(_DWORD, _DWORD, _DWORD);
// 49C684: using guessed type int __app_type;
// 49ED38: using guessed type int dword_49ED38[];
// 4A60F0: using guessed type int __error_mode;

//----- (00435FA1) --------------------------------------------------------
int __cdecl _GET_RTERRMSG(int a1)
{
  int v1; // edx@1
  int *v2; // eax@1
  int result; // eax@5

  v1 = 0;
  v2 = dword_49ED38;
  do
  {
    if ( a1 == *v2 )
      break;
    v2 += 2;
    ++v1;
  }
  while ( v2 < (int *)_iob );
  if ( a1 == dword_49ED38[2 * v1] )
    result = off_49ED3C[2 * v1];
  else
    result = 0;
  return result;
}
// 49ED38: using guessed type int dword_49ED38[];

//----- (00437B42) --------------------------------------------------------
int __cdecl _ValidateRead(const void *lp, UINT_PTR ucb)
{
  signed int v2; // esi@1

  v2 = 1;
  if ( IsBadReadPtr(lp, ucb) )
    v2 = 0;
  return v2;
}

//----- (00437B5E) --------------------------------------------------------
int __cdecl _ValidateWrite(void *lp, UINT_PTR ucb)
{
  signed int v2; // esi@1

  v2 = 1;
  if ( IsBadWritePtr(lp, ucb) )
    v2 = 0;
  return v2;
}

//----- (004387CD) --------------------------------------------------------
int __cdecl _ld12tod(int a1, int a2)
{
  return _ld12cvt(a1, a2, &unk_49F110);
}
// 438661: using guessed type _DWORD __cdecl _ld12cvt(_DWORD, _DWORD, _DWORD);

//----- (004387E3) --------------------------------------------------------
int __cdecl _ld12tof(int a1, int a2)
{
  return _ld12cvt(a1, a2, &unk_49F128);
}
// 438661: using guessed type _DWORD __cdecl _ld12cvt(_DWORD, _DWORD, _DWORD);

//----- (0043947A) --------------------------------------------------------
signed int __init_ctype()
{
  signed int v0; // ebx@1
  void *v1; // eax@4
  void *v2; // edi@4
  const unsigned __int16 *v3; // eax@4
  signed int v4; // eax@8
  char *v5; // eax@14
  int i; // edx@15
  int v7; // ecx@16
  LPCWSTR v8; // ecx@21
  signed int v9; // eax@21
  const wctype_t *v10; // edi@23
  char *v11; // eax@26
  signed int v12; // esi@28
  char *v13; // ecx@29
  signed int result; // eax@37
  struct _cpinfo CPInfo; // [sp+4h] [bp-24h]@10
  void *v16; // [sp+18h] [bp-10h]@4
  void *v17; // [sp+1Ch] [bp-Ch]@4
  LPCWSTR lpSrcStr; // [sp+20h] [bp-8h]@1
  void *Memory; // [sp+24h] [bp-4h]@1

  v0 = 0;
  Memory = 0;
  lpSrcStr = 0;
  if ( dword_4A61E0 )
  {
    if ( !__lc_codepage && __getlocaleinfo(0, (unsigned __int16)word_4A641C, 0x1004u, (int)&__lc_codepage) )
      goto LABEL_42;
    v1 = malloc(0x202u);
    v2 = v1;
    v16 = v1;
    v17 = malloc(0x202u);
    Memory = malloc(0x101u);
    v3 = (const unsigned __int16 *)malloc(0x202u);
    lpSrcStr = v3;
    if ( !v2 )
      goto LABEL_42;
    if ( !v17 )
      goto LABEL_42;
    if ( !Memory )
      goto LABEL_42;
    if ( !v3 )
      goto LABEL_42;
    v4 = 0;
    do
    {
      *((_BYTE *)Memory + v4) = v4;
      ++v4;
    }
    while ( v4 < 256 );
    if ( !GetCPInfo(__lc_codepage, &CPInfo) || CPInfo.MaxCharSize > 2 )
      goto LABEL_42;
    __mb_cur_max = LOWORD(CPInfo.MaxCharSize);
    if ( (signed int)LOWORD(CPInfo.MaxCharSize) > 1 && CPInfo.LeadByte[0] )
    {
      v5 = &CPInfo.LeadByte[1];
      do
      {
        LOBYTE(i) = *v5;
        if ( !*v5 )
          break;
        v7 = (unsigned __int8)*(v5 - 1);
        for ( i = (unsigned __int8)i; v7 <= i; i = (unsigned __int8)*v5 )
          *((_BYTE *)Memory + v7++) = 0;
        v5 += 2;
      }
      while ( *(v5 - 1) );
    }
    if ( !__crtGetStringTypeA(1u, (LPCSTR)Memory, 256, (LPWORD)v2 + 1, 0, 0, 0) )
      goto LABEL_42;
    v8 = lpSrcStr;
    *(_WORD *)v2 = 0;
    v9 = 0;
    do
    {
      *v8 = v9;
      ++v8;
      ++v9;
    }
    while ( v9 < 256 );
    v10 = (const wctype_t *)((char *)v17 + 2);
    if ( __crtGetStringTypeW(1u, lpSrcStr, 256, (LPWORD)v17 + 1, 0, 0) )
    {
      *(_WORD *)v17 = 0;
      if ( __mb_cur_max > 1 && CPInfo.LeadByte[0] )
      {
        v11 = &CPInfo.LeadByte[1];
        do
        {
          if ( !*v11 )
            break;
          v12 = (unsigned __int8)*(v11 - 1);
          if ( v12 <= (unsigned __int8)*v11 )
          {
            v13 = (char *)v16 + 2 * v12 + 2;
            do
            {
              *(_WORD *)v13 = -32768;
              ++v12;
              v13 += 2;
            }
            while ( v12 <= (unsigned __int8)*v11 );
          }
          v11 += 2;
        }
        while ( *(v11 - 1) );
      }
      _pwctype = v10;
      _pctype = (const unsigned __int16 *)((char *)v16 + 2);
      if ( dword_4A6408 )
        free(dword_4A6408);
      dword_4A6408 = v16;
      if ( dword_4A640C )
        free(dword_4A640C);
      dword_4A640C = v17;
    }
    else
    {
LABEL_42:
      free(v16);
      free(v17);
      v0 = 1;
    }
    free(Memory);
    free((void *)lpSrcStr);
    result = v0;
  }
  else
  {
    _pctype = (const unsigned __int16 *)word_49EB02;
    _pwctype = (const wctype_t *)word_49EB02;
    free(dword_4A6408);
    free(dword_4A640C);
    dword_4A6408 = 0;
    dword_4A640C = 0;
    result = 0;
  }
  return result;
}
// 49EB02: using guessed type __int16 word_49EB02[];
// 4A641C: using guessed type __int16 word_4A641C;

//----- (004396BF) --------------------------------------------------------
int __init_collate()
{
  return 0;
}

//----- (00439DFA) --------------------------------------------------------
signed int __cdecl sub_439DFA(__int16 a1)
{
  char **v1; // eax@1

  v1 = (char **)&__rglangidNotDefault;
  while ( a1 != *(_WORD *)v1 )
  {
    v1 = (char **)((char *)v1 + 2);
    if ( v1 >= &__rg_country )
      return 1;
  }
  return 0;
}
// 49F5F8: using guessed type char *__rg_country;

//----- (0043A393) --------------------------------------------------------
int __cdecl _ismbbkalnum(unsigned int a1)
{
  return sub_43A470(a1, 0, 1u);
}

//----- (0043A470) --------------------------------------------------------
signed int __cdecl sub_43A470(unsigned __int8 a1, int a2, unsigned __int8 a3)
{
  signed int result; // eax@3

  if ( a3 & (unsigned __int8)byte_4A66E1[a1]
    || (!a2 ? (result = 0) : (result = (unsigned __int16)(a2 & word_49EB02[a1])), result) )
  {
    result = 1;
  }
  return result;
}
// 49EB02: using guessed type __int16 word_49EB02[];

//----- (0043B8C8) --------------------------------------------------------
int __fpecode()
{
  return _getptd() + 88;
}
// 431441: using guessed type int _getptd(void);

//----- (0043C6CF) --------------------------------------------------------
size_t __cdecl _Strftime(char *a1, size_t a2, const char *a3, const struct tm *a4, void *a5)
{
  void *v5; // eax@4
  const char *v6; // esi@7
  char v7; // al@8
  char *v8; // esi@14
  size_t result; // eax@22
  signed int v10; // [sp+Ch] [bp-8h]@2
  size_t v11; // [sp+10h] [bp-4h]@1

  v11 = a2;
  InterlockedIncrement(&__unguarded_readlc_active);
  if ( __setlc_active )
  {
    InterlockedDecrement(&__unguarded_readlc_active);
    _lock(19);
    v10 = 1;
  }
  else
  {
    v10 = 0;
  }
  v5 = a5;
  if ( !a5 )
    v5 = __lc_time_curr;
  a5 = v5;
  if ( v11 > 0 )
  {
    v6 = a3;
    do
    {
      v7 = *v6;
      if ( !*v6 )
        break;
      if ( v7 == 37 )
      {
        __alternate_form = 0;
        v8 = (char *)(v6 + 1);
        if ( *v8 == 35 )
        {
          __alternate_form = 1;
          ++v8;
        }
        _expandtime(*v8, a4, &a1, &v11, a5);
        v6 = v8 + 1;
      }
      else
      {
        if ( HIBYTE(_pctype[(unsigned __int8)v7]) & 0x80 && v11 > 1 )
        {
          *a1++ = v7;
          ++v6;
          --v11;
        }
        *a1++ = *v6++;
        --v11;
      }
    }
    while ( v11 );
  }
  if ( v10 )
    _unlock(19);
  else
    InterlockedDecrement(&__unguarded_readlc_active);
  if ( v11 )
  {
    *a1 = 0;
    result = a2 - v11;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 430ACB: using guessed type _DWORD __cdecl _lock(_DWORD);
// 430B2C: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 43C7C9: using guessed type _DWORD __cdecl _expandtime(char, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A65B4: using guessed type int __alternate_form;
// 4A7924: using guessed type int __setlc_active;

//----- (0043CC97) --------------------------------------------------------
void __cdecl sub_43CC97(char *Str1, int a2, int a3, int a4, int a5)
{
  char *v5; // ebx@1
  _DWORD *v6; // edi@2
  _DWORD *v7; // esi@2
  int v8; // ecx@3
  _BYTE *v9; // eax@5
  int v10; // ebx@32
  char v11; // al@39
  unsigned __int8 *v12; // eax@66
  unsigned __int8 v13; // cl@75
  char Str1_3; // [sp+1Bh] [bp+Bh]@4
  int v15; // [sp+20h] [bp+10h]@4
  int v16; // [sp+20h] [bp+10h]@6
  char v17; // [sp+24h] [bp+14h]@22

  v5 = Str1;
  if ( *Str1 )
  {
    v6 = (_DWORD *)a4;
    v7 = (_DWORD *)a3;
    do
    {
      v8 = 0;
      if ( !*v6 )
        return;
      __no_lead_zeros = 0;
      Str1_3 = *v5;
      v15 = (int)(v5 + 1);
      do
      {
        v9 = (_BYTE *)v15;
        ++v8;
        ++v15;
      }
      while ( *v9 == Str1_3 );
      v16 = v15 - 1;
      if ( Str1_3 > 100 )
      {
        switch ( Str1_3 )
        {
          case 104:
            if ( v8 == 1 )
            {
              __no_lead_zeros = 1;
            }
            else if ( v8 != 2 )
            {
LABEL_13:
              if ( HIBYTE(_pctype[(unsigned __int8)Str1_3]) & 0x80 )
              {
                ++v5;
                *(_BYTE *)(*v7)++ = Str1_3;
                --*v6;
              }
              *(_BYTE *)(*v7)++ = *v5++;
              --*v6;
              continue;
            }
            v17 = 73;
            break;
          case 109:
            if ( v8 == 1 )
            {
              __no_lead_zeros = 1;
            }
            else if ( v8 != 2 )
            {
              goto LABEL_13;
            }
            v17 = 77;
            break;
          case 115:
            if ( v8 == 1 )
            {
              __no_lead_zeros = 1;
            }
            else if ( v8 != 2 )
            {
              goto LABEL_13;
            }
            v17 = 83;
            break;
          default:
            if ( Str1_3 == 116 )
            {
              if ( *(_DWORD *)(a2 + 8) > 11 )
                v12 = *(unsigned __int8 **)(a5 + 156);
              else
                v12 = *(unsigned __int8 **)(a5 + 152);
              if ( v8 == 1 && *v6 )
              {
                if ( HIBYTE(_pctype[*v12]) & 0x80 && *v6 > 1u )
                {
                  *(_BYTE *)(*v7)++ = *v12++;
                  --*v6;
                }
                *(_BYTE *)(*v7)++ = *v12;
                --*v6;
              }
              else
              {
                while ( 1 )
                {
                  v13 = *v12;
                  if ( !*v12 || !*v6 )
                    break;
                  if ( HIBYTE(_pctype[v13]) & 0x80 && *v6 > 1u )
                  {
                    *(_BYTE *)(*v7)++ = v13;
                    ++v12;
                    --*v6;
                  }
                  *(_BYTE *)(*v7)++ = *v12++;
                  --*v6;
                }
              }
              goto LABEL_74;
            }
            if ( Str1_3 != 121 )
              goto LABEL_13;
            if ( v8 == 2 )
            {
              v17 = 121;
            }
            else
            {
              if ( v8 != 4 )
                goto LABEL_13;
              v17 = 89;
            }
            break;
        }
      }
      else if ( Str1_3 == 100 )
      {
        if ( v8 == 1 )
        {
          __no_lead_zeros = 1;
        }
        else if ( v8 != 2 )
        {
          if ( v8 == 3 )
          {
            v17 = 97;
          }
          else
          {
            if ( v8 != 4 )
              goto LABEL_13;
            v17 = 65;
          }
          goto LABEL_96;
        }
        v17 = 100;
      }
      else
      {
        if ( Str1_3 == 39 )
        {
          if ( v8 & 1 )
          {
            v5 += v8;
            while ( 1 )
            {
              v11 = *v5;
              if ( !*v5 || !*v6 )
                break;
              if ( v11 == 39 )
              {
                ++v5;
                goto LABEL_16;
              }
              if ( HIBYTE(_pctype[(unsigned __int8)v11]) & 0x80 && *v6 > 1u )
              {
                *(_BYTE *)(*v7)++ = v11;
                ++v5;
                --*v6;
              }
              *(_BYTE *)(*v7)++ = *v5++;
              --*v6;
            }
          }
          else
          {
            v5 += v8;
          }
          continue;
        }
        if ( Str1_3 == 65 )
          goto LABEL_31;
        if ( Str1_3 == 72 )
        {
          if ( v8 == 1 )
          {
            __no_lead_zeros = 1;
          }
          else if ( v8 != 2 )
          {
            goto LABEL_13;
          }
          v17 = 72;
          goto LABEL_96;
        }
        if ( Str1_3 != 77 )
        {
          if ( Str1_3 != 97 )
            goto LABEL_13;
LABEL_31:
          if ( !_strcmpi(v5, "am/pm") )
          {
            v10 = (int)(v5 + 5);
            goto LABEL_35;
          }
          if ( !_strcmpi(v5, "a/p") )
          {
            v10 = (int)(v5 + 3);
LABEL_35:
            v16 = v10;
          }
          v17 = 112;
          goto LABEL_96;
        }
        if ( v8 == 1 )
        {
          __no_lead_zeros = 1;
        }
        else if ( v8 != 2 )
        {
          if ( v8 == 3 )
          {
            v17 = 98;
          }
          else
          {
            if ( v8 != 4 )
              goto LABEL_13;
            v17 = 66;
          }
          goto LABEL_96;
        }
        v17 = 109;
      }
LABEL_96:
      _expandtime(v17, a2, v7, v6, a5);
LABEL_74:
      v5 = (char *)v16;
LABEL_16:
      ;
    }
    while ( *v5 );
  }
}
// 43C7C9: using guessed type _DWORD __cdecl _expandtime(char, _DWORD, _DWORD, _DWORD, _DWORD);
// 4A65B8: using guessed type int __no_lead_zeros;

//----- (0043E6D8) --------------------------------------------------------
void __usercall _L111766(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  TSingleton<CAdminAcceptor>::~TSingleton<CAdminAcceptor>();
}

//----- (0043E6F0) --------------------------------------------------------
void __usercall _L111840(int a1@<ebp>)
{
  ZSocketAcceptor<CAdminSocket>::~ZSocketAcceptor<CAdminSocket>(*(ZSocketAcceptor<CAdminSocket> **)(a1 - 16));
}

//----- (0043E6F8) --------------------------------------------------------
void __usercall _L111841(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 16 : 0;
  TSingleton<CAdminAcceptor>::~TSingleton<CAdminAcceptor>();
}

//----- (0043E70C) --------------------------------------------------------
void __usercall _L111842(int a1@<ebp>)
{
  ZPort::~ZPort((ZPort *)(*(_DWORD *)(a1 - 16) + 16));
}

//----- (0043E717) --------------------------------------------------------
void __usercall _L111843(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 76));
}

//----- (0043E722) --------------------------------------------------------
void __usercall _L111844(int a1@<ebp>)
{
  ZList<ZRef<CAdminSocket>>::~ZList<ZRef<CAdminSocket>>((ZList<ZRef<CAdminSocket> > *)(*(_DWORD *)(a1 - 16) + 100));
}

//----- (0043E738) --------------------------------------------------------
void __usercall _L112055(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043E74C) --------------------------------------------------------
void __usercall _L112161(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043E760) --------------------------------------------------------
void __usercall _L112202(int a1@<ebp>)
{
  ZRef<CAdminSocket>::~ZRef<CAdminSocket>((ZRef<CAdminSocket> *)(a1 - 28));
}

//----- (0043E768) --------------------------------------------------------
void __usercall _L112203(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 36));
}

//----- (0043E770) --------------------------------------------------------
void __usercall _L112204(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 16));
}

//----- (0043E778) --------------------------------------------------------
void __usercall _L112205(int a1@<ebp>)
{
  ZRef<CAdminSocket>::~ZRef<CAdminSocket>((ZRef<CAdminSocket> *)(a1 - 44));
}

//----- (0043E78C) --------------------------------------------------------
void __usercall _L112675(int a1@<ebp>)
{
  ZSocketBase::~ZSocketBase((ZSocketBase *)(*(_DWORD *)(a1 - 16) + 8));
}

//----- (0043E797) --------------------------------------------------------
void __usercall _L112676(int a1@<ebp>)
{
  ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>::~ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped>((ZArray<ZSocketAcceptor<CAdminSocket>::ZAcceptOverlapped> *)(*(_DWORD *)(a1 - 16) + 12));
}

//----- (0043E7AC) --------------------------------------------------------
void __usercall _L113428(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (0043E800) --------------------------------------------------------
void __usercall _L114569(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043E8C8) --------------------------------------------------------
void __usercall _L115765(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (0043E8F0) --------------------------------------------------------
void __usercall _L116109(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (0043E8F8) --------------------------------------------------------
void __usercall _L116110(int a1@<ebp>)
{
  ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>::~ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket>>,16,ZRef<CAdminSocket>>((ZRecyclable<ZRefCountedDummy<ZRef<CAdminSocket> >,16,ZRef<CAdminSocket> > *)(*(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 12 : 0));
}

//----- (0043E918) --------------------------------------------------------
void __usercall _L116189(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043E92C) --------------------------------------------------------
void __usercall _L116313(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 16));
}

//----- (0043E937) --------------------------------------------------------
void __usercall _L116314(int a1@<ebp>)
{
  ZList<ZPort::ZPortThread *> *v1; // ecx@1

  v1 = (ZList<ZPort::ZPortThread *> *)(*(_DWORD *)(a1 - 16) + 40);
  v1->vfptr = (ZList<ZPort::ZPortThread *>Vtbl *)&ZList<ZPort::ZPortThread *>::`vftable';
  ZList<ZPort::ZPortThread *>::RemoveAll(v1);
}
// 4433B0: using guessed type int (__thiscall *ZList<ZPort::ZPortThread *>::`vftable')(void *p, unsigned int __flags);

//----- (0043E960) --------------------------------------------------------
void __usercall _L116675(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (0043E968) --------------------------------------------------------
void __usercall _L116676(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(*(_DWORD *)(a1 - 16) + 20));
}

//----- (0043E980) --------------------------------------------------------
void __usercall _L116941(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (0043E988) --------------------------------------------------------
void __usercall _L116942(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(*(_DWORD *)(a1 - 16) + 20));
}

//----- (0043E9A0) --------------------------------------------------------
void __usercall _L117082(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 20));
}

//----- (0043E9C8) --------------------------------------------------------
void __usercall _L117394(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043E9DC) --------------------------------------------------------
void __usercall _L117539(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043E9F0) --------------------------------------------------------
void __usercall _L118013(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 20));
}

//----- (0043EA04) --------------------------------------------------------
void __usercall _L118078(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043EA18) --------------------------------------------------------
void __usercall _L118191(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043EA2C) --------------------------------------------------------
void __usercall _L114348(int a1@<ebp>)
{
  ZSocketEx::~ZSocketEx(*(ZSocketEx **)(a1 - 16));
}

//----- (0043EA34) --------------------------------------------------------
void __usercall _L114349(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 288));
}

//----- (0043EA42) --------------------------------------------------------
void __usercall _L114350(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 316));
}

//----- (0043EA5C) --------------------------------------------------------
void __usercall _L114619(int a1@<ebp>)
{
  ZSocketEx::~ZSocketEx(*(ZSocketEx **)(a1 - 16));
}

//----- (0043EA64) --------------------------------------------------------
void __usercall _L114620(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 288));
}

//----- (0043EA72) --------------------------------------------------------
void __usercall _L114621(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 316));
}

//----- (0043EA80) --------------------------------------------------------
void __usercall _L114622(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 340));
}

//----- (0043EA98) --------------------------------------------------------
void __usercall _L114728(int a1@<ebp>)
{
  ZArray<unsigned char>::RemoveAll((ZArray<unsigned char> *)(a1 - 28 + 4));
}

//----- (0043EAB4) --------------------------------------------------------
void __usercall _L114805(int a1@<ebp>)
{
  ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>((ZList<ZRef<ZSocketBuffer> > *)(a1 - 48));
}

//----- (0043EAC8) --------------------------------------------------------
void __usercall _L114958(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 40));
}

//----- (0043EADC) --------------------------------------------------------
void __usercall _L115137(int a1@<ebp>)
{
  CInPacket::AUTO_CLEAR::~AUTO_CLEAR((CInPacket::AUTO_CLEAR *)(a1 - 20));
}

//----- (0043EAF0) --------------------------------------------------------
void __usercall _L115223(int a1@<ebp>)
{
  ZRef<CAdminSocket>::~ZRef<CAdminSocket>((ZRef<CAdminSocket> *)(a1 - 20));
}

//----- (0043EB04) --------------------------------------------------------
void _L115346()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043EB18) --------------------------------------------------------
void _L115547()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043EB20) --------------------------------------------------------
void __usercall _L115548(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 24));
}

//----- (0043EB28) --------------------------------------------------------
void __usercall _L115549(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 32));
}

//----- (0043EB3C) --------------------------------------------------------
void __usercall _L115916(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 28));
}

//----- (0043EB44) --------------------------------------------------------
void __usercall _L115917(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 20));
}

//----- (0043EB4C) --------------------------------------------------------
void __usercall _L115918(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 16) & 1 )
    ZRef<CClientSocket>::~ZRef<CClientSocket>(*(ZRef<CClientSocket> **)(a1 + 8));
}

//----- (0043ECB0) --------------------------------------------------------
void __usercall _L119043(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (0043ECB8) --------------------------------------------------------
void __usercall _L119044(int a1@<ebp>)
{
  ZSocketBase::~ZSocketBase((ZSocketBase *)(*(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 16 : 0));
}

//----- (0043ECCC) --------------------------------------------------------
void __usercall _L119045(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 36));
}

//----- (0043ECD7) --------------------------------------------------------
void __usercall _L119046(int a1@<ebp>)
{
  ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>((ZList<ZRef<ZSocketBuffer> > *)(*(_DWORD *)(a1 - 16) + 92));
}

//----- (0043ECE2) --------------------------------------------------------
void __usercall _L119047(int a1@<ebp>)
{
  ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>((ZList<ZRef<ZSocketBuffer> > *)(*(_DWORD *)(a1 - 16) + 112));
}

//----- (0043ECED) --------------------------------------------------------
void __usercall _L119048(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 140));
}

//----- (0043ECFB) --------------------------------------------------------
void __usercall _L119049(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(*(_DWORD *)(a1 - 16) + 196));
}

//----- (0043ED09) --------------------------------------------------------
void __usercall _L119050(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 240));
}

//----- (0043ED24) --------------------------------------------------------
void __usercall _L119343(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043ED4C) --------------------------------------------------------
void __usercall _L119825(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (0043ED54) --------------------------------------------------------
void __usercall _L119826(int a1@<ebp>)
{
  ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>::~ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer>>,16,ZRef<ZSocketBuffer>>((ZRecyclable<ZRefCountedDummy<ZRef<ZSocketBuffer> >,16,ZRef<ZSocketBuffer> > *)(*(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 12 : 0));
}

//----- (0043ED74) --------------------------------------------------------
void __usercall _L119912(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043ED88) --------------------------------------------------------
void __usercall _L120050(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043ED90) --------------------------------------------------------
void __usercall _L120051(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 24));
}

//----- (0043EDA4) --------------------------------------------------------
void __usercall _L121184(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 20));
}

//----- (0043EDAC) --------------------------------------------------------
void __usercall _L121185(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 28));
}

//----- (0043EDB4) --------------------------------------------------------
void __usercall _L121186(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 8));
}

//----- (0043EDBC) --------------------------------------------------------
void __usercall _L121187(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 20));
}

//----- (0043EDC4) --------------------------------------------------------
void __usercall _L121188(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 16));
}

//----- (0043EDCC) --------------------------------------------------------
void __usercall _L121189(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 28));
}

//----- (0043EDD4) --------------------------------------------------------
void __usercall _L121377(int a1@<ebp>)
{
  operator delete(*(void **)(a1 + 8));
}

//----- (0043EDDE) --------------------------------------------------------
void __usercall _L121190(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 8));
}

//----- (0043EDE6) --------------------------------------------------------
void __usercall _L121191(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 20));
}

//----- (0043EF78) --------------------------------------------------------
void __usercall _L115759(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>(*(ZCriticalSectionEx<4000> **)(a1 - 16));
}

//----- (0043EF80) --------------------------------------------------------
void __usercall _L115760(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 28));
}

//----- (0043EF8B) --------------------------------------------------------
void __usercall _L115761(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 52));
}

//----- (0043EFA0) --------------------------------------------------------
void __usercall _L115830(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>(*(ZCriticalSectionEx<4000> **)(a1 - 16));
}

//----- (0043EFA8) --------------------------------------------------------
void __usercall _L115831(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 28));
}

//----- (0043EFB3) --------------------------------------------------------
void __usercall _L115832(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 52));
}

//----- (0043EFBE) --------------------------------------------------------
void __usercall _L115833(int a1@<ebp>)
{
  ZInetAddr::~ZInetAddr((ZInetAddr *)(*(_DWORD *)(a1 - 16) + 68));
}

//----- (0043EFC9) --------------------------------------------------------
void __usercall _L115834(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 84));
}

//----- (0043EFD4) --------------------------------------------------------
void __usercall _L115835(int a1@<ebp>)
{
  ZArray<long>::~ZArray<long>((ZArray<long> *)(*(_DWORD *)(a1 - 16) + 92));
}

//----- (0043EFDF) --------------------------------------------------------
void __usercall _L115836(int a1@<ebp>)
{
  ZArray<int>::~ZArray<int>((ZArray<int> *)(*(_DWORD *)(a1 - 16) + 96));
}

//----- (0043EFF4) --------------------------------------------------------
void __usercall _L116012(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 + 16));
}

//----- (0043EFFC) --------------------------------------------------------
void __usercall _L116013(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (0043F004) --------------------------------------------------------
void __usercall _L116014(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 92));
}

//----- (0043F00C) --------------------------------------------------------
void __usercall _L116015(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 24));
}

//----- (0043F014) --------------------------------------------------------
void __usercall _L116016(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (0043F01C) --------------------------------------------------------
void __usercall _L116017(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 108));
}

//----- (0043F024) --------------------------------------------------------
void __usercall _L116018(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 28));
}

//----- (0043F02C) --------------------------------------------------------
void __usercall _L116019(int a1@<ebp>)
{
  ZInetAddr::~ZInetAddr((ZInetAddr *)(a1 - 76));
}

//----- (0043F034) --------------------------------------------------------
void __usercall _L116020(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (0043F03C) --------------------------------------------------------
void __usercall _L116021(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 108));
}

//----- (0043F044) --------------------------------------------------------
void __usercall _L116022(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (0043F04C) --------------------------------------------------------
void __usercall _L116023(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 108));
}

//----- (0043F054) --------------------------------------------------------
void __usercall _L116024(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (0043F05C) --------------------------------------------------------
void __usercall _L116025(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 108));
}

//----- (0043F064) --------------------------------------------------------
void __usercall _L116026(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (0043F06C) --------------------------------------------------------
void __usercall _L116027(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 108));
}

//----- (0043F074) --------------------------------------------------------
void __usercall _L116028(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (0043F07C) --------------------------------------------------------
void __usercall _L116029(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 108));
}

//----- (0043F084) --------------------------------------------------------
void __usercall _L116030(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 60));
}

//----- (0043F08C) --------------------------------------------------------
void __usercall _L116031(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (0043F094) --------------------------------------------------------
void __usercall _L116032(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 108));
}

//----- (0043F09C) --------------------------------------------------------
void __usercall _L116033(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 20));
}

//----- (0043F0A4) --------------------------------------------------------
void __usercall _L116034(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *)(a1 - 36));
}

//----- (0043F0AC) --------------------------------------------------------
void __usercall _L116035(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *)(a1 + 12));
}

//----- (0043F0B4) --------------------------------------------------------
void __usercall _L116036(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 + 8));
}

//----- (0043F0BC) --------------------------------------------------------
void __usercall _L116037(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 44));
}

//----- (0043F0C4) --------------------------------------------------------
void __usercall _L116038(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 92));
}

//----- (0043F0D8) --------------------------------------------------------
void __usercall _L116758(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043F100) --------------------------------------------------------
void __usercall _L116880(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043F114) --------------------------------------------------------
void __usercall _L117029(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 20));
}

//----- (0043F11C) --------------------------------------------------------
void _L117030()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F130) --------------------------------------------------------
void _L117386()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F144) --------------------------------------------------------
void __usercall _L117564(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (0043F160) --------------------------------------------------------
void __usercall _L117626(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 20) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (0043F238) --------------------------------------------------------
void __usercall _L120123(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043F2EC) --------------------------------------------------------
void __usercall _L121129(int a1@<ebp>)
{
  _variant_t::~_variant_t((_variant_t *)(a1 - 28));
}

//----- (0043F300) --------------------------------------------------------
void __usercall _L121388(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 + 12));
}

//----- (0043F314) --------------------------------------------------------
void __usercall _L121563(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 28));
}

//----- (0043F328) --------------------------------------------------------
void __usercall _L115761_0(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 8));
}

//----- (0043F333) --------------------------------------------------------
void __usercall _L115762(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 32));
}

//----- (0043F33E) --------------------------------------------------------
void __usercall _L115763(int a1@<ebp>)
{
  ZSocket::~ZSocket((ZSocket *)(*(_DWORD *)(a1 - 16) + 44));
}

//----- (0043F349) --------------------------------------------------------
void __usercall _L115764(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 64));
}

//----- (0043F354) --------------------------------------------------------
void __usercall _L115765_0(int a1@<ebp>)
{
  ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>((ZList<ZRef<ZSocketBuffer> > *)(*(_DWORD *)(a1 - 16) + 88));
}

//----- (0043F35F) --------------------------------------------------------
void __usercall _L115766(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(*(_DWORD *)(a1 - 16) + 112));
}

//----- (0043F36A) --------------------------------------------------------
void __usercall _L115767(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 124));
}

//----- (0043F380) --------------------------------------------------------
void __usercall _L116003(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 8));
}

//----- (0043F38B) --------------------------------------------------------
void __usercall _L116004(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 32));
}

//----- (0043F396) --------------------------------------------------------
void __usercall _L116005(int a1@<ebp>)
{
  ZSocket::~ZSocket((ZSocket *)(*(_DWORD *)(a1 - 16) + 44));
}

//----- (0043F3A1) --------------------------------------------------------
void __usercall _L116006(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 64));
}

//----- (0043F3AC) --------------------------------------------------------
void __usercall _L116007(int a1@<ebp>)
{
  ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>((ZList<ZRef<ZSocketBuffer> > *)(*(_DWORD *)(a1 - 16) + 88));
}

//----- (0043F3B7) --------------------------------------------------------
void __usercall _L116008(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(*(_DWORD *)(a1 - 16) + 112));
}

//----- (0043F3CC) --------------------------------------------------------
void __usercall _L116323(int a1@<ebp>)
{
  operator delete(*(void **)(a1 - 44));
}

//----- (0043F3D6) --------------------------------------------------------
void __usercall _L116245(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 60));
}

//----- (0043F3DE) --------------------------------------------------------
void __usercall _L116246(int a1@<ebp>)
{
  CInPacket::AUTO_CLEAR::~AUTO_CLEAR((CInPacket::AUTO_CLEAR *)(a1 - 68));
}

//----- (0043F3FC) --------------------------------------------------------
void __usercall _L116562(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 44));
}

//----- (0043F404) --------------------------------------------------------
void __usercall _L116563(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 84));
}

//----- (0043F40C) --------------------------------------------------------
void __usercall _L116564(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 24));
}

//----- (0043F414) --------------------------------------------------------
void __usercall _L116565(int a1@<ebp>)
{
  ZInetAddr::~ZInetAddr((ZInetAddr *)(a1 - 60));
}

//----- (0043F424) --------------------------------------------------------
void __usercall _L116568(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 52));
}

//----- (0043F438) --------------------------------------------------------
void __usercall _L117225(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (0043F44C) --------------------------------------------------------
void __usercall _L117277(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (0043F460) --------------------------------------------------------
void __usercall _L117867(int a1@<ebp>)
{
  ZFixedArray<unsigned char,65536,0>::~ZFixedArray<unsigned char,65536,0>((ZFixedArray<unsigned char,65536,0> *)(a1 - 16));
}

//----- (0043F474) --------------------------------------------------------
void __usercall _L118918(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043F5C8) --------------------------------------------------------
void __usercall _L121523(int a1@<ebp>)
{
  ZSocketBase::~ZSocketBase((ZSocketBase *)(*(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 4 : 0));
}

//----- (0043F5DC) --------------------------------------------------------
void __usercall _L121524(int a1@<ebp>)
{
  ZIStream::~ZIStream(*(ZIStream **)(a1 - 16));
}

//----- (0043F5E4) --------------------------------------------------------
void __usercall _L121525(int a1@<ebp>)
{
  ZRef<ZSocketThread>::~ZRef<ZSocketThread>((ZRef<ZSocketThread> *)(*(_DWORD *)(a1 - 16) + 8));
}

//----- (0043F5FC) --------------------------------------------------------
void __usercall _L121841(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 8));
}

//----- (0043F624) --------------------------------------------------------
void __usercall _L122319(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043F64C) --------------------------------------------------------
void __usercall _L122827(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (0043F654) --------------------------------------------------------
void __usercall _L122828(int a1@<ebp>)
{
  ZThread *v1; // ecx@1

  v1 = (ZThread *)(*(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 12 : 0);
  v1->vfptr = (ZThreadVtbl *)&ZThread::`vftable';
  ZThread::CloseThread(v1);
}
// 4433EC: using guessed type int (__thiscall *ZThread::`vftable')(void *p, unsigned int __flags);

//----- (0043F668) --------------------------------------------------------
void __usercall _L122829(int a1@<ebp>)
{
  ZMap<void *,ZSocket *,void *> *v1; // ecx@1

  v1 = (ZMap<void *,ZSocket *,void *> *)(*(_DWORD *)(a1 - 16) + 24);
  v1->vfptr = (ZMap<void *,ZSocket *,void *>Vtbl *)&ZMap<void *,ZSocket *,void *>::`vftable';
  ZMap<void *,ZSocket *,void *>::RemoveAll(v1);
}
// 4435AC: using guessed type int (__thiscall *ZMap<void *,ZSocket *,void *>::`vftable')(void *p, unsigned int __flags);

//----- (0043F673) --------------------------------------------------------
void __usercall _L122830(int a1@<ebp>)
{
  ZArray<void *>::~ZArray<void *>((ZArray<void *> *)(*(_DWORD *)(a1 - 16) + 48));
}

//----- (0043F67E) --------------------------------------------------------
void __usercall _L122831(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 52));
}

//----- (0043F689) --------------------------------------------------------
void __usercall _L122832(int a1@<ebp>)
{
  ZList<ZSocketThread::REQ> *v1; // ecx@1

  v1 = (ZList<ZSocketThread::REQ> *)(*(_DWORD *)(a1 - 16) + 76);
  v1->vfptr = (ZList<ZSocketThread::REQ>Vtbl *)&ZList<ZSocketThread::REQ>::`vftable';
  ZList<ZSocketThread::REQ>::RemoveAll(v1);
}
// 4435A4: using guessed type int (__thiscall *ZList<ZSocketThread::REQ>::`vftable')(void *p, unsigned int __flags);

//----- (0043F6A0) --------------------------------------------------------
void __usercall _L123081(int a1@<ebp>)
{
  ZRef<ZSocketThread>::~ZRef<ZSocketThread>((ZRef<ZSocketThread> *)(a1 - 44));
}

//----- (0043F6A8) --------------------------------------------------------
void __usercall _L123082(int a1@<ebp>)
{
  ZRef<ZSocketThread>::~ZRef<ZSocketThread>((ZRef<ZSocketThread> *)(a1 - 36));
}

//----- (0043F6C8) --------------------------------------------------------
void __usercall _L123492(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043F6E8) --------------------------------------------------------
void __usercall _L124132(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043F6FC) --------------------------------------------------------
void __usercall _L124302(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (0043F724) --------------------------------------------------------
void __usercall _L124775(int a1@<ebp>)
{
  ZSocketEx::~ZSocketEx(*(ZSocketEx **)(a1 - 16));
}

//----- (0043F72C) --------------------------------------------------------
void __usercall _L124776(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 288));
}

//----- (0043F73A) --------------------------------------------------------
void __usercall _L124777(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 312));
}

//----- (0043F748) --------------------------------------------------------
void __usercall _L124778(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 336));
}

//----- (0043F756) --------------------------------------------------------
void __usercall _L124779(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 380));
}

//----- (0043F764) --------------------------------------------------------
void __usercall _L124780(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 404));
}

//----- (0043F772) --------------------------------------------------------
void __usercall _L124781(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 464));
}

//----- (0043F780) --------------------------------------------------------
void __usercall _L124782(int a1@<ebp>)
{
  ZMap<unsigned long,ZXString<char>,unsigned long>::~ZMap<unsigned long,ZXString<char>,unsigned long>((ZMap<unsigned long,ZXString<char>,unsigned long> *)(*(_DWORD *)(a1 - 16) + 468));
}

//----- (0043F78E) --------------------------------------------------------
void __usercall _L124783(int a1@<ebp>)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char>>::~ZMap<ZXString<char>,unsigned long,ZXString<char>>((ZMap<ZXString<char>,unsigned long,ZXString<char> > *)(*(_DWORD *)(a1 - 16) + 492));
}

//----- (0043F79C) --------------------------------------------------------
void __usercall _L124784(int a1@<ebp>)
{
  ZInetAddr::~ZInetAddr((ZInetAddr *)(*(_DWORD *)(a1 - 16) + 556));
}

//----- (0043F7AA) --------------------------------------------------------
void __usercall _L124785(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 572));
}

//----- (0043F7B8) --------------------------------------------------------
void __usercall _L124786(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F7C6) --------------------------------------------------------
void __usercall _L124787(int a1@<ebp>)
{
  ZRef<CMxHelperServerManager>::~ZRef<CMxHelperServerManager>((ZRef<CMxHelperServerManager> *)(*(_DWORD *)(a1 - 16) + 648));
}

//----- (0043F7E8) --------------------------------------------------------
void __usercall _L125128(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F800) --------------------------------------------------------
void __usercall _L125165(int a1@<ebp>)
{
  ZSocketEx::~ZSocketEx(*(ZSocketEx **)(a1 - 16));
}

//----- (0043F808) --------------------------------------------------------
void __usercall _L125166(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 288));
}

//----- (0043F816) --------------------------------------------------------
void __usercall _L125167(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 312));
}

//----- (0043F824) --------------------------------------------------------
void __usercall _L125168(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 336));
}

//----- (0043F832) --------------------------------------------------------
void __usercall _L125169(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 380));
}

//----- (0043F840) --------------------------------------------------------
void __usercall _L125170(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 404));
}

//----- (0043F84E) --------------------------------------------------------
void __usercall _L125171(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 464));
}

//----- (0043F85C) --------------------------------------------------------
void __usercall _L125172(int a1@<ebp>)
{
  ZMap<unsigned long,ZXString<char>,unsigned long>::~ZMap<unsigned long,ZXString<char>,unsigned long>((ZMap<unsigned long,ZXString<char>,unsigned long> *)(*(_DWORD *)(a1 - 16) + 468));
}

//----- (0043F86A) --------------------------------------------------------
void __usercall _L125173(int a1@<ebp>)
{
  ZMap<ZXString<char>,unsigned long,ZXString<char>>::~ZMap<ZXString<char>,unsigned long,ZXString<char>>((ZMap<ZXString<char>,unsigned long,ZXString<char> > *)(*(_DWORD *)(a1 - 16) + 492));
}

//----- (0043F878) --------------------------------------------------------
void __usercall _L125174(int a1@<ebp>)
{
  ZInetAddr::~ZInetAddr((ZInetAddr *)(*(_DWORD *)(a1 - 16) + 556));
}

//----- (0043F886) --------------------------------------------------------
void __usercall _L125175(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 572));
}

//----- (0043F894) --------------------------------------------------------
void __usercall _L125176(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F8A2) --------------------------------------------------------
void __usercall _L125177(int a1@<ebp>)
{
  ZRef<CMxHelperServerManager>::~ZRef<CMxHelperServerManager>((ZRef<CMxHelperServerManager> *)(*(_DWORD *)(a1 - 16) + 648));
}

//----- (0043F8BC) --------------------------------------------------------
void __usercall _L125420(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F8D4) --------------------------------------------------------
void _L125499()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F8F0) --------------------------------------------------------
void __usercall _L125553(int a1@<ebp>)
{
  ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>((ZList<ZRef<ZSocketBuffer> > *)(a1 - 48));
}

//----- (0043F904) --------------------------------------------------------
void __usercall _L125695(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043F918) --------------------------------------------------------
void _L125755()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F92C) --------------------------------------------------------
void _L126113()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F940) --------------------------------------------------------
void _L126371()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F948) --------------------------------------------------------
void __usercall _L126374(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043F950) --------------------------------------------------------
void _L126376()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F964) --------------------------------------------------------
void __usercall _L127045(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (0043F978) --------------------------------------------------------
void __usercall _L127246(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 40));
}

//----- (0043F980) --------------------------------------------------------
void __usercall _L127247(int a1@<ebp>)
{
  CInPacket::AUTO_CLEAR::~AUTO_CLEAR((CInPacket::AUTO_CLEAR *)(a1 - 48));
}

//----- (0043F988) --------------------------------------------------------
void __usercall _L127248(int a1@<ebp>)
{
  CInPacket::AUTO_CLEAR::~AUTO_CLEAR((CInPacket::AUTO_CLEAR *)(a1 - 48));
}

//----- (0043F99C) --------------------------------------------------------
void __usercall _L127613(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043F9A4) --------------------------------------------------------
void __usercall _L127614(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 24));
}

//----- (0043F9AC) --------------------------------------------------------
void __usercall _L127616(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (0043F9B4) --------------------------------------------------------
void _L127617()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F9BC) --------------------------------------------------------
void _L127619()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043F9C4) --------------------------------------------------------
void __usercall _L127620(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 88));
}

//----- (0043F9CC) --------------------------------------------------------
void __usercall _L127621(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 72));
}

//----- (0043F9D4) --------------------------------------------------------
void __usercall _L127622(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 36));
}

//----- (0043F9DC) --------------------------------------------------------
void __usercall _L127623(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 104));
}

//----- (0043F9E4) --------------------------------------------------------
void __usercall _L127624(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 32));
}

//----- (0043F9EC) --------------------------------------------------------
void __usercall _L127625(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 36));
}

//----- (0043F9F4) --------------------------------------------------------
void __usercall _L127626(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 120));
}

//----- (0043F9FC) --------------------------------------------------------
void _L127627()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FA10) --------------------------------------------------------
void _L128778()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FA24) --------------------------------------------------------
void __usercall _L129197(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FA2C) --------------------------------------------------------
void _L129198()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FA40) --------------------------------------------------------
void __usercall _L129669(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FA48) --------------------------------------------------------
void __usercall _L129670(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 28));
}

//----- (0043FA50) --------------------------------------------------------
void _L129671()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FA64) --------------------------------------------------------
void __usercall _L130261(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FA6C) --------------------------------------------------------
void _L130262()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FA80) --------------------------------------------------------
void __usercall _L130500(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (0043FA88) --------------------------------------------------------
void _L130501()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FA90) --------------------------------------------------------
void _L130503()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FAA4) --------------------------------------------------------
void _L131107()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FAAC) --------------------------------------------------------
void _L131108()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FAC0) --------------------------------------------------------
void _L131508()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FAD4) --------------------------------------------------------
void _L131777()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FADC) --------------------------------------------------------
void _L131778()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FAE4) --------------------------------------------------------
void __usercall _L131779(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FAF8) --------------------------------------------------------
void _L132129()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FB00) --------------------------------------------------------
void _L132130()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FB14) --------------------------------------------------------
void _L132505()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FB1C) --------------------------------------------------------
void _L132506()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FB30) --------------------------------------------------------
void _L132821()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FB38) --------------------------------------------------------
void _L132822()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FB40) --------------------------------------------------------
void __usercall _L132823(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FB48) --------------------------------------------------------
void __usercall _L132824(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FB5C) --------------------------------------------------------
void __usercall _L133129(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FB64) --------------------------------------------------------
void _L133130()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FB78) --------------------------------------------------------
void _L133281()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FB80) --------------------------------------------------------
void __usercall _L133282(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FB94) --------------------------------------------------------
void _L133490()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FBA8) --------------------------------------------------------
void _L133887()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FBBC) --------------------------------------------------------
void __usercall _L134088(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FBC4) --------------------------------------------------------
void _L134089()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FBD8) --------------------------------------------------------
void __usercall _L134315(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FBE0) --------------------------------------------------------
void _L134316()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FBF4) --------------------------------------------------------
void _L134481()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FC08) --------------------------------------------------------
void __usercall _L134754(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 72));
}

//----- (0043FC10) --------------------------------------------------------
void __usercall _L134755(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 56));
}

//----- (0043FC18) --------------------------------------------------------
void __usercall _L134756(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (0043FC20) --------------------------------------------------------
void __usercall _L134757(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 88));
}

//----- (0043FC28) --------------------------------------------------------
void __usercall _L134758(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 + 8));
}

//----- (0043FC30) --------------------------------------------------------
void __usercall _L134759(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (0043FC38) --------------------------------------------------------
void __usercall _L134760(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 104));
}

//----- (0043FC40) --------------------------------------------------------
void _L134761()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FC54) --------------------------------------------------------
void _L135000()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FC5C) --------------------------------------------------------
void _L135001()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FC64) --------------------------------------------------------
void _L135002()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FC6C) --------------------------------------------------------
void __usercall _L135003(int a1@<ebp>)
{
  ZArray<int>::~ZArray<int>((ZArray<int> *)(a1 - 24));
}

//----- (0043FC74) --------------------------------------------------------
void _L135004()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FC7C) --------------------------------------------------------
void _L135006()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FC84) --------------------------------------------------------
void _L135005()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FC98) --------------------------------------------------------
void _L135641()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (0043FCAC) --------------------------------------------------------
void __usercall _L135684(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 24));
}

//----- (0043FCB4) --------------------------------------------------------
void __usercall _L135685(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043FCC8) --------------------------------------------------------
void __usercall _L135834(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FCDC) --------------------------------------------------------
void __usercall _L135946(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 40));
}

//----- (0043FCE4) --------------------------------------------------------
void __usercall _L135947(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (0043FCF8) --------------------------------------------------------
void __usercall _L138332(int a1@<ebp>)
{
  ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::operator delete(*(void **)(a1 - 16));
}

//----- (0043FD02) --------------------------------------------------------
void __usercall _L138394(int a1@<ebp>)
{
  ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::~ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(*(ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> **)(a1 - 16));
}

//----- (0043FD14) --------------------------------------------------------
void __usercall _L138517(int a1@<ebp>)
{
  ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::operator delete(*(void **)(a1 - 24));
}

//----- (0043FD1E) --------------------------------------------------------
void __usercall _L138519(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 20) & 1 )
    ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0043FD35) --------------------------------------------------------
void __usercall _L138604(int a1@<ebp>)
{
  ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::~ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(*(ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> **)(a1 - 24));
}

//----- (0043FE60) --------------------------------------------------------
void __usercall _L143532(int a1@<ebp>)
{
  ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>::~ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR>(*(ZRecyclable<ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZXString<char>,unsigned long>::_PAIR> **)(a1 - 16));
}

//----- (0043FE74) --------------------------------------------------------
void __usercall _L143574(int a1@<ebp>)
{
  ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>::~ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char>>::_PAIR>(*(ZRecyclable<ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR,16,ZMap<ZXString<char>,unsigned long,ZXString<char> >::_PAIR> **)(a1 - 16));
}

//----- (0043FE88) --------------------------------------------------------
void __usercall _L143613(int a1@<ebp>)
{
  ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>::~ZRecyclable<ZMap<char const *,int,ZXString<char>>::_PAIR,16,ZMap<char const *,int,ZXString<char>>::_PAIR>(*(ZRecyclable<ZMap<char const *,int,ZXString<char> >::_PAIR,16,ZMap<char const *,int,ZXString<char> >::_PAIR> **)(a1 - 16));
}

//----- (0043FE9C) --------------------------------------------------------
void __usercall _L143797(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 + 12));
}

//----- (0043FEB0) --------------------------------------------------------
void __usercall _L144198(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043FEC4) --------------------------------------------------------
void __usercall _L144262(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0043FED8) --------------------------------------------------------
void __usercall _L144326(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0044007C) --------------------------------------------------------
void __usercall _L121430(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)(a1 - 24));
}

//----- (00440084) --------------------------------------------------------
void __usercall _L121431(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 16) & 1 )
    ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 + 8));
}

//----- (004400A8) --------------------------------------------------------
void __usercall _L121622(int a1@<ebp>)
{
  operator delete(*(void **)(a1 + 12));
}

//----- (004400B2) --------------------------------------------------------
void __usercall _L121621(int a1@<ebp>)
{
  operator delete(*(void **)(a1 + 12));
}

//----- (004400BC) --------------------------------------------------------
void __usercall _L121617(int a1@<ebp>)
{
  operator delete(*(void **)(a1 + 12));
}

//----- (004400D0) --------------------------------------------------------
void __usercall _L122261(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)(a1 - 24));
}

//----- (004400D8) --------------------------------------------------------
void __usercall _L122262(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 16) & 1 )
    ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 + 8));
}

//----- (00440104) --------------------------------------------------------
void __usercall _L122396(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 20) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (00440128) --------------------------------------------------------
void __usercall _L122751(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 24));
}

//----- (00440130) --------------------------------------------------------
void __usercall _L122752(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00440138) --------------------------------------------------------
void __usercall _L122753(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (00440140) --------------------------------------------------------
void __usercall _L122754(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 28) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (00440164) --------------------------------------------------------
void __usercall _L123747(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 24));
}

//----- (0044016C) --------------------------------------------------------
void __usercall _L123748(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00440174) --------------------------------------------------------
void __usercall _L123749(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (0044017C) --------------------------------------------------------
void __usercall _L123750(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 28) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (004401A8) --------------------------------------------------------
void __usercall _L124177(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (004401B0) --------------------------------------------------------
void __usercall _L124178(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 24) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (004401D4) --------------------------------------------------------
void __usercall _L125000(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)(a1 - 20));
}

//----- (004401E8) --------------------------------------------------------
void __usercall _L126052(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (004401F0) --------------------------------------------------------
void __usercall _L126053(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (004401F8) --------------------------------------------------------
void __usercall _L126054(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (00440214) --------------------------------------------------------
void __usercall _L126920(int a1@<ebp>)
{
  ZRef<GW_MiniGameRecord>::~ZRef<GW_MiniGameRecord>((ZRef<GW_MiniGameRecord> *)(a1 - 44));
}

//----- (00440228) --------------------------------------------------------
int __usercall _L128225@<eax>(int a1@<ebp>)
{
  return `eh vector destructor iterator'(
           (void *)(a1 - 108),
           4u,
           6,
           (void (__thiscall *)(void *))ZArray<CashItemEntry>::~ZArray<CashItemEntry>);
}

//----- (0044023B) --------------------------------------------------------
int __usercall _L128226@<eax>(int a1@<ebp>)
{
  return `eh vector destructor iterator'(
           (void *)(a1 - 84),
           4u,
           6,
           (void (__thiscall *)(void *))ZArray<CashItemEntry>::~ZArray<CashItemEntry>);
}

//----- (0044024E) --------------------------------------------------------
void __usercall _L128227(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 - 48));
}

//----- (00440256) --------------------------------------------------------
void __usercall _L128228(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 - 48));
}

//----- (0044025E) --------------------------------------------------------
void __usercall _L128229(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 - 48));
}

//----- (00440266) --------------------------------------------------------
void __usercall _L128230(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)(a1 - 40));
}

//----- (0044026E) --------------------------------------------------------
void __usercall _L128231(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 - 48));
}

//----- (00440276) --------------------------------------------------------
void __usercall _L128232(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)(a1 - 40));
}

//----- (0044027E) --------------------------------------------------------
void __usercall _L128233(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 - 48));
}

//----- (00440286) --------------------------------------------------------
void __usercall _L128234(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)(a1 - 24));
}

//----- (0044028E) --------------------------------------------------------
void __usercall _L128235(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 - 48));
}

//----- (00440296) --------------------------------------------------------
void __usercall _L128236(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)(a1 - 60));
}

//----- (0044029E) --------------------------------------------------------
void __usercall _L128237(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>(*(ZRef<GW_ItemSlotBase> **)(a1 - 48));
}

//----- (004402A6) --------------------------------------------------------
void __usercall _L128238(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (004402AE) --------------------------------------------------------
void __usercall _L128239(int a1@<ebp>)
{
  ZRef<GW_MiniGameRecord>::~ZRef<GW_MiniGameRecord>((ZRef<GW_MiniGameRecord> *)(a1 - 52));
}

//----- (004402B6) --------------------------------------------------------
void __usercall _L128240(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 48));
}

//----- (004402C8) --------------------------------------------------------
void __usercall _L130563(int a1@<ebp>)
{
  ZRef<GW_ItemSlotBase>::~ZRef<GW_ItemSlotBase>((ZRef<GW_ItemSlotBase> *)(a1 + 8));
}

//----- (004402E4) --------------------------------------------------------
void __usercall _L130759(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 20) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (00440308) --------------------------------------------------------
void __usercall _L130856(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0044031C) --------------------------------------------------------
void __usercall _L132152(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00440330) --------------------------------------------------------
void __usercall _L133437(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 16) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (00440347) --------------------------------------------------------
void __usercall _L133440(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 16));
}

//----- (00440410) --------------------------------------------------------
void __usercall _L136178(int a1@<ebp>)
{
  ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>::~ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR>(*(ZRecyclable<ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR,16,ZMap<long,ZRef<GW_MiniGameRecord>,long>::_PAIR> **)(a1 - 16));
}

//----- (00440424) --------------------------------------------------------
void __usercall _L136262(int a1@<ebp>)
{
  ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>::~ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR>(*(ZRecyclable<ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR,16,ZMap<unsigned short,ZXString<char>,unsigned short>::_PAIR> **)(a1 - 16));
}

//----- (00440438) --------------------------------------------------------
void __usercall _L137029(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0044044C) --------------------------------------------------------
void __usercall _L137093(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (00440460) --------------------------------------------------------
void __usercall _L137157(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (00440474) --------------------------------------------------------
void __usercall _L137221(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (00440488) --------------------------------------------------------
void __usercall _L137285(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0044049C) --------------------------------------------------------
void __usercall _L137349(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004405B4) --------------------------------------------------------
void __usercall _L138979(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004405C8) --------------------------------------------------------
void __usercall _L139043(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004405DC) --------------------------------------------------------
void __usercall _L139107(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004405F0) --------------------------------------------------------
void __usercall _L110150(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 20));
}

//----- (004405F8) --------------------------------------------------------
void __usercall _L110151(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 96));
}

//----- (00440600) --------------------------------------------------------
void __usercall _L110152(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 80));
}

//----- (00440608) --------------------------------------------------------
void __usercall _L110153_0(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 44));
}

//----- (00440610) --------------------------------------------------------
void __usercall _L110154(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 112));
}

//----- (00440618) --------------------------------------------------------
void __usercall _L110155_0(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 64));
}

//----- (00440620) --------------------------------------------------------
void __usercall _L110156(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *)(a1 - 36));
}

//----- (00440628) --------------------------------------------------------
void __usercall _L110157(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *)(a1 - 32));
}

//----- (00440630) --------------------------------------------------------
void __usercall _L110158(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 28));
}

//----- (00440638) --------------------------------------------------------
void __usercall _L110159(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 48));
}

//----- (00440640) --------------------------------------------------------
void __usercall _L110160(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 112));
}

//----- (00440648) --------------------------------------------------------
void __usercall _L110161(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 24));
}

//----- (0044065C) --------------------------------------------------------
void __usercall _L110427(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 + 8));
}

//----- (00440664) --------------------------------------------------------
void __usercall _L110428(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (0044066C) --------------------------------------------------------
void __usercall _L110429(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 52));
}

//----- (00440674) --------------------------------------------------------
void __usercall _L110430(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 20));
}

//----- (0044067C) --------------------------------------------------------
void __usercall _L110431(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (00440684) --------------------------------------------------------
void __usercall _L110432(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 68));
}

//----- (0044068C) --------------------------------------------------------
void __usercall _L110433(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 16));
}

//----- (00440694) --------------------------------------------------------
void __usercall _L110434(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 36));
}

//----- (0044069C) --------------------------------------------------------
void __usercall _L110435(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 52));
}

//----- (004406A4) --------------------------------------------------------
void __usercall _L110436(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 36));
}

//----- (004406AC) --------------------------------------------------------
void __usercall _L110437(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 52));
}

//----- (004406B4) --------------------------------------------------------
void __usercall _L110438(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 36));
}

//----- (004406BC) --------------------------------------------------------
void __usercall _L110439(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 52));
}

//----- (00440784) --------------------------------------------------------
void __usercall _L114973(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  TSingleton<CIPCheckerServer>::~TSingleton<CIPCheckerServer>();
}

//----- (0044078F) --------------------------------------------------------
void __usercall _L114974(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 8));
}

//----- (0044079A) --------------------------------------------------------
void __usercall _L114975(int a1@<ebp>)
{
  ZSocket::~ZSocket((ZSocket *)(*(_DWORD *)(a1 - 16) + 32));
}

//----- (004407A5) --------------------------------------------------------
void __usercall _L114976(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 60));
}

//----- (004407B0) --------------------------------------------------------
void __usercall _L114977(int a1@<ebp>)
{
  ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>((ZList<ZRef<ZSocketBuffer> > *)(*(_DWORD *)(a1 - 16) + 84));
}

//----- (004407BB) --------------------------------------------------------
void __usercall _L114978(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(*(_DWORD *)(a1 - 16) + 108));
}

//----- (004407C6) --------------------------------------------------------
void __usercall _L114979(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 120));
}

//----- (004407DC) --------------------------------------------------------
void __usercall _L115253(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 8 : 0;
  TSingleton<CIPCheckerServer>::~TSingleton<CIPCheckerServer>();
}

//----- (004407F0) --------------------------------------------------------
void __usercall _L115254(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 8));
}

//----- (004407FB) --------------------------------------------------------
void __usercall _L115255(int a1@<ebp>)
{
  ZSocket::~ZSocket((ZSocket *)(*(_DWORD *)(a1 - 16) + 32));
}

//----- (00440806) --------------------------------------------------------
void __usercall _L115256(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 60));
}

//----- (00440811) --------------------------------------------------------
void __usercall _L115257(int a1@<ebp>)
{
  ZList<ZRef<ZSocketBuffer>>::~ZList<ZRef<ZSocketBuffer>>((ZList<ZRef<ZSocketBuffer> > *)(*(_DWORD *)(a1 - 16) + 84));
}

//----- (0044081C) --------------------------------------------------------
void __usercall _L115258(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(*(_DWORD *)(a1 - 16) + 108));
}

//----- (00440827) --------------------------------------------------------
void __usercall _L115259(int a1@<ebp>)
{
  CInPacket::~CInPacket((CInPacket *)(*(_DWORD *)(a1 - 16) + 120));
}

//----- (0044083C) --------------------------------------------------------
void __usercall _L115676(int a1@<ebp>)
{
  operator delete(*(void **)(a1 - 44));
}

//----- (00440846) --------------------------------------------------------
void __usercall _L115598(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 60));
}

//----- (0044084E) --------------------------------------------------------
void __usercall _L115599(int a1@<ebp>)
{
  CInPacket::AUTO_CLEAR::~AUTO_CLEAR((CInPacket::AUTO_CLEAR *)(a1 - 68));
}

//----- (0044086C) --------------------------------------------------------
void __usercall _L115932(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 36));
}

//----- (00440874) --------------------------------------------------------
void __usercall _L115933(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 52));
}

//----- (0044087C) --------------------------------------------------------
void __usercall _L115934(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 84));
}

//----- (00440884) --------------------------------------------------------
void __usercall _L115935(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 24));
}

//----- (0044088C) --------------------------------------------------------
void __usercall _L115936(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 52));
}

//----- (00440894) --------------------------------------------------------
void __usercall _L115937(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 68));
}

//----- (0044089C) --------------------------------------------------------
void __usercall _L115938(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 28));
}

//----- (004408A4) --------------------------------------------------------
void __usercall _L115939(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 52));
}

//----- (004408AC) --------------------------------------------------------
void __usercall _L115940(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 100));
}

//----- (004408B4) --------------------------------------------------------
void __usercall _L115941(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 32));
}

//----- (004408BC) --------------------------------------------------------
void __usercall _L115942(int a1@<ebp>)
{
  ZInetAddr::~ZInetAddr((ZInetAddr *)(a1 - 84));
}

//----- (004408C4) --------------------------------------------------------
void __usercall _L115943(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 60));
}

//----- (004408CC) --------------------------------------------------------
void __usercall _L116302(int a1@<ebp>)
{
  operator delete(*(void **)(a1 - 52));
}

//----- (004408D6) --------------------------------------------------------
void __usercall _L115945(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 76));
}

//----- (004408E8) --------------------------------------------------------
void __usercall _L116646(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (004408FC) --------------------------------------------------------
void __usercall _L116701(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (00440910) --------------------------------------------------------
void __usercall _L116855(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 20));
}

//----- (00440918) --------------------------------------------------------
void _L116856()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (00440A58) --------------------------------------------------------
void __usercall _L114268(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  TSingleton<CIPFilter>::~TSingleton<CIPFilter>();
}

//----- (00440A60) --------------------------------------------------------
int __usercall _L114269@<eax>(int a1@<ebp>)
{
  return `eh vector destructor iterator'(
           (void *)(*(_DWORD *)(a1 - 16) + 4),
           4u,
           3,
           (void (__thiscall *)(void *))ZArray<CIPRange>::~ZArray<CIPRange>);
}

//----- (00440A76) --------------------------------------------------------
int __usercall _L114270@<eax>(int a1@<ebp>)
{
  return `eh vector destructor iterator'(
           (void *)(*(_DWORD *)(a1 - 16) + 20),
           4u,
           3,
           (void (__thiscall *)(void *))ZArray<CIPRange>::~ZArray<CIPRange>);
}

//----- (00440A8C) --------------------------------------------------------
void __usercall _L114271(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 48));
}

//----- (00440AA4) --------------------------------------------------------
void __usercall _L114303(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 + 12));
}

//----- (00440AAC) --------------------------------------------------------
void __usercall _L114304(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 40));
}

//----- (00440AB4) --------------------------------------------------------
void __usercall _L114305(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 28));
}

//----- (00440ABC) --------------------------------------------------------
void __usercall _L114306_0(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 36));
}

//----- (00440AC4) --------------------------------------------------------
void __usercall _L114307(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 40));
}

//----- (00440ACC) --------------------------------------------------------
void __usercall _L114308(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 60));
}

//----- (00440AD4) --------------------------------------------------------
void __usercall _L114309(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 32));
}

//----- (00440AE8) --------------------------------------------------------
void __usercall _L114524(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 + 12));
}

//----- (00440AF0) --------------------------------------------------------
void __usercall _L114525(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00440AF8) --------------------------------------------------------
void __usercall _L114526(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 44));
}

//----- (00440B00) --------------------------------------------------------
void __usercall _L114527(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 20));
}

//----- (00440B08) --------------------------------------------------------
void __usercall _L114528(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00440B10) --------------------------------------------------------
void __usercall _L114529(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 60));
}

//----- (00440B18) --------------------------------------------------------
void __usercall _L114530(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 16));
}

//----- (00440B2C) --------------------------------------------------------
void __usercall _L114838(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 20));
}

//----- (00440B34) --------------------------------------------------------
void __usercall _L114839(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 84));
}

//----- (00440B3C) --------------------------------------------------------
void __usercall _L114840(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 100));
}

//----- (00440B44) --------------------------------------------------------
void __usercall _L114841(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 68));
}

//----- (00440B4C) --------------------------------------------------------
void __usercall _L114842(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 136));
}

//----- (00440B57) --------------------------------------------------------
void __usercall _L114843(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 68));
}

//----- (00440B5F) --------------------------------------------------------
void __usercall _L114844(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00440B67) --------------------------------------------------------
void __usercall _L114845(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 136));
}

//----- (00440B72) --------------------------------------------------------
void __usercall _L114846(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 36));
}

//----- (00440B7A) --------------------------------------------------------
void __usercall _L114847(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00440B82) --------------------------------------------------------
void __usercall _L114848(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 84));
}

//----- (00440B8A) --------------------------------------------------------
void __usercall _L114849(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00440B92) --------------------------------------------------------
void __usercall _L114850(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 84));
}

//----- (00440B9A) --------------------------------------------------------
void __usercall _L114851(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00440BA2) --------------------------------------------------------
void __usercall _L114852(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 84));
}

//----- (00440BAA) --------------------------------------------------------
void __usercall _L114853(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 32));
}

//----- (00440BB2) --------------------------------------------------------
void __usercall _L114854(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 100));
}

//----- (00440BBA) --------------------------------------------------------
void __usercall _L114855(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *)(a1 - 120));
}

//----- (00440BC2) --------------------------------------------------------
void __usercall _L114856(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *)(a1 - 40));
}

//----- (00440BCA) --------------------------------------------------------
void __usercall _L114857(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 48));
}

//----- (00440BD2) --------------------------------------------------------
void __usercall _L114858(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 60));
}

//----- (00440BDA) --------------------------------------------------------
void __usercall _L114859(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 168));
}

//----- (00440BE5) --------------------------------------------------------
void __usercall _L114860(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 28));
}

//----- (00440BED) --------------------------------------------------------
void __usercall _L114861(int a1@<ebp>)
{
  ZXString<unsigned short>::~ZXString<unsigned short>((ZXString<unsigned short> *)(a1 - 56));
}

//----- (00440BF5) --------------------------------------------------------
void __usercall _L114862(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 60));
}

//----- (00440BFD) --------------------------------------------------------
void __usercall _L114863(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 152));
}

//----- (00440C08) --------------------------------------------------------
void __usercall _L114864(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *)(a1 - 112));
}

//----- (00440C10) --------------------------------------------------------
void __usercall _L114865(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *)(a1 - 52));
}

//----- (00440C18) --------------------------------------------------------
void __usercall _L114866(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 60));
}

//----- (00440C20) --------------------------------------------------------
void __usercall _L114867(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 184));
}

//----- (00440C2B) --------------------------------------------------------
void __usercall _L114868(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 44));
}

//----- (00440C40) --------------------------------------------------------
void __usercall _L115578(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 24));
}

//----- (00440C48) --------------------------------------------------------
void __usercall _L115579(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 120));
}

//----- (00440C50) --------------------------------------------------------
void __usercall _L115580(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 84));
}

//----- (00440C58) --------------------------------------------------------
void __usercall _L115581(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 68));
}

//----- (00440C60) --------------------------------------------------------
void __usercall _L115582(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 136));
}

//----- (00440C6B) --------------------------------------------------------
void __usercall _L115583(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 68));
}

//----- (00440C73) --------------------------------------------------------
void __usercall _L115584(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 40));
}

//----- (00440C7B) --------------------------------------------------------
void __usercall _L115585(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 136));
}

//----- (00440C86) --------------------------------------------------------
void __usercall _L115586(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 44));
}

//----- (00440C8E) --------------------------------------------------------
void __usercall _L115587(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 40));
}

//----- (00440C96) --------------------------------------------------------
void __usercall _L115588(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 120));
}

//----- (00440C9E) --------------------------------------------------------
void __usercall _L115589(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 40));
}

//----- (00440CA6) --------------------------------------------------------
void __usercall _L115590(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 120));
}

//----- (00440CAE) --------------------------------------------------------
void __usercall _L115591(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 20));
}

//----- (00440CB6) --------------------------------------------------------
void __usercall _L115592(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 84));
}

//----- (00440CBE) --------------------------------------------------------
void __usercall _L115593(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *)(a1 - 92));
}

//----- (00440CC6) --------------------------------------------------------
void __usercall _L115594(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *)(a1 - 32));
}

//----- (00440CCE) --------------------------------------------------------
void __usercall _L115595(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 48));
}

//----- (00440CD6) --------------------------------------------------------
void __usercall _L115596_0(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 64));
}

//----- (00440CDE) --------------------------------------------------------
void __usercall _L115597_0(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 152));
}

//----- (00440CE9) --------------------------------------------------------
void __usercall _L115598_0(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 28));
}

//----- (00440CF1) --------------------------------------------------------
void __usercall _L115599_0(int a1@<ebp>)
{
  ZXString<unsigned short>::~ZXString<unsigned short>((ZXString<unsigned short> *)(a1 - 56));
}

//----- (00440CF9) --------------------------------------------------------
void __usercall _L115600(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 64));
}

//----- (00440D01) --------------------------------------------------------
void __usercall _L115601(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 168));
}

//----- (00440D0C) --------------------------------------------------------
void __usercall _L115602(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *)(a1 - 104));
}

//----- (00440D14) --------------------------------------------------------
void __usercall _L115603(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *)(a1 - 60));
}

//----- (00440D1C) --------------------------------------------------------
void __usercall _L115604(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 64));
}

//----- (00440D24) --------------------------------------------------------
void __usercall _L115605(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 184));
}

//----- (00440D2F) --------------------------------------------------------
void __usercall _L115606(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 36));
}

//----- (00440D6C) --------------------------------------------------------
void __usercall _L117337(int a1@<ebp>)
{
  ZXString<unsigned short>::~ZXString<unsigned short>((ZXString<unsigned short> *)(a1 - 16));
}

//----- (00440E0C) --------------------------------------------------------
void __usercall _L118946(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (00440E20) --------------------------------------------------------
void __usercall _L109971(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 12 : 0;
  TSingleton<CLog>::~TSingleton<CLog>();
}

//----- (00440E34) --------------------------------------------------------
void __usercall _L109972(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  JUMPOUT(ZThread::~ZThread);
}

//----- (00440E3C) --------------------------------------------------------
void __usercall _L109973(int a1@<ebp>)
{
  ZArray<CLog::FILEINFO>::~ZArray<CLog::FILEINFO>((ZArray<CLog::FILEINFO> *)(*(_DWORD *)(a1 - 16) + 12));
}

//----- (00440E47) --------------------------------------------------------
void __usercall _L109974(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 16));
}

//----- (00440E52) --------------------------------------------------------
void __usercall _L109975(int a1@<ebp>)
{
  ZList<CLog::FILELOG>::~ZList<CLog::FILELOG>((ZList<CLog::FILELOG> *)(*(_DWORD *)(a1 - 16) + 44));
}

//----- (00440E68) --------------------------------------------------------
void __usercall _L110154_0(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (00440E7C) --------------------------------------------------------
void __usercall _L110363(int a1@<ebp>)
{
  ZList<CLog::FILELOG>::~ZList<CLog::FILELOG>((ZList<CLog::FILELOG> *)(a1 - 56));
}

//----- (00440E84) --------------------------------------------------------
void __usercall _L110364(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 20));
}

//----- (00440E98) --------------------------------------------------------
void __usercall _L110617(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 12));
}

//----- (00440EA0) --------------------------------------------------------
void __usercall _L110618(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00440EB4) --------------------------------------------------------
void __usercall _L110792(int a1@<ebp>)
{
  _com_error::~_com_error((_com_error *)(a1 - 28));
}

//----- (00440EBC) --------------------------------------------------------
void __usercall _L110793(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (00440ED0) --------------------------------------------------------
void __usercall _L110839(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (00440F34) --------------------------------------------------------
void __usercall _L112636(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (00440F3C) --------------------------------------------------------
void __usercall _L112637(int a1@<ebp>)
{
  ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>::~ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream>((ZRecyclable<ZRefCountedDummy<ZFileStream>,16,ZFileStream> *)(*(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 12 : 0));
}

//----- (00440F50) --------------------------------------------------------
void __usercall _L112640(int a1@<ebp>)
{
  ZISeekableStream::~ZISeekableStream(*(ZISeekableStream **)(a1 - 20));
}

//----- (00440F58) --------------------------------------------------------
void __usercall _L112641(int a1@<ebp>)
{
  ZFixedArray<unsigned char,65536,0>::~ZFixedArray<unsigned char,65536,0>((ZFixedArray<unsigned char,65536,0> *)(*(_DWORD *)(a1 - 20) + 48));
}

//----- (00440F70) --------------------------------------------------------
void __usercall _L113126(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(*(_DWORD *)(a1 - 16) + 4));
}

//----- (00440F88) --------------------------------------------------------
void __usercall _L113309(int a1@<ebp>)
{
  ZISeekableStream::~ZISeekableStream(*(ZISeekableStream **)(a1 - 16));
}

//----- (00440F90) --------------------------------------------------------
void __usercall _L113310(int a1@<ebp>)
{
  ZFixedArray<unsigned char,65536,0>::~ZFixedArray<unsigned char,65536,0>((ZFixedArray<unsigned char,65536,0> *)(*(_DWORD *)(a1 - 16) + 48));
}

//----- (00440FA8) --------------------------------------------------------
void __usercall _L113389(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (00441040) --------------------------------------------------------
void __usercall _L114579(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 12));
}

//----- (00441048) --------------------------------------------------------
void __usercall _L114580(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (00441070) --------------------------------------------------------
void __usercall _L114891(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (00441078) --------------------------------------------------------
void __usercall _L114892(int a1@<ebp>)
{
  ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>::~ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG>((ZRecyclable<ZRefCountedDummy<CLog::FILELOG>,16,CLog::FILELOG> *)(*(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 12 : 0));
}

//----- (00441098) --------------------------------------------------------
void __usercall _L114942(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004410B4) --------------------------------------------------------
void __usercall _L115184(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  TSingleton<CLoginAcceptor>::~TSingleton<CLoginAcceptor>();
}

//----- (004410CC) --------------------------------------------------------
void __usercall _L115294(int a1@<ebp>)
{
  ZSocketAcceptor<CClientSocket>::~ZSocketAcceptor<CClientSocket>(*(ZSocketAcceptor<CClientSocket> **)(a1 - 16));
}

//----- (004410D4) --------------------------------------------------------
void __usercall _L115295_0(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 16 : 0;
  TSingleton<CLoginAcceptor>::~TSingleton<CLoginAcceptor>();
}

//----- (004410E8) --------------------------------------------------------
void __usercall _L115296(int a1@<ebp>)
{
  ZPort::~ZPort((ZPort *)(*(_DWORD *)(a1 - 16) + 20));
}

//----- (004410F3) --------------------------------------------------------
void __usercall _L115297(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 84));
}

//----- (004410FE) --------------------------------------------------------
void __usercall _L115298(int a1@<ebp>)
{
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *v1; // ecx@1

  v1 = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long> *)(*(_DWORD *)(a1 - 16) + 108);
  v1->vfptr = (ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>Vtbl *)&ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable';
  ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::RemoveAll(v1);
}
// 4435D4: using guessed type int (__thiscall *ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::`vftable')(void *p, unsigned int __flags);

//----- (00441109) --------------------------------------------------------
void __usercall _L115299(int a1@<ebp>)
{
  ZList<ZRef<CClientSocket>>::~ZList<ZRef<CClientSocket>>((ZList<ZRef<CClientSocket> > *)(*(_DWORD *)(a1 - 16) + 132));
}

//----- (00441117) --------------------------------------------------------
void __usercall _L115300(int a1@<ebp>)
{
  ZMap<unsigned long,unsigned long,unsigned long>::~ZMap<unsigned long,unsigned long,unsigned long>((ZMap<unsigned long,unsigned long,unsigned long> *)(*(_DWORD *)(a1 - 16) + 172));
}

//----- (00441130) --------------------------------------------------------
void __usercall _L115519(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (00441144) --------------------------------------------------------
void __usercall _L115641(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 52));
}

//----- (0044114C) --------------------------------------------------------
void __usercall _L115642(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 32));
}

//----- (00441154) --------------------------------------------------------
void __usercall _L115643(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 60));
}

//----- (0044115C) --------------------------------------------------------
void __usercall _L115644(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 60));
}

//----- (00441164) --------------------------------------------------------
void __usercall _L115645(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 60));
}

//----- (0044116C) --------------------------------------------------------
void __usercall _L115868_0(int a1@<ebp>)
{
  operator delete(*(void **)(a1 - 36));
}

//----- (00441176) --------------------------------------------------------
void __usercall _L115648(int a1@<ebp>)
{
  ZMap<unsigned long,unsigned long,unsigned long>::~ZMap<unsigned long,unsigned long,unsigned long>((ZMap<unsigned long,unsigned long,unsigned long> *)(a1 - 84));
}

//----- (0044117E) --------------------------------------------------------
void __usercall _L115647(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 40));
}

//----- (00441186) --------------------------------------------------------
void __usercall _L115649(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 28));
}

//----- (00441198) --------------------------------------------------------
void __usercall _L116522(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 28));
}

//----- (004411A0) --------------------------------------------------------
void __usercall _L116523(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 20));
}

//----- (004411A8) --------------------------------------------------------
void __usercall _L116524(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 16) & 1 )
    ZRef<CClientSocket>::~ZRef<CClientSocket>(*(ZRef<CClientSocket> **)(a1 + 8));
}

//----- (004411CC) --------------------------------------------------------
void __usercall _L116672(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004411E0) --------------------------------------------------------
void __usercall _L116956(int a1@<ebp>)
{
  ZSocketBase::~ZSocketBase((ZSocketBase *)(*(_DWORD *)(a1 - 16) + 8));
}

//----- (004411EB) --------------------------------------------------------
void __usercall _L116957(int a1@<ebp>)
{
  ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>::~ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped>((ZArray<ZSocketAcceptor<CClientSocket>::ZAcceptOverlapped> *)(*(_DWORD *)(a1 - 16) + 12));
}

//----- (004412A4) --------------------------------------------------------
void __usercall _L119839(int a1@<ebp>)
{
  ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>::~ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR>(*(ZRecyclable<ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR,16,ZMap<unsigned long,ZRef<CClientSocket>,unsigned long>::_PAIR> **)(a1 - 16));
}

//----- (004412CC) --------------------------------------------------------
void __usercall _L120296(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004412E0) --------------------------------------------------------
void __usercall _L120360_0(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004413A8) --------------------------------------------------------
void __usercall _L121499(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (004413B0) --------------------------------------------------------
void __usercall _L121500(int a1@<ebp>)
{
  ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>::~ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket>>,16,ZRef<CClientSocket>>((ZRecyclable<ZRefCountedDummy<ZRef<CClientSocket> >,16,ZRef<CClientSocket> > *)(*(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 12 : 0));
}

//----- (004413D0) --------------------------------------------------------
void __usercall _L121579(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004413E4) --------------------------------------------------------
void __usercall _L123638(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004413EC) --------------------------------------------------------
void __usercall _L123639(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 24));
}

//----- (00441440) --------------------------------------------------------
void __usercall _L122492(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (00441454) --------------------------------------------------------
void __usercall _L122760(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (0044145C) --------------------------------------------------------
void __usercall _L122761(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 44));
}

//----- (00441464) --------------------------------------------------------
void __usercall _L122762(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 20));
}

//----- (0044146C) --------------------------------------------------------
void __usercall _L122763(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00441474) --------------------------------------------------------
void __usercall _L122764(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 60));
}

//----- (0044147C) --------------------------------------------------------
void __usercall _L122765(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 16));
}

//----- (00441484) --------------------------------------------------------
void __usercall _L122766(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (0044148C) --------------------------------------------------------
void __usercall _L122767(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (004414B4) --------------------------------------------------------
void __usercall _L123035(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 76));
}

//----- (004414BC) --------------------------------------------------------
void __usercall _L123036(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 116));
}

//----- (004414C4) --------------------------------------------------------
void __usercall _L123037(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 24));
}

//----- (004414CC) --------------------------------------------------------
void __usercall _L123038(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 100));
}

//----- (004414D4) --------------------------------------------------------
void __usercall _L123039(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IUnknown,&__s_GUID _GUID_00000000_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IUnknown,&_GUID_00000000_0000_0000_c000_000000000046> > *)(a1 - 56));
}

//----- (004414DC) --------------------------------------------------------
void __usercall _L123040(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>::~_com_ptr_t<_com_IIID<IEnumVARIANT,&__s_GUID _GUID_00020404_0000_0000_c000_000000000046>>((_com_ptr_t<_com_IIID<IEnumVARIANT,&_GUID_00020404_0000_0000_c000_000000000046> > *)(a1 - 36));
}

//----- (004414E4) --------------------------------------------------------
void __usercall _L123041(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 32));
}

//----- (004414EC) --------------------------------------------------------
void __usercall _L123042(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 84));
}

//----- (004414F4) --------------------------------------------------------
void __usercall _L123043(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 132));
}

//----- (004414FF) --------------------------------------------------------
void __usercall _L123044(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 28));
}

//----- (00441507) --------------------------------------------------------
void __usercall _L123045(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>(*(_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > **)(a1 - 84));
}

//----- (0044151C) --------------------------------------------------------
void __usercall _L123291(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00441524) --------------------------------------------------------
void __usercall _L123292(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 40));
}

//----- (0044152C) --------------------------------------------------------
void __usercall _L123293(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 20));
}

//----- (00441534) --------------------------------------------------------
void __usercall _L123294(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (0044153C) --------------------------------------------------------
void __usercall _L123295(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 56));
}

//----- (00441544) --------------------------------------------------------
void __usercall _L123296(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0044154C) --------------------------------------------------------
void __usercall _L123297(int a1@<ebp>)
{
  ZInetAddr::~ZInetAddr((ZInetAddr *)(a1 - 72));
}

//----- (00441560) --------------------------------------------------------
void __usercall _L123550(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (00441568) --------------------------------------------------------
void __usercall _L123551(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 40));
}

//----- (00441570) --------------------------------------------------------
void __usercall _L123552(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 - 16));
}

//----- (00441578) --------------------------------------------------------
void __usercall _L123553(int a1@<ebp>)
{
  ZInetAddr::~ZInetAddr((ZInetAddr *)(a1 - 56));
}

//----- (004415A0) --------------------------------------------------------
void __usercall _L123768(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 116));
}

//----- (004415A8) --------------------------------------------------------
void __usercall _L123769(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 100));
}

//----- (004415B0) --------------------------------------------------------
void __usercall _L123770(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 44));
}

//----- (004415B8) --------------------------------------------------------
void __usercall _L123771(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 212));
}

//----- (004415C3) --------------------------------------------------------
void __usercall _L123772(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 20));
}

//----- (004415CB) --------------------------------------------------------
void __usercall _L123773(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 44));
}

//----- (004415D3) --------------------------------------------------------
void __usercall _L123774(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 80));
}

//----- (004415DB) --------------------------------------------------------
void __usercall _L123775(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 148));
}

//----- (004415E6) --------------------------------------------------------
void __usercall _L123776(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 196));
}

//----- (004415F1) --------------------------------------------------------
void __usercall _L123777(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 44));
}

//----- (004415F9) --------------------------------------------------------
void __usercall _L123778(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 244));
}

//----- (00441604) --------------------------------------------------------
void __usercall _L123779(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 36));
}

//----- (0044160C) --------------------------------------------------------
void __usercall _L123780(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 32));
}

//----- (00441614) --------------------------------------------------------
void __usercall _L123781(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 44));
}

//----- (0044161C) --------------------------------------------------------
void __usercall _L123782(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 80));
}

//----- (00441624) --------------------------------------------------------
void __usercall _L123783(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 52));
}

//----- (0044162C) --------------------------------------------------------
void __usercall _L123784(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 48));
}

//----- (00441634) --------------------------------------------------------
void __usercall _L123785(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 40));
}

//----- (0044163C) --------------------------------------------------------
void __usercall _L123786(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 132));
}

//----- (00441647) --------------------------------------------------------
void __usercall _L123787(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 180));
}

//----- (00441652) --------------------------------------------------------
void __usercall _L123788(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (0044165A) --------------------------------------------------------
void __usercall _L123789(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 276));
}

//----- (00441665) --------------------------------------------------------
void __usercall _L123790(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 80));
}

//----- (0044166D) --------------------------------------------------------
void __usercall _L123791(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 164));
}

//----- (00441678) --------------------------------------------------------
void __usercall _L123792(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (00441680) --------------------------------------------------------
void __usercall _L123793(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 228));
}

//----- (0044168B) --------------------------------------------------------
void __usercall _L123794(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (00441693) --------------------------------------------------------
void __usercall _L123795(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 260));
}

//----- (0044169E) --------------------------------------------------------
void __usercall _L123796(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 84));
}

//----- (004416A6) --------------------------------------------------------
void __usercall _L123797(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 292));
}

//----- (004416BC) --------------------------------------------------------
void __usercall _L124477_0(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 12));
}

//----- (004416D0) --------------------------------------------------------
void __usercall _L124914(int a1@<ebp>)
{
  operator delete(*(void **)(a1 - 16));
}

//----- (004416DA) --------------------------------------------------------
void __usercall _L124930(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  TSingleton<CIPChecker>::~TSingleton<CIPChecker>();
}

//----- (004416E2) --------------------------------------------------------
void __usercall _L124931(int a1@<ebp>)
{
  ZArray<CIPChecker::IPELEM>::~ZArray<CIPChecker::IPELEM>(*(ZArray<CIPChecker::IPELEM> **)(a1 - 16));
}

//----- (00441708) --------------------------------------------------------
void __usercall _L125056(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 4 : 0;
  TSingleton<CSecurityServer>::~TSingleton<CSecurityServer>();
}

//----- (0044171C) --------------------------------------------------------
void __usercall _L125057(int a1@<ebp>)
{
  ZArray<unsigned long>::~ZArray<unsigned long>((ZArray<unsigned long> *)(*(_DWORD *)(a1 - 16) + 12));
}

//----- (00441748) --------------------------------------------------------
void __usercall _L125290(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (00441764) --------------------------------------------------------
void __usercall _L125483(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  JUMPOUT(ZThread::~ZThread);
}

//----- (0044176C) --------------------------------------------------------
void __usercall _L125484(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16) != 0 ? *(_DWORD *)(a1 - 16) + 12 : 0;
  TSingleton<TSelfTestThread<CLoginAcceptor>>::~TSingleton<TSelfTestThread<CLoginAcceptor>>();
}

//----- (004418A4) --------------------------------------------------------
void __usercall _L128706(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (004418B8) --------------------------------------------------------
void __usercall _L128939(int a1@<ebp>)
{
  operator delete(*(void **)(a1 - 16), *(void **)(a1 + 8));
}

//----- (004419B4) --------------------------------------------------------
void __usercall _L130414(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 + 8));
}

//----- (00441B08) --------------------------------------------------------
void __usercall _L109533(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 45072));
}

//----- (00441B20) --------------------------------------------------------
void __usercall _L109553(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 24));
}

//----- (00441B28) --------------------------------------------------------
void __usercall _L109554(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00441BF0) --------------------------------------------------------
void __usercall _L109692(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 12));
}

//----- (00441C00) --------------------------------------------------------
void __usercall _L109694(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00441C08) --------------------------------------------------------
void __usercall _L109695(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 24) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (00441CE0) --------------------------------------------------------
void __usercall _L115078(int a1@<ebp>)
{
  ZRefCounted::~ZRefCounted(*(ZRefCounted **)(a1 - 16));
}

//----- (00441F1C) --------------------------------------------------------
void __usercall _L110341(int a1@<ebp>)
{
  ZArray<unsigned char>::~ZArray<unsigned char>((ZArray<unsigned char> *)(*(_DWORD *)(a1 - 16) + 8));
}

//----- (00441F3C) --------------------------------------------------------
void __usercall _L110802(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00441F44) --------------------------------------------------------
void __usercall _L110803(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 24) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (00441F68) --------------------------------------------------------
void __usercall _L110913(int a1@<ebp>)
{
  ZArray<unsigned char>::~ZArray<unsigned char>((ZArray<unsigned char> *)(*(_DWORD *)(a1 - 20) + 4));
}

//----- (00441F80) --------------------------------------------------------
void __usercall _L111253(int a1@<ebp>)
{
  ZRef<ZSocketBuffer>::~ZRef<ZSocketBuffer>((ZRef<ZSocketBuffer> *)(a1 - 36));
}

//----- (00441F9C) --------------------------------------------------------
void __usercall _L111651(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00441FA4) --------------------------------------------------------
void __usercall _L111652(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 24) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (004421E4) --------------------------------------------------------
void __usercall _L110490(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 24));
}

//----- (004422BC) --------------------------------------------------------
void __usercall _L110255(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>::~_com_ptr_t<_com_IIID<IWzFileSystem,&__s_GUID _GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5>>((_com_ptr_t<_com_IIID<IWzFileSystem,&_GUID_352d8655_51e4_4668_8ce4_0866e2b6a5b5> > *)(a1 - 16));
}

//----- (004422C4) --------------------------------------------------------
void __usercall _L110256(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (004422CC) --------------------------------------------------------
void __usercall _L110257(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (004422D4) --------------------------------------------------------
void __usercall _L110258(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (004422DC) --------------------------------------------------------
void __usercall _L110259(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 24));
}

//----- (004422E4) --------------------------------------------------------
void __usercall _L110260(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 60));
}

//----- (004422EC) --------------------------------------------------------
void __usercall _L110261(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 44));
}

//----- (004422F4) --------------------------------------------------------
void __usercall _L110262(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 24));
}

//----- (004422FC) --------------------------------------------------------
void __usercall _L110263(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 76));
}

//----- (004423D8) --------------------------------------------------------
void __usercall _L112911(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 + 8));
}

//----- (004423EC) --------------------------------------------------------
void __usercall _L112989(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t((Ztl_bstr_t *)(a1 + 8));
}

//----- (00442400) --------------------------------------------------------
void __usercall _L109752(int a1@<ebp>)
{
  int v1; // ecx@1

  v1 = *(_DWORD *)(a1 - 16);
  TSingleton<CServerDialog>::~TSingleton<CServerDialog>();
}

//----- (00442420) --------------------------------------------------------
void __usercall _L109882(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (00442434) --------------------------------------------------------
void __usercall _L110005(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00442448) --------------------------------------------------------
void __usercall _L110048(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 16));
}

//----- (0044245C) --------------------------------------------------------
void __usercall _L110106(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 + 12));
}

//----- (00442524) --------------------------------------------------------
void __usercall _L111221(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 4));
}

//----- (0044253C) --------------------------------------------------------
void __usercall _L111651_0(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 4));
}

//----- (00442554) --------------------------------------------------------
void __usercall _L111698(int a1@<ebp>)
{
  ZCriticalSectionEx<4000>::~ZCriticalSectionEx<4000>((ZCriticalSectionEx<4000> *)(*(_DWORD *)(a1 - 16) + 4));
}

//----- (00442620) --------------------------------------------------------
void _L113216()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (00442628) --------------------------------------------------------
void __usercall _L113217(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 40));
}

//----- (00442630) --------------------------------------------------------
void __usercall _L113218(int a1@<ebp>)
{
  ZRef<CClientSocket>::~ZRef<CClientSocket>((ZRef<CClientSocket> *)(a1 - 48));
}

//----- (00442638) --------------------------------------------------------
void __usercall _L113219(int a1@<ebp>)
{
  ZSynchronizedHelper<ZCriticalSectionEx<4000>>::~ZSynchronizedHelper<ZCriticalSectionEx<4000>>((ZSynchronizedHelper<ZCriticalSectionEx<4000> > *)(a1 - 40));
}

//----- (00442778) --------------------------------------------------------
void __usercall _L110124_0(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (00442780) --------------------------------------------------------
void __usercall _L110125(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 24));
}

//----- (00442794) --------------------------------------------------------
void __usercall _L110390(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0044279C) --------------------------------------------------------
void __usercall _L110391(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 24) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (004427C0) --------------------------------------------------------
void __usercall _L110497(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 24));
}

//----- (004427C8) --------------------------------------------------------
void __usercall _L110498(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (004427D0) --------------------------------------------------------
void __usercall _L110499(int a1@<ebp>)
{
  _bstr_t::~_bstr_t((_bstr_t *)(a1 + 12));
}

//----- (004427D8) --------------------------------------------------------
void __usercall _L110500_0(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IErrorInfo,&__s_GUID _GUID_1cf2b120_547d_101b_8e65_08002b2bd119>>::~_com_ptr_t<_com_IIID<IErrorInfo,&__s_GUID _GUID_1cf2b120_547d_101b_8e65_08002b2bd119>>((_com_ptr_t<_com_IIID<IErrorInfo,&_GUID_1cf2b120_547d_101b_8e65_08002b2bd119> > *)(a1 + 12));
}

//----- (004427E0) --------------------------------------------------------
void __usercall _L110501(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (004427E8) --------------------------------------------------------
void __usercall _L110502(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 32) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (0044280C) --------------------------------------------------------
void __usercall _L110733(int a1@<ebp>)
{
  _com_error::~_com_error((_com_error *)(a1 - 28));
}

//----- (00442820) --------------------------------------------------------
void __usercall _L110749(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 16) & 1 )
    Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 + 8));
}

//----- (00442837) --------------------------------------------------------
void __usercall _L110752(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 32));
}

//----- (0044284C) --------------------------------------------------------
void __usercall _L110856(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 + 12));
}

//----- (00442854) --------------------------------------------------------
void __usercall _L110857(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (0044285C) --------------------------------------------------------
void __usercall _L110858(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (00442864) --------------------------------------------------------
void __usercall _L110859(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 60));
}

//----- (0044286C) --------------------------------------------------------
void __usercall _L110860(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 + 16));
}

//----- (00442874) --------------------------------------------------------
void __usercall _L110861(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 20) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (0044288B) --------------------------------------------------------
void __usercall _L110864(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (00442893) --------------------------------------------------------
void __usercall _L110865(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 44));
}

//----- (004428A8) --------------------------------------------------------
void __usercall _L111049(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 16));
}

//----- (004428B0) --------------------------------------------------------
void __usercall _L111050(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 + 12));
}

//----- (004428B8) --------------------------------------------------------
void __usercall _L111051(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 20));
}

//----- (004428C0) --------------------------------------------------------
void __usercall _L111052(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 32));
}

//----- (004428C8) --------------------------------------------------------
void __usercall _L111053(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 64));
}

//----- (004428D0) --------------------------------------------------------
void __usercall _L111054(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 16));
}

//----- (004428D8) --------------------------------------------------------
void __usercall _L111055(int a1@<ebp>)
{
  if ( *(_DWORD *)(a1 - 24) & 1 )
    ZXString<char>::~ZXString<char>(*(ZXString<char> **)(a1 + 8));
}

//----- (004428EF) --------------------------------------------------------
void __usercall _L111058_0(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 32));
}

//----- (004428F7) --------------------------------------------------------
void __usercall _L111059(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 48));
}

//----- (004429D4) --------------------------------------------------------
void __usercall _L109433(int a1@<ebp>)
{
  _com_error::~_com_error((_com_error *)(a1 - 28));
}

//----- (004429DC) --------------------------------------------------------
void __usercall _L109434(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (004429F0) --------------------------------------------------------
void __usercall _L109485(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (00442C34) --------------------------------------------------------
void __usercall _L110527(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00442C48) --------------------------------------------------------
void __usercall _L110596(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 20));
}

//----- (00442C50) --------------------------------------------------------
void __usercall _L110597(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 80));
}

//----- (00442C58) --------------------------------------------------------
void __usercall _L110598(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 64));
}

//----- (00442C60) --------------------------------------------------------
void __usercall _L110599(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 44));
}

//----- (00442C68) --------------------------------------------------------
void __usercall _L110600(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 96));
}

//----- (00442C70) --------------------------------------------------------
void __usercall _L110601(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 28));
}

//----- (00442C78) --------------------------------------------------------
void __usercall _L110602(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 96));
}

//----- (00442C80) --------------------------------------------------------
void __usercall _L110603_0(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 32));
}

//----- (00442C88) --------------------------------------------------------
void __usercall _L110604_0(int a1@<ebp>)
{
  ZXString<unsigned short>::~ZXString<unsigned short>((ZXString<unsigned short> *)(a1 - 28));
}

//----- (00442C90) --------------------------------------------------------
void __usercall _L110605(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 48));
}

//----- (00442C98) --------------------------------------------------------
void __usercall _L110606(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 80));
}

//----- (00442CA0) --------------------------------------------------------
void __usercall _L110607(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 48));
}

//----- (00442CA8) --------------------------------------------------------
void __usercall _L110608_0(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 64));
}

//----- (00442CB0) --------------------------------------------------------
void __usercall _L110609_0(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 48));
}

//----- (00442CB8) --------------------------------------------------------
void __usercall _L110610(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 80));
}

//----- (00442CC0) --------------------------------------------------------
void __usercall _L110611(int a1@<ebp>)
{
  _com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>::~_com_ptr_t<_com_IIID<IWzProperty,&__s_GUID _GUID_986515d9_0a0b_4929_8b4f_718682177b92>>((_com_ptr_t<_com_IIID<IWzProperty,&_GUID_986515d9_0a0b_4929_8b4f_718682177b92> > *)(a1 - 40));
}

//----- (00442CC8) --------------------------------------------------------
void __usercall _L110612(int a1@<ebp>)
{
  Ztl_bstr_t::~Ztl_bstr_t(*(Ztl_bstr_t **)(a1 - 48));
}

//----- (00442CD0) --------------------------------------------------------
void __usercall _L110613(int a1@<ebp>)
{
  Ztl_variant_t::~Ztl_variant_t((Ztl_variant_t *)(a1 - 64));
}

//----- (00442D98) --------------------------------------------------------
void __usercall _L112012(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 12));
}

//----- (00442DA0) --------------------------------------------------------
void __usercall _L112013_0(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 16));
}

//----- (00442DB4) --------------------------------------------------------
void _L112135_0()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (00442DC8) --------------------------------------------------------
void __usercall _L112586(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (00442DDC) --------------------------------------------------------
void __usercall _L112626(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

//----- (00442DE4) --------------------------------------------------------
void _L112627()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (00442DEC) --------------------------------------------------------
void __usercall _L112628(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 - 16));
}

//----- (00442E00) --------------------------------------------------------
void _L112830()
{
  JUMPOUT(COutPacket::~COutPacket);
}

//----- (00442E08) --------------------------------------------------------
void __usercall _L112831(int a1@<ebp>)
{
  ZXString<char>::~ZXString<char>((ZXString<char> *)(a1 + 8));
}

#error "There were 11 decompilation failure(s) on 2629 function(s)"
